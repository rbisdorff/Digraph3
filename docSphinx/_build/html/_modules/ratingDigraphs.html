<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ratingDigraphs &mdash; Digraph3 3.13.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sphinx_rtd_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=6aaf4047"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=15d7cbb8"></script>
        <script src="../_static/js/hoverxref.js?v=4352a7d3"></script>
        <script src="../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
        <script src="../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Python 3.13
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">ratingDigraphs</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ratingDigraphs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Digraph3 collection of python3 modules for</span>
<span class="sd">Algorithmic Decision Theory applications.</span>

<span class="sd">Module for relative and absolute rating of multicriteria performance records </span>
<span class="sd">with abstract *RatingDigraph* root class.</span>

<span class="sd">The module, better suitable for rating problems of small sizes (&lt; 500 mulicriteria performance records), reimplements a simpler and more consistent version</span>
<span class="sd">of the MP optimised :py:class:`~sortingDigraphs.QuantilesSortingDigraph` and the</span>
<span class="sd">:py:class:`~sortingDigraphs.LearnedQuantilesRatingDigraph` classes from the</span>
<span class="sd">:py:mod:`sortingDigraphs` module.</span>

<span class="sd">Copyright (C) 2016-2023  Raymond Bisdorff.</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR ANY PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along</span>
<span class="sd">    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="sd">    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">.. note::</span>
<span class="sd">    The actions attribute of RatingDigraph instances contains besides the</span>
<span class="sd">    standard Digraph.actions (stored in *self.actionsOrig*) also the</span>
<span class="sd">    quantile limit profiles (stored in *self.profiles*).</span>

<span class="sd">    The *ratingDigraphs* module is not optimised for *BigData* applications.</span>
<span class="sd">    In such cases, it is recommended to use instead the</span>
<span class="sd">    MP optimised *sortingDigraph* module. </span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">######### abstract root class</span>
<span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
<div class="viewcode-block" id="RatingDigraph">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RatingDigraph</span><span class="p">(</span><span class="n">BipolarOutrankingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract root class with generic private and public methods</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Abstract root class with private and public methods for RatingDigraph instances&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default presentation method for relative quantiles</span>
<span class="sd">        rating digraph instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">repString</span> <span class="o">=</span>  <span class="s1">&#39;*-----  Object instance description -----------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Actions             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Criteria            : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Quantiles           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Lowerclosed         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">])</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Rankingrule         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Size                : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Valuation domain    : [</span><span class="si">%.2f</span><span class="s1">;</span><span class="si">%.2f</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span>\
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">==</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span>
                <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Uncertainty model  : </span><span class="si">%s</span><span class="s1">(a=</span><span class="si">%.1f</span><span class="s1">,b=</span><span class="si">%.1f</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Uncertainty model    : </span><span class="si">%s</span><span class="s1">(a=</span><span class="si">%s</span><span class="s1">,b=</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;2w&#39;</span><span class="p">)</span> 
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Likelihood domain    : [-1.0;+1.0]</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Confidence level     : </span><span class="si">%.2f</span><span class="s1"> (</span><span class="si">%.1f%%</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                         <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span><span class="p">,</span>\
                          <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="mf">100.0</span> <span class="p">)</span>
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Confident majority   : </span><span class="si">%.2f</span><span class="s1"> (</span><span class="si">%.1f%%</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidenceCutLevel</span><span class="p">,</span>\
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidenceCutLevel</span><span class="o">+</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Determinateness (</span><span class="si">%%</span><span class="s1">): </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                         <span class="bp">self</span><span class="o">.</span><span class="n">computeDeterminateness</span><span class="p">(</span><span class="n">InPercents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes          : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;*------  Constructor run times (in sec.) ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Threads             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Threads             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;StartMethod         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;StartMethod         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Total time          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Data input          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Compute quantiles   : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;Compute outrankings : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;outrankingRelation&#39;</span><span class="p">]</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;rating-by-sorting   : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sortingRelation&#39;</span><span class="p">]</span>
        <span class="n">repString</span> <span class="o">+=</span> <span class="s1">&#39;rating-by-ranking   : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;rating-by-ranking&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">repString</span>
    
<div class="viewcode-block" id="RatingDigraph.exportRatingBySortingGraphViz">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.exportRatingBySortingGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportRatingBySortingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;decreasing&#39;</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                       <span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for weak order (Hasse diagram) drawing</span>
<span class="sd">        filtering from SortingDigraph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

        <span class="c1"># backup actions and relation        </span>
        <span class="n">relationBkp</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="n">actionsBkp</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>

        <span class="c1"># computing rating preorder</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;decreasing&#39;</span><span class="p">:</span>
            <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantileOrdering</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantileOrdering</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
                                
        <span class="c1">#  the preorder reltion being transitive</span>
        <span class="c1">#  we use the exportGraphViz() method of the TransitiveDigraph class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computePreorderRelation</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getActionsKeys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isTransitive</span><span class="p">())</span>
        <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="n">TransitiveDigraph</span>
        <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                         <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                                         <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                                         <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                         <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                                         <span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">,</span>
                                         <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                                         <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


        <span class="c1"># restore original actions and relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actionsBkp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relationBkp</span></div>

    
<span class="c1">#------------</span>
<div class="viewcode-block" id="RatingDigraph.exportRatingByRankingGraphViz">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.exportRatingByRankingGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportRatingByRankingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                             <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                             <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                             <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for Hasse diagram drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
            
        <span class="k">def</span> <span class="nf">_safeName</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">QuantileName</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">QuantileName</span><span class="p">:</span> <span class="c1"># graphviz node names must not start with a digit</span>
                <span class="n">t0</span> <span class="o">=</span> <span class="n">t0</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   
            <span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">t1</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">t1</span>
        
        <span class="c1"># working on a deepcopy of self</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;profile limits:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                  <span class="n">digraph</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;relative quantile contents:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                  <span class="n">digraph</span><span class="o">.</span><span class="n">relativeCategoryContent</span><span class="p">)</span>

        <span class="c1"># constructing rankingByBestChoosing result</span>
        <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),[</span><span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]))</span>
                <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),[</span><span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>

            
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>

        <span class="c1"># install rating relation (weakly transitive)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">_computeRatingRelation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;digraph is transitive ?&#39;</span><span class="p">,</span> <span class="n">digraph</span><span class="o">.</span><span class="n">isTransitive</span><span class="p">())</span>
        
        <span class="c1"># sorting actionsKeys</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">)</span>
        
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_ratbyrank&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="c1"># writing out graphviz instructions</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="n">bgcolor</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz)</span><span class="se">\\</span><span class="s1">n R. Bisdorff, 2020&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;,fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fontSize</span><span class="p">)</span>
        <span class="c1"># nodes</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
            <span class="c1">#print(digraphClass)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                <span class="n">cat</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; _&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="s1">&#39;_ &#39;</span> <span class="o">+</span><span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;box&quot;, fillcolor=lightcoral, style=filled, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">QuantileName</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>           
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        
        <span class="c1"># keep only relation skeleton</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">isTransitive</span><span class="p">())</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">InSite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
        <span class="c1">#        actionKeys = digraph.computeCopelandRanking()</span>
            <span class="n">digraph</span><span class="o">.</span><span class="n">showRelationMap</span><span class="p">()</span>

        <span class="c1"># write out relations between nodes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">actionKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                <span class="n">xQuantileName</span><span class="o">=</span><span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xQuantileName</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">actionKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                    <span class="n">yQuantileName</span><span class="o">=</span><span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">yQuantileName</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                           <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xQuantileName</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yQuantileName</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;dot -Grankdir=TB -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="c1">#commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="RatingDigraph.showSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">showSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSortingCharacteristics</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderedCategoryKeys</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                       <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">()</span></div>



<div class="viewcode-block" id="RatingDigraph.showHTMLRatingByQuantileSorting">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showHTMLRatingByQuantileSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLRatingByQuantileSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Quantiles Preordering&#39;</span><span class="p">,</span>
                                 <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                 <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the html version of the quantile preordering in a browser window.</span>

<span class="sd">        The ordring strategy is either:</span>
<span class="sd">            * **average** (default), following the averag of the upper and lower quantile limits,</span>
<span class="sd">            * **optimistic**, following the upper quantile limits (default),</span>
<span class="sd">            * **pessimistic**, following the lower quantile limits.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantileOrdering</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span>
                                              <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
                                              <span class="n">HTML</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                              <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                              <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="RatingDigraph.showHTMLSorting">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showHTMLSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the html version of the sorting result in a browser window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showSorting</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">,</span><span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="RatingDigraph.showSorting">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows sorting results in decreasing or increasing (Reverse=False)</span>
<span class="sd">        order of the categories. If isReturningHTML is True (default = False)</span>
<span class="sd">        the method returns a htlm table with the sorting result.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#from string import replace</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeCategoryContents</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span> <span class="o">=</span> <span class="n">categoryContent</span>

        <span class="n">categoryKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">Reverse</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in descending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in descending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Quantiles&lt;/th&gt;&lt;th&gt;Assortment&lt;/th&gt;&lt;/tr&gt;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in ascending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in ascending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Quantiles&lt;/th&gt;&lt;th&gt;Assortment&lt;/th&gt;&lt;/tr&gt;&#39;</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categoryKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="c1">#html += &#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;[%s - %s[&lt;/td&gt;&#39; % (limprevc,limc)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span></div>



<div class="viewcode-block" id="RatingDigraph.showAllQuantiles">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showAllQuantiles">[docs]</a>
    <span class="k">def</span> <span class="nf">showAllQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCriteriaQuantileLimits</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="RatingDigraph.showCriteriaQuantileLimits">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showCriteriaQuantileLimits">[docs]</a>
    <span class="k">def</span> <span class="nf">showCriteriaQuantileLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ByCriterion</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows category minimum and maximum limits for each criterion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">catLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantile Class Limits (q = </span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lower-closed classes&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Upper-closed classes&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ByCriterion</span><span class="p">:</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">catg</span> <span class="o">=</span> <span class="n">catLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%.2f</span><span class="s1"> [</span><span class="si">%.2f</span><span class="s1">; </span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span>\
                          <span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)][</span><span class="s1">&#39;quantile&#39;</span><span class="p">],</span> <span class="n">catg</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">catg</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;crit.&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*----------------------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
                <span class="n">catg</span> <span class="o">=</span> <span class="n">catLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catg</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="RatingDigraph.showHTMLPerformanceHeatmap">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showHTMLPerformanceHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please use the showHTMLRatingHeatmap() here !!&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="RatingDigraph.showHTMLRatingHeatmap">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showHTMLRatingHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLRatingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="c1">#actionsList=None,</span>
                                   <span class="n">WithActionNames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="c1">#criteriaList=None,</span>
                                   <span class="n">colorLevels</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                                   <span class="n">pageTitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">rankingRule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Correlations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation of html heatmap version showing the performance tableau in a browser window;</span>
<span class="sd">        see :py:meth:`perfTabs.showHTMLPerformanceHeatMap` method.</span>

<span class="sd">        **Parameters**:</span>
<span class="sd">              - *ndigits* = 0 may be used to show integer evaluation values.</span>
<span class="sd">              - If no *actionsList* is provided, the decision actions are ordered from the best to the worst following the ranking of the LearnedQuatilesRatingDigraph instance.              </span>
<span class="sd">              - It may interesting in some cases to use *RankingRule* = &#39;NetFlows&#39;.</span>
<span class="sd">              - With *Correlations* = *True* and *criteriaList* = *None*, the criteria will be presented from left to right in decreasing order of the correlations between the marginal criterion based ranking and the global ranking used for presenting the decision alternatives.</span>
<span class="sd">              - Computing the marginal correlations may be boosted with Threading = True, if multiple parallel computing cores are available.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pageTitle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pageTitle</span> <span class="o">=</span> <span class="s1">&#39;Rating-by-ranking result of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="c1">#quantiles = len(self.quantilesFrequencies)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_htmlRatingHeatmap</span><span class="p">(</span> <span class="c1">#argCriteriaList=criteriaList,</span>
                                          <span class="c1">#   argActionsList=actionsList,</span>
                                         <span class="n">WithActionNames</span><span class="o">=</span><span class="n">WithActionNames</span><span class="p">,</span>
                                             <span class="c1">#quantiles=quantiles,</span>
                                             <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span>
                                             <span class="n">colorLevels</span><span class="o">=</span><span class="n">colorLevels</span><span class="p">,</span>
                                             <span class="n">pageTitle</span><span class="o">=</span><span class="n">pageTitle</span><span class="p">,</span>
                                             <span class="n">rankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span>
                                             <span class="n">Correlations</span><span class="o">=</span><span class="n">Correlations</span><span class="p">,</span>
                                             <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                             <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                             <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="RatingDigraph.showRatingByQuantilesRanking">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showRatingByQuantilesRanking">[docs]</a>
    <span class="k">def</span> <span class="nf">showRatingByQuantilesRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show rating-by-ranking result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- rating by quantiles </span><span class="si">%s</span><span class="s1"> ranking result ---------&#39;</span> <span class="o">%</span>\
                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span></div>



<div class="viewcode-block" id="RatingDigraph.showRatingByQuantilesSorting">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingDigraph.showRatingByQuantilesSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showRatingByQuantilesSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy show method for the commenting _computeQuantileOrdering() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;average&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantileOrdering</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">computeRatingByRankingCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">ratingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeRatingRelation</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">:</span>
                <span class="c1">#print(q,x)</span>
                <span class="c1">#if self.LowerClosed:</span>
                <span class="n">E</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">q</span><span class="p">],</span><span class="n">ratingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">q</span><span class="p">]),</span>
                          <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">q</span><span class="p">],</span><span class="o">-</span><span class="n">ratingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">q</span><span class="p">]))</span>
                <span class="n">D</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">q</span><span class="p">]),</span><span class="nb">abs</span><span class="p">(</span><span class="n">ratingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">q</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="o">/</span><span class="n">D</span><span class="p">)</span>

        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;correlation&#39;</span><span class="p">:</span><span class="n">E</span><span class="o">/</span><span class="n">D</span><span class="p">,</span> <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="n">D</span><span class="o">/</span><span class="n">Decimal</span><span class="p">((</span><span class="n">nq</span><span class="o">*</span><span class="n">na</span><span class="p">))}</span>
    
<span class="c1">##    def computeRatingBySortingCorrelation(self,strategy=&#39;average&#39;,Debug=False):</span>
<span class="c1">##        from decimal import Decimal</span>
<span class="c1">##        E = Decimal(&#39;0&#39;)</span>
<span class="c1">##        D = Decimal(&#39;0&#39;)</span>
<span class="c1">##        #qspo = self.computePreorderRelation(list(reversed(self._computeQuantileOrdering(strategy=strategy))))</span>
<span class="c1">##        qspo = self.computePreorderRelation(self._computeQuantileOrdering(strategy=strategy))</span>
<span class="c1">##        #print(&#39;qspo&#39;,qspo)</span>
<span class="c1">##        for q in self.ratingCategories:</span>
<span class="c1">##            for x in self.actionsOrig:</span>
<span class="c1">##                #if self.LowerClosed:</span>
<span class="c1">##                E -= min( max(-self.relation[x][q],qspo[x][q]),\</span>
<span class="c1">##                              max(self.relation[x][q],-qspo[x][q]))</span>
<span class="c1">##                D += min(abs(self.relation[x][q]),abs(qspo[x][q]))</span>
<span class="c1">####                else:</span>
<span class="c1">####                    E += min( max(self.relation[q][x],-qspo[q][x]),\</span>
<span class="c1">####                              max(-self.relation[q][x],qspo[q][x]))</span>
<span class="c1">####                    D += min(abs(self.relation[q][x]),abs(qspo[q][x]))</span>
<span class="c1">##        if Debug:      </span>
<span class="c1">##            print(E,D,E/D)</span>
<span class="c1">##        return E/D</span>


<span class="c1">#######  private genric class methods</span>
        
    <span class="k">def</span> <span class="nf">_getActionsKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">withoutProfiles</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extract normal actions keys()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsExt</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">withoutProfiles</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">actionsExt</span> <span class="o">-</span> <span class="n">profiles</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">actionsExt</span> <span class="o">|</span> <span class="n">profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">action</span><span class="p">])</span>
        
        
    <span class="k">def</span> <span class="nf">_computeCategoryContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the sorting results per category.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_getActionsKeys</span><span class="p">())</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSortingCharacteristics</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span><span class="o">=</span><span class="n">sorting</span>

        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">):</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relativeCategoryContent</span> <span class="o">=</span> <span class="n">categoryContent</span>
        
        <span class="k">return</span> <span class="n">categoryContent</span>

    <span class="k">def</span> <span class="nf">_computeLimitingQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">PrefThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the list of limiting quantiles on criteria g</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">actionsOrig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span>
        <span class="n">gValues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g,x,evaluation[g][x]&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                <span class="n">gValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
        <span class="n">gValues</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">PrefThresholds</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>            
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gValues</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g,n,gValues&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">gValues</span><span class="p">)</span>
<span class="c1">##        if n &gt; 0:</span>
<span class="c1">##        nf = Decimal(str(n+1))</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
        <span class="c1">#limitingQuantiles.sort()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">quantilesFrequencies</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">quantilesFrequencies</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
        <span class="c1"># computing the quantiles on criterion g</span>
        <span class="n">gQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="c1"># we ignore the 1.00 quantile and replace it with +infty</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantilesFrequencies</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r,rq&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rq</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]</span>\
                        <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rq</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">rq</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">PrefThresholds</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">+</span> <span class="n">quantile</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;200.0&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span><span class="n">quantile</span><span class="p">)</span>
                <span class="n">gQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantile</span><span class="p">)</span>               

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># upper closed categories</span>
            <span class="c1"># we ignore the quantile 0.0 and replace it with -\infty            </span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantilesFrequencies</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r,rq&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rq</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-200.0&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-100.0&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]</span>\
                        <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rq</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">PrefThresholds</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">-=</span> <span class="n">gPrefThrCst</span> <span class="o">-</span> <span class="n">quantile</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-200.0&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-100.0&#39;</span><span class="p">)</span>     
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span><span class="n">quantile</span><span class="p">)</span>
                <span class="n">gQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantile</span><span class="p">)</span>
<span class="c1">##        else:</span>
<span class="c1">##            gQuantiles = []</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">LowerClosed</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">],</span><span class="n">gQuantiles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gQuantiles</span>

    <span class="k">def</span> <span class="nf">_computePreorderRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">preorder</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the bipolar-valued relation obtained from</span>
<span class="sd">        a given preordering in increasing levels (list of lists) result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        
        <span class="k">if</span> <span class="n">Normalized</span><span class="p">:</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   
            <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
            
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">currentActions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">preorderRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">preorderRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">preorderRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>

        <span class="k">for</span> <span class="n">eqcl</span> <span class="ow">in</span> <span class="n">preorder</span><span class="p">:</span>
            <span class="n">currRest</span> <span class="o">=</span> <span class="n">currentActions</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">eqcl</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">currentActions</span><span class="p">,</span> <span class="n">eqcl</span><span class="p">,</span> <span class="n">currRest</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="n">preorderRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                        <span class="n">preorderRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">currRest</span><span class="p">:</span>
                    <span class="n">preorderRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">preorderRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
            <span class="n">currentActions</span> <span class="o">=</span> <span class="n">currentActions</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">eqcl</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">preorderRelation</span>

    <span class="k">def</span> <span class="nf">_computeQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">HTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Quantiles Preordering&#39;</span><span class="p">,</span>
                                <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Parameters*:</span>
<span class="sd">            * Descending: listing in *decreasing* (default) or *increasing* quantile order.</span>
<span class="sd">            * strategy: ordering in an {&#39;optimistic&#39; | &#39;pessimistic&#39; | &#39;average&#39; (default)}</span>
<span class="sd">              in the uppest, the lowest or the average potential quantile.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;optimistic&#39;</span>
        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">title</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;quantile limits&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1"> sorting&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">strategy</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">actionsCategories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span> <span class="o">=</span>\
                     <span class="bp">self</span><span class="o">.</span><span class="n">_showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">ilowCateg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
            <span class="n">ihighCateg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">ac</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">+</span><span class="n">hc</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: </span><span class="si">%s</span><span class="s1"> not a valid ordering strategy !!!&#39;</span> <span class="o">%</span> <span class="n">strategy</span><span class="p">)</span>
                <span class="k">break</span>
                
        <span class="c1"># sorting the quantile equivalence classes</span>
        <span class="n">actionsCategoriesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">actionsCategories</span><span class="p">]</span>
        <span class="n">actionsCategoriesKeys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">actionsCategoriesKeys</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">actionsCategIntervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">actionsCategoriesKeys</span><span class="p">:</span>
            <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">interval</span><span class="p">,</span>\
                                          <span class="n">actionsCategories</span><span class="p">[</span><span class="n">interval</span><span class="p">]])</span>

        <span class="c1"># gathering the result with output when Comments=True</span>
        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">Comments</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- rating by quantiles sorting result----*&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">actionsCategIntervals</span><span class="p">:</span>
            <span class="c1">#print(item)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;tdbgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> \
                                  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>                            
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> \
                                  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> \
                                  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                 <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span>\
                                  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>                   
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> \
                                  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> \
                                  <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">weakOrdering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">weakOrdering</span>
            
    <span class="k">def</span> <span class="nf">_computeQuantilesFrequencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the quantiles frequencies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;bitiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;tritiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;quartiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;quintiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;sextiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;septiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;octiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;deciles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;dodeciles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;centiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;automatic&#39;</span><span class="p">:</span>
            <span class="n">pth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> \
                           <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">))</span>
                    <span class="n">pth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pref</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">amp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">pth</span><span class="p">))</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">amp</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Detected preference thresholds = &#39;</span><span class="p">,</span><span class="n">pth</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;amplitude, n&#39;</span><span class="p">,</span><span class="n">amp</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

        <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">quantilesFrequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="p">)</span>
        <span class="c1">#self.name = &#39;sorting_with_%d-tile_limits&#39; % n</span>
        <span class="k">return</span> <span class="n">quantilesFrequencies</span>

    <span class="k">def</span> <span class="nf">_computeQuantilesRatingByRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          Renders an ordered dictionary of non empty quantiles in ascending order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        
        <span class="n">ranking</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span> <span class="c1"># lower closed quantiles</span>
            <span class="n">ranking</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;9.1&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="n">ratingCategories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">:</span>
            <span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ranking</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranking</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;swapping&#39;</span><span class="p">,</span><span class="n">ranking</span><span class="p">)</span>
        <span class="n">New</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">New</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">ratingCategories</span><span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">New</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">ratingCategories</span><span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ratingCategories</span><span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">New</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ratingCategories</span>

    <span class="k">def</span> <span class="nf">_computeRatingRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">StoreRating</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a bipolar rating relation using a pre-ranking (list of lists)</span>
<span class="sd">        of the self-actions (self.newActions + self.profiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantilesRating</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>

        <span class="c1"># pre-ranking self.actions</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span>
        <span class="n">preRanking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span> <span class="c1">#  in ascending order</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="n">preRanking</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="n">c</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">preRanking</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># computing in descending order</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">profiles</span><span class="p">):</span>
                <span class="n">preRanking</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">preRanking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;preRanking&#39;</span><span class="p">,</span><span class="n">preRanking</span><span class="p">)</span>

        <span class="n">ratingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computePreorderRelation</span><span class="p">(</span><span class="n">preRanking</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">StoreRating</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ratingRelation</span> <span class="o">=</span> <span class="n">ratingRelation</span>
        <span class="k">return</span> <span class="n">ratingRelation</span>

    <span class="k">def</span> <span class="nf">_computeSortingRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">categoryContents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constructs a bipolar sorting relation using the category contents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">categoryContents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">categoryContents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">categoryContents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeCategoryContents</span><span class="p">()</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="c1">#actions = [x for x in self.actionsOrig]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getActionsKeys</span><span class="p">()</span>
        <span class="n">currActions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">sortingRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categoryContents&#39;</span><span class="p">,</span><span class="n">categoryContents</span><span class="p">)</span>
        <span class="c1">#for i in categoryKeys:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">categoryContents</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="n">ribch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">currActions</span><span class="p">)</span> <span class="o">-</span> <span class="n">ibch</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ibch,ribch&#39;</span><span class="p">,</span><span class="n">ibch</span><span class="p">,</span><span class="n">ribch</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ibch</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ibch</span><span class="p">:</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ribch</span><span class="p">:</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
            <span class="n">currActions</span> <span class="o">=</span> <span class="n">currActions</span> <span class="o">-</span> <span class="n">ibch</span>
        <span class="k">return</span> <span class="n">sortingRelation</span>
    
    <span class="k">def</span> <span class="nf">_computeSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderedCategoryKeys</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1">#LowerClosed = self.criteriaCategoryLimits[&#39;LowerClosed&#39;]</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>

        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                        <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="c1">#if Comments:</span>
                <span class="c1">#    print(&#39;%s in %s: low = %.2f, high = %.2f&#39; % \</span>
                <span class="c1">#          (x, c,lowLimit,notHighLimit), end=&#39; &#39;)</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="se">\t</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="c1">#print(&#39;\t %.2f \t %.2f \t %.2f&#39; % (sorting[x][c][&#39;lowLimit&#39;], sorting[x][c][&#39;notHighLimit&#39;], sorting[x][c][&#39;categoryMembership&#39;]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                             <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>
                             <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">sorting</span>

    <span class="k">def</span> <span class="nf">_htmlRatingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argCriteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">argActionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">WithActionNames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="c1">#quantiles=None,</span>
                               <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">contentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">colorLevels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">pageTitle</span><span class="o">=</span><span class="s1">&#39;Rating Heatmap&#39;</span><span class="p">,</span>
                               <span class="n">rankingRule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">Correlations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;       </span>
<span class="sd">        Renders the Brewer RdYlGn 5,7, or 9 levels colored heatmap of the performance table</span>
<span class="sd">        actions x criteria in html format.</span>

<span class="sd">        See the corresponding :py:meth:`perfTabs.showHTMLPerformanceHeatMap` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;see browser&#39;</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">brewerRdYlGn9Colors</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1111&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D53E4F&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2222&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#F46D43&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.3333&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4444&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5555&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6666&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.7777&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8888&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#65BD63&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.000&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#1A9850&quot;&#39;</span><span class="p">)]</span>
        <span class="n">brewerRdYlGn7Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1429&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#F46D43&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2857&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4286&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5714&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.7143&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8571&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0000&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#65BD63&quot;&#39;</span><span class="p">)</span>
                               <span class="p">]</span>
        <span class="n">brewerRdYlGn5Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">)</span>
                               <span class="p">]</span>
        <span class="k">if</span> <span class="n">colorLevels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colorLevels</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">if</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn7Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn9Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn5Colors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn7Colors</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorPalette</span><span class="p">)</span>
        <span class="n">backGroundColor</span>   <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">naColor</span>           <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">columnHeaderColor</span> <span class="o">=</span> <span class="s1">&#39;&quot;#CCFFFF&quot;&#39;</span>
        <span class="n">rowHeaderColor</span>    <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">actionRowHeaderColor</span> <span class="o">=</span> <span class="s1">&#39;#FFF79B&#39;</span>

        <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;Rating heat map&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1">#html += &#39;table {border-collapse: collapse;}&#39;</span>
        <span class="k">if</span> <span class="n">contentCentered</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;td {text-align: center;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;td.na {color: rgb(192,192,192);}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;tr.quantile {color: rgb(100,100,100);}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/style&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/head&gt;</span><span class="se">\n</span><span class="s1">&lt;body&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h2&gt;</span><span class="si">%s</span><span class="s1">&lt;/h2&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pageTitle</span>
        
<span class="c1">##        from sparseOutrankingDigraphs import PreRankedOutrankingDigraph</span>
        <span class="k">if</span> <span class="n">argCriteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argCriteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="n">argCriteriaList</span>

        <span class="k">if</span> <span class="n">rankingRule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">argActionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span>
                <span class="n">rankingRule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">argActionsList</span>
                <span class="n">rankingRule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">argActionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNetFlowsRanking</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rankingRule</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">argActionsList</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
            <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="n">actionsList</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="n">rankCorrelation</span><span class="p">)</span>

        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">if</span> <span class="n">criteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span>
                            <span class="n">actionsList</span><span class="p">,</span><span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                            <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">criteriaWeightsList</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]),</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">]</span>
                <span class="n">criteriaWeightsList</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaWeightsList</span><span class="p">]</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span>
                            <span class="n">actionsList</span><span class="p">,</span><span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                            <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>    
                            <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
            
        <span class="n">quantileColor</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">quantilexg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionQuantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">quantilexg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        
                        <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">&lt;=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">naColor</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">])</span>
        <span class="c1"># heatmap</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Ranking rule&lt;/i&gt;: &lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;; &lt;i&gt;Ranking correlation&lt;/i&gt;: &lt;b&gt;</span><span class="si">%.3f</span><span class="s1">&lt;/b&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>\
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">])</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;criteria&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">gName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gName</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;weights&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;tau&lt;sup&gt;(*)&lt;/sup&gt;&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(html)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="n">xcat</span> <span class="o">=</span> <span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">xcat</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; -&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="s1">&#39;- &#39;</span> <span class="o">+</span> <span class="n">categories</span><span class="p">[</span><span class="n">xcat</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">WithActionNames</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr class=&quot;quantile&quot;&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rowHeaderColor</span><span class="p">,</span><span class="n">xName</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionRowHeaderColor</span><span class="p">,</span><span class="n">xName</span><span class="p">)</span>                
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">:</span>
                    <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> align=&quot;right&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> \
                        <span class="o">%</span> <span class="p">(</span><span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">],</span><span class="n">ndigits</span><span class="p">)</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> class=&quot;na&quot;&gt;NA&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">naColor</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(html)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># table legend</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;b&gt;Color legend: &lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;quantile&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="c1">#html += &#39;&lt;td bgcolor=%s&gt;&amp;nbsp;[%.2f - %.2f[&amp;nbsp;&lt;/td&gt;&#39; % (colorPalette[0][1],0.0,colorPalette[0][0])</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&amp;nbsp;</span><span class="si">%.2f</span><span class="s1">&amp;#037;&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">colorPalette</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                                                  <span class="c1">#colorPalette[col-1][0],</span>
                                                                   <span class="n">colorPalette</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">))</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;(*) tau: Ordinal (Kendall) correlation between&lt;/i&gt;&lt;br/&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;marginal criterion and global ranking relation.&lt;/i&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c1">##        if rankCorrelation is not None:</span>
<span class="c1">##            html += &#39;&lt;i&gt;Ordinal (Kendall) correlation between global ranking and outranking relation: %.2f.&lt;/i&gt;&#39; % (rankCorrelation[&#39;correlation&#39;])</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/body&gt;&lt;/html&gt;&#39;</span>
        <span class="k">return</span> <span class="n">html</span>

    <span class="k">def</span> <span class="nf">_orderedCategoryKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the ordered list of category keys</span>
<span class="sd">        based on self.categories[&#39;order&#39;] numeric values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">orderedCategoryKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">Reverse</span><span class="p">:</span>
            <span class="n">orderedCategoryKeys</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">orderedCategoryKeys</span>

    <span class="k">def</span> <span class="nf">_showActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        Returns a tuple : action, lowest category key, highest category key, membership credibility !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSortingCharacteristics</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>\
                                                     <span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">catKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderedCategoryKeys</span><span class="p">()</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderedCategoryKeys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="c1">#keys.append(c)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">],</span> <span class="n">keys</span><span class="p">)</span>
        <span class="n">credibility</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>\
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>\
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                 <span class="n">action</span><span class="p">,</span>\
                                 <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>\
                <span class="n">credibility</span></div>


<span class="c1">#########   relative quantiles raking</span>
<span class="kn">from</span> <span class="nn">perfTabs</span> <span class="kn">import</span> <span class="n">PerformanceTableau</span> 
<div class="viewcode-block" id="RatingByRelativeQuantilesDigraph">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingByRelativeQuantilesDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RatingByRelativeQuantilesDigraph</span><span class="p">(</span><span class="n">RatingDigraph</span><span class="p">,</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for a relative quantiles rating-by sorting and rating-by-ranking digraph.</span>
<span class="sd">    See the :py:class:`sortingDigraphs.QuantilesSortingDigraph` class.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">       * *argPerfTab*: valid stored PerformanceTableau instance,</span>
<span class="sd">        </span>
<span class="sd">       * *quantiles*: integer number of quantile classes,</span>
<span class="sd">        </span>
<span class="sd">       * *LowerClosed*:  {True | False (default upper closed quantiles)},</span>
<span class="sd">        </span>
<span class="sd">       * *rankingRule*: &#39;NetFlows&#39; (default).</span>

<span class="sd">       * *outrankingModel*: {&#39;standard&#39; (default) | &#39;confident&#39; | &#39;robust&#39; | &#39;mp&#39; },</span>

<span class="sd">          Parameters for the *confident* outranking model: </span>

<span class="sd">          *distribution*: {&#39;triangular&#39; (default)| &#39;uniform&#39; | &#39;beta&#39;},</span>
<span class="sd">        </span>
<span class="sd">          *betaParameter* : 2 (default), </span>
<span class="sd">        </span>
<span class="sd">          *confidence*: alpha% confidence level (in percents, 90.0 default).</span>
<span class="sd">    </span>

<span class="sd">       * *startMethod*: {&#39;spawn&#39; (default) | &#39;forkserver&#39; | &#39;fork&#39; }</span>
<span class="sd">        </span>
<span class="sd">    Example usage:</span>

<span class="sd">    &gt;&gt;&gt; # generating random multicriteria performance records</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; pt = RandomPerformanceTableau(numberOfActions=50,seed=3)</span>
<span class="sd">    &gt;&gt;&gt; # rating-by-sorting with relative quantiles</span>
<span class="sd">    &gt;&gt;&gt; from ratingDigraphs import RatingByRelativeQuantilesDigraph</span>
<span class="sd">    &gt;&gt;&gt; g = RatingByRelativeQuantilesDigraph(pt,7,LowerClosed=True)</span>
<span class="sd">    &gt;&gt;&gt; g.showRatingByQuantileSorting(strategy=&#39;average&#39;)</span>
<span class="sd">        *---- rating by quantiles sorting result----*</span>
<span class="sd">        [0.71-&lt;[ : [&#39;a07&#39;]</span>
<span class="sd">        [0.71-0.86[ : [&#39;a08&#39;, &#39;a48&#39;]</span>
<span class="sd">        [0.57-0.71[ : [&#39;a04&#39;, &#39;a06&#39;, &#39;a09&#39;, &#39;a12&#39;, &#39;a19&#39;, &#39;a23&#39;,</span>
<span class="sd">                       &#39;a27&#39;, &#39;a33&#39;, &#39;a38&#39;, &#39;a39&#39;, &#39;a43&#39;]</span>
<span class="sd">        [0.43-0.71[ : [&#39;a11&#39;, &#39;a18&#39;]</span>
<span class="sd">        [0.43-0.57[ : [&#39;a03&#39;, &#39;a20&#39;, &#39;a22&#39;, &#39;a29&#39;, &#39;a30&#39;, &#39;a31&#39;,</span>
<span class="sd">                       &#39;a41&#39;, &#39;a47&#39;, &#39;a49&#39;]</span>
<span class="sd">        [0.29-0.57[ : [&#39;a01&#39;, &#39;a26&#39;, &#39;a46&#39;, &#39;a50&#39;]</span>
<span class="sd">        [0.29-0.43[ : [&#39;a05&#39;, &#39;a10&#39;, &#39;a13&#39;, &#39;a16&#39;, &#39;a17&#39;, &#39;a21&#39;,</span>
<span class="sd">                       &#39;a28&#39;, &#39;a32&#39;, &#39;a37&#39;]</span>
<span class="sd">        [0.14-0.43[ : [&#39;a40&#39;]</span>
<span class="sd">        [0.14-0.29[ : [&#39;a15&#39;, &#39;a24&#39;, &#39;a25&#39;, &#39;a34&#39;, &#39;a35&#39;, &#39;a36&#39;,</span>
<span class="sd">                       &#39;a42&#39;, &#39;a44&#39;, &#39;a45&#39;]</span>
<span class="sd">        [0.00-0.29[ : [&#39;a14&#39;]</span>
<span class="sd">        [0.00-0.14[ : [&#39;a02&#39;]</span>
<span class="sd">    &gt;&gt;&gt; g.showRatingByQuantilesRanking()</span>
<span class="sd">        *-------- rating by quantiles ranking result ---------</span>
<span class="sd">        [0.57 - 0.71[ [&#39;a48&#39;, &#39;a23&#39;, &#39;a07&#39;]</span>
<span class="sd">        [0.43 - 0.57[ [&#39;a04&#39;, &#39;a27&#39;, &#39;a33&#39;, &#39;a38&#39;, &#39;a09&#39;, &#39;a08&#39;,</span>
<span class="sd">                       &#39;a41&#39;, &#39;a11&#39;, &#39;a06&#39;, &#39;a46&#39;, &#39;a19&#39;, &#39;a47&#39;,</span>
<span class="sd">                       &#39;a49&#39;, &#39;a39&#39;, &#39;a43&#39;, &#39;a12&#39;, &#39;a22&#39;, &#39;a20&#39;,</span>
<span class="sd">                       &#39;a32&#39;]</span>
<span class="sd">        [0.29 - 0.43[ [&#39;a01&#39;, &#39;a18&#39;, &#39;a17&#39;, &#39;a37&#39;, &#39;a16&#39;, &#39;a30&#39;,</span>
<span class="sd">                       &#39;a31&#39;, &#39;a21&#39;, &#39;a50&#39;, &#39;a05&#39;, &#39;a29&#39;, &#39;a02&#39;,</span>
<span class="sd">                       &#39;a13&#39;, &#39;a26&#39;, &#39;a40&#39;]</span>
<span class="sd">        [0.14 - 0.29[ [&#39;a03&#39;, &#39;a42&#39;, &#39;a28&#39;, &#39;a10&#39;, &#39;a36&#39;, &#39;a45&#39;,</span>
<span class="sd">                       &#39;a44&#39;, &#39;a34&#39;, &#39;a25&#39;, &#39;a24&#39;, &#39;a35&#39;, &#39;a14&#39;,</span>
<span class="sd">                       &#39;a15&#39;]</span>

<span class="sd">.. warning::  Mind that when executing a multiprocessing (Threading = True) Python script file and not using the &#39;fork&#39; threading start method, the main program code entry must be protected with a __name__==&#39;__main__&#39; test in order to avoid the recursive re-execution of the script in every started thread.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="p">,</span>
                 <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">outrankingModel</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                 <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;triangular&#39;</span><span class="p">,</span>
                 <span class="n">betaParameter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">confidence</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span>
                 <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrCores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">deepcopy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">copy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

        <span class="c1"># import the performance tableau</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">argPerfTab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a valid performance tableau is required!&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>

        <span class="c1"># naming the digraph instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;relative_rating_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> 

        <span class="c1"># normalize the actions as a dictionary construct</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>

        <span class="c1"># keep a copy of the original actions set before adding the profiles</span>
        <span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">actionsOrig</span>

        <span class="c1">#  normalizing the performance tableau</span>
        <span class="kn">from</span> <span class="nn">perfTabs</span> <span class="kn">import</span> <span class="n">NormalizedPerformanceTableau</span>
        <span class="n">normPerfTab</span> <span class="o">=</span> <span class="n">NormalizedPerformanceTableau</span><span class="p">(</span><span class="n">perfTab</span><span class="p">)</span>

        <span class="c1"># instantiating the performance tableau part</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Decimal</span><span class="p">()</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dataInput&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span><span class="p">}</span>
        
        <span class="c1">#  compute the limiting quantiles</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quantiles</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="c1">#self.name = &#39;sorting_with_given_quantiles&#39;</span>
            <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
                <span class="n">quantilesFrequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;convert to decimal!&#39;</span><span class="p">,</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantilesFrequencies</span><span class="p">(</span><span class="n">quantiles</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">quantilesFrequencies</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantilesFrequencies&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
        <span class="c1"># supposing all criteria scales between 0.0 and 100.0</span>
        <span class="c1"># with preference direction = max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="n">lowValue</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">highValue</span> <span class="o">=</span> <span class="mf">100.00</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>\
                                <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>\
                                <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="p">]}</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - &lt;[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span>\
                                  <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>\
                                  <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;[&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span>                 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]&lt; - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                    <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]&lt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantilesFrequencies</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>                                  
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantilesFrequencies</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">categories</span><span class="p">)))</span>

        <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
            <span class="n">gQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeLimitingQuantiles</span><span class="p">(</span><span class="n">g</span><span class="p">,</span>\
                            <span class="n">PrefThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
<span class="c1">##            if Debug:</span>
<span class="c1">##                print(g,gQuantiles)</span>
            <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">gQuantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CriteriaCategoryLimits&#39;</span><span class="p">,</span><span class="n">criteriaCategoryLimits</span><span class="p">)</span>

        <span class="c1"># add the catogory limits to the actions set</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1">#profileLimits = set()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
            <span class="c1">#profileLimits.add(cKey)</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
        <span class="n">profileLimits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1">#profileLimits.sort()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span> <span class="o">=</span> <span class="n">profileLimits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span> <span class="c1"># actionsOrig + profiles</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profiles&#39;</span><span class="p">,</span><span class="n">profiles</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profileLimits&#39;</span><span class="p">,</span><span class="n">profileLimits</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># construct quantile limits extended outranking relation</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="c1">##        if nbrCores=None:</span>
<span class="c1">##            self.nbrThreads = 1</span>
<span class="c1">##        else:</span>
<span class="c1">##            self.nbrThreads = nbrCores</span>
        <span class="k">if</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;mp&#39;</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">os</span>
            <span class="c1"># from perfTabs import PerformanceTableau</span>
            <span class="c1"># PerformanceTableau.save(self,&#39;sharedPerfTab&#39;)</span>
            <span class="c1"># while not os.path.exists(&#39;./sharedPerfTab.py&#39;):</span>
            <span class="c1">#     pass</span>
            <span class="kn">from</span> <span class="nn">mpOutrankingDigraphs</span> <span class="kn">import</span> <span class="n">MPBipolarOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">MPBipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                           <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                    <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                    <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">)</span>
            <span class="c1">#self.nbrThreads = copy2self(g.nbrThreads)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;confident&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">ConfidentBipolarOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
                                <span class="n">betaParameter</span><span class="o">=</span><span class="n">betaParameter</span><span class="p">,</span>
                                <span class="n">confidence</span><span class="o">=</span><span class="n">confidence</span><span class="p">,</span>
                                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidenceCutLevel</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">confidenceCutLevel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">distribution</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">betaParameter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;robust&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">RobustOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">RobustOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stability</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">stability</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;outrankingRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute quantiles by sorting</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSortingRelation</span><span class="p">(</span>
            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sortingRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute rating-by-ranking</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span><span class="p">,</span><span class="n">CopelandOrder</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>           
            <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">corrnf</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="n">nf</span><span class="o">.</span><span class="n">netFlowsOrder</span><span class="p">)</span>
            <span class="c1">#print(&#39;nf:&#39;, corrnf)</span>
            <span class="n">corrcop</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="n">cop</span><span class="o">.</span><span class="n">copelandOrder</span><span class="p">)</span>
            <span class="c1">#print(&#39;cop&#39;, corrcop)</span>
            <span class="k">if</span> <span class="n">corrnf</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">corrcop</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;NetFlows&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">corrnf</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlows</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Copeland&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">corrcop</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">decCopelandScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">CopelandOrder</span>
            <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Copeland&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">decCopelandScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;NetFlows&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">decnetFlowScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;RankedPairs&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">RankedPairsRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">RankedPairsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">rankedPairsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;RankedPairs&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedCopeland&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedCopelandRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">IteratedCopelandRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">iteratedCopelandRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;IteratedCopeland&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedNetFlows&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedNetFlowsRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">IteratedNetFlowsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">iteratedNetFlowsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;IteratedNetFlows&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1">##        elif rankingRule == &#39;Kemeny&#39;:</span>
<span class="c1">##            if g.order &gt; 12:</span>
<span class="c1">##                print(&#39;Error: the digraph is to big for the Kemeny ranking rule üüü&#39;)</span>
<span class="c1">##            else:</span>
<span class="c1">##                from linearOrders import KemenyRanking</span>
<span class="c1">##                ke = KemenyRanking(g, orderLimit=g.order)</span>
<span class="c1">##                actionsList = ke.kemenyRanking</span>
<span class="c1">##                self.rankingRule = &#39;Kemeny&#39;</span>
<span class="c1">##                self.rankingScores = None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Errr: The ranking rule </span><span class="si">%s</span><span class="s1"> is not availbale !!&#39;</span> <span class="o">%</span> <span class="n">rankingRule</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">!=</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;6.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantilesRatingByRanking</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking rule        :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actions ranking     :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking correlation :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rating categories:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;rating-by-ranking&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span>

 
<span class="c1">#.....  specific relative rating class methods  ....</span>
        
    <span class="k">def</span> <span class="nf">_computeMarginalRatingCorrelations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">perfTabs</span> <span class="kn">import</span> <span class="n">PartialPerformanceTableau</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">BipartitePartialDigraph</span>
        <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsRanking</span><span class="p">,</span><span class="n">CopelandRanking</span>
        <span class="c1">#nf = NetFlowsRanking(self)</span>
        <span class="c1">#cop = CopelandRanking(self)</span>
        <span class="n">bp</span> <span class="o">=</span> <span class="n">BipartitePartialDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span>
        <span class="n">marginalCorrelations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
            <span class="c1">#print(g)</span>
            <span class="n">ptg</span> <span class="o">=</span> <span class="n">PartialPerformanceTableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteriaSubset</span><span class="o">=</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
            <span class="c1">#print(ptg)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="n">selfg</span> <span class="o">=</span> <span class="n">RatingByRelativeQuantilesDigraph</span><span class="p">(</span><span class="n">ptg</span><span class="p">,</span><span class="n">quantiles</span><span class="o">=</span><span class="n">q</span><span class="p">,</span>
                                    <span class="n">LowerClosed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">)</span>
            <span class="c1">#print(selfg)</span>
            <span class="n">bpg</span> <span class="o">=</span> <span class="n">BipartitePartialDigraph</span><span class="p">(</span><span class="n">selfg</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span>
            <span class="n">marginalCorrelations</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="n">bpg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">marginalCorrelations</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">marginalCorrelations</span>   

    <span class="k">def</span> <span class="nf">_computeRatingConsensusQuality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the marginal criteria correlations with a given rating with summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#from outrankingDigraphs import BipolarOutrankingDigraph</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="c1">#g = BipolarOutrankingDigraph(self,Normalized=True)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">marginalCorrelation</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">_computeMarginalRatingCorrelations</span><span class="p">()</span>
        <span class="n">ncrit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">marginalCorrelation</span><span class="p">)))</span>
        <span class="n">meanMarginalCorrelation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">varMarginalCorrelation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelation</span><span class="p">:</span>
            <span class="n">sumWeights</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelation</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">cgw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span>
            <span class="n">meanMarginalCorrelation</span> <span class="o">+=</span> <span class="n">marginalCorrelation</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">cgw</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelation</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">cgw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span>
            <span class="n">varMarginalCorrelation</span> <span class="o">+=</span>\
                <span class="p">((</span><span class="n">marginalCorrelation</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">meanMarginalCorrelation</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cgw</span>
        <span class="n">sdMarginalCorrelation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">varMarginalCorrelation</span><span class="p">)</span> 
        <span class="c1"># showing the results</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Consensus quality of rating:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criterion (weight): tau (deter.) equiv.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">marginalCorrelation</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">): </span><span class="se">\t</span><span class="s1"> </span><span class="si">%+.3f</span><span class="s1"> (</span><span class="si">%+.3f</span><span class="s1">) </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="p">(</span><span class="n">cg</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span><span class="p">,</span>
                       <span class="n">marginalCorrelation</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span>
                       <span class="n">marginalCorrelation</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span>
                       <span class="n">marginalCorrelation</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span> <span class="o">*</span>\
                                  <span class="n">marginalCorrelation</span><span class="p">[</span><span class="n">cg</span><span class="p">][</span><span class="s1">&#39;determination&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weighted mean marginal correlation (a): </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">meanMarginalCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard deviation (b)                : </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sdMarginalCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking fairness (a)-(b)              : </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                  <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">meanMarginalCorrelation</span><span class="p">)</span> <span class="o">-</span> <span class="n">sdMarginalCorrelation</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">marginalCorrelation</span><span class="p">,</span><span class="n">meanMarginalCorrelation</span><span class="p">,</span><span class="n">sdMarginalCorrelation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">showRatingConsensusQuality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_computeRatingConsensusQuality</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

    

<span class="c1">#########################################</span>
<span class="c1">#########   learned quantiles rating</span>
<span class="kn">from</span> <span class="nn">performanceQuantiles</span> <span class="kn">import</span> <span class="n">PerformanceQuantiles</span>
<div class="viewcode-block" id="RatingByLearnedQuantilesDigraph">
<a class="viewcode-back" href="../techDoc.html#ratingDigraphs.RatingByLearnedQuantilesDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RatingByLearnedQuantilesDigraph</span><span class="p">(</span><span class="n">RatingDigraph</span><span class="p">,</span><span class="n">PerformanceQuantiles</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for a learned quantiles rating-by sorting and rating-by-ranking digraph.</span>
<span class="sd">    See the :py:class:`sortingDigraphs.LearnedQuantilesRatingDigraph` class.</span>
<span class="sd">    </span>
<span class="sd">    **Parameters**</span>

<span class="sd">    *argPerfQuantiles*: valid stored :py:class:`~performanceQuantiles.PerformanceQuantiles` instance,</span>

<span class="sd">    *newData*: new random actions or performance tableau</span>
<span class="sd">    generated with the :py:class:`~randomPerfTabs.RandomPerformanceGenerator` class,</span>
<span class="sd">        </span>
<span class="sd">    *quantiles*: integer number of quantile classes,</span>
<span class="sd">        </span>
<span class="sd">    *LowerClosed*:  {True | False (default upper closed quantiles)},</span>
<span class="sd">        </span>
<span class="sd">    *rankingRule*: &#39;NetFlows&#39; (default).</span>

<span class="sd">    *outrankingModel*: {&#39;standard&#39; (default) | &#39;mp&#39; | &#39;confident&#39; | &#39;robust&#39;},</span>

<span class="sd">        Parameters for the *confident* outranking model: </span>

<span class="sd">        *distribution*: {&#39;triangular&#39; (default)| &#39;uniform&#39; | &#39;beta&#39;},</span>
<span class="sd">        </span>
<span class="sd">        *betaParameter* : 2 (default), </span>
<span class="sd">        </span>
<span class="sd">        *confidence*: alpha% confidence level (in percents, 90.0 default).</span>

<span class="sd">    * *startMethod*: {&#39;spawn&#39; (default) | &#39;forkserver&#39; | &#39;fork&#39; }</span>
<span class="sd">        </span>
<span class="sd">     Example usage:</span>

<span class="sd">    &gt;&gt;&gt; # generating random historical performance records and quantiles</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; hpt = RandomPerformanceTableau(numberOfActions=1000,seed=1)</span>
<span class="sd">    &gt;&gt;&gt; from performanceQuantiles import PerformanceQuantiles</span>
<span class="sd">    &gt;&gt;&gt; pq = PerformanceQuantiles(hpt,numberOfBins=7,LowerClosed=True,Debug=False)</span>
<span class="sd">    &gt;&gt;&gt; # generating new incoming performance records of the same kind</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceGenerator</span>
<span class="sd">    &gt;&gt;&gt; tpg = RandomPerformanceGenerator(hpt,instanceCounter=0,seed=1)</span>
<span class="sd">    &gt;&gt;&gt; newRecords = tpg.randomActions(10)</span>
<span class="sd">    &gt;&gt;&gt; # updating the historical performance quantiles</span>
<span class="sd">    &gt;&gt;&gt; pq.updateQuantiles(newRecords,historySize=None)</span>
<span class="sd">    &gt;&gt;&gt; # rating the new set of performance records after</span>
<span class="sd">    &gt;&gt;&gt; from ratingDigraphs import RatingByLearnedQuantilesDigraph</span>
<span class="sd">    &gt;&gt;&gt; lqr = RatingByLearnedQuantilesDigraph(pq,newRecords,Debug=False)</span>
<span class="sd">    &gt;&gt;&gt; lqr.showRatingByQuantilesSorting(strategy=&#39;average&#39;)</span>
<span class="sd">        *---- rating by quantiles sorting result----*</span>
<span class="sd">        [0.86-&lt;[ : [&#39;a06&#39;]</span>
<span class="sd">        [0.71-0.86[ : [&#39;a04&#39;]</span>
<span class="sd">        [0.57-0.71[ : [&#39;a07&#39;]</span>
<span class="sd">        [0.43-0.57[ : [&#39;a03&#39;, &#39;a05&#39;, &#39;a08&#39;]</span>
<span class="sd">        [0.29-0.43[ : [&#39;a02&#39;, &#39;a09&#39;]</span>
<span class="sd">        [0.14-0.29[ : [&#39;a01&#39;, &#39;a10&#39;]</span>
<span class="sd">    &gt;&gt;&gt; lqr.showRatingByQuantilesRanking(Descending=True)</span>
<span class="sd">        *-------- rating by quantiles ranking result ---------</span>
<span class="sd">        [0.57 - 0.71[ [&#39;a06&#39;]</span>
<span class="sd">        [0.43 - 0.57[ [&#39;a07&#39;, &#39;a04&#39;, &#39;a05&#39;, &#39;a09&#39;]</span>
<span class="sd">        [0.29 - 0.43[ [&#39;a08&#39;, &#39;a03&#39;, &#39;a02&#39;, &#39;a01&#39;]</span>
<span class="sd">        [0.14 - 0.29[ [&#39;a10&#39;]</span>

<span class="sd">.. note:: Mind that when setting *Threading* to *True* in a Python script file,</span>
<span class="sd">   the main program code entry must start with a *__name__==&#39;__main__&#39;* test</span>
<span class="sd">   in order to avoid recursive execution of the submitted script.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfQuantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">newData</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="c1">#hasNoVeto=False,</span>
                 <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span>
                 <span class="n">outrankingModel</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                 <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;triangular&#39;</span><span class="p">,</span>
                 <span class="n">betaParameter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">confidence</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrCores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        
        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">deepcopy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">copy</span>

        <span class="c1"># import init parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="n">rankingRule</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outrankingModel</span> <span class="o">=</span> <span class="n">outrankingModel</span>
        <span class="k">if</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;confident&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span> <span class="o">=</span> <span class="n">betaParameter</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="n">confidence</span>
        
        <span class="c1"># import the performance quantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">argPerfQuantiles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: valid PerformanceQuantiles instance is required!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">argPerfQuantiles</span><span class="p">)</span>
            
        <span class="c1"># instantiating the performance quantiles part</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">objectives</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">quantilesFrequencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">limitingQuantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">limitingQuantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">historySizes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">historySizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">cdf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">NA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;learnedRatingDigraph&#39;</span>

        <span class="c1"># import the actions to rate</span>
        <span class="k">if</span> <span class="n">newData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newData</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">newData</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># randomActions format {&#39;actions&#39;: .., &#39;evaluation&#39;:..}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newData</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newData</span><span class="p">[</span><span class="s1">&#39;evaluation&#39;</span><span class="p">]</span>
                <span class="c1">## need NA to found somewhere !!!</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>  <span class="c1">#  randomPerformanceTableau format</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newData</span><span class="o">.</span><span class="n">actions</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newData</span><span class="o">.</span><span class="n">evaluation</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !!!: valid new Actions or valid new PerformanceTableau required&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !!!: newly observed decision actions with performance evaluations are required !!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span>

        <span class="c1"># check if new quantile limits should be interpolated</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantiles</span> <span class="o">=</span> <span class="n">quantiles</span>
        <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">oldFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span>
            <span class="n">newFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantilesFrequencies</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span>
            <span class="n">newLimitingQuantiles</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="n">newLimitingQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">newFreq</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p,oldFreq&#39;</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">oldFreq</span><span class="p">)</span>
                <span class="n">newQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileProfile</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">oldFreq</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                    <span class="n">newLimitingQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">newLimitingQuantiles</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">newLimitingQuantiles</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">newFreq</span>
            
        <span class="c1"># rating categories</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="n">quantFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>\
                                <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>\
                                <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]}</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - &lt;[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span>\
                                  <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>\
                                  <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;[&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span>                 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]&lt; - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>\
                    <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]&lt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>                                  
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
<span class="c1">##</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">categories</span><span class="p">)))</span>

        <span class="c1"># set the category limits type (LowerClosed = True is default)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span>

        <span class="c1"># add the profiles, ie quantile limits, to the actions set</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
<span class="c1">##            if LowerClosed:</span>
<span class="c1">##                cKey = c+&#39;-m&#39;</span>
<span class="c1">##            else:</span>
<span class="c1">##                cKey = c+&#39;-M&#39;</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; -&#39;</span><span class="p">,</span>\
                                  <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;- &#39;</span> <span class="o">+</span> <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                  <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criteriaCategoryLimits[g]&#39;</span><span class="p">,</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
        <span class="n">profileLimits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span> <span class="o">=</span> <span class="n">profileLimits</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profiles&#39;</span><span class="p">,</span><span class="n">profiles</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.actions&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profileLimits&#39;</span><span class="p">,</span><span class="n">profileLimits</span><span class="p">)</span>
                        
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># construct outranking relation</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                         <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                         <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;mp&#39;</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">os</span>
            <span class="kn">from</span> <span class="nn">mpOutrankingDigraphs</span> <span class="kn">import</span> <span class="n">MPBipolarOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">MPBipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;confident&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">ConfidentBipolarOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
                                <span class="n">betaParameter</span><span class="o">=</span><span class="n">betaParameter</span><span class="p">,</span>
                                <span class="n">confidence</span><span class="o">=</span><span class="n">confidence</span><span class="p">,</span>
                                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>       
            <span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidenceCutLevel</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">confidenceCutLevel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">distribution</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">betaParameter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;robust&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">RobustOutrankingDigraph</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">RobustOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>       
            <span class="bp">self</span><span class="o">.</span><span class="n">stability</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">stability</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Errr: The outranking model </span><span class="si">%s</span><span class="s1"> is not availbale !!&#39;</span> <span class="o">%</span> <span class="n">outrankingModel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;outrankingRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        
        <span class="c1"># compute quantiles by sorting</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeSortingRelation</span><span class="p">(</span>
            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sortingRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute rating-by-ranking</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span><span class="p">,</span><span class="n">CopelandOrder</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>           
            <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">corrnf</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="n">nf</span><span class="o">.</span><span class="n">netFlowsOrder</span><span class="p">)</span>
            <span class="c1">#print(&#39;nf:&#39;, corrnf)</span>
            <span class="n">corrcop</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="n">cop</span><span class="o">.</span><span class="n">copelandOrder</span><span class="p">)</span>
            <span class="c1">#print(&#39;cop&#39;, corrcop)</span>
            <span class="k">if</span> <span class="n">corrnf</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">corrcop</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;NetFlows&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">corrnf</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlows</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Copeland&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">corrcop</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">decCopelandScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">CopelandOrder</span>
            <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Copeland&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">decCopelandScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;NetFlows&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">decnetFlowScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;RankedPairs&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">RankedPairsRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">RankedPairsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">rankedPairsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;RankedPairs&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedCopeland&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedCopelandRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">IteratedCopelandRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">iteratedCopelandRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;IteratedCopeland&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedNetFlows&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedNetFlowsRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">IteratedNetFlowsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">iteratedNetFlowsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;IteratedNetFlows&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Kemeny&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the digraph is to big for the Kemeny ranking rule üüü&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">KemenyRanking</span>
                <span class="n">ke</span> <span class="o">=</span> <span class="n">KemenyRanking</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">orderLimit</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">kemenyRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Kemeny&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Errr: The ranking rule </span><span class="si">%s</span><span class="s1"> is not availbale !!&#39;</span> <span class="o">%</span> <span class="n">rankingRule</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">!=</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;6.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantilesRatingByRanking</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking rule        :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actions ranking     :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking correlation :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rating categories:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;rating-by-ranking&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span></div>


<span class="c1">#.....  specific absolute rating class methods  ....</span>
<span class="c1">#       see abstract ratingDigraphs class     </span>

<span class="c1">###############  testing</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Digraph3 ratingDigraphs module                   *</span>
<span class="s2">    * Copyright (C) 2022 Raymond Bisdorff              *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Testing classes and methods -------&#39;</span><span class="p">)</span>


    <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="n">MP</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">nbrCores</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1">##    # relative quantiles rating</span>
<span class="c1">##    pt = RandomCBPerformanceTableau(numberOfActions=500,seed=9)</span>
<span class="c1">##    rrq = RatingByRelativeQuantilesDigraph(pt,quantiles=11,</span>
<span class="c1">##                                         LowerClosed=False,</span>
<span class="c1">##                                         outrankingModel=&#39;mp&#39;,</span>
<span class="c1">##                                         Threading=MP,</span>
<span class="c1">##                                         nbrCores=nbrCores,</span>
<span class="c1">##                                         Debug=False)</span>
<span class="c1">##    print(rrq)</span>
<span class="c1">##    #rrq.showHTMLRatingHeatmap()</span>
<span class="c1">##    #rrq.showRatingByQuantilesSorting(strategy=&#39;average&#39;)</span>
<span class="c1">##    rrq.showRatingByQuantilesRanking()</span>
    
<span class="c1">##    rlq = RatingByLearnedQuantilesDigraph(pt,quantiles=7,outrankingModel=&#39;mp&#39;)</span>
<span class="c1">##    print(rlq)</span>
<span class="c1">##    lrq.showRatingByQuantilesRanking()</span>
    <span class="c1">#corr = rrq.computeRatingByRankingCorrelation(Debug=False)</span>
    <span class="c1">#print(&#39;*-----Global Relative-Rating-By-Ranking Quality&#39;)</span>
    <span class="c1">#rrq.showCorrelation(corr)</span>
    <span class="c1">#rrq.showRatingConsensusQuality()</span>

    <span class="c1"># absolute quantiles rating from randomPerfTabs import</span>
<span class="c1">#   Random3ObjectivesPerformanceTableau</span>
    <span class="n">hpt</span> <span class="o">=</span> <span class="n">Random3ObjectivesPerformanceTableau</span><span class="p">(</span><span class="n">numberOfActions</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">performanceQuantiles</span> <span class="kn">import</span> <span class="n">PerformanceQuantiles</span>
    <span class="n">pq</span> <span class="o">=</span> <span class="n">PerformanceQuantiles</span><span class="p">(</span><span class="n">hpt</span><span class="p">,</span><span class="n">numberOfBins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">LowerClosed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># new incoming decision actions of the same kind</span>
    <span class="kn">from</span> <span class="nn">randomPerfTabs</span>\
    <span class="kn">import</span> <span class="nn">RandomPerformanceGenerator</span> <span class="k">as</span> <span class="nn">PerfTabGenerator</span>
    <span class="n">tpg</span> <span class="o">=</span> <span class="n">PerfTabGenerator</span><span class="p">(</span><span class="n">hpt</span><span class="p">,</span><span class="n">instanceCounter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">newActions</span> <span class="o">=</span> <span class="n">tpg</span><span class="o">.</span><span class="n">randomActions</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1"># rating the new set of decision actions after</span>
    <span class="c1"># updating the historical performance quantiles</span>
    <span class="n">pq</span><span class="o">.</span><span class="n">updateQuantiles</span><span class="p">(</span><span class="n">newActions</span><span class="p">,</span><span class="n">historySize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">lqr</span> <span class="o">=</span> <span class="n">RatingByLearnedQuantilesDigraph</span><span class="p">(</span><span class="n">pq</span><span class="p">,</span><span class="n">newData</span><span class="o">=</span><span class="n">newActions</span><span class="p">,</span>
                        <span class="n">quantiles</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">outrankingModel</span><span class="o">=</span><span class="s1">&#39;mp&#39;</span><span class="p">,</span>
                        <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">Threading</span><span class="o">=</span><span class="n">MP</span><span class="p">,</span>
                        <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lqr</span><span class="p">)</span>

<span class="c1">##    lqr.showRatingByQuantilesSorting()</span>
<span class="c1">##    lqr.showRatingByQuantilesRanking()</span>
<span class="c1">##    print(lqr.computeRatingByRankingCorrelation(Debug=True))</span>
<span class="c1">##    lqr.showRankingConsensusQuality(lqr.actionsRanking)</span>
    <span class="c1"># from outrankingDigraphs import *</span>
    <span class="c1"># t = PerformanceTableau(filePerfTab=&#39;pmax3&#39;)</span>
    <span class="c1"># qr = RatingByRelativeQuantilesDigraph(t,outrankingModel=&#39;mp&#39;)</span>
    <span class="c1"># PerformanceTableau.showHTMLPerformanceHeatmap(qr,Correlations=True)</span>
    
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2024, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Feb 07, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>