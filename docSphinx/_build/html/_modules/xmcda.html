<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>xmcda &mdash; Digraph3 3.13.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sphinx_rtd_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=6aaf4047"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=15d7cbb8"></script>
        <script src="../_static/js/hoverxref.js?v=4352a7d3"></script>
        <script src="../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
        <script src="../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Python 3.13
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">xmcda</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for xmcda</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/Usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Python3+ implementation of xmcda tools</span>

<span class="sd">.. warning::</span>

<span class="sd">   These resources are now deprecated and should no more be considered for ongoing usage!! They were developped in the context of now obsolete xml encoded web services deployments. A replacement alternative is given with the standard save() methods of performance tableaux, digraphs and graphs. </span>
<span class="sd">  </span>
<span class="sd">Copyright (C) 2016-2022  Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#######################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.10&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">XMCDA 2.0 xsl style sheets and XMCDA save and show method</span>
<span class="sd">for the Rubis best-choice recommendation.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">copy</span><span class="o">,</span><span class="nn">string</span><span class="o">,</span><span class="nn">os</span><span class="o">,</span><span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">xmcda</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">############################</span>
<span class="n">rubisExtXSL</span> <span class="o">=</span>\
<span class="sd">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="sd">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot;&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- </span>
<span class="sd">XMCDA 2.0 Rubis XSLT tranformation to HTML, RB 2017</span>
<span class="sd">$Revision: 1.0 $</span>
<span class="sd">The ressource comes with ABSOLUTELY NO WARRANTY </span>
<span class="sd">to the extent permitted by the applicable law.</span>
<span class="sd">This is free software, and you are welcome to </span>
<span class="sd">redistribute it if it remains free software. </span>
<span class="sd">Copyright (C) 2009 DECISION DECK Consortium</span>
<span class="sd">Copyright (C) 2009-2017 Raymond Bisdorff Luxembourg</span>
<span class="sd">--&gt;</span>


<span class="sd"> &lt;!-- Main start of the transform --&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;/&quot; &gt;</span>
<span class="sd"> &lt;html&gt;</span>
<span class="sd">  &lt;head&gt;&lt;title&gt;D2-Decision-Deck UMCDA-ML XMCDA-2.0 application&lt;/title&gt;&lt;/head&gt;</span>
<span class="sd">  &lt;body&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;font color=&quot;#0000bb&quot;&gt;Decision-Deck UMCDA-ML XMCDA 2.0 application&lt;/font&gt;&lt;/h2&gt;</span>
<span class="sd">    </span>
<span class="sd">    &lt;xsl:apply-templates /&gt;</span>
<span class="sd">    &lt;hr /&gt;</span>
<span class="sd">    &lt;p&gt;&lt;b&gt;Rubis XSLT to HTML stylesheet (R. Bisdorff):&lt;/b&gt; $Revision: 1.0$ &lt;br/&gt;</span>
<span class="sd">          UMCDA-ML &lt;a href=&quot;http://www.decision-deck.org/xmcda&quot;&gt;XMCDA 2.0 Extended Schema&lt;/a&gt;&lt;br/&gt;</span>
<span class="sd">          Raymond Bisdorff (University of Luxembourg), Patrick Meyer (Telecom Bretagne) and Thomas Veneziano (University of Luxembourg)March 2009&lt;br/&gt;</span>
<span class="sd">          Copyright Â© 2009-2017 &lt;a href=&quot;http://www.decision-deck.org/&quot;&gt;DECISION DECK Consortium&lt;/a&gt;&lt;br/&gt;</span>
<span class="sd">          &lt;a href=&quot;javascript:void(document.location=&#39;view-source:&#39;+document.location)&quot;&gt;View the source of this document.&lt;/a&gt;&lt;/p&gt;</span>
<span class="sd">   &lt;/body&gt;</span>
<span class="sd">  &lt;/html&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisions[@mcdaConcept=&#39;outrankingDigraph&#39;]&quot; mode=&quot;toc&quot;&gt;</span>
<span class="sd">     &lt;!-- &lt;xsl:apply-templates select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">    &lt;li&gt;&lt;a href=&quot;#digraph&quot;&gt;Outranking Digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisions[@mcdaConcept=&#39;ValuedDigraph&#39;]&quot; mode=&quot;toc&quot;&gt;</span>
<span class="sd">     &lt;!-- &lt;xsl:apply-templates select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">    &lt;li&gt;&lt;a href=&quot;#digraph&quot;&gt;Valued Digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd"> &lt;!--  generic description layout: must fit all element description !!! --&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;title&quot;&gt;</span>
<span class="sd">    &lt;h1&gt;&lt;font color=&quot;#bb0000&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h1&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;subTitle&quot;&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h2&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;subSubTitle&quot;&gt;</span>
<span class="sd">    &lt;h3&gt;&lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h3&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;id&quot;&gt;</span>
<span class="sd">    Identifier: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;approach&quot;&gt;</span>
<span class="sd">    Approach: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;methodology&quot;&gt;</span>
<span class="sd">    Methodology: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;problematique&quot;&gt;</span>
<span class="sd">    Problematique: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;shortName&quot;&gt;</span>
<span class="sd">    Short name: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;name&quot;&gt;</span>
<span class="sd">    Name: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;comment&quot;&gt;</span>
<span class="sd">    Comment: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;author&quot;&gt;</span>
<span class="sd">    Author: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;user&quot;&gt;</span>
<span class="sd">    User: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;type&quot;&gt;</span>
<span class="sd"> &lt;!--    &lt;tr&gt;&lt;th align=&quot;left&quot;&gt;Type: &lt;/th&gt;&lt;td&gt;&lt;xsl:apply-templates/&gt;&lt;/td&gt;&lt;/tr&gt; --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;version&quot;&gt;</span>
<span class="sd">    Version: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;abstract&quot;&gt;</span>
<span class="sd">    Abstract: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;keywords&quot;&gt;</span>
<span class="sd">    Key Words: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;bibliography&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;0&quot;&gt;</span>
<span class="sd">    &lt;xsl:for-each select=&quot;bibEntry&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">    &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;dateTime&quot;&gt;</span>
<span class="sd">    Date: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- Method Data --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;methodParameters&quot;&gt;</span>
<span class="sd">   &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;parameters&quot;&gt;</span>
<span class="sd">    &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Parameter&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Value&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Comment&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates/&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[value]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;value&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/constant]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/linear]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function/linear/intercept&quot;/&gt;+&lt;xsl:value-of select=&quot;function/linear/slope&quot;/&gt;x&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;errorMessage&quot;&gt;</span>
<span class="sd"> &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Number&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Name&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Text&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;number&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;text&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>


<span class="sd">&lt;xsl:template match=&quot;alternatives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;alternatives&quot;/&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;alternative&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisons&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;digraph&quot;/&gt;</span>
<span class="sd">    &lt;xsl:choose&gt;</span>
<span class="sd">      &lt;xsl:when test=&quot;valuation/valuationType=&#39;bipolar&#39;&quot;&gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;bipolar&quot;/&gt;</span>
<span class="sd">      &lt;/xsl:when&gt;</span>
<span class="sd">      &lt;xsl:otherwise&gt;</span>
<span class="sd">        &lt;xsl:apply-templates/&gt;</span>
<span class="sd">      &lt;/xsl:otherwise&gt;</span>
<span class="sd">    &lt;/xsl:choose&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;relationOnCriteria&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;correlation&quot;/&gt;</span>
<span class="sd">     &lt;xsl:apply-templates mode=&quot;simil&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;relationOnAlternatives[description/type=&#39;Vetoes&#39;]&quot; &gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;veto&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;median&quot; select=&quot;quantitative/minimum + (quantitative/maximum - quantitative/minimum) div 2&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Median&lt;/td&gt;&lt;td bgcolor=&quot;#dddddd&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;$median&quot; /&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">       &lt;/table&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">        &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;comparisonType&quot;&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;comparisonType&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;Veto&quot; select=&#39;.&#39; /&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">       &lt;ol&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$Veto/pair&quot;&gt;</span>
<span class="sd">           &lt;li&gt;Veto against &lt;b&gt;&lt;xsl:value-of select=&quot;initial/alternativeID&quot;/&gt; outranks</span>
<span class="sd">            &lt;xsl:value-of select=&quot;terminal/alternativeID&quot;/&gt; &lt;/b&gt; (</span>
<span class="sd">          &lt;xsl:value-of select=&quot;description/comment&quot;/&gt;)</span>
<span class="sd">           &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">             &lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criterion&lt;/th&gt;&lt;th&gt;performance difference&lt;/th&gt;&lt;th&gt;status&lt;/th&gt;&lt;th&gt;characteristic&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">             &lt;xsl:for-each select=&quot;values&quot;&gt;</span>
<span class="sd">               &lt;tr&gt;</span>
<span class="sd">                 &lt;th bgcolor=&quot;#FFF79B&quot; align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;performanceDifference&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;vetoCharacteristic&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">               &lt;/tr&gt;</span>
<span class="sd">             &lt;/xsl:for-each&gt;</span>
<span class="sd">             &lt;/table&gt;&lt;br/&gt;</span>
<span class="sd">           &lt;/li&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">         &lt;/ol&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;allAlternatives&quot; select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    --&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;&lt;xsl:value-of select=&quot;preceding::comparisonType&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">                   &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">         &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">          &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">            &lt;xsl:call-template name=&quot;currentValue&quot; &gt;</span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">             &lt;/xsl:call-template&gt;</span>
<span class="sd">           &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;allAlternatives&quot; select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    </span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;&lt;xsl:value-of select=&quot;preceding::comparisonType&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:variable name=&quot;Min&quot; select=&quot;parent::node()/valuation/quantitative/minimum&quot;/&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;Max&quot; select=&quot;parent::node()/valuation/quantitative/maximum&quot;/&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;Med&quot; select=&quot;$Min + ($Max - $Min) div 2&quot;/&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">            &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">              &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">              &lt;xsl:call-template name=&quot;currentBipolarValue&quot; &gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;Med&quot; select=&quot;$Med&quot; /&gt;</span>
<span class="sd">              &lt;/xsl:call-template&gt;</span>
<span class="sd">            &lt;/xsl:for-each&gt;</span>
<span class="sd">          &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>

<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;relation&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">                   &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">         &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">          &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$currentArcs/arc[from/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">            &lt;xsl:call-template name=&quot;currentSimilValue&quot; &gt;</span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">             &lt;/xsl:call-template&gt;</span>
<span class="sd">           &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>

<span class="sd"> </span>
<span class="sd">  &lt;xsl:template name=&quot;currentSimilValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/criterionID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentValue&quot; match=&quot;pair&quot; &gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/alternativeID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;td align=&quot;right&quot; &gt;&lt;xsl:value-of select=&quot;./value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentBipolarValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;Med&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/alternativeID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>


<span class="sd">&lt;!-- presentation of the objectives--&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;objectives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;objectives&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Criteria list&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;objective&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;objectiveCriteria&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">       &lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- presentation of the coalitions --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;criteriaSets&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;coalitions&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">  &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">    &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Criteria&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">    &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;criteriaSet&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;</span>
<span class="sd">        &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">       &lt;td&gt;{</span>
<span class="sd">          &lt;xsl:for-each select=&quot;element&quot;&gt;&lt;xsl:value-of select=&quot;criterionID&quot;/&gt;, &lt;/xsl:for-each&gt;</span>
<span class="sd">          }&lt;/td&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">    &lt;/xsl:for-each&gt;</span>
<span class="sd">  &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- presentation of the criteria --&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;criteria&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;criteria&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Weight&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;3&quot;&gt;Scale&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;5&quot;&gt;Thresholds&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">       &lt;th&gt;direction&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;min&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;max&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;indifference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak veto&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;veto&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;criterion&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;criterionValue/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/preferenceDirection&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/minimum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/maximum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;ind&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakPreference&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;pref&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakVeto&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;veto&#39;]&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;constant&quot;&gt;</span>
<span class="sd">  &lt;!--&lt;xsl:if test=&quot;descendant::*name()= &#39;linear&#39;&quot;&gt;integer&lt;xsl:value-of select=&quot;.&quot;/&gt;&lt;/xsl:if&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">  &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!--&lt;xsl:template match=&quot;value/integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;!--&lt;xsl:template match=&quot;value/real&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#.##&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;real&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#.##&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;!--&lt;xsl:template match=&quot;value/rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;linear&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;intercept/.&quot;/&gt; + &lt;xsl:value-of select=&quot;slope/.&quot;/&gt;x</span>
<span class="sd">&lt;/xsl:template&gt;</span>



<span class="sd">  &lt;!-- Controlling the presentation of the performance table --&gt;</span>
<span class="sd">  &lt;xsl:key name=&quot;currentCriterion&quot; match=&quot;/xmcda:XMCDA/criteria/criterion&quot; use=&#39;.&#39;  /&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:variable name=&quot;allCriteria&quot; </span>
<span class="sd">    select=&quot;/xmcda:XMCDA/criteria/criterion[</span>
<span class="sd">    generate-id() = </span>
<span class="sd">    generate-id(key(&#39;currentCriterion&#39;,.)[1] </span>
<span class="sd">    )</span>
<span class="sd">    ]&quot; /&gt;  </span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;performanceTable&quot;&gt;</span>
<span class="sd">  &lt;xsl:variable name=&quot;root&quot; select=&quot;/xmcda:XMCDA/criteria&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">   &lt;xsl:variable name=&quot;currentTable&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;alternative&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$root/criterion&quot;&gt;</span>
<span class="sd">	  &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates select=&quot;$currentTable/alternativePerformances&quot;/&gt; </span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;alternativePerformances&quot;&gt;</span>
<span class="sd">  &lt;tr&gt;</span>
<span class="sd">    &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;alternativeID&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentAlternative&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>

<span class="sd">   &lt;xsl:for-each select=&quot;key(&#39;currentCriterion&#39;, $allCriteria)&quot;&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentCriterion&quot; select=&quot;./@id&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;xsl:call-template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentAlternative&quot; select=&quot;$currentAlternative&quot; /&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentCriterion&quot; select=&quot;$currentCriterion&quot;/&gt;</span>
<span class="sd">       &lt;/xsl:call-template&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">  &lt;/tr&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentAlternative&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentCriterion&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentPerformance&quot; select=&quot;$currentAlternative/performance[criterionID=$currentCriterion]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">     &lt;td align=&quot;right&quot;&gt;&lt;xsl:apply-templates select=&quot;$currentPerformance/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- &lt;xsl:template match=&quot;comment&quot;&gt; --&gt;</span>
<span class="sd">  &lt;!-- no comments --&gt;</span>
<span class="sd">&lt;!-- &lt;/xsl:template&gt; --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;XMCDA/alternatives/description&quot;&gt;</span>
<span class="sd">  &lt;!-- no comments --&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;choices&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;choices&quot;&gt;&lt;/a&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Choice set&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Determinateness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankingness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankedness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;choice&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;{</span>
<span class="sd">           &lt;xsl:for-each select=&quot;choiceMembersList/choiceMember&quot;&gt;</span>
<span class="sd">             &lt;xsl:value-of select=&quot;./alternativeID&quot;/&gt;,</span>
<span class="sd">           &lt;/xsl:for-each&gt;}</span>
<span class="sd">           &lt;/th&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;qualities/parameter[name=&#39;determinateness&#39;]/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;qualities/parameter[name=&#39;outranking&#39;]/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;qualities/parameter[name=&#39;outranked&#39;]/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">&lt;/xsl:stylesheet&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="n">rubisXSL</span> <span class="o">=</span>\
<span class="sd">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="sd">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot;&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- </span>
<span class="sd">XMCDA 2.0 Default XSLT tranformation to HTML, RB 2009</span>
<span class="sd">$Revision: 1.7 $</span>
<span class="sd">The ressource comes with ABSOLUTELY NO WARRANTY </span>
<span class="sd">to the extent permitted by the applicable law.</span>
<span class="sd">This is free software, and you are welcome to </span>
<span class="sd">redistribute it if it remains free software. </span>
<span class="sd">Copyright (C) 2009 DECISION DECK Consortium</span>
<span class="sd">--&gt;</span>


<span class="sd"> &lt;!-- Main start of the transform --&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;/&quot; &gt;</span>
<span class="sd"> &lt;html&gt;</span>
<span class="sd">  &lt;head&gt;&lt;title&gt;D2-Decision-Deck UMCDA-ML XMCDA-2.0 application&lt;/title&gt;&lt;/head&gt;</span>
<span class="sd">  &lt;body&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;font color=&quot;#0000bb&quot;&gt;Decision-Deck UMCDA-ML XMCDA 2.0 application&lt;/font&gt;&lt;/h2&gt;</span>
<span class="sd">    </span>
<span class="sd">    &lt;xsl:apply-templates /&gt;</span>
<span class="sd">    &lt;hr /&gt;</span>
<span class="sd">    &lt;p&gt;&lt;b&gt;Rubis XSLT to HTML stylesheet (R. Bisdorff):&lt;/b&gt; $Revision: 1.7 $ &lt;br/&gt;</span>
<span class="sd">          UMCDA-ML &lt;a href=&quot;http://www.decision-deck.org/xmcda&quot;&gt;XMCDA 2.0 Schema&lt;/a&gt;&lt;br/&gt;</span>
<span class="sd">          Raymond Bisdorff (University of Luxembourg), Patrick Meyer (Telecom Bretagne) and Thomas Veneziano (University of Luxembourg)March 2009&lt;br/&gt;</span>
<span class="sd">          Copyright Â© 2009 &lt;a href=&quot;http://www.decision-deck.org/&quot;&gt;DECISION DECK Consortium&lt;/a&gt;&lt;br/&gt;</span>
<span class="sd">          &lt;a href=&quot;javascript:void(document.location=&#39;view-source:&#39;+document.location)&quot;&gt;View the source of this document.&lt;/a&gt;&lt;/p&gt;</span>
<span class="sd">   &lt;/body&gt;</span>
<span class="sd">  &lt;/html&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisions[@mcdaConcept=&#39;outrankingDigraph&#39;]&quot; mode=&quot;toc&quot;&gt;</span>
<span class="sd">     &lt;!-- &lt;xsl:apply-templates select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">    &lt;li&gt;&lt;a href=&quot;#digraph&quot;&gt;Outranking Digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisions[@mcdaConcept=&#39;ValuedDigraph&#39;]&quot; mode=&quot;toc&quot;&gt;</span>
<span class="sd">     &lt;!-- &lt;xsl:apply-templates select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">    &lt;li&gt;&lt;a href=&quot;#digraph&quot;&gt;Valued Digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd"> &lt;!--  generic description layout: must fit all element description !!! --&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;title&quot;&gt;</span>
<span class="sd">    &lt;h1&gt;&lt;font color=&quot;#bb0000&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h1&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;subTitle&quot;&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h2&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;subSubTitle&quot;&gt;</span>
<span class="sd">    &lt;h3&gt;&lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h3&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;id&quot;&gt;</span>
<span class="sd">    Identifier: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;approach&quot;&gt;</span>
<span class="sd">    Approach: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;methodology&quot;&gt;</span>
<span class="sd">    Methodology: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;problematique&quot;&gt;</span>
<span class="sd">    Problematique: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;shortName&quot;&gt;</span>
<span class="sd">    Short name: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;name&quot;&gt;</span>
<span class="sd">    Name: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;comment&quot;&gt;</span>
<span class="sd">    Comment: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;author&quot;&gt;</span>
<span class="sd">    Author: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;user&quot;&gt;</span>
<span class="sd">    User: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;type&quot;&gt;</span>
<span class="sd"> &lt;!--    &lt;tr&gt;&lt;th align=&quot;left&quot;&gt;Type: &lt;/th&gt;&lt;td&gt;&lt;xsl:apply-templates/&gt;&lt;/td&gt;&lt;/tr&gt; --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;version&quot;&gt;</span>
<span class="sd">    Version: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;abstract&quot;&gt;</span>
<span class="sd">    Abstract: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;keywords&quot;&gt;</span>
<span class="sd">    Key Words: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;bibliography&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;0&quot;&gt;</span>
<span class="sd">    &lt;xsl:for-each select=&quot;bibEntry&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">    &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;dateTime&quot;&gt;</span>
<span class="sd">    Date: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- Method Data --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;methodParameters&quot;&gt;</span>
<span class="sd">   &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;parameters&quot;&gt;</span>
<span class="sd">    &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Parameter&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Value&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Comment&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates/&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[value]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;value&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/constant]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/linear]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function/linear/intercept&quot;/&gt;+&lt;xsl:value-of select=&quot;function/linear/slope&quot;/&gt;x&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;errorMessage&quot;&gt;</span>
<span class="sd"> &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Number&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Name&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Text&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;number&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;text&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>


<span class="sd">&lt;xsl:template match=&quot;alternatives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;alternatives&quot;/&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;alternative&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisons&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;digraph&quot;/&gt;</span>
<span class="sd">    &lt;xsl:choose&gt;</span>
<span class="sd">      &lt;xsl:when test=&quot;valuation/valuationType=&#39;bipolar&#39;&quot;&gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;bipolar&quot;/&gt;</span>
<span class="sd">      &lt;/xsl:when&gt;</span>
<span class="sd">      &lt;xsl:otherwise&gt;</span>
<span class="sd">        &lt;xsl:apply-templates/&gt;</span>
<span class="sd">      &lt;/xsl:otherwise&gt;</span>
<span class="sd">    &lt;/xsl:choose&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;relationOnCriteria&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;correlation&quot;/&gt;</span>
<span class="sd">     &lt;xsl:apply-templates mode=&quot;simil&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;relationOnAlternatives[description/type=&#39;Vetoes&#39;]&quot; &gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;veto&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;median&quot; select=&quot;quantitative/minimum + (quantitative/maximum - quantitative/minimum) div 2&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Median&lt;/td&gt;&lt;td bgcolor=&quot;#dddddd&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;$median&quot; /&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">       &lt;/table&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">        &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;comparisonType&quot;&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;comparisonType&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;Veto&quot; select=&#39;.&#39; /&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">       &lt;ol&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$Veto/pair&quot;&gt;</span>
<span class="sd">           &lt;li&gt;Veto against &lt;b&gt;&lt;xsl:value-of select=&quot;initial/alternativeID&quot;/&gt; outranks</span>
<span class="sd">            &lt;xsl:value-of select=&quot;terminal/alternativeID&quot;/&gt; &lt;/b&gt; (</span>
<span class="sd">          &lt;xsl:value-of select=&quot;description/comment&quot;/&gt;)</span>
<span class="sd">           &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">             &lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criterion&lt;/th&gt;&lt;th&gt;performance difference&lt;/th&gt;&lt;th&gt;status&lt;/th&gt;&lt;th&gt;characteristic&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">             &lt;xsl:for-each select=&quot;values&quot;&gt;</span>
<span class="sd">               &lt;tr&gt;</span>
<span class="sd">                 &lt;th bgcolor=&quot;#FFF79B&quot; align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;performanceDifference&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;vetoCharacteristic&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">               &lt;/tr&gt;</span>
<span class="sd">             &lt;/xsl:for-each&gt;</span>
<span class="sd">             &lt;/table&gt;&lt;br/&gt;</span>
<span class="sd">           &lt;/li&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">         &lt;/ol&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;allAlternatives&quot; select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    --&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;&lt;xsl:value-of select=&quot;preceding::comparisonType&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">                   &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">         &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">          &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">            &lt;xsl:call-template name=&quot;currentValue&quot; &gt;</span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">             &lt;/xsl:call-template&gt;</span>
<span class="sd">           &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;allAlternatives&quot; select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    </span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;&lt;xsl:value-of select=&quot;preceding::comparisonType&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:variable name=&quot;Min&quot; select=&quot;parent::node()/valuation/quantitative/minimum&quot;/&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;Max&quot; select=&quot;parent::node()/valuation/quantitative/maximum&quot;/&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;Med&quot; select=&quot;$Min + ($Max - $Min) div 2&quot;/&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$allAlternatives&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">            &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">              &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">              &lt;xsl:call-template name=&quot;currentBipolarValue&quot; &gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;Med&quot; select=&quot;$Med&quot; /&gt;</span>
<span class="sd">              &lt;/xsl:call-template&gt;</span>
<span class="sd">            &lt;/xsl:for-each&gt;</span>
<span class="sd">          &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>

<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;relation&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">                   &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">         &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">          &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$currentArcs/arc[from/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">            &lt;xsl:call-template name=&quot;currentSimilValue&quot; &gt;</span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">             &lt;/xsl:call-template&gt;</span>
<span class="sd">           &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template name=&quot;currentSimilValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/criterionID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentValue&quot; match=&quot;pair&quot; &gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/alternativeID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;td align=&quot;right&quot; &gt;&lt;xsl:value-of select=&quot;./value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentBipolarValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;Med&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/alternativeID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- presentation of the objectives--&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;objectives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;objectives&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Criteria list&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;objective&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;objectiveCriteria&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">       &lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- presentation of the coalitions --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;criteriaSets&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;coalitions&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">  &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">    &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Criteria&lt;/th&gt;</span>
<span class="sd">      &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">    &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;criteriaSet&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;</span>
<span class="sd">        &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">       &lt;td&gt;{</span>
<span class="sd">          &lt;xsl:for-each select=&quot;element&quot;&gt;&lt;xsl:value-of select=&quot;criterionID&quot;/&gt;, &lt;/xsl:for-each&gt;</span>
<span class="sd">          }&lt;/td&gt;</span>
<span class="sd">        &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">    &lt;/xsl:for-each&gt;</span>
<span class="sd">  &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- presentation of the criteria --&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;criteria&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;criteria&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Weight&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;3&quot;&gt;Scale&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;5&quot;&gt;Thresholds&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">       &lt;th&gt;direction&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;min&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;max&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;indifference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak veto&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;veto&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;criterion&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;criterionValue/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/preferenceDirection&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/minimum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/maximum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;ind&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakPreference&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;pref&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakVeto&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;veto&#39;]&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;constant&quot;&gt;</span>
<span class="sd">  &lt;!--&lt;xsl:if test=&quot;descendant::*name()= &#39;linear&#39;&quot;&gt;integer&lt;xsl:value-of select=&quot;.&quot;/&gt;&lt;/xsl:if&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">  &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!--&lt;xsl:template match=&quot;value/integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;!--&lt;xsl:template match=&quot;value/real&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#.##&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;real&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#.##&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;!--&lt;xsl:template match=&quot;value/rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;linear&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;intercept/.&quot;/&gt; + &lt;xsl:value-of select=&quot;slope/.&quot;/&gt;x</span>
<span class="sd">&lt;/xsl:template&gt;</span>



<span class="sd">  &lt;!-- Controlling the presentation of the performance table --&gt;</span>
<span class="sd">  &lt;xsl:key name=&quot;currentCriterion&quot; match=&quot;/xmcda:XMCDA/criteria/criterion&quot; use=&#39;.&#39;  /&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:variable name=&quot;allCriteria&quot; </span>
<span class="sd">    select=&quot;/xmcda:XMCDA/criteria/criterion[</span>
<span class="sd">    generate-id() = </span>
<span class="sd">    generate-id(key(&#39;currentCriterion&#39;,.)[1] </span>
<span class="sd">    )</span>
<span class="sd">    ]&quot; /&gt;  </span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;performanceTable&quot;&gt;</span>
<span class="sd">  &lt;xsl:variable name=&quot;root&quot; select=&quot;/xmcda:XMCDA/criteria&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">   &lt;xsl:variable name=&quot;currentTable&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;alternative&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$root/criterion&quot;&gt;</span>
<span class="sd">	  &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates select=&quot;$currentTable/alternativePerformances&quot;/&gt; </span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;alternativePerformances&quot;&gt;</span>
<span class="sd">  &lt;tr&gt;</span>
<span class="sd">    &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;alternativeID&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentAlternative&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>

<span class="sd">   &lt;xsl:for-each select=&quot;key(&#39;currentCriterion&#39;, $allCriteria)&quot;&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentCriterion&quot; select=&quot;./@id&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;xsl:call-template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentAlternative&quot; select=&quot;$currentAlternative&quot; /&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentCriterion&quot; select=&quot;$currentCriterion&quot;/&gt;</span>
<span class="sd">       &lt;/xsl:call-template&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">  &lt;/tr&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentAlternative&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentCriterion&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentPerformance&quot; select=&quot;$currentAlternative/performance[criterionID=$currentCriterion]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">     &lt;td align=&quot;right&quot;&gt;&lt;xsl:apply-templates select=&quot;$currentPerformance/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- &lt;xsl:template match=&quot;comment&quot;&gt; --&gt;</span>
<span class="sd">  &lt;!-- no comments --&gt;</span>
<span class="sd">&lt;!-- &lt;/xsl:template&gt; --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;XMCDA/alternatives/description&quot;&gt;</span>
<span class="sd">  &lt;!-- no comments --&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;choices&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;choices&quot;&gt;&lt;/a&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Choice set&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Determinateness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankingness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankedness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;choice&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;{</span>
<span class="sd">           &lt;xsl:for-each select=&quot;choiceMembersList/choiceMember&quot;&gt;</span>
<span class="sd">             &lt;xsl:value-of select=&quot;./alternativeID&quot;/&gt;,</span>
<span class="sd">           &lt;/xsl:for-each&gt;}</span>
<span class="sd">           &lt;/th&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;qualities/parameter[name=&#39;determinateness&#39;]/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;qualities/parameter[name=&#39;outranking&#39;]/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;qualities/parameter[name=&#39;outranked&#39;]/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">&lt;/xsl:stylesheet&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">####################</span>
<span class="n">rubisChoiceXSL</span> <span class="o">=</span>\
<span class="sd">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="sd">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; </span>
<span class="sd">                       xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot;&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- </span>
<span class="sd">XMCDA 2.0 Rubis XSLT tranformation to HTML, RB 2009</span>
<span class="sd">$Revision: 1.6 $</span>
<span class="sd">The ressource comes with ABSOLUTELY NO WARRANTY </span>
<span class="sd">to the extent permitted by the applicable law.</span>
<span class="sd">This is free software, and you are welcome to </span>
<span class="sd">redistribute it if it remains free software. </span>
<span class="sd">Copyright (C) 2009 DECISION DECK Consortium</span>
<span class="sd">--&gt;</span>


<span class="sd"> &lt;!-- Main start of the transform --&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;/&quot; &gt;</span>
<span class="sd"> &lt;html&gt;</span>
<span class="sd">  &lt;head&gt;&lt;title&gt;Decision-Deck UMCDA-ML-2.0 application&lt;/title&gt;&lt;/head&gt;</span>
<span class="sd">  &lt;body&gt;</span>
<span class="sd">    &lt;h1&gt;&lt;font color=&quot;#0000bb&quot;&gt;Decision-Deck UMCDA-ML-2.0 Application&lt;/font&gt;&lt;/h1&gt;</span>

<span class="sd">    &lt;xsl:apply-templates  select=&quot;xmcda:XMCDA&quot; /&gt;</span>
<span class="sd">    &lt;br/&gt;</span>
<span class="sd">    &lt;h2&gt;Content&lt;/h2&gt;</span>
<span class="sd">    &lt;ul&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#choice&quot;&gt;Choice Recommendation&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#graph&quot;&gt;Outranking digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#alternatives&quot;&gt;Potential decision actions&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#performance&quot;&gt;Performance table&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#criteria&quot;&gt;Family of criteria&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#correlation&quot;&gt;Criteria ordinal correlation&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#outranking&quot;&gt;Outranking relation&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#vetos&quot;&gt;Veto situations&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#notice&quot;&gt;Notice&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">    &lt;/ul&gt;</span>
<span class="sd">    &lt;hr /&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;a name=&quot;notice&quot;&gt;&lt;font color=&quot;#bb0000&quot;&gt;Notice&lt;/font&gt;&lt;/a&gt;&lt;/h2&gt;</span>
<span class="sd">    &lt;p&gt;Bisdorff R., Meyer P., Roubens M., &lt;b&gt;Rubis&lt;/b&gt;: A new methodology for the choice decision problem. 4OR, </span>
<span class="sd">      &lt;em&gt;A Quarterly Journal of Operational Research&lt;/em&gt;, Springer (2008), Vol 6 Number 2 pp. 143-165, DOI 10.1007/s10288-007-0045-5.</span>
<span class="sd">    &lt;a href=&quot;http://sma.uni.lu/bisdorff/documents/HyperKernels.pdf&quot;&gt;PDF preprint version&lt;/a&gt;.&lt;/p&gt;</span>
<span class="sd">   &lt;p&gt;Online documentation: &lt;a href=&quot;https://www.decision-deck.org&quot;&gt;Decision Deck Project&lt;/a&gt;&lt;br/&gt;</span>
<span class="sd">     &lt;b&gt;Rubis XSL Transformation to HTML&lt;/b&gt; R. Bisdorff, $Revision: 1.6 $&lt;br/&gt;</span>
<span class="sd">          &lt;a href=&quot;http://www.decision-deck.org/xmcda&quot;&gt;XMCDA 2.0 Schema&lt;/a&gt; P. Meyer and Th. Veneziano 2009 &lt;br/&gt;</span>
<span class="sd">           Copyright Â© 2009 DECISION DECK Consortium&lt;/p&gt;</span>
<span class="sd">   &lt;/body&gt;</span>
<span class="sd">  &lt;/html&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>

<span class="sd"> &lt;!--  generic description layout: must fit all element description !!! --&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;projectReference&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates /&gt;</span>
<span class="sd">    &lt;h3&gt;Content&lt;/h3&gt;</span>
<span class="sd">    &lt;ul&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#choice&quot;&gt;Choice Recommendation&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#graph&quot;&gt;Outranking digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#alternatives&quot;&gt;Potential decision actions&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#performance&quot;&gt;Performance table&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#criteria&quot;&gt;Family of criteria&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#correlation&quot;&gt;Criteria ordinal correlation&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#outranking&quot;&gt;Outranking relation&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#vetos&quot;&gt;Veto situations&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#notice&quot;&gt;Notice&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">    &lt;/ul&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;title&quot;&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;font color=&quot;#bb0000&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h2&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;subTitle&quot;&gt;</span>
<span class="sd">    &lt;h3&gt;&lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h3&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;id&quot;&gt;</span>
<span class="sd">    Identifier: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;approach&quot;&gt;</span>
<span class="sd">    Approach: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;methodology&quot;&gt;</span>
<span class="sd">    Methodology: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;problematique&quot;&gt;</span>
<span class="sd">    Problematique: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;shortName&quot;&gt;</span>
<span class="sd">    Short name: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;name&quot;&gt;</span>
<span class="sd">    Name: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;comment&quot;&gt;</span>
<span class="sd">    Comment: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;author&quot;&gt;</span>
<span class="sd">    Author: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;user&quot;&gt;</span>
<span class="sd">    User: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;type&quot;&gt;</span>
<span class="sd"> &lt;!--    &lt;tr&gt;&lt;th align=&quot;left&quot;&gt;Type: &lt;/th&gt;&lt;td&gt;&lt;xsl:apply-templates/&gt;&lt;/td&gt;&lt;/tr&gt; --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;version&quot;&gt;</span>
<span class="sd">    Version: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;abstract&quot;&gt;</span>
<span class="sd">    Abstract: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;keywords&quot;&gt;</span>
<span class="sd">    Key Words: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;bibliography&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;0&quot;&gt;</span>
<span class="sd">      &lt;xsl:for-each select=&quot;bibEntry&quot;&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;dateTime&quot;&gt;</span>
<span class="sd">    Date: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>

<span class="sd">&lt;!--  Method Options  --&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;methodParameters&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;parameters&quot;&gt;</span>
<span class="sd">    &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Parameter&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Value&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Comment&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates/&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[value]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;value&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/constant]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/linear]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function/linear/intercept&quot;/&gt;+&lt;xsl:value-of select=&quot;function/linear/slope&quot;/&gt;x&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;errorMessage&quot;&gt;</span>
<span class="sd"> &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Number&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Name&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Text&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;number&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;text&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- List of potential alternatives --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;alternatives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;alternatives&quot;/&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;alternative&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;!-- relation on Alternatives --&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisons[@mcdaConcept=&#39;outrankingDigraph&#39;]&quot;&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;a name=&quot;graph&quot;&gt;&lt;font color=&quot;#bb0000&quot;&gt;Significantly Concordant Outranking Graph&lt;/font&gt;&lt;/a&gt;&lt;/h2&gt;</span>
<span class="sd">    &lt;p&gt;(&lt;i&gt;&lt;b&gt; Black arrows&lt;/b&gt; indicate outranking situations supported by a criteria coalition </span>
<span class="sd">      of positive significance, i.e. gathering more than 50&amp;#37; of the global criteria significance weights.</span>
<span class="sd">      &lt;b&gt;Empty arrow heads&lt;/b&gt; indicate an indeterminate outranking situation.&lt;/i&gt;)&lt;/p&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;tiret&quot; select=&quot; &#39;-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;dot&quot; select=&quot; &#39;.&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;name&quot; select =&quot;/xmcda:XMCDA/@instanceID&quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;path&quot; select=&quot; &#39;rubisGraph-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionPNG&quot; select=&quot; &#39;.png&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionPDF&quot; select=&quot; &#39;.pdf&#39; &quot; /&gt;</span>
<span class="sd">    &lt;div style=&quot;text-align: left;&quot;&gt;	</span>
<span class="sd">      &lt;p&gt;&lt;a href=&quot;{concat($path,$name,$extensionPDF)}&quot; &gt;</span>
<span class="sd">      See PDF graphic file for better image quality and zooming options&lt;/a&gt;</span>
<span class="sd">        (generated with GraphViz).&lt;/p&gt; </span>
<span class="sd">      &lt;img src=&quot;{concat($path,$name,$extensionPNG)}&quot;  /&gt;   </span>
<span class="sd">    &lt;/div&gt; </span>
<span class="sd">    </span>
<span class="sd">    &lt;a name=&quot;outranking&quot;/&gt;</span>
<span class="sd">    &lt;xsl:choose&gt;</span>
<span class="sd">      &lt;xsl:when test=&quot;valuation/valuationType=&#39;bipolar&#39;&quot;&gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;bipolar&quot;/&gt;</span>
<span class="sd">      &lt;/xsl:when&gt;</span>
<span class="sd">      &lt;xsl:otherwise&gt;</span>
<span class="sd">        &lt;xsl:apply-templates/&gt;</span>
<span class="sd">      &lt;/xsl:otherwise&gt;</span>
<span class="sd">    &lt;/xsl:choose&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;criteriaComparisons[@mcdaConcept=&#39;correlationTable&#39;]&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;correlation&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates mode=&quot;simil&quot;/&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;tiret&quot; select=&quot; &#39;-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;dot&quot; select=&quot; &#39;.&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;name&quot; select =&quot;/xmcda:XMCDA/@instanceID&quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;path&quot; select=&quot; &#39;similarityPlot-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionPDF&quot; select=&quot; &#39;.pdf&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionJPG&quot; select=&quot; &#39;.jpg&#39; &quot; /&gt;</span>
<span class="sd">    &lt;h3&gt;&lt;font color=&quot;#bb0000&quot;&gt;Principal component analysis of the criteria correlation index&lt;/font&gt;&lt;/h3&gt;</span>
<span class="sd">    &lt;div style=&quot;text-align: left;&quot;&gt;	</span>
<span class="sd">      &lt;p&gt;&lt;a href=&quot;{concat($path,$name,$extensionPDF)}&quot; &gt;</span>
<span class="sd">      See PDF graphic file for better image quality and zooming options&lt;/a&gt;</span>
<span class="sd">        (generated with R).&lt;/p&gt;</span>
<span class="sd">      &lt;img src=&quot;{concat($path,$name,$extensionJPG)}&quot;  /&gt;</span>
<span class="sd">    &lt;/div&gt; </span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisons[@mcdaConcept=&#39;Vetoes&#39;]&quot; &gt;</span>
<span class="sd">         &lt;a name=&quot;vetos&quot; /&gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;veto&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;median&quot; select=&quot;quantitative/minimum + (quantitative/maximum - quantitative/minimum) div 2&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;format-number(quantitative/maximum,&#39;#.##&#39;)&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Median&lt;/td&gt;&lt;td bgcolor=&quot;#dddddd&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;format-number($median,&#39;#.##&#39;)&quot; /&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;format-number(quantitative/minimum,&#39;#.##&#39;)&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">       &lt;/table&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">        &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd"> &lt;xsl:template match=&quot;comparisonType&quot;&gt;</span>
<span class="sd">    &lt;!-- nothing --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;comparisonType&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;!-- nothing --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;Veto&quot; select=&#39;.&#39; /&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;p&gt;(The &lt;b&gt;concordance degree&lt;/b&gt; of an outranking statement (an arc) results from the </span>
<span class="sd">      difference between the significance (the sum of weights) of the coalition of criteria </span>
<span class="sd">      in favour and the significance of the coalition of criteria in disfavour of this statement.)&lt;/p&gt;</span>
<span class="sd">       &lt;ol&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$Veto/pair&quot;&gt;</span>
<span class="sd">           &lt;li&gt;Veto against &lt;b&gt;&lt;xsl:value-of select=&quot;initial/alternativeID&quot;/&gt; outranks</span>
<span class="sd">            &lt;xsl:value-of select=&quot;terminal/alternativeID&quot;/&gt; &lt;/b&gt; (</span>
<span class="sd">          &lt;xsl:value-of select=&quot;description/comment&quot;/&gt;)</span>
<span class="sd">           &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">             &lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criterion&lt;/th&gt;&lt;th&gt;performance difference&lt;/th&gt;&lt;th&gt;status&lt;/th&gt;&lt;th&gt;characteristic&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">             &lt;xsl:for-each select=&quot;values&quot;&gt;</span>
<span class="sd">               &lt;tr&gt;</span>
<span class="sd">                 &lt;th bgcolor=&quot;#FFF79B&quot; align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;performanceDifference&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;vetoCharacteristic&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">               &lt;/tr&gt;</span>
<span class="sd">             &lt;/xsl:for-each&gt;</span>
<span class="sd">             &lt;/table&gt;&lt;br/&gt;</span>
<span class="sd">           &lt;/li&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">         &lt;/ol&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>

<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;relation&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">                   &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">         &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">          &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">            &lt;xsl:call-template name=&quot;currentValue&quot; &gt;</span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">             &lt;/xsl:call-template&gt;</span>
<span class="sd">           &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;&lt;xsl:value-of select=&quot;parent::node()/description/name&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives[@mcdaConcept=&#39;alternatives&#39;]/alternative&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">        &lt;xsl:variable name=&quot;Min&quot; select=&quot;parent::node()/valuation/quantitative/minimum&quot;/&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;Max&quot; select=&quot;parent::node()/valuation/quantitative/maximum&quot;/&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;Med&quot; select=&quot;$Min + ($Max - $Min) div 2&quot;/&gt;</span>

<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives[@mcdaConcept=&#39;alternatives&#39;]/alternative&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives[@mcdaConcept=&#39;alternatives&#39;]/alternative&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">            &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">              &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">              &lt;xsl:call-template name=&quot;currentBipolarValue&quot; &gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">                  &lt;xsl:with-param name=&quot;Med&quot; select=&quot;$Med&quot; /&gt; </span>
<span class="sd">              &lt;/xsl:call-template&gt;</span>
<span class="sd">            &lt;/xsl:for-each&gt;</span>
<span class="sd">          &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    </span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;relation&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">            &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">              &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">              &lt;xsl:call-template name=&quot;currentSimilValue&quot; &gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">              &lt;/xsl:call-template&gt;</span>
<span class="sd">            &lt;/xsl:for-each&gt;</span>
<span class="sd">          &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc/initial/alternativeID=$currentRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc/terminal/alternativeID=$currentColumn&quot;&gt;</span>
<span class="sd">        &lt;td align=&quot;right&quot; &gt;&lt;xsl:value-of select=&quot;./value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentBipolarValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;Med&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc/initial/alternativeID=$currentRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc/terminal/alternativeID=$currentColumn&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template name=&quot;currentSimilValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/criterionID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- presentation of the objectives--&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;objectives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;objectives&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Criteria list&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;objective&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;objectiveCriteria&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">       &lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd"> &lt;!-- presentation of the coalitions --&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;criteriaSets&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;coalitions&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Criteria&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:for-each select=&quot;criteriaSet&quot;&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;td&gt;{</span>
<span class="sd">            &lt;xsl:for-each select=&quot;element&quot;&gt;&lt;xsl:value-of select=&quot;criterionID&quot;/&gt;, &lt;/xsl:for-each&gt;</span>
<span class="sd">            }&lt;/td&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- presentation of the criteria --&gt; </span>
<span class="sd">&lt;xsl:template match=&quot;criteria&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;criteria&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Weight&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;3&quot;&gt;Scale&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;5&quot;&gt;Thresholds&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">       &lt;th&gt;direction&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;min&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;max&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;indifference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak veto&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;veto&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;criterion&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;criterionValue/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/preferenceDirection&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/minimum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/maximum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;ind&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakPreference&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;pref&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakVeto&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;veto&#39;]/.&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">   </span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;function/constant&quot;&gt;</span>
<span class="sd">  &lt;!--&lt;xsl:if test=&quot;descendant::*name()= &#39;linear&#39;&quot;&gt;integer&lt;xsl:value-of select=&quot;.&quot;/&gt;&lt;/xsl:if&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">  &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;constant&quot;&gt;</span>
<span class="sd">  &lt;!--&lt;xsl:if test=&quot;descendant::*name()= &#39;linear&#39;&quot;&gt;integer&lt;xsl:value-of select=&quot;.&quot;/&gt;&lt;/xsl:if&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">  &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;value/integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;value[real]&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;0.00&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;real&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;0.00&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;value/rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>


<span class="sd">&lt;xsl:template match=&quot;function[linear]&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;intercept/.&quot;/&gt; + &lt;xsl:value-of select=&quot;slope/.&quot;/&gt;x</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;linear&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;intercept/.&quot;/&gt; + &lt;xsl:value-of select=&quot;slope/.&quot;/&gt;x</span>
<span class="sd">&lt;/xsl:template&gt;</span>



<span class="sd">  &lt;!-- Controlling the presentation criteria X alternatives of the performance table --&gt;</span>
<span class="sd">  &lt;xsl:key name=&quot;currentCriterion&quot; match=&quot;/xmcda:XMCDA/criteria/criterion&quot; use=&#39;.&#39;  /&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:variable name=&quot;allCriteria&quot; </span>
<span class="sd">    select=&quot;/xmcda:XMCDA/criteria/criterion[</span>
<span class="sd">    generate-id() = </span>
<span class="sd">    generate-id(key(&#39;currentCriterion&#39;,.)[1] </span>
<span class="sd">    )</span>
<span class="sd">    ]&quot; /&gt;  </span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;performanceTable&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;root&quot; select=&quot;/xmcda:XMCDA/criteria&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentTable&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;alternative&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$root/criterion&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates select=&quot;$currentTable/alternativePerformances&quot;/&gt; </span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativePerformances&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;</span>
<span class="sd">      &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;alternativeID&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentAlternative&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;key(&#39;currentCriterion&#39;, $allCriteria)&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentCriterion&quot; select=&quot;./@id&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:call-template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">          &lt;xsl:with-param name=&quot;currentAlternative&quot; select=&quot;$currentAlternative&quot;&gt;</span>
<span class="sd">          &lt;/xsl:with-param&gt;</span>
<span class="sd">          &lt;xsl:with-param name=&quot;currentCriterion&quot; select=&quot;$currentCriterion&quot;&gt;&lt;/xsl:with-param&gt;</span>
<span class="sd">        &lt;/xsl:call-template&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentAlternative&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentCriterion&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentPerformance&quot; select=&quot;$currentAlternative/performance[criterionID=$currentCriterion]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;td align=&quot;right&quot;&gt;&lt;xsl:apply-templates select=&quot;$currentPerformance/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:key name=&quot;currentAlternative&quot; match=&quot;/xmcda:XMCDA/alternatives/alternative&quot; use=&#39;.&#39;  /&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:variable name=&quot;allAlternatives&quot; </span>
<span class="sd">    select=&quot;/xmcda:XMCDA/alternatives/alternative[</span>
<span class="sd">    generate-id() = </span>
<span class="sd">    generate-id(key(&#39;currentAlternative&#39;,.)[1] </span>
<span class="sd">    )</span>
<span class="sd">    ]&quot; /&gt;  </span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;performanceTable&quot; mode=&quot;criterionEvaluations&quot; &gt;</span>
<span class="sd">  &lt;a name=&quot;performance&quot; /&gt;</span>
<span class="sd">   &lt;xsl:variable name=&quot;currentTable&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;criterion&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">	  &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates select=&quot;$currentTable/criterionEvaluations&quot;/&gt; </span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;criterionEvaluations&quot;&gt;</span>
<span class="sd">  &lt;tr&gt;</span>
<span class="sd">    &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;criterionID&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentCriterion&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:for-each select=&quot;key(&#39;currentAlternative&#39;, $allAlternatives)&quot;&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentAlternative&quot; select=&quot;./@id&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;xsl:call-template name=&quot;performanceRowCritEval&quot;&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentCriterion&quot; select=&quot;$currentCriterion&quot;&gt;</span>
<span class="sd">         &lt;/xsl:with-param&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentAlternative&quot; select=&quot;$currentAlternative&quot;&gt;&lt;/xsl:with-param&gt;</span>
<span class="sd">       &lt;/xsl:call-template&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">  &lt;/tr&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template name=&quot;performanceRowCritEval&quot;&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentCriterion&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentAlternative&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentPerformance&quot; select=&quot;$currentCriterion/evaluation[alternativeID=$currentAlternative]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">     &lt;td align=&quot;right&quot;&gt;&lt;xsl:apply-templates select=&quot;$currentPerformance/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>


<span class="sd">  &lt;xsl:template match=&quot;XMCDA/alternatives/description&quot;&gt;</span>
<span class="sd">  &lt;!-- no comments --&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;!-- Presenting Choice Recommendation --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;alternativesSets[@mcdaConcept=&#39;goodChoices&#39;]&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;choice&quot;&gt;&lt;/a&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Choice set&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Determinateness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankingness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankedness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;alternativesSet[@mcdaConcept=&#39;goodChoice&#39;]&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;{</span>
<span class="sd">           &lt;xsl:for-each select=&quot;element&quot;&gt;</span>
<span class="sd">             &lt;xsl:value-of select=&quot;./alternativeID&quot;/&gt;,</span>
<span class="sd">           &lt;/xsl:for-each&gt;}</span>
<span class="sd">           &lt;/th&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;determinateness&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranking&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranked&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesSets[@mcdaConcept=&#39;badChoices&#39;]&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;choice&quot;&gt;&lt;/a&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Choice set&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Determinateness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankedness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankingness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;alternativesSet[@mcdaConcept=&#39;badChoice&#39;]&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#add8e6&quot;&gt;{</span>
<span class="sd">           &lt;xsl:for-each select=&quot;element&quot;&gt;</span>
<span class="sd">             &lt;xsl:value-of select=&quot;./alternativeID&quot;/&gt;,</span>
<span class="sd">           &lt;/xsl:for-each&gt;}</span>
<span class="sd">           &lt;/th&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;determinateness&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranked&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranking&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	  &lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">&lt;/xsl:stylesheet&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="n">robustRubisXSL</span> <span class="o">=</span>\
<span class="sd">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="sd">&lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; </span>
<span class="sd">                       xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot;&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- </span>
<span class="sd">XMCDA 2.0 Rubis XSLT tranformation to HTML, RB 2009</span>
<span class="sd">$Revision: 1.5 $</span>
<span class="sd">The ressource comes with ABSOLUTELY NO WARRANTY </span>
<span class="sd">to the extent permitted by the applicable law.</span>
<span class="sd">This is free software, and you are welcome to </span>
<span class="sd">redistribute it if it remains free software. </span>
<span class="sd">Copyright (C) 2009 DECISION DECK Consortium</span>
<span class="sd">--&gt;</span>


<span class="sd"> &lt;!-- Main start of the transform --&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;/&quot; &gt;</span>
<span class="sd"> &lt;html&gt;</span>
<span class="sd">  &lt;head&gt;&lt;title&gt;Decision-Deck UMCDA-ML application&lt;/title&gt;&lt;/head&gt;</span>
<span class="sd">  &lt;body&gt;</span>
<span class="sd">    &lt;h1&gt;&lt;font color=&quot;#0000bb&quot;&gt;Decision-Deck UMCDA-ML Application&lt;/font&gt;&lt;/h1&gt;</span>

<span class="sd">    &lt;xsl:apply-templates  select=&quot;xmcda:XMCDA&quot; /&gt;</span>
<span class="sd">    &lt;br/&gt;</span>
<span class="sd">    &lt;h2&gt;Content&lt;/h2&gt;</span>
<span class="sd">    &lt;ul&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#choice&quot;&gt;Choice Recommendation&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#graph&quot;&gt;Robustly significant outranking digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#alternatives&quot;&gt;Potential decision actions&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#performance&quot;&gt;Performance table&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#objectives&quot;&gt;Decision objectives&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#criteria&quot;&gt;Family of criteria&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#outranking&quot;&gt;Condorcet robustness denotation&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#vetos&quot;&gt;Veto situations&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#notice&quot;&gt;Notice&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">    &lt;/ul&gt;</span>
<span class="sd">    &lt;hr /&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;a name=&quot;notice&quot;&gt;&lt;font color=&quot;#bb0000&quot;&gt;Notice&lt;/font&gt;&lt;/a&gt;&lt;/h2&gt;</span>
<span class="sd">    &lt;p&gt;Bisdorff R., Meyer P., Roubens M., &lt;b&gt;Rubis&lt;/b&gt;: A new methodology for the choice decision problem. 4OR, </span>
<span class="sd">      &lt;em&gt;A Quarterly Journal of Operational Research&lt;/em&gt;, Springer (2008), Vol 6 Number 2 pp. 143-165, DOI 10.1007/s10288-007-0045-5.</span>
<span class="sd">    &lt;a href=&quot;http://sma.uni.lu/bisdorff/documents/HyperKernels.pdf&quot;&gt;PDF preprint version&lt;/a&gt;.&lt;/p&gt;</span>
<span class="sd">   &lt;p&gt;Online documentation: &lt;a href=&quot;https://www.decision-deck.org/project/&quot;&gt;Decision Deck Project&lt;/a&gt;&lt;br/&gt;</span>
<span class="sd">     &lt;b&gt;Rubis XSL Transformation to HTML&lt;/b&gt; R. Bisdorff, $Revision: 1.5 $&lt;br/&gt;</span>
<span class="sd">          &lt;a href=&quot;http://www.decision-deck.org/xmcda&quot;&gt;XMCDA 2.0 Schema&lt;/a&gt; P. Meyer and Th. Veneziano 2009 &lt;br/&gt;</span>
<span class="sd">           Copyright Â© 2009 DECISION DECK Consortium&lt;/p&gt;</span>
<span class="sd">   &lt;/body&gt;</span>
<span class="sd">  &lt;/html&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>

<span class="sd"> &lt;!--  generic description layout: must fit all element description !!! --&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;projectReference&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates /&gt;</span>
<span class="sd">    &lt;h3&gt;Content&lt;/h3&gt;</span>
<span class="sd">    &lt;ul&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#choice&quot;&gt;Choice Recommendation&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#graph&quot;&gt;Robustly significant outranking digraph&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#alternatives&quot;&gt;Potential decision actions&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#performance&quot;&gt;Performance table&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#objectives&quot;&gt;Decision objectives&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#criteria&quot;&gt;Family of criteria&lt;/a&gt;&lt;/li&gt;</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#outranking&quot;&gt;Condorcet robustness denotation&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#vetos&quot;&gt;Veto situations&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">      &lt;li&gt;&lt;a href=&quot;#notice&quot;&gt;Notice&lt;/a&gt;&lt;/li&gt;	</span>
<span class="sd">    &lt;/ul&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">     &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;description&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;.&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;title&quot;&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;font color=&quot;#bb0000&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h2&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;subTitle&quot;&gt;</span>
<span class="sd">    &lt;h3&gt;&lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/font&gt;&lt;/h3&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;id&quot;&gt;</span>
<span class="sd">    Identifier: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;approach&quot;&gt;</span>
<span class="sd">    Approach: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;methodology&quot;&gt;</span>
<span class="sd">    Methodology: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;problematique&quot;&gt;</span>
<span class="sd">    Problematique: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;shortName&quot;&gt;</span>
<span class="sd">    Short name: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;name&quot;&gt;</span>
<span class="sd">    Name: &lt;font color=&quot;#0000bb&quot;&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/font&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;comment&quot;&gt;</span>
<span class="sd">    Comment: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;author&quot;&gt;</span>
<span class="sd">    Author: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;user&quot;&gt;</span>
<span class="sd">    User: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;type&quot;&gt;</span>
<span class="sd"> &lt;!--    &lt;tr&gt;&lt;th align=&quot;left&quot;&gt;Type: &lt;/th&gt;&lt;td&gt;&lt;xsl:apply-templates/&gt;&lt;/td&gt;&lt;/tr&gt; --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;version&quot;&gt;</span>
<span class="sd">    Version: &lt;xsl:apply-templates/&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;abstract&quot;&gt;</span>
<span class="sd">    Abstract: &lt;em&gt;&lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;/em&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;keywords&quot;&gt;</span>
<span class="sd">    Key Words: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;bibliography&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;0&quot;&gt;</span>
<span class="sd">      &lt;xsl:for-each select=&quot;bibEntry&quot;&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:value-of select=&quot;text()&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;dateTime&quot;&gt;</span>
<span class="sd">    Date: &lt;xsl:value-of select=&quot;text()&quot; /&gt;&lt;br/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>

<span class="sd">&lt;!--  Method Options  --&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;methodParameters&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;parameters&quot;&gt;</span>
<span class="sd">    &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Parameter&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Value&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Comment&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates/&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[value]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;value&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/constant]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;parameter[function/linear]&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;function/linear/intercept&quot;/&gt;+&lt;xsl:value-of select=&quot;function/linear/slope&quot;/&gt;x&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;errorMessage&quot;&gt;</span>
<span class="sd"> &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Number&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Name&lt;/th&gt;&lt;th bgcolor=&quot;#9acd32&quot;&gt;Text&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;number&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;&lt;td&gt;&lt;xsl:value-of select=&quot;text&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- List of potential alternatives --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;alternatives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;alternatives&quot;/&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;alternative&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;!-- relation on Alternatives --&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisons[@mcdaConcept=&#39;CondorcetRobustness&#39;]&quot;&gt;</span>
<span class="sd">    &lt;h2&gt;&lt;a name=&quot;graph&quot;&gt;&lt;font color=&quot;#bb0000&quot;&gt;Robustly Concordant Outranking Graph&lt;/font&gt;&lt;/a&gt;&lt;/h2&gt;</span>
<span class="sd">    &lt;p&gt;(&lt;i&gt;&lt;b&gt; Black arrows&lt;/b&gt; indicate outranking situations supported by a criteria coalition </span>
<span class="sd">      of positive significance, i.e. gathering more than 50&amp;#37; of the global criteria significance weights.</span>
<span class="sd">      &lt;b&gt;Empty arrow heads&lt;/b&gt; indicate an indeterminate outranking situation.&lt;/i&gt;)&lt;/p&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;tiret&quot; select=&quot; &#39;-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;dot&quot; select=&quot; &#39;.&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;name&quot; select =&quot;/xmcda:XMCDA/@instanceID&quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;path&quot; select=&quot; &#39;rubisGraph-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionPNG&quot; select=&quot; &#39;.png&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionPDF&quot; select=&quot; &#39;.pdf&#39; &quot; /&gt;</span>
<span class="sd">    &lt;div style=&quot;text-align: left;&quot;&gt;	</span>
<span class="sd">      &lt;p&gt;&lt;a href=&quot;{concat($path,$name,$extensionPDF)}&quot; &gt;</span>
<span class="sd">      See PDF graphic file for better image quality and zooming options&lt;/a&gt;</span>
<span class="sd">        (generated with GraphViz).&lt;/p&gt; </span>
<span class="sd">      &lt;img src=&quot;{concat($path,$name,$extensionPNG)}&quot;  /&gt;   </span>
<span class="sd">    &lt;/div&gt; </span>
<span class="sd">    </span>
<span class="sd">    &lt;a name=&quot;outranking&quot;/&gt;</span>
<span class="sd">    &lt;xsl:choose&gt;</span>
<span class="sd">      &lt;xsl:when test=&quot;valuation/valuationType=&#39;bipolar&#39;&quot;&gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;bipolar&quot;/&gt;</span>
<span class="sd">      &lt;/xsl:when&gt;</span>
<span class="sd">      &lt;xsl:otherwise&gt;</span>
<span class="sd">        &lt;xsl:apply-templates/&gt;</span>
<span class="sd">      &lt;/xsl:otherwise&gt;</span>
<span class="sd">    &lt;/xsl:choose&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;criteriaComparisons[@mcdaConcept=&#39;correlationTable&#39;]&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;correlation&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates mode=&quot;simil&quot;/&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;tiret&quot; select=&quot; &#39;-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;dot&quot; select=&quot; &#39;.&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;name&quot; select =&quot;/xmcda:XMCDA/@instanceID&quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;path&quot; select=&quot; &#39;similarityPlot-&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionPDF&quot; select=&quot; &#39;.pdf&#39; &quot; /&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;extensionJPG&quot; select=&quot; &#39;.jpg&#39; &quot; /&gt;</span>
<span class="sd">    &lt;h3&gt;&lt;font color=&quot;#bb0000&quot;&gt;Principal component analysis of the criteria correlation index&lt;/font&gt;&lt;/h3&gt;</span>
<span class="sd">    &lt;div style=&quot;text-align: left;&quot;&gt;	</span>
<span class="sd">      &lt;p&gt;&lt;a href=&quot;{concat($path,$name,$extensionPDF)}&quot; &gt;</span>
<span class="sd">      See PDF graphic file for better image quality and zooming options&lt;/a&gt;</span>
<span class="sd">        (generated with R).&lt;/p&gt;</span>
<span class="sd">      &lt;img src=&quot;{concat($path,$name,$extensionJPG)}&quot;  /&gt;</span>
<span class="sd">    &lt;/div&gt; </span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesComparisons[@mcdaConcept=&#39;Vetoes&#39;]&quot; &gt;</span>
<span class="sd">         &lt;a name=&quot;vetos&quot; /&gt;</span>
<span class="sd">        &lt;xsl:apply-templates mode=&quot;veto&quot;/&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Unanimously concordant&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#78ff78&quot;&gt; &lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Ordinal majority concordant&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#bdffbd&quot;&gt; 2&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Cardinal majority concordant&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#e6ffe6&quot;&gt; 1&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Balanced concordance and discordance, or weak veto&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#ffffff&quot; &gt; 0&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Simple majority discordant&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#fff0ff&quot; &gt;-1&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Ordinal majority discordant&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#ffd4ff&quot; &gt;-2&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">      &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Unanimously discordant, or veto&lt;/td&gt; &lt;td align=&quot;right&quot; bgcolor=&quot;#ffadff&quot; &gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;!--&lt;xsl:template match=&quot;valuation&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;median&quot; select=&quot;quantitative/minimum + (quantitative/maximum - quantitative/minimum) div 2&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;format-number(quantitative/maximum,&#39;#.##&#39;)&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Median&lt;/td&gt;&lt;td bgcolor=&quot;#dddddd&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;format-number($median,&#39;#.##&#39;)&quot; /&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;format-number(quantitative/minimum,&#39;#.##&#39;)&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">       &lt;/table&gt;</span>
<span class="sd">    </span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   --&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;valuation&quot;&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">        &lt;table cellpadding=&quot;1&quot; border=&quot;1&quot;&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Minimum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/minimum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">         &lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;Maximum&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;xsl:value-of select=&quot;quantitative/maximum&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">        &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd"> &lt;xsl:template match=&quot;comparisonType&quot;&gt;</span>
<span class="sd">    &lt;!-- nothing --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;comparisonType&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;!-- nothing --&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;veto&quot;&gt;</span>
<span class="sd">       &lt;xsl:variable name=&quot;Veto&quot; select=&#39;.&#39; /&gt;</span>
<span class="sd">       &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;p&gt;(The &lt;b&gt;concordance degree&lt;/b&gt; of an outranking statement (an arc) results from the </span>
<span class="sd">      difference between the significance (the sum of weights) of the coalition of criteria </span>
<span class="sd">      in favour and the significance of the coalition of criteria in disfavour of this statement.)&lt;/p&gt;</span>
<span class="sd">       &lt;ol&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$Veto/pair&quot;&gt;</span>
<span class="sd">           &lt;li&gt;Veto against &lt;b&gt;&lt;xsl:value-of select=&quot;initial/alternativeID&quot;/&gt; outranks</span>
<span class="sd">            &lt;xsl:value-of select=&quot;terminal/alternativeID&quot;/&gt; &lt;/b&gt; (</span>
<span class="sd">          &lt;xsl:value-of select=&quot;description/comment&quot;/&gt;)</span>
<span class="sd">           &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">             &lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criterion&lt;/th&gt;&lt;th&gt;performance difference&lt;/th&gt;&lt;th&gt;status&lt;/th&gt;&lt;th&gt;characteristic&lt;/th&gt;&lt;/tr&gt;</span>
<span class="sd">             &lt;xsl:for-each select=&quot;values&quot;&gt;</span>
<span class="sd">               &lt;tr&gt;</span>
<span class="sd">                 &lt;th bgcolor=&quot;#FFF79B&quot; align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;performanceDifference&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">                 &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;value[@name=&#39;vetoCharacteristic&#39;]/real&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">               &lt;/tr&gt;</span>
<span class="sd">             &lt;/xsl:for-each&gt;</span>
<span class="sd">             &lt;/table&gt;&lt;br/&gt;</span>
<span class="sd">           &lt;/li&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">         &lt;/ol&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">   </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>

<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;relation&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">                   &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">        &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">         &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">          &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">            &lt;xsl:call-template name=&quot;currentValue&quot; &gt;</span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">              &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">             &lt;/xsl:call-template&gt;</span>
<span class="sd">           &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;bipolar&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;&lt;xsl:value-of select=&quot;parent::node()/description/name&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives[@mcdaConcept=&#39;alternatives&#39;]/alternative&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">        &lt;xsl:variable name=&quot;Min&quot; select=&quot;parent::node()/valuation/quantitative/minimum&quot;/&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;Max&quot; select=&quot;parent::node()/valuation/quantitative/maximum&quot;/&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;Med&quot; select=&quot;$Min + ($Max - $Min) div 2&quot;/&gt;</span>

<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives[@mcdaConcept=&#39;alternatives&#39;]/alternative&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives[@mcdaConcept=&#39;alternatives&#39;]/alternative&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">            &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/alternativeID=$currentRow]&quot;&gt;</span>
<span class="sd">              &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">              &lt;xsl:call-template name=&quot;currentBipolarValue&quot; &gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">                  &lt;xsl:with-param name=&quot;Med&quot; select=&quot;$Med&quot; /&gt; </span>
<span class="sd">              &lt;/xsl:call-template&gt;</span>
<span class="sd">            &lt;/xsl:for-each&gt;</span>
<span class="sd">          &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;pairs&quot; mode=&quot;simil&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentArcs&quot; select=&quot;.&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates select=&quot;description&quot;/&gt;</span>
<span class="sd">    </span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;relation&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentRow&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;$currentRow&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;xsl:for-each select=&quot;/xmcda:XMCDA/criteria/criterion&quot;&gt;</span>
<span class="sd">            &lt;xsl:variable name=&quot;currentColumn&quot; select=&#39;@id&#39; /&gt;</span>
<span class="sd">            &lt;xsl:for-each select=&quot;$currentArcs/pair[initial/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">              &lt;xsl:variable name=&quot;currentArc&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">              &lt;xsl:call-template name=&quot;currentSimilValue&quot; &gt;</span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentRow&quot; select=&quot;$currentRow&quot; /&gt;   </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentColumn&quot; select=&quot;$currentColumn&quot;/&gt;                  </span>
<span class="sd">                &lt;xsl:with-param name=&quot;currentArc&quot; select=&quot;$currentArc&quot; /&gt;</span>
<span class="sd">              &lt;/xsl:call-template&gt;</span>
<span class="sd">            &lt;/xsl:for-each&gt;</span>
<span class="sd">          &lt;/xsl:for-each&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc/initial/alternativeID=$currentRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc/terminal/alternativeID=$currentColumn&quot;&gt;</span>
<span class="sd">        &lt;td align=&quot;right&quot; &gt;&lt;xsl:value-of select=&quot;./value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentBipolarValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;Med&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc/initial/alternativeID=$currentRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc/terminal/alternativeID=$currentColumn&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/values/value[@name=&#39;outranking&#39;]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcRobustness&quot; select=&quot;$currentArc/values/value[@name=&#39;robustness&#39;]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcRobustness = 3&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#78ff78&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">            &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">         &lt;xsl:when test=&quot;$arcRobustness = 2&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#bdffbd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">           &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">         &lt;/xsl:when&gt;</span>
<span class="sd">         &lt;xsl:when test=&quot;$arcRobustness = 1&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#e6ffe6&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">           &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">         &lt;/xsl:when&gt;</span>
<span class="sd">         &lt;xsl:when test=&quot;$arcRobustness = -3&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffadff&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">           &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">         &lt;/xsl:when&gt;</span>
<span class="sd">         &lt;xsl:when test=&quot;$arcRobustness = -2&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffd4ff&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">           &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">         &lt;/xsl:when&gt;</span>
<span class="sd">         &lt;xsl:when test=&quot;$arcRobustness = -1&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#fff0ff&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">           &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">         &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffffff&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;!--&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;)&lt;/td&gt;--&gt;</span>
<span class="sd">            &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt; (&lt;xsl:value-of select=&quot;$arcRobustness&quot;/&gt;)&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!--  &lt;xsl:template name=&quot;currentBipolarValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;Med&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc/initial/alternativeID=$currentRow&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc/terminal/alternativeID=$currentColumn&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; $Med&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">--&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;currentSimilValue&quot; match=&quot;pair&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentRow&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentColumn&quot;/&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentArc&quot;/&gt;</span>
<span class="sd">    &lt;xsl:if test=&quot;$currentArc[initial/criterionID=$currentRow]&quot;&gt;</span>
<span class="sd">      &lt;xsl:if test=&quot;$currentArc[terminal/criterionID=$currentColumn]&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;arcValue&quot; select=&quot;$currentArc/value&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:choose&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;gt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:when test=&quot;$arcValue &amp;lt; 0.0&quot;&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:when&gt;</span>
<span class="sd">          &lt;xsl:otherwise&gt;</span>
<span class="sd">            &lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span>
<span class="sd">              &lt;xsl:value-of select=&quot;$arcValue&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;/xsl:otherwise&gt;</span>
<span class="sd">        &lt;/xsl:choose&gt;</span>
<span class="sd">      &lt;/xsl:if&gt;</span>
<span class="sd">    &lt;/xsl:if&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>

<span class="sd">&lt;!-- presentation of the objectives--&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;objectives&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;objectives&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Criteria list&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;objective&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;objectiveCriteria&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">       &lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd"> &lt;!-- presentation of the coalitions --&gt;</span>
<span class="sd">  &lt;xsl:template match=&quot;criteriaSets&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;coalitions&quot;/&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Criteria&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;1&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:for-each select=&quot;criteriaSet&quot;&gt;</span>
<span class="sd">        &lt;tr&gt;</span>
<span class="sd">          &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">          &lt;td&gt;{</span>
<span class="sd">            &lt;xsl:for-each select=&quot;element&quot;&gt;&lt;xsl:value-of select=&quot;criterionID&quot;/&gt;, &lt;/xsl:for-each&gt;</span>
<span class="sd">            }&lt;/td&gt;</span>
<span class="sd">          &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">        &lt;/tr&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">&lt;!-- presentation of the criteria --&gt; </span>
<span class="sd">&lt;xsl:template match=&quot;criteria&quot;&gt;</span>
<span class="sd">  &lt;a name=&quot;criteria&quot;/&gt;</span>
<span class="sd">  &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Name&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Comment&lt;/th&gt;</span>
<span class="sd">        &lt;th rowspan=&quot;2&quot;&gt;Weight&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;3&quot;&gt;Scale&lt;/th&gt;</span>
<span class="sd">	&lt;th colspan=&quot;5&quot;&gt;Thresholds&lt;/th&gt;</span>
<span class="sd">     &lt;/tr&gt;</span>
<span class="sd">     &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">       &lt;th&gt;direction&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;min&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;max&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;indifference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;preference&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;weak veto&lt;/th&gt;</span>
<span class="sd">       &lt;th&gt;veto&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;criterion&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;@name&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;        </span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;criterionValue/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	   &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/preferenceDirection&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/minimum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;scale/quantitative/maximum/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;ind&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakPreference&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;pref&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;weakVeto&#39;]/.&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:apply-templates select=&quot;thresholds/threshold[@id=&#39;veto&#39;]/.&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="sd">     &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">   </span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;function/constant&quot;&gt;</span>
<span class="sd">  &lt;!--&lt;xsl:if test=&quot;descendant::*name()= &#39;linear&#39;&quot;&gt;integer&lt;xsl:value-of select=&quot;.&quot;/&gt;&lt;/xsl:if&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">  &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;constant&quot;&gt;</span>
<span class="sd">  &lt;!--&lt;xsl:if test=&quot;descendant::*name()= &#39;linear&#39;&quot;&gt;integer&lt;xsl:value-of select=&quot;.&quot;/&gt;&lt;/xsl:if&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;.&quot;/&gt; --&gt;</span>
<span class="sd">  &lt;xsl:apply-templates/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;value/integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;integer&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;#&#39;)&quot; /&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;value[real]&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;0.00&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;real&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;format-number(.,&#39;0.00&#39;)&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;xsl:template match=&quot;value/rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;rational&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;//numerator&quot; /&gt; &lt;xsl.text&gt;/&lt;/xsl.text&gt;&lt;xsl:value-of select=&quot;//denominator&quot;/&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>


<span class="sd">&lt;xsl:template match=&quot;function[linear]&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;intercept/.&quot;/&gt; + &lt;xsl:value-of select=&quot;slope/.&quot;/&gt;x</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;linear&quot;&gt;</span>
<span class="sd">  &lt;xsl:value-of select=&quot;intercept/.&quot;/&gt; + &lt;xsl:value-of select=&quot;slope/.&quot;/&gt;x</span>
<span class="sd">&lt;/xsl:template&gt;</span>



<span class="sd">  &lt;!-- Controlling the presentation criteria X alternatives of the performance table --&gt;</span>
<span class="sd">  &lt;xsl:key name=&quot;currentCriterion&quot; match=&quot;/xmcda:XMCDA/criteria/criterion&quot; use=&#39;.&#39;  /&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:variable name=&quot;allCriteria&quot; </span>
<span class="sd">    select=&quot;/xmcda:XMCDA/criteria/criterion[</span>
<span class="sd">    generate-id() = </span>
<span class="sd">    generate-id(key(&#39;currentCriterion&#39;,.)[1] </span>
<span class="sd">    )</span>
<span class="sd">    ]&quot; /&gt;  </span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;performanceTable&quot;&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;root&quot; select=&quot;/xmcda:XMCDA/criteria&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentTable&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;alternative&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;$root/criterion&quot;&gt;</span>
<span class="sd">          &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates select=&quot;$currentTable/alternativePerformances&quot;/&gt; </span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativePerformances&quot;&gt;</span>
<span class="sd">    &lt;tr&gt;</span>
<span class="sd">      &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;alternativeID&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentAlternative&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">      </span>
<span class="sd">      &lt;xsl:for-each select=&quot;key(&#39;currentCriterion&#39;, $allCriteria)&quot;&gt;</span>
<span class="sd">        &lt;xsl:variable name=&quot;currentCriterion&quot; select=&quot;./@id&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">        &lt;xsl:call-template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">          &lt;xsl:with-param name=&quot;currentAlternative&quot; select=&quot;$currentAlternative&quot;&gt;</span>
<span class="sd">          &lt;/xsl:with-param&gt;</span>
<span class="sd">          &lt;xsl:with-param name=&quot;currentCriterion&quot; select=&quot;$currentCriterion&quot;&gt;&lt;/xsl:with-param&gt;</span>
<span class="sd">        &lt;/xsl:call-template&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">    &lt;/tr&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:template name=&quot;performanceRow&quot;&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentAlternative&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">    &lt;xsl:param name=&quot;currentCriterion&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentPerformance&quot; select=&quot;$currentAlternative/performance[criterionID=$currentCriterion]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;td align=&quot;right&quot;&gt;&lt;xsl:apply-templates select=&quot;$currentPerformance/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">  &lt;/xsl:template&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:key name=&quot;currentAlternative&quot; match=&quot;/xmcda:XMCDA/alternatives/alternative&quot; use=&#39;.&#39;  /&gt;</span>
<span class="sd">  </span>
<span class="sd">  &lt;xsl:variable name=&quot;allAlternatives&quot; </span>
<span class="sd">    select=&quot;/xmcda:XMCDA/alternatives/alternative[</span>
<span class="sd">    generate-id() = </span>
<span class="sd">    generate-id(key(&#39;currentAlternative&#39;,.)[1] </span>
<span class="sd">    )</span>
<span class="sd">    ]&quot; /&gt;  </span>
<span class="sd">  </span>
<span class="sd">  </span>
<span class="sd">&lt;xsl:template match=&quot;performanceTable&quot; mode=&quot;criterionEvaluations&quot; &gt;</span>
<span class="sd">  &lt;a name=&quot;performance&quot; /&gt;</span>
<span class="sd">   &lt;xsl:variable name=&quot;currentTable&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">    &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;criterion&lt;/th&gt;</span>
<span class="sd">        &lt;xsl:for-each select=&quot;/xmcda:XMCDA/alternatives/alternative&quot;&gt;</span>
<span class="sd">	  &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;@id&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">        &lt;/xsl:for-each&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">      &lt;xsl:apply-templates select=&quot;$currentTable/criterionEvaluations&quot;/&gt; </span>
<span class="sd">    &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template match=&quot;criterionEvaluations&quot;&gt;</span>
<span class="sd">  &lt;tr&gt;</span>
<span class="sd">    &lt;th bgcolor=&quot;#FFF79B&quot;&gt;&lt;xsl:value-of select=&quot;criterionID&quot;/&gt;&lt;/th&gt;</span>
<span class="sd">    &lt;xsl:variable name=&quot;currentCriterion&quot; select=&quot;.&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">    &lt;xsl:for-each select=&quot;key(&#39;currentAlternative&#39;, $allAlternatives)&quot;&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentAlternative&quot; select=&quot;./@id&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">       &lt;xsl:call-template name=&quot;performanceRowCritEval&quot;&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentCriterion&quot; select=&quot;$currentCriterion&quot;&gt;</span>
<span class="sd">         &lt;/xsl:with-param&gt;</span>
<span class="sd">         &lt;xsl:with-param name=&quot;currentAlternative&quot; select=&quot;$currentAlternative&quot;&gt;&lt;/xsl:with-param&gt;</span>
<span class="sd">       &lt;/xsl:call-template&gt;</span>
<span class="sd">      &lt;/xsl:for-each&gt;</span>
<span class="sd">  &lt;/tr&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">&lt;xsl:template name=&quot;performanceRowCritEval&quot;&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentCriterion&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:param name=&quot;currentAlternative&quot;&gt;&lt;/xsl:param&gt;</span>
<span class="sd">      &lt;xsl:variable name=&quot;currentPerformance&quot; select=&quot;$currentCriterion/evaluation[alternativeID=$currentAlternative]&quot;&gt;&lt;/xsl:variable&gt;</span>
<span class="sd">     &lt;td align=&quot;right&quot;&gt;&lt;xsl:apply-templates select=&quot;$currentPerformance/value&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>


<span class="sd">  &lt;xsl:template match=&quot;XMCDA/alternatives/description&quot;&gt;</span>
<span class="sd">  &lt;!-- no comments --&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>

<span class="sd">  &lt;!-- Presenting Choice Recommendation --&gt;</span>
<span class="sd">&lt;xsl:template match=&quot;alternativesSets[@mcdaConcept=&#39;goodChoices&#39;]&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;choice&quot;&gt;&lt;/a&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Choice set&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Determinateness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankingness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankedness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">   &lt;xsl:for-each select=&quot;alternativesSet[@mcdaConcept=&#39;goodChoice&#39;]&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#FFF79B&quot;&gt;{</span>
<span class="sd">           &lt;xsl:for-each select=&quot;element&quot;&gt;</span>
<span class="sd">             &lt;xsl:value-of select=&quot;./alternativeID&quot;/&gt;,</span>
<span class="sd">           &lt;/xsl:for-each&gt;}</span>
<span class="sd">           &lt;/th&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;determinateness&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranking&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranked&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	&lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">  &lt;xsl:template match=&quot;alternativesSets[@mcdaConcept=&#39;badChoices&#39;]&quot;&gt;</span>
<span class="sd">    &lt;a name=&quot;choice&quot;&gt;&lt;/a&gt;</span>
<span class="sd">   &lt;xsl:apply-templates  select=&quot;description&quot;/&gt;</span>
<span class="sd">   &lt;table border=&quot;1&quot;&gt;</span>
<span class="sd">      &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="sd">        &lt;th&gt;#&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Choice set&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Determinateness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankedness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Outrankingness&lt;/th&gt;</span>
<span class="sd">        &lt;th&gt;Comment&lt;/th&gt;</span>
<span class="sd">      &lt;/tr&gt;</span>
<span class="sd">     &lt;xsl:for-each select=&quot;alternativesSet[@mcdaConcept=&#39;badChoice&#39;]&quot;&gt;</span>
<span class="sd">       &lt;tr&gt;&lt;td&gt;&lt;xsl:number format=&quot;1&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">         &lt;th bgcolor=&quot;#add8e6&quot;&gt;{</span>
<span class="sd">           &lt;xsl:for-each select=&quot;element&quot;&gt;</span>
<span class="sd">             &lt;xsl:value-of select=&quot;./alternativeID&quot;/&gt;,</span>
<span class="sd">           &lt;/xsl:for-each&gt;}</span>
<span class="sd">           &lt;/th&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;determinateness&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranked&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td align=&quot;center&quot;&gt;&lt;xsl:value-of select=&quot;values/value[@name=&#39;outranking&#39;]&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">           &lt;td&gt;&lt;xsl:value-of select=&quot;description/comment&quot;/&gt;&lt;/td&gt;</span>
<span class="sd">	  &lt;/tr&gt;</span>
<span class="sd">   &lt;/xsl:for-each&gt;</span>
<span class="sd">   &lt;/table&gt;</span>
<span class="sd">&lt;/xsl:template&gt;</span>
<span class="sd"> </span>
<span class="sd">&lt;/xsl:stylesheet&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="saveRubisXSL">
<a class="viewcode-back" href="../techDoc.html#xmcda.saveRubisXSL">[docs]</a>
<span class="k">def</span> <span class="nf">saveRubisXSL</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;xmcda2Rubis.xsl&#39;</span><span class="p">,</span><span class="n">Extended</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the standard Rubis XMCDA 2.0 XSL style sheet in the current working directory.</span>
<span class="sd">    This style sheet allows to visualize an XMCDA 2.0 encoded performance tableau in a browser.</span>

<span class="sd">    .. note::</span>

<span class="sd">        When accessing an XMCDA encoded data file in a browser, for safety reasons, the corresponding XSL style sheet</span>
<span class="sd">        must be present in the same working directory.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">xmcda</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Extended</span><span class="p">:</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xmcda</span><span class="o">.</span><span class="n">rubisExtXSL</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xmcda</span><span class="o">.</span><span class="n">rubisXSL</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="saveRubisChoiceXSL">
<a class="viewcode-back" href="../techDoc.html#xmcda.saveRubisChoiceXSL">[docs]</a>
<span class="k">def</span> <span class="nf">saveRubisChoiceXSL</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;xmcda2RubisChoice.xsl&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the local Rubis Best-Choice XMCDA 2.0 XSL style sheet in the current working directory</span>
<span class="sd">    This style sheet allows to browse an XMCDA 2.0 encoded Rubis Best-Choice recommendation.</span>

<span class="sd">    .. note::</span>

<span class="sd">        When accessing an XMCDA encoded data file in a browser, for safety reasons, the corresponding XSL style sheet</span>
<span class="sd">        must be present in the same working directory.</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">xmcda</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xmcda</span><span class="o">.</span><span class="n">rubisChoiceXSL</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="saveRobustRubisChoiceXSL">
<a class="viewcode-back" href="../techDoc.html#xmcda.saveRobustRubisChoiceXSL">[docs]</a>
<span class="k">def</span> <span class="nf">saveRobustRubisChoiceXSL</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;xmcda2RubisRobustChoice.xsl&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save the robust version of the Rubis Best-Choice XMCDA 2.0 XSL style sheet in the current working directory</span>
<span class="sd">    This style sheet allows to browse an XMCDA 2.0 encoded robust Rubis Best-Choice recommendation.</span>

<span class="sd">    .. note::</span>

<span class="sd">        When accessing an XMCDA encoded data file in a browser, for safety reasons, the corresponding XSL style sheet</span>
<span class="sd">        must be present in the same working directory.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">xmcda</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xmcda</span><span class="o">.</span><span class="n">robustRubisXSL</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="saveXMCDARubisBestChoiceRecommendation">
<a class="viewcode-back" href="../techDoc.html#xmcda.saveXMCDARubisBestChoiceRecommendation">[docs]</a>
<span class="k">def</span> <span class="nf">saveXMCDARubisBestChoiceRecommendation</span><span class="p">(</span><span class="n">problemFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">tempDir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">valuationType</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Store an XMCDA2 encoded solution file of the Rubis best-choice recommendation.</span>

<span class="sd">      The valuationType parameter allows to work:</span>
<span class="sd">    </span>
<span class="sd">        - on the standard bipolar outranking digraph (valuationType = &#39;bipolar&#39;, default),</span>
<span class="sd">        - on the normalized --[-1,1] valued-- bipolar outranking digraph (valuationType = &#39;normalized&#39;),</span>
<span class="sd">        - on the robust --ordinal criteria weights-- bipolar outranking digraph (valuationType = &#39;robust&#39;),</span>
<span class="sd">        - on the confident outranking digraph (valuationType = &#39;confident&#39;),</span>
<span class="sd">        - ignoring considerable performances differences (valuationType = &#39;noVeto&#39;).  </span>

<span class="sd">    .. note::</span>

<span class="sd">         The method requires an Unix like OS like Ubuntu or Mac OSX and depends on:</span>

<span class="sd">              - the R statistics package for Principal Component Analysis graphic,</span>
<span class="sd">              - the C calmat matrix interpreter (see Digraph3/calmat/README)</span>
<span class="sd">              - the xpdf ressources ( ...$ apt-get install xpdf on Ubuntu) for converting pdf files to ppm format, and ppm files to png format.  </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementTree</span>
    <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">xmcda</span>
    <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">,</span>\
         <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">,</span> <span class="n">RobustOutrankingDigraph</span>
    
    
    <span class="k">def</span> <span class="nf">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span><span class="n">Number</span><span class="p">,</span><span class="n">Name</span><span class="p">,</span><span class="n">Message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        XMCDA 2.0 Error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print(tempDir,problemFileName,Number,Name,Message)</span>
        <span class="n">solutionFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/solution-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.xmcda2&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">solutionFileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&lt;xmcda:XMCDA xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.decision-deck.org/2008/XMCDA-2.0.0 file:../XMCDA-2.0.0.xsd&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot;&gt;&#39;</span><span class="p">))</span>
        <span class="c1"># write error message</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;methodMessages&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;title&gt;XMCDA 2.0 Error Messages&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;errorMessage name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;number&gt;</span><span class="si">%d</span><span class="s1">&lt;/number&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Number</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;text&gt;</span><span class="si">%s</span><span class="s1">&lt;/text&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Message</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/errorMessage&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/methodMessages&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/xmcda:XMCDA&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Number</span>
        <span class="c1">#exit(Number)</span>


    <span class="k">if</span> <span class="n">problemFileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Input error&#39;</span><span class="p">,</span> <span class="s1">&#39;No data file name given !&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1">#########   main #################</span>
    <span class="c1"># get XML file type and load problem data</span>
    <span class="k">try</span><span class="p">:</span>
            <span class="n">problemFileNameExt</span> <span class="o">=</span> <span class="n">problemFileName</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">problemFileNameExt</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="n">rootTag</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span> 
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                    <span class="n">problemFileNameExt</span> <span class="o">=</span> <span class="n">problemFileName</span><span class="o">+</span><span class="s1">&#39;.xmcda2&#39;</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">problemFileNameExt</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                    <span class="n">rootTag</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                    <span class="n">problemFileNameExt</span> <span class="o">=</span> <span class="n">problemFileName</span><span class="o">+</span><span class="s1">&#39;.xmcda&#39;</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">problemFileNameExt</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                    <span class="n">rootTag</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">tag</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">##    try:</span>
<span class="c1">##        t = XMCDA2PerformanceTableau(problemFileName)</span>
<span class="c1">##        </span>
<span class="c1">##    except:</span>
<span class="c1">##        errorExit(tempDir,problemFileName, 1, &#39;UMCDA-ML XMCDA 2.0 input error&#39;, &#39;Error when reading XML input data file !&#39;)</span>
<span class="c1">##        return</span>
        


    <span class="k">if</span> <span class="n">rootTag</span> <span class="o">==</span> <span class="s1">&#39;RubisPerformanceTableau&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">XMLRubisPerformanceTableau</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Rubis XML input error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when reading XML input data file !&#39;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="n">rootTag</span> <span class="o">==</span> <span class="s1">&#39;{http://www.decision-deck.org/2009/XMCDA-2.0.0}XMCDA&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">XMCDA2PerformanceTableau</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;UMCDA-ML XMCDA 2.0 input error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when reading XML input data file !&#39;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="n">rootTag</span> <span class="o">==</span> <span class="s1">&#39;{http://www.decision-deck.org/2008/UMCDA-ML-1.0}XMCDA&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">XMCDAPerformanceTableau</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;UMCDA-ML XMCDA 1.0 input error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when reading XML input data file !&#39;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Input error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when reading input data file !&#39;</span><span class="p">)</span>
        <span class="k">return</span>

<span class="c1">##    t = XMCDA2PerformanceTableau(problemFileName)</span>
<span class="c1">##    print(rootTag,t)</span>
    

    <span class="c1"># contruct outranking digraph</span>
    <span class="n">isRobust</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1">#print(isRobust)</span>
    <span class="k">if</span> <span class="n">valuationType</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rootTag</span> <span class="o">!=</span> <span class="s1">&#39;rubisPerformanceTableau&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valuationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;integer&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarIntegerOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="c1">##                elif t.parameter[&#39;valuationType&#39;] == &#39;electre3&#39;:</span>
<span class="c1">##                    g = Electre3OutrankingDigraph(t)</span>
                <span class="k">elif</span> <span class="n">t</span><span class="o">.</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valuationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;normalized&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">t</span><span class="o">.</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valuationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bipolar&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">hasBipolarVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">t</span><span class="o">.</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valuationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;confident&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">hasBipolarVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">##                elif t.parameter[&#39;valuationType&#39;] == &#39;electreVeto&#39;:</span>
<span class="c1">##                    g = BipolarOutrankingDigraph(t,hasBipolarVeto=False)</span>
                <span class="k">elif</span> <span class="n">t</span><span class="o">.</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valuationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;noVeto&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">t</span><span class="o">.</span><span class="n">parameter</span><span class="p">[</span><span class="s1">&#39;valuationType&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;robust&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">RobustOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">isRobust</span> <span class="o">=</span> <span class="kc">True</span>			
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="c1">#print(g)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Corrupt problem data&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when computing outranking digraph !&#39;</span><span class="p">)</span>
            <span class="k">return</span>
    <span class="k">elif</span> <span class="n">valuationType</span> <span class="o">==</span> <span class="s1">&#39;robust&#39;</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">RobustOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">isRobust</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">valuationType</span> <span class="o">==</span> <span class="s1">&#39;confident&#39;</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">valuationType</span> <span class="o">==</span> <span class="s1">&#39;noVeto&#39;</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1">##    g = BipolarOutrankingDigraph(t)</span>
<span class="c1">##    print(g)</span>

    <span class="c1"># save Rubis solution file</span>
    <span class="n">g_orig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">solutionFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/solution-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">saveXMCDA2RubisChoiceRecommendation</span><span class="p">(</span>\
            <span class="n">fileName</span><span class="o">=</span><span class="n">solutionFileName</span><span class="p">,</span><span class="n">author</span><span class="o">=</span><span class="s1">&#39;XMCDA 2.0 Rubis Server&#39;</span><span class="p">,</span>\
            <span class="n">servingD3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">instanceID</span><span class="o">=</span><span class="n">problemFileName</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Rubis Solver error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when computing Rubis choice recommendation !&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">g_orig</span><span class="o">.</span><span class="n">goodChoices</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="nb">frozenset</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ch</span><span class="p">:</span>
                    <span class="n">g_orig</span><span class="o">.</span><span class="n">goodChoices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g_orig</span><span class="o">.</span><span class="n">goodChoices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="n">g_orig</span><span class="o">.</span><span class="n">badChoices</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">badChoices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="nb">frozenset</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ch</span><span class="p">:</span>
                    <span class="n">g_orig</span><span class="o">.</span><span class="n">badChoices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g_orig</span><span class="o">.</span><span class="n">badChoices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>	

    <span class="n">graphFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/rubisGraph-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">g_orig</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span>\
            <span class="n">fileName</span><span class="o">=</span><span class="n">graphFileName</span><span class="p">,</span>\
            <span class="n">bestChoice</span><span class="o">=</span><span class="n">g_orig</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">,</span>\
            <span class="n">worstChoice</span><span class="o">=</span><span class="n">g_orig</span><span class="o">.</span><span class="n">badChoices</span><span class="p">,</span>\
            <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;10,10&#39;</span><span class="p">)</span>
        <span class="n">g_orig</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span>\
                                  <span class="n">fileName</span><span class="o">=</span><span class="n">graphFileName</span><span class="p">,</span><span class="n">bestChoice</span><span class="o">=</span><span class="n">g_orig</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">,</span>\
                                  <span class="n">worstChoice</span><span class="o">=</span><span class="n">g_orig</span><span class="o">.</span><span class="n">badChoices</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                                  <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;10,10&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> 
        <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;GraphViz export error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when computing the outranking digraph image.&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># criteria correlation</span>

    <span class="c1">#similarityPlotFileName = str(tempDir)+&#39;/similarityPlot-&#39; + str(problemFileName)</span>
    <span class="n">similarityPlotFileName</span> <span class="o">=</span> <span class="n">problemFileName</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isRobust</span><span class="p">:</span>
            <span class="n">g_orig</span><span class="o">.</span><span class="n">export3DplotOfCriteriaCorrelation</span><span class="p">(</span><span class="n">plotFileName</span><span class="o">=</span><span class="n">similarityPlotFileName</span><span class="p">,</span><span class="n">Type</span><span class="o">=</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bipolarFlag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">dist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">centeredFlag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Calmat or R error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when generating the criteria correlation png plot.&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># copy similarity jpg in place</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isRobust</span><span class="p">:</span>
        <span class="n">inFile</span> <span class="o">=</span> <span class="n">similarityPlotFileName</span> <span class="o">+</span> <span class="s1">&#39;.pdf&#39;</span>
        <span class="kn">import</span> <span class="nn">os.path</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">inFile</span><span class="p">):</span>
            <span class="n">outFile</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/similarityPlot-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpg&#39;</span>
            <span class="k">if</span> <span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;darwin&#39;</span><span class="p">:</span>
                <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;pdftoppm -r 85 </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">/temp ; ppmtojpeg </span><span class="si">%s</span><span class="s1">/temp-000001.ppm &gt; </span><span class="si">%s</span><span class="s1">/temp.jpg; cp </span><span class="si">%s</span><span class="s1">/temp.jpg </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">inFile</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">),</span><span class="n">outFile</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;pdftoppm -r 85 &lt; &#39;</span> <span class="o">+</span> <span class="n">inFile</span> <span class="o">+</span> <span class="s1">&#39; &gt; /tmp/temp.ppm ; ppmtojpeg &lt; /tmp/temp.ppm &gt; /tmp/temp.jpg; cp /tmp/temp.jpg &#39;</span> <span class="o">+</span> <span class="n">outFile</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">errorExit</span><span class="p">(</span><span class="n">tempDir</span><span class="p">,</span><span class="n">problemFileName</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;system error&#39;</span><span class="p">,</span> <span class="s1">&#39;Error when generating the criteria correlation jpeg plot.&#39;</span><span class="p">)</span>
                <span class="k">return</span>

    <span class="c1"># copy Rubis styles sheet</span>
    <span class="n">xmcda</span><span class="o">.</span><span class="n">saveRubisXSL</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/xmcda2Rubis.xsl&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">isRobust</span><span class="p">:</span>
        <span class="n">xmcda</span><span class="o">.</span><span class="n">saveRobustRubisChoiceXSL</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/xmcda2RubisRobustChoice.xsl&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xmcda</span><span class="o">.</span><span class="n">saveRubisChoiceXSL</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tempDir</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/xmcda2RubisChoice.xsl&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="showXMCDARubisBestChoiceRecommendation">
<a class="viewcode-back" href="../techDoc.html#xmcda.showXMCDARubisBestChoiceRecommendation">[docs]</a>
<span class="k">def</span> <span class="nf">showXMCDARubisBestChoiceRecommendation</span><span class="p">(</span><span class="n">problemFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">valuationType</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Launches a browser window with the XMCDA2 solution of the</span>
<span class="sd">    Rubis Solver computed from a stored XMCDA2 encoded performance tableau.</span>

<span class="sd">    The valuationType parameter allows to work:</span>
<span class="sd">    </span>
<span class="sd">        - on the standard bipolar outranking digraph (valuationType = &#39;bipolar&#39;, default),</span>
<span class="sd">        - on the normalized --[-1,1] valued-- bipolar outranking digraph (valuationType = &#39;normalized&#39;),</span>
<span class="sd">        - on the robust --ordinal criteria weights-- bipolar outranking digraph (valuationType = &#39;robust&#39;),</span>
<span class="sd">        - on the confident outranking digraph (valuationType = &#39;confident&#39;),</span>
<span class="sd">        - ignoring considerable performances differences (valuationType = &#39;noVeto&#39;).</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; import xmcda</span>
<span class="sd">        &gt;&gt;&gt; from randomPerfTabs import RandomCBPerformanceTableau</span>
<span class="sd">        &gt;&gt;&gt; t = RandomCBPerformanceTableau()</span>
<span class="sd">        &gt;&gt;&gt; t.saveXMCDA2(&#39;example&#39;)</span>
<span class="sd">        &gt;&gt;&gt; xmcda.showXMCDARubisBestChoiceRecommendation(problemFileName=&#39;example&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="kn">import</span> <span class="nn">webbrowser</span><span class="o">,</span> <span class="nn">xmcda</span><span class="o">,</span> <span class="nn">tempfile</span><span class="o">,</span> <span class="nn">os</span>
    <span class="n">currDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">tempDirName</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="n">currDir</span><span class="p">)</span>
    <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;cp </span><span class="si">%s</span><span class="s1">.* </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">problemFileName</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">tempDirName</span><span class="p">)</span>
    <span class="n">xmcda</span><span class="o">.</span><span class="n">saveXMCDARubisBestChoiceRecommendation</span><span class="p">(</span><span class="n">problemFileName</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">valuationType</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/solution-&#39;</span><span class="o">+</span><span class="n">problemFileName</span><span class="o">+</span><span class="s1">&#39;.xmcda2&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new</span><span class="p">(</span><span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">url</span><span class="p">)</span>    
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">currDir</span><span class="p">)</span></div>

   
<span class="c1">###############################</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Python xmcda module                              *</span>
<span class="s2">    * Copyright (C) 2011-2021 Raymond Bisdorff         *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="c1">######  scratch pad for testing the module components</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2024, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Feb 07, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>