<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>graphs &mdash; Digraph3 3.13.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sphinx_rtd_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f92f4e34"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=15d7cbb8"></script>
        <script src="../_static/js/hoverxref.js?v=4352a7d3"></script>
        <script src="../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
        <script src="../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Python 3.13
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">graphs</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for graphs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Digraph3 graphs.py module</span>
<span class="sd">  Copyright (C)  2011-2025 Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along</span>
<span class="sd">    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="sd">    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="sd">    </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#############################################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.13.2&quot;</span>


<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

<div class="viewcode-block" id="Graph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph">[docs]</a>
<span class="k">class</span> <span class="nc">Graph</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In the `graphs` module, the root :py:class:`graphs.Graph` class provides a generic graph model. A given object consists in:</span>
<span class="sd">    </span>
<span class="sd">       1. a vertices dictionary</span>
<span class="sd">       2. a characteristic valuation domain, {-1,0,+1} by default</span>
<span class="sd">       3. an edges dictionary, characterising each edge in the given valuation domain</span>
<span class="sd">       4. a gamma function dictionary, holding the neighborhood vertices of each vertex</span>

<span class="sd">    General structure::</span>

<span class="sd">       vertices = {&#39;v1&#39;: {&#39;name&#39;: ...,&#39;shortName&#39;: ...},</span>
<span class="sd">                   &#39;v2&#39;: {&#39;name&#39;: ...,&#39;shortName&#39;: ...},</span>
<span class="sd">                   &#39;v3&#39;: {&#39;name&#39;: ...,&#39;shortName&#39;: ...},</span>
<span class="sd">                   ... }</span>
<span class="sd">       valuationDomain = {&#39;min&#39;: -1, &#39;med&#39;: 0, &#39;max&#39;: 1}</span>
<span class="sd">       edges = {frozenset({&#39;v1&#39;,&#39;v2&#39;}): 1,</span>
<span class="sd">                frozenset({&#39;v1&#39;,&#39;v3&#39;}): 1,</span>
<span class="sd">                frozenset({&#39;v2&#39;,&#39;v3&#39;}): -1,</span>
<span class="sd">                  ...}</span>
<span class="sd">       ## links from each vertex to its neighbors</span>
<span class="sd">       gamma = {&#39;v1&#39;: {&#39;v2&#39;,v3&#39;}, &#39;v2&#39;: {&#39;v1&#39;}, &#39;v3&#39;: {&#39;v1&#39;}, ... }</span>
<span class="sd">       </span>
<span class="sd">    Example python3 session:</span>
<span class="sd">       &gt;&gt;&gt; from graphs import Graph</span>
<span class="sd">       &gt;&gt;&gt; g = Graph(numberOfVertices=5,edgeProbability=0.5) # random instance</span>
<span class="sd">       &gt;&gt;&gt; g.showShort()</span>
<span class="sd">       *----- show short --------------*</span>
<span class="sd">       *---- short description of the graph ----*</span>
<span class="sd">       Name             :  &#39;random&#39;</span>
<span class="sd">       Vertices         :  [&#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;, &#39;v4&#39;, &#39;v5&#39;]</span>
<span class="sd">       Valuation domain :  {&#39;med&#39;: 0, &#39;max&#39;: 1, &#39;min&#39;: -1}</span>
<span class="sd">       Gamma function   :</span>
<span class="sd">       v1 -&gt; [&#39;v4&#39;]</span>
<span class="sd">       v2 -&gt; []</span>
<span class="sd">       v3 -&gt; [&#39;v4&#39;]</span>
<span class="sd">       v4 -&gt; [&#39;v1&#39;, &#39;v3&#39;]</span>
<span class="sd">       v5 -&gt; []</span>
<span class="sd">       </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default presentation method for Graph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="s1">&#39;*------- Graph instance description ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class   : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name    : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Seed             : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>      
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Edge Probability     : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edgeProbability</span><span class="p">)</span>      
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Graph Order      : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Permutation      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permutation</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Graph Size       : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Valuation domain : [</span><span class="si">%.2f</span><span class="s1">; </span><span class="si">%.2f</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span>\
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
       
        <span class="k">return</span> <span class="n">reprString</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Empty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numberOfVertices</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">edgeProbability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for Graph objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        
        <span class="k">if</span> <span class="n">Empty</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;emptyInstance&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">fileName</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">RandomGraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">numberOfVertices</span><span class="p">,</span>\
                               <span class="n">edgeProbability</span><span class="o">=</span><span class="n">edgeProbability</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">fileText</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fileText</span><span class="p">,</span> <span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;vertices&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;valuationDomain&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the negation operator -self available for Graph instances.</span>
<span class="sd">        Returns a DualGraph instance of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">DualGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="k">return</span> <span class="n">new</span>

<span class="c1">#-----------Dias/Castonguay/Longo/Jradi--------*</span>

<div class="viewcode-block" id="Graph.computeGraphCentres">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeGraphCentres">[docs]</a>
    <span class="k">def</span> <span class="nf">computeGraphCentres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the vertices of minimal Neighborhood depth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph2Digraph</span><span class="p">()</span>
        <span class="n">centres</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">computeDigraphCentres</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">centres</span></div>

        
    <span class="k">def</span> <span class="nf">_degreeLabelling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inspired from Dias, Castonguay, Longo &amp; Jradi,</span>
<span class="sd">        Algorithmica 2015, p 14</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">degree</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
            
        <span class="n">labelling</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">minDegree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">color</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span> <span class="ow">and</span> <span class="n">degree</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minDegree</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">x</span>
                    <span class="n">minDegree</span> <span class="o">=</span> <span class="n">degree</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">labelling</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
            <span class="c1">#print(v,i,minDegree)</span>
            <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span><span class="p">:</span>
                    <span class="n">degree</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labelling</span> <span class="o">=</span> <span class="n">labelling</span>
        <span class="k">return</span> <span class="n">labelling</span>

    
    <span class="k">def</span> <span class="nf">_triplets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        p.15 Inspired from Dias, Castonguay, Longo &amp; Jradi,</span>
<span class="sd">        Algorithmica 2015.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
        <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
        <span class="n">labelling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelling</span>
        <span class="n">tG</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cycles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">u</span><span class="p">],</span><span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
<span class="c1">##                    print(u,self.labelling[u],</span>
<span class="c1">##                          x,self.labelling[x],</span>
<span class="c1">##                          y,self.labelling[y])</span>
                    <span class="k">if</span> <span class="n">labelling</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">labelling</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">and</span> \
                       <span class="n">labelling</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">labelling</span><span class="p">[</span><span class="n">y</span><span class="p">]:</span>
<span class="c1">##                    if u &lt; x and x &lt; y:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inital triple:&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                            <span class="n">tG</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3-cycle:&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                            <span class="n">cycles</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
        <span class="c1">#self.tG = tG</span>
        <span class="c1">#self.cycles = cycles</span>
        <span class="k">return</span> <span class="n">tG</span><span class="p">,</span><span class="n">cycles</span>

<div class="viewcode-block" id="Graph.computeChordlessCycles">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeChordlessCycles">[docs]</a>
    <span class="k">def</span> <span class="nf">computeChordlessCycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Cycle3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the set of all chordless cycles observed in a Graph</span>
<span class="sd">        intance. Inspired from Dias, Castonguay, Longo &amp; Jradi,</span>
<span class="sd">        Algorithmica 2015.</span>

<span class="sd">        .. note::</span>

<span class="sd">             By default, a chordless cycle must have at least length 4.If the Cycle3 flag is set to True,</span>
<span class="sd">             the cyclicly closed triplets will be inserted as 3-cycles in the result.</span>
<span class="sd">             </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span>
        <span class="c1">#self.visitedChordlessPathsNew = []</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_degreeLabelling</span><span class="p">()</span>
        <span class="n">triplets</span><span class="p">,</span><span class="n">cycles3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_triplets</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# of initial triplets:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">triplets</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# of 3-cycles        :&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">cycles3</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Cycle3</span><span class="p">:</span>
            <span class="n">cycles</span> <span class="o">=</span> <span class="n">cycles3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cycles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">triplets</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===&gt;&gt;&gt;&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cycles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ccVisit</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">cycles</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">cycles</span></div>


    <span class="k">def</span> <span class="nf">_ccVisit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">cycles</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; p.15 &quot;&quot;&quot;</span>
        <span class="c1">#labelling = self.labelling</span>
        <span class="c1">#self.visitedChordlessPathsNew.append(p)</span>
        <span class="n">ut</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">u1</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">##        if Comments:</span>
<span class="c1">##            print(p,u1,u,ut)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">ut</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">ut</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelling</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelling</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">p1</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">u1</span><span class="p">,</span><span class="n">v</span><span class="p">])]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cycle certificate: &#39;</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
                    <span class="n">cycles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;continue ...&#39;</span><span class="p">,</span><span class="n">p1</span><span class="p">)</span>
                    <span class="n">cycles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ccVisit</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">cycles</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">ut</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blocked</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">cycles</span>
        
            
<span class="c1">#----------------------------------------</span>

    <span class="k">def</span> <span class="nf">_chordlessPaths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Pk</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">Cycle3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        recursice chordless precycle (len &gt; 3) construction:</span>
<span class="sd">            Pk is the current pre chordless cycle</span>
<span class="sd">            v0 is the initial vertex of the precycle</span>
<span class="sd">            vn is the last vertex of the precycle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="n">Pk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">detectedChordlessCycle</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visitedChordlessPaths</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">Pk</span><span class="p">))</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Cycle3</span><span class="p">:</span>
            <span class="n">minPreCycleLength</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># only cycles of length 4 and more are holes in fact</span>
            <span class="n">minPreCycleLength</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="c1">#if len(e) &gt; 1:</span>
        <span class="k">if</span> <span class="n">v0</span> <span class="o">!=</span> <span class="n">vn</span><span class="p">:</span>
            <span class="c1"># not a reflexive link</span>
            <span class="n">e</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">v0</span><span class="p">,</span><span class="n">vn</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Pk</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># we close the chordless pre cycle here</span>
                <span class="n">detectedChordlessCycle</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(&#39;Pk, len(Pk)&#39;, Pk, len(Pk))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Pk</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">minPreCycleLength</span><span class="p">:</span>
                    <span class="c1"># only cycles of length 4 and more are holes in fact</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">xCC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pk</span><span class="p">)</span>
                    <span class="n">Pk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chordless cycle certificate --&gt;&gt;&gt; &#39;</span><span class="p">,</span> <span class="n">Pk</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">detectedChordlessCycle</span>
        <span class="k">if</span> <span class="n">detectedChordlessCycle</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">NBvn</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">vn</span><span class="p">])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">Pk</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Pk</span><span class="p">)])</span>
            <span class="c1"># exterior neighborhood of vn</span>

<span class="c1">##            if Debug:</span>
<span class="c1">##                print(&#39;vn, NBvn, Pk, Pk[1:len(Pk)] = &#39;, vn, NBvn, Pk, Pk[1:len(Pk)])</span>
            <span class="c1">#while NBvn != set():</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">NBvn</span><span class="p">:</span>
                <span class="c1"># we try in turn all neighbours of vn</span>
                <span class="c1">#v = NBvn.pop()</span>
                <span class="n">vCP</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">Pk</span><span class="p">)</span>
                <span class="n">vCP</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">vCP</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">vCP</span><span class="p">)</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(&#39;v,vCP  =&#39;, v,vCP)</span>
                <span class="k">if</span> <span class="n">vCP</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visitedChordlessPaths</span><span class="p">:</span>
                    <span class="c1"># test history of paths</span>
                    <span class="n">P</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Pk</span><span class="p">)</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(&#39;P,P[:-1] = &#39;, P,P[:-1])</span>
                    <span class="n">noChord</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">P</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="c1">##                        if Debug:</span>
<span class="c1">##                            print(&#39;x = &#39;, x)</span>
                        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">v0</span><span class="p">:</span>
                            <span class="c1"># we avoid the initial vertex</span>
                            <span class="c1"># to stay with a chordless precycle</span>
                            <span class="n">ex</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">])</span>
<span class="c1">##                            if Debug:</span>
<span class="c1">##                                print(&#39;x, v, ex = &#39;,x,v,ex)</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">ex</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                                <span class="c1"># there is a chord</span>
                                <span class="n">noChord</span> <span class="o">=</span> <span class="kc">False</span>
                                <span class="k">break</span>
                    <span class="k">if</span> <span class="n">noChord</span><span class="p">:</span>
                        <span class="n">P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="c1">##                        if Debug:</span>
<span class="c1">##                            print(&#39;P,v0&#39;,P,v0)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chordlessPaths</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">Cycle3</span><span class="o">=</span><span class="n">Cycle3</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">):</span>
                            <span class="c1"># we continue with the current chordless precycle</span>
                            <span class="n">detectedChordlessCycle</span><span class="o">=</span><span class="kc">True</span>
<span class="c1">##            if Debug:</span>
<span class="c1">##                print(&#39;No further chordless precycles from &#39;,vn,&#39; to &#39;,v0)</span>
        <span class="k">return</span> <span class="n">detectedChordlessCycle</span>

    <span class="k">def</span> <span class="nf">_MISgen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        generator of maximal independent choices (voir Byskov 2004):</span>
<span class="sd">            * S ::= remaining nodes;</span>
<span class="sd">            * I ::= current independent choice</span>

<span class="sd">        .. note::</span>

<span class="sd">            - Initialize self.misset = set() before using !    </span>
<span class="sd">            - Inititalize S with a set of vertex keys, and I with an empty set.</span>
<span class="sd">            - See self.showMIS() for usage instructions.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">S</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
            <span class="n">add</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">missetit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">misset</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">mis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">missetit</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mis</span> <span class="o">&lt;</span> <span class="n">I</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">misset</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mis</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">I</span> <span class="o">&lt;=</span> <span class="n">mis</span><span class="p">:</span>
                        <span class="n">add</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">break</span>
            <span class="k">if</span> <span class="n">add</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">misset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">misset</span> <span class="o">|</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">I</span><span class="p">])</span>
                <span class="k">yield</span> <span class="n">I</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">Sv</span> <span class="o">=</span> <span class="n">S</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">Iv</span> <span class="o">=</span> <span class="n">I</span> <span class="o">|</span> <span class="nb">set</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MISgen</span><span class="p">(</span><span class="n">Sv</span><span class="p">,</span><span class="n">Iv</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">choice</span>
            <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MISgen</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">choice</span>

    <span class="k">def</span> <span class="nf">_saveEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;graphEdges&#39;</span><span class="p">,</span><span class="n">Agrum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Decimal</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saving graph instances as list of edges, ie node node on each line</span>
<span class="sd">        for enumChordlessCycles C++/agrum progam.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving graph edges in file: &lt;&#39;</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.text&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.text&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">)</span> <span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">)):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Agrum</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span>  <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>  <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_singletons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of singletons in frozenset format with neighborhood</span>
<span class="sd">        and not neighbourhood sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="n">indep</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="p">[(</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">]),</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">indep</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">_computeChordlessCycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Cycle3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the set of all chordless cycles observed in a Graph</span>
<span class="sd">        intance. Obsolete home brewed version.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visitedChordlessPaths</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">chordlessCycles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
            <span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xCC</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chordlessPaths</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">Cycle3</span><span class="o">=</span><span class="n">Cycle3</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">):</span>
                <span class="n">chordlessCycles</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xCC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chordlessCycles</span> <span class="o">=</span> <span class="n">chordlessCycles</span>
        <span class="n">chordlessCyclesList</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chordlessCycles</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Return list of chordless cycles as a tuple (path, set)&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">chordlessCyclesList</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">chordlessCyclesList</span>

<div class="viewcode-block" id="Graph.computeCliques">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeCliques">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCliques</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes all cliques, ie maximal complete subgraphs in self:</span>

<span class="sd">        .. Note::</span>

<span class="sd">            - Computes the maximal independent vertex sets in the dual of self.</span>
<span class="sd">            - Result is stored in self.cliques.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">time</span><span class="o">,</span><span class="nn">copy</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---  Maximal Cliques ---*&#39;</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">dualSelf</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span>
        <span class="n">dualSelf</span><span class="o">.</span><span class="n">misset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cliques</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">dualSelf</span><span class="o">.</span><span class="n">generateIndependent</span><span class="p">(</span><span class="n">dualSelf</span><span class="o">.</span><span class="n">_singletons</span><span class="p">())</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> 
        <span class="n">cliqueList</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">clique</span><span class="p">),</span><span class="n">clique</span><span class="p">)</span> <span class="k">for</span> <span class="n">clique</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cliques</span><span class="p">]</span>
        <span class="n">cliqueList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">clq</span> <span class="ow">in</span> <span class="n">cliqueList</span><span class="p">:</span>  <span class="c1"># clq = (len(clique),clique)</span>
            <span class="n">clique</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">clq</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">clique</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">clique</span><span class="p">)</span>
            <span class="n">v</span><span class="p">[</span><span class="n">clq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cliqueNumber</span> <span class="o">=</span> <span class="n">clq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cliqueNumber</span><span class="o">=</span> <span class="n">cliqueNumber</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>  
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of solutions: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cliques</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cardinality distribution&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;card.: &#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;freq.: &#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;clique Number: &#39;</span><span class="p">,</span> <span class="n">cliqueNumber</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execution time: </span><span class="si">%.5f</span><span class="s1"> sec.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Results in self.cliques&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graph.computeComponents">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeComponents">[docs]</a>
    <span class="k">def</span> <span class="nf">computeComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the connected components of a graph instance.</span>
<span class="sd">        Returns a partition of the vertices as a list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depthFirstSearch</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">:</span>
            <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">components</span></div>

    
<div class="viewcode-block" id="Graph.computeDegreeDistribution">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeDegreeDistribution">[docs]</a>
    <span class="k">def</span> <span class="nf">computeDegreeDistribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the distribution of vertex degrees.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">degreeDistribution</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">dv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="n">degreeDistribution</span><span class="p">[</span><span class="n">dv</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;degrees      : &#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;distribution : &#39;</span><span class="p">,</span> <span class="n">degreeDistribution</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">degreeDistribution</span></div>


<div class="viewcode-block" id="Graph.computeDiameter">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeDiameter">[docs]</a>
    <span class="k">def</span> <span class="nf">computeDiameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Oriented</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the diameter (maximal neighbourhood depth) of the digraph instance.</span>

<span class="sd">        .. Note::</span>

<span class="sd">            The diameter of a disconnected graph is considered to be *infinite*</span>
<span class="sd">            (results in a value -1) !</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">nbDepths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNeighbourhoodDepthDistribution</span><span class="p">()</span>
        <span class="n">nbDepths</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">nbDepths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">diameter</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diameter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nbDepths</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">nbDepths</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">diameter</span> <span class="o">=</span> <span class="n">order</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">diameter</span>                       </div>


<div class="viewcode-block" id="Graph.computeGirth">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeGirth">[docs]</a>
    <span class="k">def</span> <span class="nf">computeGirth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">girthType</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the *girth* of self, i.e. the length of the shortest chordless cycle in the graph.</span>

<span class="sd">        *Parameter*:</span>
<span class="sd">            * *girthType* = &quot;any&quot; (default) | &quot;odd&quot; | &quot;even&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cycles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeChordlessCycles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span>
        <span class="n">girth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">girthType</span> <span class="o">==</span> <span class="s2">&quot;odd&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nc</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="n">girth</span><span class="p">:</span>
                    <span class="n">girth</span> <span class="o">=</span> <span class="n">nc</span>
            <span class="k">elif</span> <span class="n">girthType</span> <span class="o">==</span> <span class="s2">&quot;even&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nc</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="n">girth</span><span class="p">:</span>
                    <span class="n">girth</span> <span class="o">=</span> <span class="n">nc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nc</span> <span class="o">&lt;</span> <span class="n">girth</span><span class="p">:</span>
                    <span class="n">girth</span> <span class="o">=</span> <span class="n">nc</span>
        <span class="k">if</span> <span class="n">girth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">girthType</span> <span class="o">==</span> <span class="s2">&quot;any&quot;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the graph </span><span class="si">%s</span><span class="s1"> has no cycles&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the graph </span><span class="si">%s</span><span class="s1"> has no </span><span class="si">%s</span><span class="s1"> cycles&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">girthType</span><span class="p">))</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="n">girthType</span> <span class="o">==</span> <span class="s2">&quot;odd&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oddGirth</span> <span class="o">=</span> <span class="n">girth</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;odd girth = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">girth</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">girthType</span> <span class="o">==</span> <span class="s2">&quot;even&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evenGirth</span> <span class="o">=</span> <span class="n">girth</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;even girth = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">girth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">girth</span> <span class="o">=</span> <span class="n">girth</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;girth = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">girth</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">girth</span></div>

                
<div class="viewcode-block" id="Graph.computeMaximumMatching">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeMaximumMatching">[docs]</a>
    <span class="k">def</span> <span class="nf">computeMaximumMatching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a maximum matching in *self* by computing</span>
<span class="sd">        a maximum MIS of the line graph of *self*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">graphs</span> <span class="kn">import</span> <span class="n">LineGraph</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="n">LineGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ls</span><span class="o">.</span><span class="n">computeMIS</span><span class="p">()</span>
        <span class="n">matchings</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">mis</span><span class="p">),</span><span class="n">mis</span><span class="p">)</span> <span class="k">for</span> <span class="n">mis</span> <span class="ow">in</span> <span class="n">ls</span><span class="o">.</span><span class="n">misset</span><span class="p">]</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">matchings</span><span class="p">,</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">mis</span> <span class="ow">in</span> <span class="n">ms</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">mis</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ms</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># skipping the length argument</span></div>


<div class="viewcode-block" id="Graph.computeMIS">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeMIS">[docs]</a>
    <span class="k">def</span> <span class="nf">computeMIS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints all maximal independent vertex sets:</span>

<span class="sd">        .. Note::</span>
<span class="sd">        </span>
<span class="sd">            - Result is stored in self.misset !</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">time</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---  Maximal Independent Sets ---*&#39;</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">misset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">misset</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateIndependent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_singletons</span><span class="p">())</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> 
        <span class="n">misList</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">mis</span><span class="p">),</span><span class="n">mis</span><span class="p">)</span> <span class="k">for</span> <span class="n">mis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">misset</span><span class="p">]</span>
        <span class="n">misList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1">#print(misList)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">misList</span><span class="p">:</span> <span class="c1"># m = (len(mis),mis))</span>
            <span class="n">mis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">mis</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="c1">#print(mis)</span>
            <span class="n">v</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">stabilityNumber</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stabilityNumber</span> <span class="o">=</span> <span class="n">stabilityNumber</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of solutions: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">misList</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cardinality distribution&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;card.: &#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;freq.: &#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stability number : &#39;</span><span class="p">,</span> <span class="n">stabilityNumber</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execution time: </span><span class="si">%.5f</span><span class="s1"> sec.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Results in self.misset&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graph.computeNeighbourhoodDepth">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeNeighbourhoodDepth">[docs]</a>
    <span class="k">def</span> <span class="nf">computeNeighbourhoodDepth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vertex</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the distribtion of neighbourhood depths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">copy</span>
        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&#39;</span><span class="p">,</span><span class="n">vertex</span><span class="p">)</span>
        <span class="n">nbx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">neighbx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">vertex</span><span class="p">])</span>
        <span class="n">restVertices</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">-</span> <span class="n">neighbx</span>
        <span class="k">while</span> <span class="n">restVertices</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()</span> <span class="ow">and</span> <span class="n">nbx</span> <span class="o">&lt;</span> <span class="n">order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbx,restVertices&#39;</span><span class="p">,</span> <span class="n">nbx</span><span class="p">,</span><span class="n">restVertices</span><span class="p">)</span>
            <span class="n">nbx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">iterneighbx</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">neighbx</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">iterneighbx</span><span class="p">:</span>
                <span class="n">neighbx</span> <span class="o">=</span> <span class="n">neighbx</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y,self.gamma[y],neighbx&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">neighbx</span><span class="p">)</span>
            <span class="n">restVertices</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">-</span> <span class="n">neighbx</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbx,restVertices&#39;</span><span class="p">,</span><span class="n">nbx</span><span class="p">,</span><span class="n">restVertices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">restVertices</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">order</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nbx</span></div>


<div class="viewcode-block" id="Graph.computeNeighbourhoodDepthDistribution">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeNeighbourhoodDepthDistribution">[docs]</a>
    <span class="k">def</span> <span class="nf">computeNeighbourhoodDepthDistribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the distribtion of neighbourhood depths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">copy</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">vecNeighbourhoodDepth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> 
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
            <span class="n">nbx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">neighbx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
            <span class="n">restVertices</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">-</span> <span class="n">neighbx</span>
            <span class="k">while</span> <span class="n">restVertices</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()</span> <span class="ow">and</span> <span class="n">nbx</span> <span class="o">&lt;</span> <span class="n">order</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbx,restVertices&#39;</span><span class="p">,</span> <span class="n">nbx</span><span class="p">,</span><span class="n">restVertices</span><span class="p">)</span>
                <span class="n">nbx</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">iterneighbx</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">neighbx</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">iterneighbx</span><span class="p">:</span>
                    <span class="n">neighbx</span> <span class="o">=</span> <span class="n">neighbx</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y,self.gamma[y],neighbx&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">neighbx</span><span class="p">)</span>
                <span class="n">restVertices</span> <span class="o">=</span> <span class="n">vertices</span> <span class="o">-</span> <span class="n">neighbx</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbx,restVertices&#39;</span><span class="p">,</span><span class="n">nbx</span><span class="p">,</span><span class="n">restVertices</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">restVertices</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>
                <span class="n">vecNeighbourhoodDepth</span><span class="p">[</span><span class="n">order</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vecNeighbourhoodDepth</span><span class="p">[</span><span class="n">nbx</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="n">depths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">))</span>
            <span class="n">depths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;inf.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbh depths   : &#39;</span><span class="p">,</span> <span class="n">depths</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;distribution : &#39;</span><span class="p">,</span> <span class="n">vecNeighbourhoodDepth</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">vecNeighbourhoodDepth</span></div>


<div class="viewcode-block" id="Graph.computeOrientedDigraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeOrientedDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">computeOrientedDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">PartiallyDetermined</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a digraph where each edge of the permutation graph *self*</span>
<span class="sd">        is converted into an arc oriented in increasing order of the adjacent vertices&#39; numbers.</span>
<span class="sd">        If self is a PermutationGraph instance, the orientation will be transitive.</span>

<span class="sd">        The parameter *PartiallyDetermined*: {True|False by default], converts if *True* all absent</span>
<span class="sd">        edges of the graph into indeterminate symmetric relations in the resulting digraph.</span>
<span class="sd">     </span>
<span class="sd">        &gt;&gt;&gt; from graphs import RandomGraph</span>
<span class="sd">        &gt;&gt;&gt; g = RandomGraph(order=6,seed=101)</span>
<span class="sd">        &gt;&gt;&gt; dg = g.computeOrientedDigraph()</span>
<span class="sd">        &gt;&gt;&gt; dg</span>
<span class="sd">        *------- Digraph instance description ------*</span>
<span class="sd">        Instance class   : Digraph</span>
<span class="sd">        Instance name    : oriented_randomGraph</span>
<span class="sd">        Digraph Order      : 6</span>
<span class="sd">        Digraph Size       : 5</span>
<span class="sd">        Valuation domain : [-1.00; 1.00]</span>
<span class="sd">        Determinateness  : 100.000</span>
<span class="sd">        Attributes       : [&#39;name&#39;,&#39;order&#39;,&#39;actions&#39;,&#39;valuationdomain&#39;,</span>
<span class="sd">                            &#39;relation&#39;, &#39;gamma&#39;, &#39;notGamma&#39;,</span>
<span class="sd">                            &#39;size&#39;, &#39;transitivityDegree&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dg.transitivityDegree</span>
<span class="sd">        Decimal(&#39;0.7142857142857142857142857143&#39;)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">Digraph</span><span class="p">,</span> <span class="n">EmptyDigraph</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        
        <span class="n">g</span> <span class="o">=</span> <span class="n">EmptyDigraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">Digraph</span>
        <span class="n">g</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;oriented_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">g</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">actionKeysList</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeysList</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionKeysList</span><span class="p">:</span>
                <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeysList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                        
        <span class="k">if</span> <span class="n">PartiallyDetermined</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span> <span class="ow">and</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                        
        <span class="n">g</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">transitivityDegree</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeTransitivityDegree</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">g</span></div>


<div class="viewcode-block" id="Graph.computeTransitivelyOrientedDigraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeTransitivelyOrientedDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">computeTransitivelyOrientedDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">PartiallyDetermined</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a digraph where each edge of the permutation graph *self*</span>
<span class="sd">        is converted into an arc oriented in increasing order of the ranks of implication classes</span>
<span class="sd">        detected with the :py:func:`digraphs.Digraph.isComparabilityGraph` test and stored in self.edgeOrientations.</span>

<span class="sd">        The parameter *PartiallyDetermined*: {True|False (by default), converts if *True* all absent</span>
<span class="sd">        edges of the graph into indeterminate symmetric relations in the resulting digraph.</span>
<span class="sd">        Verifies if the graph instance is a comparability graph.</span>
<span class="sd">        </span>
<span class="sd">        *Source*: M. Ch. Golumbic (2004) Algorithmic Graph Thery and Perfect Graphs,</span>
<span class="sd">        Annals of Discrete Mathematics 57, Elsevier, p. 129-132.</span>
<span class="sd">     </span>
<span class="sd">        &gt;&gt;&gt; from graphs import RandomGraph</span>
<span class="sd">        &gt;&gt;&gt; g = RandomGraph(order=6,edgeProbability=0.5,seed=100)</span>
<span class="sd">        &gt;&gt;&gt; og = g.computeTransitivelyOrientedDigraph()</span>
<span class="sd">        &gt;&gt;&gt; if og is not None:</span>
<span class="sd">        ...     print(og)</span>
<span class="sd">        ...     print(&#39;Transitivity degree: %.3f&#39; % og.transitivityDegree)</span>
<span class="sd">         *------- Digraph instance description ------*</span>
<span class="sd">          Instance class   : TransitiveDigraph</span>
<span class="sd">          Instance name    : trans_oriented_randomGraph</span>
<span class="sd">          Digraph Order      : 6</span>
<span class="sd">          Digraph Size       : 7</span>
<span class="sd">          Valuation domain : [-1.00 - 1.00]</span>
<span class="sd">          Determinateness  : 46.667</span>
<span class="sd">          Attributes       : [&#39;name&#39;, &#39;order&#39;, &#39;actions&#39;, </span>
<span class="sd">                             &#39;valuationdomain&#39;, &#39;relation&#39;,</span>
<span class="sd">                             &#39;gamma&#39;, &#39;notGamma&#39;, &#39;size&#39;, </span>
<span class="sd">                             &#39;transitivityDegree&#39;]</span>
<span class="sd">         Transitivity degree: 1.000</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; gd = -g</span>
<span class="sd">        &gt;&gt;&gt; ogd = gd.computeTransitivelyOrientedDigraph()</span>
<span class="sd">        &gt;&gt;&gt; if ogd is not None:</span>
<span class="sd">        ...     print(ogd)</span>
<span class="sd">        ...     print(&#39;Dual transitivity degree: %.3f&#39; % ogd.transitivityDegree)</span>
<span class="sd">         *------- Digraph instance description ------*</span>
<span class="sd">          Instance class   : TransitiveOrder</span>
<span class="sd">          Instance name    : trans_oriented_dual_randomGraph</span>
<span class="sd">          Digraph Order      : 6</span>
<span class="sd">         Digraph Size       : 8</span>
<span class="sd">         Valuation domain : [-1.00 - 1.00]</span>
<span class="sd">         Determinateness  : 53.333</span>
<span class="sd">         Attributes       : [&#39;name&#39;, &#39;order&#39;, &#39;actions&#39;, </span>
<span class="sd">                             &#39;valuationdomain&#39;, &#39;relation&#39;,</span>
<span class="sd">                            &#39;gamma&#39;, &#39;notGamma&#39;, &#39;size&#39;, </span>
<span class="sd">                            &#39;transitivityDegree&#39;]</span>
<span class="sd">        Dual transitivity degree: 1.000</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">EmptyDigraph</span>
        <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="n">TransitiveDigraph</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isComparabilityGraph</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The graph </span><span class="si">%s</span><span class="s1"> does not admit a transitive orientation.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span><span class="p">[</span><span class="n">arc</span><span class="p">])</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">EmptyDigraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">TransitiveDigraph</span>
            <span class="n">g</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;trans_oriented_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="n">g</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
            <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">actionKeysList</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeysList</span><span class="p">:</span>
                <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionKeysList</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeysList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>            
            <span class="k">if</span> <span class="n">PartiallyDetermined</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">actionKeysList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span> <span class="ow">and</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                            <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="n">g</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
            <span class="n">g</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">transitivityDegree</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeTransitivityDegree</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">g</span></div>



<div class="viewcode-block" id="Graph.computePermutation">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computePermutation">[docs]</a>
    <span class="k">def</span> <span class="nf">computePermutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seq1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seq2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tests whether the graph instance *self* is a permutation graph</span>
<span class="sd">        and renders, in case the test is positive,</span>
<span class="sd">        the corresponding permutation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">FusionDigraph</span>
        <span class="k">if</span> <span class="n">seq1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">seq2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">og</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeTransitivelyOrientedDigraph</span><span class="p">(</span><span class="n">PartiallyDetermined</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">odt</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">computeTransitivityDegree</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">odt</span> <span class="o">&lt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transitivity degree </span><span class="si">%.3f</span><span class="s1"> &lt; 1&#39;</span> <span class="o">%</span> <span class="n">odt</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The graph instance is not a permutation graph&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">gd</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span>
            <span class="n">ogd</span> <span class="o">=</span> <span class="n">gd</span><span class="o">.</span><span class="n">computeTransitivelyOrientedDigraph</span><span class="p">(</span><span class="n">PartiallyDetermined</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ogdt</span> <span class="o">=</span> <span class="n">ogd</span><span class="o">.</span><span class="n">computeTransitivityDegree</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ogdt</span> <span class="o">&lt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dual transitivity degree </span><span class="si">%.3f</span><span class="s1"> &lt; 1&#39;</span> <span class="o">%</span> <span class="n">ogdt</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The graph instance is not a permutation graph&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            
            <span class="n">f1</span> <span class="o">=</span> <span class="n">FusionDigraph</span><span class="p">(</span><span class="n">og</span><span class="p">,</span><span class="n">ogd</span><span class="p">,</span><span class="s1">&#39;o-max&#39;</span><span class="p">)</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="n">FusionDigraph</span><span class="p">((</span><span class="o">-</span><span class="n">og</span><span class="p">),</span><span class="n">ogd</span><span class="p">,</span><span class="s1">&#39;o-max&#39;</span><span class="p">)</span>
            <span class="n">seq1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">seq1</span><span class="p">)</span>
            <span class="n">seq2</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">seq2</span><span class="p">)</span>
        <span class="n">permutation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
            <span class="n">permutation</span><span class="p">[</span><span class="n">seq2</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">seq1</span><span class="p">[</span><span class="n">j</span><span class="p">])]</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">permutation</span></div>


<div class="viewcode-block" id="Graph.computeSize">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.computeSize">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the number of positively characterised edges of this graph instance</span>
<span class="sd">        (result is stored in self.size).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">return</span> <span class="n">size</span></div>


<div class="viewcode-block" id="Graph.breadthFirstSearch">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.breadthFirstSearch">[docs]</a>
    <span class="k">def</span> <span class="nf">breadthFirstSearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">alphabeticOrder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Breadth first search through a graph in lexicographical order</span>
<span class="sd">        of the vertex keys.</span>

<span class="sd">        Renders a list of vertice keys in</span>
<span class="sd">        increasing distance from the origin *s*. Ties in the distances</span>
<span class="sd">        are resolved by alphabetic ordering of the vertice keys.</span>

<span class="sd">        A warning is issued when the graph is not connected and the resulting</span>
<span class="sd">        search does not cover the whole set of graph vertices. </span>

<span class="sd">        Source: Cormen, Leiserson, Rivest &amp; Stein, *Introduction to Algorithms* 2d Ed., MIT Press 2001.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
        <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeComponents</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">:</span>
                <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">alphabeticOrder</span><span class="p">:</span>
                    <span class="n">verticesKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
                <span class="n">verticesKeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">color</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">bfsDepth</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
                    <span class="n">color</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">bfsDepth</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">nv</span>
                    <span class="n">parent</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">color</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">bfsDepth</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">parent</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">color</span><span class="p">,</span><span class="n">bfsDepth</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>
                <span class="k">while</span> <span class="n">F</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">u</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">u</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                            <span class="n">bfsDepth</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">bfsDepth</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                            <span class="n">parent</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
                            <span class="n">F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;u,v,F&#39;</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
                    <span class="n">F</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
                    <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">color</span><span class="p">,</span><span class="n">bfsDepth</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">bfs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bfsDepth</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">]</span>
                <span class="n">bfs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bfs</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bfsDepth</span> <span class="o">=</span> <span class="n">bfsDepth</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bfs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Warnings</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: graph </span><span class="si">%s</span><span class="s1"> is not connected!&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Not with </span><span class="si">%s</span><span class="s1"> connected vertices: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">comp</span><span class="p">))</span> <span class="p">)</span></div>

                                
<div class="viewcode-block" id="Graph.depthFirstSearch">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.depthFirstSearch">[docs]</a>
    <span class="k">def</span> <span class="nf">depthFirstSearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Depth first search through a graph in lexicographical order</span>
<span class="sd">        of the vertex keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">_visitVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Visits all followers of vertex x.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1">## self.date += 1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;startDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; dfs </span><span class="si">%s</span><span class="s1">, date = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">),</span>  <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;startDate&#39;</span><span class="p">]))</span>
            <span class="n">nextVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
            <span class="n">nextVertices</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   next &#39;</span><span class="p">,</span> <span class="n">nextVertices</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">nextVertices</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">_visitVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;endDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">def</span> <span class="nf">_visitAllVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Mark the starting date for all vertices</span>
<span class="sd">            and controls the progress of the search with vertices colors:</span>
<span class="sd">            White (0), Grey (1), Black (2)</span>

<span class="sd">            Stores the depth first search path in the *self.dfs* attribute</span>
<span class="sd">            and returns it.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
            <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt; Starting from </span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
                    <span class="n">_visitVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span><span class="p">)</span>
                <span class="c1">#self.vertices[x][&#39;color&#39;] = 2</span>
                <span class="c1">#self.vertices[x][&#39;endDate&#39;] = self.date</span>


        <span class="c1"># ---- main -----</span>
        <span class="n">_visitAllVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span></div>


<div class="viewcode-block" id="Graph.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">verticesSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">WithSpanningTree</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">WithVertexColoring</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">matching</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">arcColor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">lineWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file  for graph drawing filtering.</span>

<span class="sd">        Example:</span>
<span class="sd">           &gt;&gt;&gt; g = Graph(numberOfVertices=5,edgeProbability=0.3)</span>
<span class="sd">           &gt;&gt;&gt; g.exportGraphViz(&#39;randomGraph&#39;)</span>

<span class="sd">        .. image:: randomGraph.png</span>
<span class="sd">           :alt: Random graph</span>
<span class="sd">           :width: 300 px</span>
<span class="sd">           :align: center</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verticesSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesSubset</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="c1">## if bestChoice != set():</span>
        <span class="c1">##     rankBestString = &#39;{rank=max; &#39;</span>
        <span class="c1">## if worstChoice != set():</span>
        <span class="c1">##     rankWorstString = &#39;{rank=min; &#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strict graph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2022&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">WithVertexColoring</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
                <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">&#39;</span> \
                 <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">spinColor</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">WithSpanningTree</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no spanning tree yet computed. Run self.randomDepthFirstSearch() !&#39;</span><span class="p">)</span>
            <span class="n">edgesColored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">dfs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                    <span class="c1">#print(i,tree[i],tree[i+1])</span>
                    <span class="n">edgesColored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]))</span>
            <span class="c1">#print(&#39;Spanning tree: &#39;, edgesColored)</span>
                    
        <span class="k">if</span> <span class="n">matching</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">withMatching</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">edgesColored</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">matching</span><span class="p">:</span>
                <span class="n">edgesColored</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Matching: &#39;</span><span class="p">,</span> <span class="n">edgesColored</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">withMatching</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span> <span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">WithSpanningTree</span> <span class="ow">and</span> \
                        <span class="nb">frozenset</span><span class="p">(</span> <span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span> <span class="ow">in</span> <span class="n">edgesColored</span><span class="p">:</span>
                               <span class="n">arrowFormat</span> <span class="o">=</span> \
        <span class="s1">&#39; [dir=both,style=&quot;setlinewidth(3)&quot;,color=red, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>                                          
                        <span class="k">elif</span> <span class="n">withMatching</span> <span class="ow">and</span> \
                        <span class="nb">frozenset</span><span class="p">(</span> <span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span> <span class="ow">in</span> <span class="n">edgesColored</span><span class="p">:</span>
                               <span class="n">arrowFormat</span> <span class="o">=</span> \
        <span class="s1">&#39; [dir=both,style=&quot;setlinewidth(3)&quot;,color=red, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>                                          
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">arrowFormat</span> <span class="o">=</span> \
        <span class="s1">&#39; [dir=both,style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">arrowFormat</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">==</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span>\
            <span class="s1">&#39; [dir=both, color=grey, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># choose layout model</span>
        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,(</span><span class="n">GridGraph</span><span class="p">,</span><span class="n">TriangulatedGrid</span><span class="p">,</span><span class="n">TreeGraph</span><span class="p">)):</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;neato&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,(</span><span class="n">CycleGraph</span><span class="p">)):</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;circo&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;fdp&#39;</span>
            
        <span class="n">commandString</span> <span class="o">=</span> <span class="n">layout</span><span class="o">+</span><span class="s1">&#39; -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;On Ubuntu: ..$ sudo apt-get install graphviz&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graph.exportEdgeOrientationsGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.exportEdgeOrientationsGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportEdgeOrientationsGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">verticesSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">arcColor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">lineWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">palette</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                        <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file for oriented graph drawing filtering.</span>

<span class="sd">        Example:</span>
<span class="sd">           &gt;&gt;&gt; from graphs import *</span>
<span class="sd">           &gt;&gt;&gt; g = RandomGraph(order=6,seed=100)</span>
<span class="sd">           &gt;&gt;&gt; if g.isComparabilityGraph():</span>
<span class="sd">           ...     g.exportEdgeOrientationsGraphViz(&#39;orientedGraph&#39;)</span>

<span class="sd">        .. image:: orientedGraph.png</span>
<span class="sd">           :alt: Random graph</span>
<span class="sd">           :width: 300 px</span>
<span class="sd">           :align: center</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">edgeOrientations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isComparabilityGraph</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The graph </span><span class="si">%s</span><span class="s1"> is not transitively orientable&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verticesSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesSubset</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strict graph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2022&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># reminder include a color palette in digraphsToold</span>
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">colorPalettes</span>
<span class="c1">##        colors0 = [&#39;black&#39;,</span>
<span class="c1">##                  &#39;blue&#39;,</span>
<span class="c1">##                  &#39;coral&#39;,</span>
<span class="c1">##                  &#39;gold&#39;,</span>
<span class="c1">##                  &#39;gray&#39;,</span>
<span class="c1">##                  &#39;black&#39;,</span>
<span class="c1">##                  &#39;pink&#39;,</span>
<span class="c1">##                  &#39;green&#39;,</span>
<span class="c1">##                  &#39;orange&#39;,</span>
<span class="c1">##                  &#39;skyblue&#39;,</span>
<span class="c1">##                  &#39;wheat&#39;,</span>
<span class="c1">##                  &#39;salmon&#39;]    </span>
<span class="c1">##        colors1 = [&#39;#EA2027&#39;,</span>
<span class="c1">##                  &#39;#006266&#39;,</span>
<span class="c1">##                  &#39;#1B1464&#39;,</span>
<span class="c1">##                  &#39;#5758BB&#39;,</span>
<span class="c1">##                  &#39;#6F1E51&#39;,</span>
<span class="c1">##                  &#39;#EE5A24&#39;,</span>
<span class="c1">##                  &#39;#009432&#39;,</span>
<span class="c1">##                  &#39;#0652DD&#39;,</span>
<span class="c1">##                  &#39;#9980FA&#39;,</span>
<span class="c1">##                  &#39;#833471&#39;,</span>
<span class="c1">##                  &#39;#F79F1F&#39;,</span>
<span class="c1">##                  &#39;#A3CB38&#39;,</span>
<span class="c1">##                   &#39;#1289A7&#39;,</span>
<span class="c1">##                   &#39;#D980FA&#39;,</span>
<span class="c1">##                   &#39;#B53471&#39;,</span>
<span class="c1">##                   &#39;#FFC312&#39;,</span>
<span class="c1">##                   &#39;#C4E538&#39;,</span>
<span class="c1">##                   &#39;#12CBC4&#39;,</span>
<span class="c1">##                   &#39;#FDA7DF&#39;,</span>
<span class="c1">##                   &#39;#ED4C67&#39;,</span>
<span class="c1">##                   ]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">colorPalettes</span><span class="p">[</span><span class="n">palette</span><span class="p">]</span>
        <span class="n">edgeColors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                <span class="n">arc</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">]))</span>
                <span class="n">edgeColors</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">edgeOrientations</span><span class="p">[</span><span class="n">arc</span><span class="p">])]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">edgeColors</span><span class="p">)</span>    

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">arc</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">edgeKey</span><span class="p">]))</span>
                        <span class="n">arcColor</span> <span class="o">=</span> <span class="n">edgeColors</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">arcColor</span><span class="p">,</span><span class="n">lineWidth</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">edgeOrientations</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">arrowFormat</span> <span class="o">=</span> \
        <span class="s1">&#39; [dir=forward,style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=&quot;</span><span class="si">%s</span><span class="s1">&quot;, arrowhead=normal, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                     <span class="p">(</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">edgeOrientations</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">arrowFormat</span> <span class="o">=</span> \
        <span class="s1">&#39; [dir=back,style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=&quot;</span><span class="si">%s</span><span class="s1">&quot;, arrowhead=none, arrowtail=normal] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                     <span class="p">(</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">arrowFormat</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>                    
<span class="c1">##                    elif edges[frozenset([vertexkeys[i],vertexkeys[j]])] == Med:</span>
<span class="c1">##                        edge0 = edge+&#39;-- n&#39;+str(j+1)+\</span>
<span class="c1">##            &#39; [dir=both, color=grey, arrowhead=none, arrowtail=none] ;\n&#39;</span>
<span class="c1">##                        fo.write(edge0)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># choose layout model </span>
        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;fdp&#39;</span>
            
        <span class="n">commandString</span> <span class="o">=</span> <span class="n">layout</span><span class="o">+</span><span class="s1">&#39; -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;On Ubuntu: ..$ sudo apt-get install graphviz&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="Graph.exportPermutationGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.exportPermutationGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportPermutationGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">permutation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">WithEdgeColoring</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">hspace</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                       <span class="n">vspace</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                       <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">arcColor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                        <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">lineWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file for permutation drawing filtering.</span>

<span class="sd">        Horizontal (default=100) and vertical (default=75) spaces betwen the vertices&#39;</span>
<span class="sd">        positions may be explicitely given in *hspace* and *vspace* parameters.</span>

<span class="sd">        .. note::</span>
<span class="sd">            If no *permutation* is provided, it is supposed to exist a self.permutation attribute.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
                <span class="c1"># inversions drawing</span>
        <span class="k">if</span> <span class="n">permutation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">permutation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permutation</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No permutation available !!&#39;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gold&#39;</span><span class="p">:</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;lightblue&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;lightcoral&#39;</span><span class="p">:</span><span class="s1">&#39;coral&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;lightyellow&#39;</span><span class="p">:</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;orange&#39;</span><span class="p">:</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;gray&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;lightpink&#39;</span><span class="p">:</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;seagreen1&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;skyblue&#39;</span><span class="p">:</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;wheat1&#39;</span><span class="p">:</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;lightsalmon&#39;</span><span class="p">:</span><span class="s1">&#39;salmon&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;perm_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strict digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>           
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2022&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># horizontally positioned initial nodes at line 100</span>
        <span class="c1"># horinzontal space = 75</span>
        <span class="n">vspace</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">hspace</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">, &#39;</span> <span class="o">%</span> <span class="n">spinColor</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;pos=&quot;</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">hspace</span><span class="p">,</span><span class="n">vspace</span><span class="p">)</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># horizontally positionned terminal nodes at line 0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">k</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">k</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">k</span><span class="p">]][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">, &#39;</span> <span class="o">%</span> <span class="n">spinColor</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;pos=&quot;</span><span class="si">%d</span><span class="s1">,</span><span class="si">%d</span><span class="s1">&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">hspace</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">WithEdgeColoring</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">colorKey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">computeMinimalVertexColoring</span><span class="p">()</span>
                    <span class="n">colorKey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
                <span class="n">arrowFormat</span> <span class="o">=</span> \
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-&gt; n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
                <span class="s1">&#39; [dir=both, color=</span><span class="si">%s</span><span class="s1">, style=&quot;setlinewidth(2)&quot;,</span><span class="se">\</span>
<span class="s1">                              arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>\
                    <span class="o">%</span> <span class="n">colors</span><span class="p">[</span><span class="n">colorKey</span><span class="p">]</span>
<span class="c1">##                except KeyError:</span>
<span class="c1">##                    arrowFormat = \</span>
<span class="c1">##                       edge0 = edge+&#39;-&gt; n&#39;+str(n+i+1) +\</span>
<span class="c1">##                &#39; [dir=both, color=black, arrowhead=none, arrowtail=none] ;\n&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arrowFormat</span> <span class="o">=</span> \
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-&gt; n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
                <span class="s1">&#39; [dir=both, color=black, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># choose layout model </span>
        <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;neato&#39;</span>
        <span class="n">commandString</span> <span class="o">=</span> <span class="n">layout</span><span class="o">+</span><span class="s1">&#39; -n -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;On Ubuntu: ..$ sudo apt-get install graphviz&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graph.gammaSets">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.gammaSets">[docs]</a>
    <span class="k">def</span> <span class="nf">gammaSets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the gamma function as dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vkeys&#39;</span><span class="p">,</span> <span class="n">vkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vkeys</span><span class="p">:</span>
            <span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="n">pair</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">e1</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">e2</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">gamma</span><span class="p">[</span><span class="n">e1</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
                <span class="n">gamma</span><span class="p">[</span><span class="n">e2</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gamma</span></div>


<div class="viewcode-block" id="Graph.generateIndependent">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.generateIndependent">[docs]</a>
    <span class="k">def</span> <span class="nf">generateIndependent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">U</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generator for all independent vertices sets</span>
<span class="sd">        with neighborhoods of a graph instance:</span>

<span class="sd">        .. note::</span>
<span class="sd">        </span>
<span class="sd">               * Initiate with U = self._singletons().</span>
<span class="sd">               * Yields [independent set, covered set, all vertices - covered set)].</span>
<span class="sd">               * If independent set == (all vertices - covered set), the given independent set is maximal !</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">U</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
            <span class="k">yield</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">(),</span><span class="nb">set</span><span class="p">(),</span><span class="n">vertices</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">S</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateIndependent</span><span class="p">(</span><span class="n">U</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">S</span>
                <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span>  <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">Sxgam</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">Sxindep</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span>  <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">Sxchoice</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">Sx</span> <span class="o">=</span> <span class="p">[</span><span class="n">Sxchoice</span><span class="p">,</span><span class="n">Sxgam</span><span class="p">,</span><span class="n">Sxindep</span><span class="p">]</span>
                    <span class="k">yield</span> <span class="n">Sx</span></div>



                 
<div class="viewcode-block" id="Graph.graph2Digraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.graph2Digraph">[docs]</a>
    <span class="k">def</span> <span class="nf">graph2Digraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a Graph object into a symmetric Digraph object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">Digraph</span><span class="p">,</span> <span class="n">EmptyDigraph</span>
        <span class="n">dg</span> <span class="o">=</span> <span class="n">EmptyDigraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">Digraph</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dg</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">convertValuationToDecimal</span><span class="p">()</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">relations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">actionsKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dg</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
            <span class="n">dg</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">dg</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">dg</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">convertRelationToDecimal</span><span class="p">()</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dg</span></div>



<div class="viewcode-block" id="Graph.isComparabilityGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isComparabilityGraph">[docs]</a>
    <span class="k">def</span> <span class="nf">isComparabilityGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies if the graph instance is a comparability graph.</span>
<span class="sd">        If yes, a tranditive orientation of the edges is stored </span>
<span class="sd">        in self.edgeOrientations. </span>
<span class="sd">        </span>
<span class="sd">        *Source*: M. Ch. Golumbic (2004) Algorithmic Graph Thery and Perfect Graphs,</span>
<span class="sd">        Annals of Discrete Mathematics 57, Elsevier, p. 129-132.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">global</span> <span class="n">orientation</span><span class="p">,</span><span class="n">IsComparabilityGraph</span><span class="p">,</span><span class="n">k</span>
        <span class="k">def</span> <span class="nf">_explore</span><span class="p">(</span><span class="n">arc</span><span class="p">):</span>
            <span class="k">global</span> <span class="n">orientation</span><span class="p">,</span><span class="n">IsComparabilityGraph</span><span class="p">,</span><span class="n">k</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arc&#39;</span><span class="p">,</span> <span class="n">arc</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">orientation</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="p">)])</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">orientation</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="p">)])</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">):</span> 
                    <span class="k">if</span> <span class="n">orientation</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)]</span> <span class="o">==</span> <span class="mi">999</span><span class="p">:</span>
                        <span class="n">orientation</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)]</span> <span class="o">=</span> <span class="n">k</span>
                        <span class="n">orientation</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
                        <span class="n">_explore</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">orientation</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)]</span> <span class="o">==</span> <span class="o">-</span><span class="n">k</span><span class="p">:</span>
                        <span class="n">orientation</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)]</span> <span class="o">=</span> <span class="n">k</span>
                        <span class="n">IsComparabilityGraph</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;is comp?&#39;</span><span class="p">,</span><span class="n">IsComparabilityGraph</span><span class="p">)</span>
                        <span class="c1">#return</span>
                        <span class="n">_explore</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
                    
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">orientation</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)])</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">orientation</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">)])</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">orientation</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span> <span class="o">==</span> <span class="mi">999</span><span class="p">:</span>
                        <span class="n">orientation</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="n">k</span>
                        <span class="n">orientation</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
                        <span class="n">_explore</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">orientation</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span> <span class="o">==</span> <span class="o">-</span><span class="n">k</span><span class="p">:</span>
                        <span class="n">orientation</span><span class="p">[(</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="n">k</span>
                        <span class="n">IsComparabilityGraph</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;is comp ?&#39;</span><span class="p">,</span><span class="n">IsComparabilityGraph</span><span class="p">)</span>
                        <span class="c1">#return</span>
                        <span class="n">_explore</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
                      
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span><span class="n">orientation</span><span class="p">,</span><span class="n">IsComparabilityGraph</span><span class="p">)</span>

        <span class="c1"># initializing</span>
        <span class="n">IsComparabilityGraph</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">orientation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">vi</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">orientation</span><span class="p">[(</span><span class="n">vi</span><span class="p">,</span><span class="n">vi</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="n">vi</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">vj</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">vi</span><span class="p">,</span><span class="n">vj</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                    <span class="n">orientation</span><span class="p">[(</span><span class="n">vi</span><span class="p">,</span><span class="n">vj</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">999</span>
                    <span class="n">orientation</span><span class="p">[(</span><span class="n">vj</span><span class="p">,</span><span class="n">vi</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">999</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">orientation</span><span class="p">[(</span><span class="n">vi</span><span class="p">,</span><span class="n">vj</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">orientation</span><span class="p">[(</span><span class="n">vj</span><span class="p">,</span><span class="n">vi</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#exploring all positive edges</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="n">arc</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>  
                <span class="k">if</span> <span class="n">orientation</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">==</span> <span class="mi">999</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">orientation</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
                    <span class="n">orientation</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">arc</span><span class="p">))]</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span>
                    <span class="n">_explore</span><span class="p">(</span><span class="n">arc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===&gt;&gt;&gt;&#39;</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">],</span><span class="n">orientation</span><span class="p">)</span>
                
        <span class="c1"># storing the edge decomposition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IsComparabilityGraph</span> <span class="o">=</span> <span class="n">IsComparabilityGraph</span>
        <span class="k">if</span> <span class="n">IsComparabilityGraph</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edgeOrientations</span> <span class="o">=</span> <span class="n">orientation</span>

        <span class="k">return</span> <span class="n">IsComparabilityGraph</span></div>


<div class="viewcode-block" id="Graph.isConnected">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isConnected">[docs]</a>
    <span class="k">def</span> <span class="nf">isConnected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cheks if self is a connected graph instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depthFirstSearch</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Graph.isIntervalGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isIntervalGraph">[docs]</a>
    <span class="k">def</span> <span class="nf">isIntervalGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the graph self is triangulated and</span>
<span class="sd">        its dual is a comparability graph.</span>

<span class="sd">        *Source*: M. Ch. Golumbic (2004) Algorithmic Graph Thery and Perfect Graphs,</span>
<span class="sd">        Annals of Discrete Mathematics 57, Elsevier, p. 16.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isTriangulated</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is triangulated.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">isComparabilityGraph</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is transitively orientable.&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&gt; Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is an interval graph.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is not transitively orientable.&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is not triangulated&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Graph.isPermutationGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isPermutationGraph">[docs]</a>
    <span class="k">def</span> <span class="nf">isPermutationGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the graph self and</span>
<span class="sd">        its dual are comparability graphs.</span>

<span class="sd">        *Source*: M. Ch. Golumbic (2004) Algorithmic Graph Thery and Perfect Graphs,</span>
<span class="sd">        Annals of Discrete Mathematics 57, Elsevier, p. 16.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isComparabilityGraph</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is transitively orientable.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">isComparabilityGraph</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is transitively orientable.&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&gt; Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is a permutation graph.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is not transitively orientable.&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is not transitively orientable&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>

         
<div class="viewcode-block" id="Graph.isTree">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isTree">[docs]</a>
    <span class="k">def</span> <span class="nf">isTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if self is a tree by verifing the required number of</span>
<span class="sd">        edges: order-1; and the existence of leaves.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">m</span> <span class="o">!=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nbrOfLeaves</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="n">degreex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">degreex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># isolated vertex</span>
                    <span class="k">return</span> <span class="kc">False</span> 
                <span class="k">elif</span> <span class="n">degreex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">nbrOfLeaves</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">nbrOfLeaves</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># a cycle graph</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Graph.isTriangulated">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isTriangulated">[docs]</a>
    <span class="k">def</span> <span class="nf">isTriangulated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a graph contains no chordless cycle of</span>
<span class="sd">        length greater or equal to 4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeChordlessCycles</span><span class="p">()</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Graph.isSplitGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isSplitGraph">[docs]</a>
    <span class="k">def</span> <span class="nf">isSplitGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the graph &#39; *self* &#39; and its dual &#39; *-self* &#39; are</span>
<span class="sd">        triangulated graphs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isTriangulated</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is triangulated.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span>
            <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">isTriangulated</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is triangulated.&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&gt; Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is a split graph.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is not is not triangulated.&#39;</span> <span class="o">%</span> <span class="n">ds</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is not triangulated&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Graph.isPerfectGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.isPerfectGraph">[docs]</a>
    <span class="k">def</span> <span class="nf">isPerfectGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A graph *g* is perfect when neither *g*, nor *-g*, contain any chordless</span>
<span class="sd">        cycle of odd length.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cycles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeChordlessCycles</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="si">%s</span><span class="s1"> contains an odd chordless circuit!&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="n">cycles</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">computeChordlessCycles</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cycles</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The dual of graph </span><span class="si">%s</span><span class="s1"> contains an odd chordless circuit!&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph </span><span class="si">%s</span><span class="s1"> is perfect !&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
       
        <span class="k">return</span> <span class="kc">True</span></div>

    
                  
<div class="viewcode-block" id="Graph.randomDepthFirstSearch">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.randomDepthFirstSearch">[docs]</a>
    <span class="k">def</span> <span class="nf">randomDepthFirstSearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Depth first search through a graph in random order of the vertex keys.</span>

<span class="sd">        .. Note::</span>

<span class="sd">            The resulting spanning tree (or forest) is by far not uniformly selected</span>
<span class="sd">            among all possible trees. Spanning stars will indeed be much less</span>
<span class="sd">            probably selected then streight walks !</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        
        <span class="k">def</span> <span class="nf">visitVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Visits all followers of vertex x.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1">## self.date += 1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;startDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; dfs </span><span class="si">%s</span><span class="s1">, date = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">),</span>  <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;startDate&#39;</span><span class="p">]))</span>
            <span class="n">nextVertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
            <span class="n">nextVertices</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   next &#39;</span><span class="p">,</span> <span class="n">nextVertices</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">nextVertices</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">nextVertices</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">visitVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">nextVertices</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;endDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">def</span> <span class="nf">visitAllVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Mark the starting date for all vertices</span>
<span class="sd">            and controls the progress of the search with vertices colors:</span>
<span class="sd">            White (0), Grey (1), Black (2)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
            <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">verticesList</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt; Starting from </span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
                    <span class="n">visitVertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dfsx</span><span class="p">)</span>
                <span class="n">verticesList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


        <span class="c1"># ---- main -----</span>
        <span class="n">visitAllVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span></div>


<div class="viewcode-block" id="Graph.recodeValuation">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.recodeValuation">[docs]</a>
    <span class="k">def</span> <span class="nf">recodeValuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">newMin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">newMax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recodes the characteristic valuation domain according</span>
<span class="sd">        to the parameters given.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Default values gives a normalized valuation domain</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">oldMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">oldMin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">oldMed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>

        <span class="n">oldAmplitude</span> <span class="o">=</span> <span class="n">oldMax</span> <span class="o">-</span> <span class="n">oldMin</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">oldMin</span><span class="p">,</span> <span class="n">oldMed</span><span class="p">,</span> <span class="n">oldMax</span><span class="p">,</span> <span class="n">oldAmplitude</span><span class="p">)</span>

        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">2.</span><span class="si">%d</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
        <span class="n">newMin</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">newMin</span><span class="p">))</span>
        <span class="n">newMax</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">newMax</span><span class="p">))</span>
        <span class="n">newMed</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">((</span><span class="n">newMax</span> <span class="o">+</span> <span class="n">newMin</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)))</span>

        <span class="n">newAmplitude</span> <span class="o">=</span> <span class="n">newMax</span> <span class="o">-</span> <span class="n">newMin</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">newMin</span><span class="p">,</span> <span class="n">newMed</span><span class="p">,</span> <span class="n">newMax</span><span class="p">,</span> <span class="n">newAmplitude</span><span class="p">)</span>

        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">oldEdges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">newEdges</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">oldEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldMax</span><span class="p">:</span>
                    <span class="n">newEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="n">newMax</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">oldEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldMin</span><span class="p">:</span>
                    <span class="n">newEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="n">newMin</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">oldEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldMed</span><span class="p">:</span>
                    <span class="n">newEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="n">newMed</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">newMin</span> <span class="o">+</span> <span class="p">((</span><span class="n">oldEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">-</span> <span class="n">oldMin</span><span class="p">)</span><span class="o">/</span><span class="n">oldAmplitude</span><span class="p">)</span><span class="o">*</span><span class="n">newAmplitude</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span><span class="n">oldEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">],</span><span class="n">newEdges</span><span class="p">[</span><span class="n">edge</span><span class="p">])</span>
        <span class="c1"># install new values in self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMed</span>
        <span class="k">if</span> <span class="n">ndigits</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">newEdges</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graph.save">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempGraph&#39;</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistent storage of a Graph class instance in the form of a python source code file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving graph in file: &lt;&#39;</span> <span class="o">+</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1">#order = len(self.vertices)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Graph instance saved in Python format</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;vertices = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;valuationDomain = {</span><span class="se">\&#39;</span><span class="s2">min</span><span class="se">\&#39;</span><span class="s2">: Decimal(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">),</span><span class="se">\&#39;</span><span class="s2">med</span><span class="se">\&#39;</span><span class="s2">: Decimal(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">),</span><span class="se">\&#39;</span><span class="s2">max</span><span class="se">\&#39;</span><span class="s2">: Decimal(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">)}</span><span class="se">\n</span><span class="s2">&quot;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Min</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">Med</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">Max</span><span class="p">)</span> <span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;edges = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;frozenset([</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">,</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">]) : Decimal(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">),</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]))</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="Graph.setEdgeValue">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.setEdgeValue">[docs]</a>
    <span class="k">def</span> <span class="nf">setEdgeValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">edge</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper for updating the characteristic valuation of a Graph instance.</span>
<span class="sd">        The egde parameter consists in a pair of vertices;</span>
<span class="sd">        edge = (&#39;v1&#39;,&#39;v2&#39;) for instance.</span>
<span class="sd">        The new value must be in the limits of the valuation domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="c1"># check vertices&#39; existance</span>
        <span class="n">verticesIds</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">verticesIds</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">verticesIds</span><span class="p">):</span>
            <span class="c1">#self.showShort()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Error: edge </span><span class="si">%s</span><span class="s1"> not found !!!&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">edge</span><span class="p">))</span>
            <span class="k">return</span>         
        <span class="c1"># check new edge value</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">newValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">newValue</span> <span class="o">&gt;</span> <span class="n">Max</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">Min</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Error: edge value </span><span class="si">%s</span><span class="s1"> out of range !!!&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># set new value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">edge</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;edge </span><span class="si">%s</span><span class="s1"> put to value </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">edge</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)))</span></div>


    <span class="k">def</span> <span class="nf">showCliques</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeCliques</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="Graph.showEdgesCharacteristicValues">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.showEdgesCharacteristicValues">[docs]</a>
    <span class="k">def</span> <span class="nf">showEdgesCharacteristicValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the edge links of the bipartite graph instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">IntegerValuation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;IntegerValuation&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">IntegerValuation</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">|&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--------|--------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   &#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39; | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">verticesKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">IntegerValuation</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%+d</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">+2.</span><span class="si">%d</span><span class="s1">f</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">IntegerValuation</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valuation domain: [</span><span class="si">%+d</span><span class="s1">;</span><span class="si">%+d</span><span class="s1">]&#39;</span><span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;Valuation domain: [</span><span class="si">%%</span><span class="s1">+2.</span><span class="si">%d</span><span class="s1">f;</span><span class="si">%%</span><span class="s1">+2.</span><span class="si">%d</span><span class="s1">f]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ndigits</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]))</span></div>



    <span class="k">def</span> <span class="nf">showMIS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeMIS</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="Graph.showMore">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.showMore">[docs]</a>
    <span class="k">def</span> <span class="nf">showMore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic show method for Graph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- Properties of the graph ----*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name             : </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">vKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">vKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vertices         : &#39;</span><span class="p">,</span> <span class="n">vKeys</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Order            : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showMIS</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCliques</span><span class="p">()</span></div>


<div class="viewcode-block" id="Graph.showShort">
<a class="viewcode-back" href="../techDoc.html#graphs.Graph.showShort">[docs]</a>
    <span class="k">def</span> <span class="nf">showShort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic show method for Graph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- short description of the graph ----*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name             : </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">vKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">vKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vertices         : &#39;</span><span class="p">,</span> <span class="n">vKeys</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valuation domain : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gamma function   : &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> -&gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeDegreeDistribution</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeNeighbourhoodDepthDistribution</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
</div>


<span class="c1">#----------------</span>

<div class="viewcode-block" id="EmptyGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.EmptyGraph">[docs]</a>
<span class="k">class</span> <span class="nc">EmptyGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Intantiates graph of given order without any positively valued edge.</span>

<span class="sd">    *Parameter*:</span>
<span class="sd">        * order (positive integer)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;emptyGraph&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="CompleteGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.CompleteGraph">[docs]</a>
<span class="k">class</span> <span class="nc">CompleteGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instances of complete graphs bipolarly valuated in {-1,0,+1}.</span>
<span class="sd">    Each vertex x is positively linked to</span>
<span class="sd">    all the other vertices (edges[frozenset({x,y})] = +1)</span>

<span class="sd">    *Parameter*:</span>
<span class="sd">        * *order* (positive integer)</span>
<span class="sd">        * *verticesKeys* is a list of vertex keys. When given, the *order*</span>
<span class="sd">          and the *verticesIdPrefix* parameters are ignored and</span>
<span class="sd">          the order is the length of the given list. </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">verticesKeys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">verticesIdPrefix</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;completeGraph&#39;</span>
        <span class="k">if</span> <span class="n">verticesKeys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
            <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">verticesIdPrefix</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span>
                                       <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># given list of vertices keys</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">vertexKey</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span>
                                       <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;given vertex&#39;</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<span class="c1">#-----------</span>

<div class="viewcode-block" id="BipartiteGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.BipartiteGraph">[docs]</a>
<span class="k">class</span> <span class="nc">BipartiteGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract root class for bipartite graph instances</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract class entry</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Abstract root class for bipartite graphs&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default description for bipartite graph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="s1">&#39;*------- Bipartite graph instance description ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name  : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Order          : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Size           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Part A size    : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysA</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Part B size    : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysB</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes     : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">reprString</span>

<div class="viewcode-block" id="BipartiteGraph.computeBestDeterminedMaximalMatching">
<a class="viewcode-back" href="../techDoc.html#graphs.BipartiteGraph.computeBestDeterminedMaximalMatching">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBestDeterminedMaximalMatching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Using the ranked pairs rule for assembling a best determined maximal matching</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">remainingAKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysA</span><span class="p">]</span>
        <span class="n">remainingBKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysB</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">remainingAKeys</span><span class="p">,</span><span class="n">remainingBKeys</span><span class="p">)</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">remainingAKeys</span><span class="p">)</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">remainingBKeys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">remainingAKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                     <span class="n">remainingBKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]})</span>
                <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">],</span><span class="n">edgeKey</span><span class="p">))</span>
        <span class="n">pairs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="n">lmatching</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">np</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">np</span><span class="p">:</span>
            <span class="n">edgeKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pairs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">edgeKeys</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">edgeKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">remainingAKeys</span> <span class="ow">and</span> <span class="n">edgeKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">remainingBKeys</span><span class="p">):</span>
                <span class="n">remainingAKeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edgeKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">remainingBKeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edgeKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">lmatching</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pairs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">edgeKeys</span><span class="p">,</span><span class="n">remainingAKeys</span><span class="p">,</span><span class="n">remainingBKeys</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">lmatching</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">edgeKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">remainingAKeys</span> <span class="ow">and</span> <span class="n">edgeKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">remainingBKeys</span><span class="p">):</span>
                <span class="n">remainingAKeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edgeKeys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">remainingBKeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edgeKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">lmatching</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pairs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">edgeKeys</span><span class="p">,</span><span class="n">remainingAKeys</span><span class="p">,</span><span class="n">remainingBKeys</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">lmatching</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lmatching</span><span class="p">),</span><span class="n">lmatching</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">lmatching</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="BipartiteGraph.showEdgesCharacteristicValues">
<a class="viewcode-back" href="../techDoc.html#graphs.BipartiteGraph.showEdgesCharacteristicValues">[docs]</a>
    <span class="k">def</span> <span class="nf">showEdgesCharacteristicValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the edge links of the bipartite graph instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysA</span><span class="p">]</span>
        <span class="n">bKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysB</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">IntegerValuation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;IntegerValuation&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">IntegerValuation</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">|&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">bKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="s2">&quot;&#39;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--------|--------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">aKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   &#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39; | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">bKeys</span><span class="p">:</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">IntegerValuation</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%+d</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">+2.</span><span class="si">%d</span><span class="s1">f</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">IntegerValuation</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valuation domain: [</span><span class="si">%+d</span><span class="s1">;</span><span class="si">%+d</span><span class="s1">]&#39;</span><span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;Valuation domain: [</span><span class="si">%%</span><span class="s1">+2.</span><span class="si">%d</span><span class="s1">f;</span><span class="si">%%</span><span class="s1">+2.</span><span class="si">%d</span><span class="s1">f]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ndigits</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]))</span></div>


        
        
<div class="viewcode-block" id="BipartiteGraph.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.BipartiteGraph.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                              <span class="n">edgeColor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                              <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                              <span class="n">lineWidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                              <span class="n">Debug</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file  for bipartite graph drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">Akeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysA</span>
        <span class="n">Bkeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysB</span>
        <span class="n">vertexkeys</span> <span class="o">=</span> <span class="n">Akeys</span> <span class="o">+</span> <span class="n">Bkeys</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">matching</span> <span class="o">=</span> <span class="p">[</span><span class="n">edgeKey</span> <span class="k">for</span> <span class="n">edgeKey</span> <span class="ow">in</span> <span class="n">edges</span> <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">matching</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2023&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;splines=false;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;node[shape=circle]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;edge[color=</span><span class="si">%s</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">edgeColor</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;subgraph cluster_1r {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Akeys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> [label=&quot;</span><span class="si">%s</span><span class="s1">&quot;,fillcolor=white]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Akeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Akeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1">--&#39;</span> <span class="o">%</span> <span class="n">Akeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> [style=invis]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Akeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  label = &quot;part A&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  color = white</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;subgraph cluster_1l {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Bkeys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> [label=&quot;</span><span class="si">%s</span><span class="s1">&quot;,fillcolor=white]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Bkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Bkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1">--&#39;</span> <span class="o">%</span> <span class="n">Bkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> [style=invis]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Bkeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  label = &quot;part B&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  color = white</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matching</span><span class="p">:</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">pair</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">--</span><span class="si">%s</span><span class="s1"> [constraint=false]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="s2">&quot;dot&quot;</span>
            
        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> -T</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> -o </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">layout</span><span class="p">,</span><span class="n">graphType</span><span class="p">,</span><span class="n">dotName</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">graphType</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">system</span>
            <span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;On Ubuntu: ..$ sudo apt-get install graphviz&#39;</span><span class="p">)</span></div>
</div>

    

<div class="viewcode-block" id="CompleteBipartiteGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.CompleteBipartiteGraph">[docs]</a>
<span class="k">class</span> <span class="nc">CompleteBipartiteGraph</span><span class="p">(</span><span class="n">BipartiteGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instances of complete bipartite graphs bipolarly valuated in {-1,0,+1}.</span>
<span class="sd">    Each vertex x in part *A* is positively linked to each vertex y in part *B*,</span>
<span class="sd">    i.e edges[frozenset({x,y})] = +1 for all *x* in part *A* and all *y* in part *B*.</span>

<span class="sd">    *Parameter*:</span>
<span class="sd">        * *verticesKeysA* is the list of vertex keys of part *A*</span>
<span class="sd">        * *verticesKeysB* is the list of vertex keys of part *B* </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verticesKeysA</span><span class="p">,</span><span class="n">verticesKeysB</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;bipartiteGraph&#39;</span>
        <span class="c1"># vertices </span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesKeysA</span><span class="p">:</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">,</span>
                                       <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;vertex of part A&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesKeysB</span><span class="p">:</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">,</span>
                                       <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;vertex of part B&#39;</span><span class="p">}</span>            
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysA</span> <span class="o">=</span> <span class="n">verticesKeysA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticesKeysB</span> <span class="o">=</span> <span class="n">verticesKeysB</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="c1"># valuation domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>                  
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">verticesKeysA</span><span class="p">)</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">verticesKeysB</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesKeysA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">verticesKeysB</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<span class="c1">##    def exportPairingGraphViz(self,fileName=None,</span>
<span class="c1">##                              Comments=True,</span>
<span class="c1">##                              graphType=&#39;png&#39;,graphSize=&#39;7,7&#39;,</span>
<span class="c1">##                              edgeColor=&#39;blue&#39;,</span>
<span class="c1">##                              bgcolor=&#39;cornsilk&#39;,</span>
<span class="c1">##                              lineWidth=1,</span>
<span class="c1">##                              Debug=True):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Exports GraphViz dot file  for bipartite graph drawing filtering.</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        import os</span>
<span class="c1">##        if Comments:</span>
<span class="c1">##            print(&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;)</span>
<span class="c1">##        Akeys = self.verticesKeysA</span>
<span class="c1">##        Bkeys = self.verticesKeysB</span>
<span class="c1">##        vertexkeys = Akeys + Bkeys</span>
<span class="c1">##        n = len(vertexkeys)</span>
<span class="c1">##        Med = self.valuationDomain[&#39;med&#39;]</span>
<span class="c1">##        edges = self.edges</span>
<span class="c1">##        matching = [edgeKey for edgeKey in edges if edges[edgeKey] &gt; Med]</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(matching)</span>
<span class="c1">##        i = 0</span>
<span class="c1">##        if fileName is None:</span>
<span class="c1">##            name = self.name</span>
<span class="c1">##        else:</span>
<span class="c1">##            name = fileName</span>
<span class="c1">##        dotName = name+&#39;.dot&#39;</span>
<span class="c1">##        if Comments:</span>
<span class="c1">##            print(&#39;Exporting to &#39;+dotName)</span>
<span class="c1">##        fo = open(dotName,&#39;w&#39;)</span>
<span class="c1">##        fo.write(&#39;graph G {\n&#39;)</span>
<span class="c1">##        if bgcolor is not None:</span>
<span class="c1">##            fo.write(&#39;graph [ bgcolor = %s, fontname = &quot;Helvetica-Oblique&quot;,\n fontsize = 12,\n label = &quot;&#39; % (bgcolor) )</span>
<span class="c1">##        else:</span>
<span class="c1">##            fo.write(&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,\n fontsize = 12,\n label = &quot;&#39;)</span>
<span class="c1">##        fo.write(&#39;\\nDigraph3 (graphviz), R. Bisdorff, 2023&quot;, size=&quot;&#39;)</span>
<span class="c1">##        fo.write(graphSize),fo.write(&#39;&quot;];\n&#39;)</span>
<span class="c1">##        fo.write(&#39;splines=false;\n&#39;)</span>
<span class="c1">##        fo.write(&#39;node[shape=circle]\n&#39;)</span>
<span class="c1">##        fo.write(&#39;edge[color=%s]\n&#39; % edgeColor)</span>
<span class="c1">##</span>
<span class="c1">##        fo.write(&#39;subgraph cluster_1r {\n&#39;)</span>
<span class="c1">##        n = len(Akeys)</span>
<span class="c1">##        for i in range(n):</span>
<span class="c1">##            fo.write(&#39;  %s [label=&quot;%s&quot;,fillcolor=white]\n&#39; % (Akeys[i],Akeys[i]) )</span>
<span class="c1">##        for i in range(n-1):</span>
<span class="c1">##            fo.write(&#39;  %s--&#39; % Akeys[i])</span>
<span class="c1">##        fo.write(&#39;  %s [style=invis]\n&#39; % (Akeys[n-1]) )</span>
<span class="c1">##        fo.write(&#39;  label = &quot;group A&quot;\n&#39;)</span>
<span class="c1">##        fo.write(&#39;  color = white\n&#39;)</span>
<span class="c1">##        fo.write(&#39;}\n&#39;)</span>
<span class="c1">##        </span>
<span class="c1">##        fo.write(&#39;subgraph cluster_1l {\n&#39;)</span>
<span class="c1">##        n = len(Bkeys)</span>
<span class="c1">##        for i in range(n):</span>
<span class="c1">##            fo.write(&#39;  %s [label=&quot;%s&quot;,fillcolor=white]\n&#39; % (Bkeys[i],Bkeys[i]) )</span>
<span class="c1">##        for i in range(n-1):</span>
<span class="c1">##            fo.write(&#39;  %s--&#39; % Bkeys[i])</span>
<span class="c1">##        fo.write(&#39; %s [style=invis]\n&#39; % Bkeys[n-1] )</span>
<span class="c1">##        fo.write(&#39;  label = &quot;group B&quot;\n&#39;)</span>
<span class="c1">##        fo.write(&#39;  color = white\n&#39;)</span>
<span class="c1">##        </span>
<span class="c1">##        fo.write(&#39;}\n&#39;)</span>
<span class="c1">##</span>
<span class="c1">##        for m in matching:</span>
<span class="c1">##            pair = list(m)</span>
<span class="c1">##            pair.sort()</span>
<span class="c1">##            fo.write(&#39;%s--%s [constraint=false]\n&#39; % (pair[0],pair[1]))</span>
<span class="c1">##        fo.write(&#39;}\n&#39;)</span>
<span class="c1">##</span>
<span class="c1">##        fo.close()</span>
<span class="c1">##        layout = &quot;dot&quot;</span>
<span class="c1">##            </span>
<span class="c1">##        commandString = &#39;%s -T%s %s -o %s.%s&#39; % (layout,graphType,dotName,name,graphType)</span>
<span class="c1">##        if Comments:</span>
<span class="c1">##            print(commandString)</span>
<span class="c1">##        try:</span>
<span class="c1">##            from os import system</span>
<span class="c1">##            system(commandString)</span>
<span class="c1">##        except:</span>
<span class="c1">##            if Comments:</span>
<span class="c1">##                print(&#39;graphViz tools not avalaible! Please check installation.&#39;)</span>
<span class="c1">##                print(&#39;On Ubuntu: ..$ sudo apt-get install graphviz&#39;)</span>


<div class="viewcode-block" id="DualGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.DualGraph">[docs]</a>
<span class="k">class</span> <span class="nc">DualGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates the dual Graph object of a given other Graph instance.</span>

<span class="sd">    The relation constructor returns the dual of self.relation with formula:</span>
<span class="sd">        relationOut[a][b] = Max - self.relation[a][b] + Min</span>
<span class="sd">        where Max (resp. Min) equals valuation maximum (resp. minimum).</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;dual_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>  <span class="c1"># the dual of a PermutationGraph reverses the permutation</span>
            <span class="n">permutation</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">permutation</span><span class="p">)</span>
            <span class="n">permutation</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="CycleGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.CycleGraph">[docs]</a>
<span class="k">class</span> <span class="nc">CycleGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instances of cycle graph characterized in [-1,1].</span>

<span class="sd">    *Parameter*:</span>
<span class="sd">        * order (positive integer)</span>

<span class="sd">    Example of 7-cycle graph instance:</span>

<span class="sd">    .. image:: 7cycle.png</span>
<span class="sd">       :alt: 7-cycle instance</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;cycleGraph&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1">#verticesList = [v for v in vertices]</span>
        <span class="c1">#verticesList.sort()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">edgeKey</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
        <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">edgeKey</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="IntervalIntersectionsGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.IntervalIntersectionsGraph">[docs]</a>
<span class="k">class</span> <span class="nc">IntervalIntersectionsGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inveral graph constructed from a list of *n*</span>
<span class="sd">    intervals, ie pairs (a,b) of integer numbers where a &lt; b.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">intervals</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;lineIntersections&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="n">intervals</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="c1">#verticesList.sort()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">intervals</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">:</span> 
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;=&gt;&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;=&gt;&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c</span> <span class="o">&lt;=</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;=&gt;&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="n">a</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;=&gt;&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;=&gt;&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
                 
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a,b,c,d,edgeKey,edges[edgeKey]&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">edgeKey</span><span class="p">,</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomIntervalIntersectionsGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomIntervalIntersectionsGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomIntervalIntersectionsGraph</span><span class="p">(</span><span class="n">IntervalIntersectionsGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Random generator for IntervalIntersectionsGraph intances.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randIntervalIntersections&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">intervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">intervals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">intervals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intervals</span> <span class="o">=</span> <span class="n">intervals</span>
        <span class="n">lis</span> <span class="o">=</span> <span class="n">IntervalIntersectionsGraph</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">lis</span><span class="o">.</span><span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">lis</span><span class="o">.</span><span class="n">valuationDomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">lis</span><span class="o">.</span><span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="RandomGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random instances of the Graph class</span>

<span class="sd">    *Parameters*:</span>
<span class="sd">        * order (positive integer)</span>
<span class="sd">        * edgeProbability (in [0,1])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">edgeProbability</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edgeProbability</span> <span class="o">=</span> <span class="n">edgeProbability</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomGraph&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="c1">#verticesList.sort()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">edgeProbability</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomValuationGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomValuationGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomValuationGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the genuine Graph class for generating temporary</span>
<span class="sd">    randomly valuated graphs in the range [-1.0;1.0].</span>
<span class="sd">    </span>
<span class="sd">    *Parameter*:</span>
<span class="sd">        * order (positive integer)</span>
<span class="sd">        * ndigits (decimal precision) </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomGraph&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">])</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                <span class="n">weightString</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span><span class="p">)</span> <span class="o">%</span>  <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">Min</span><span class="p">,</span><span class="n">Max</span><span class="p">)</span>
                <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">weightString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomRegularGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomRegularGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomRegularGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the general Graph class for generating</span>
<span class="sd">    temporary random regular graphs of fixed degrees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">randomDigraphs</span> <span class="kn">import</span> <span class="n">RandomRegularDigraph</span>
        <span class="n">rdg</span> <span class="o">=</span> <span class="n">RandomRegularDigraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                                   <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span>
                                   <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">rg</span> <span class="o">=</span> <span class="n">rdg</span><span class="o">.</span><span class="n">digraph2Graph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">valuationDomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomRegularGraph&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomFixedSizeGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomFixedSizeGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomFixedSizeGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a random graph with a fixed size (number of edges), by instantiating a fixed numbers of arcs</span>
<span class="sd">    from random choices in the set of potential pairs of vertices numbered from 1 to order. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="c1"># check feasability</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">((</span><span class="n">order</span> <span class="o">*</span> <span class="n">order</span><span class="p">)</span> <span class="o">-</span> <span class="n">order</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="n">r</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graph not feasable: size exceeds number of potential edges = </span><span class="si">%d</span><span class="s1"> !!&#39;</span> <span class="o">%</span> <span class="n">r</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomFixedSize&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">vertexKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;v</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="n">nd</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">vertexKey</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        <span class="n">edgesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">]</span>
        <span class="n">edgesKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">edgesKeys</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">edgesKeys</span><span class="p">)</span>
                <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="n">edgesKeys</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">edgeKey</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">edgeKey</span><span class="p">,</span><span class="n">edgesKeys</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RandomFixedDegreeSequenceGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomFixedDegreeSequenceGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomFixedDegreeSequenceGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the general Graph class for generating</span>
<span class="sd">    temporary random graphs with a fixed sequence of degrees.</span>

<span class="sd">    .. warning::</span>

<span class="sd">        The implementation is not guaranteeing a uniform choice</span>
<span class="sd">        among all potential valid graph instances.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">degreeSequence</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">randomDigraphs</span> <span class="kn">import</span> <span class="n">RandomFixedDegreeSequenceDigraph</span>
        <span class="n">rdg</span> <span class="o">=</span> <span class="n">RandomFixedDegreeSequenceDigraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                                               <span class="n">degreeSequence</span><span class="o">=</span><span class="n">degreeSequence</span><span class="p">,</span>
                                               <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">rg</span> <span class="o">=</span> <span class="n">rdg</span><span class="o">.</span><span class="n">digraph2Graph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">valuationDomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomFixedDegreeSequenceGraph&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="GridGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.GridGraph">[docs]</a>
<span class="k">class</span> <span class="nc">GridGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the general Graph class for generating</span>
<span class="sd">    temporary Grid graphs of dimension n times m.</span>

<span class="sd">    *Parameters*:</span>
<span class="sd">        * n,m &gt; 0</span>
<span class="sd">        * valuationDomain ={&#39;min&#39;:-1, &#39;med&#39;:0, &#39;max&#39;:+1}</span>

<span class="sd">    Default instantiation (5 times 5 Grid Digraph):</span>
<span class="sd">       * n = 5,</span>
<span class="sd">       * m=5,</span>
<span class="sd">       * valuationDomain = {&#39;min&#39;:-1.0,&#39;max&#39;:1.0}.</span>

<span class="sd">    Example of 5x5 GridGraph instance:</span>

<span class="sd">    .. image:: grid-5-5.png</span>
<span class="sd">       :alt: 5x5 grid instance</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">valuationMin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">valuationMax</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;grid-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">na</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ma</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ma</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gridNodes</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">na</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ma</span><span class="p">:</span>
                <span class="n">vertex</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">gridNodes</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gridnode&#39;</span><span class="p">,</span> <span class="s1">&#39;shortName&#39;</span><span class="p">:</span> <span class="n">vertex</span><span class="p">}</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridNodes</span> <span class="o">=</span> <span class="n">gridNodes</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">valuationMin</span><span class="p">))</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">valuationMax</span><span class="p">))</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">Max</span> <span class="o">+</span> <span class="n">Min</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Min</span><span class="p">,</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Med</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">}</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># instantiate edges</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>

<div class="viewcode-block" id="GridGraph.showShort">
<a class="viewcode-back" href="../techDoc.html#graphs.GridGraph.showShort">[docs]</a>
    <span class="k">def</span> <span class="nf">showShort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- show short --------------*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Grid graph    : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n             : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m             : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;order         : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;size          : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></div>
</div>


<span class="c1">#--------------------------</span>
<div class="viewcode-block" id="SnakeGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.SnakeGraph">[docs]</a>
<span class="k">class</span> <span class="nc">SnakeGraph</span><span class="p">(</span><span class="n">GridGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Snake graphs S(p/q) are made up of all the integer grid squares between</span>
<span class="sd">    the lower and upper Christofel paths of the rational number p/q, </span>
<span class="sd">    where p and q are two coprime integers such that</span>
<span class="sd">    0 &lt;= p &lt;= q, i.e. p/q gives an irreducible ratio between 0 and 1.</span>
<span class="sd">    </span>
<span class="sd">    *Reference*: M. Aigner,</span>
<span class="sd">    Markov&#39;s Theorem and 100 Years of the Uniqueness Conjecture, Springer, 2013, p. 141-149</span>

<span class="sd">    S(4/7) snake graph instance::</span>
<span class="sd">    </span>
<span class="sd">        &gt;&gt;&gt; from graphs import SnakeGraph</span>
<span class="sd">        &gt;&gt;&gt; s4_7 = SnakeGraph(p=4,q=7)</span>
<span class="sd">        &gt;&gt;&gt; s4_7.showShort()</span>
<span class="sd">        *---- short description of the snake graph ----*</span>
<span class="sd">        Name             : &#39;snakeGraph&#39;</span>
<span class="sd">        Rational p/q     : 4/7</span>
<span class="sd">        Christoffel words:</span>
<span class="sd">        Upper word       :  BBABABA</span>
<span class="sd">        Lower word       :  ABABABB</span>
<span class="sd">        &gt;&gt;&gt; s4_7.exportGraphViz(&#39;4_7_snake&#39;,lineWidth=3,arcColor=&#39;red&#39;)</span>

<span class="sd">    .. image:: 4_7_snake.png</span>
<span class="sd">       :alt: 4/7 snake graph instance</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span><span class="p">,</span> <span class="n">ceil</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">_</span><span class="si">%d</span><span class="s1">_snakeGraph&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="c1"># vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">q</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gridNodes</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">vertex</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">gridNodes</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gridnode&#39;</span><span class="p">,</span> <span class="s1">&#39;shortName&#39;</span><span class="p">:</span> <span class="n">vertex</span><span class="p">}</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridNodes</span> <span class="o">=</span> <span class="n">gridNodes</span>
        <span class="c1"># valuation domain</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span>
                                <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span>
                                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">Max</span><span class="p">}</span>
        <span class="c1"># edges</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># instantiate edges</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Med</span>
                        <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Med</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Med</span>
                        <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Med</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="c1"># snake lower Christoffel path</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">floor</span><span class="p">((</span><span class="n">p</span><span class="o">/</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEdgeValue</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Max</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEdgeValue</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Max</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEdgeValue</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Max</span><span class="p">)</span>
        <span class="c1"># snake upper  Christoffel path</span>
        <span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">p</span><span class="o">/</span><span class="n">q</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEdgeValue</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Max</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEdgeValue</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Max</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setEdgeValue</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">Max</span><span class="p">)</span>                
                    
        <span class="c1"># storing graph instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>

        <span class="c1"># ChristoffelWord</span>
        <span class="n">lcw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">ucw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">lcw</span> <span class="o">+=</span> <span class="s1">&#39;A&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lcw</span> <span class="o">+=</span> <span class="s1">&#39;B&#39;</span>
            <span class="k">if</span> <span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">K</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ucw</span> <span class="o">+=</span> <span class="s1">&#39;A&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ucw</span> <span class="o">+=</span> <span class="s1">&#39;B&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cw</span> <span class="o">=</span> <span class="p">(</span><span class="n">lcw</span><span class="p">,</span><span class="n">ucw</span><span class="p">)</span>

<div class="viewcode-block" id="SnakeGraph.showShort">
<a class="viewcode-back" href="../techDoc.html#graphs.SnakeGraph.showShort">[docs]</a>
    <span class="k">def</span> <span class="nf">showShort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WithVertices</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for SnakeGraph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- short description of the snake graph ----*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name             : </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rational p/q     : </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Christoffel words:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Upper word       : &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cw</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lower word       : &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cw</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">WithVertices</span><span class="p">:</span>
            <span class="n">vKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
            <span class="n">vKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Vertices         : &#39;</span><span class="p">,</span> <span class="n">vKeys</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valuation domain : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gamma function   : &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> -&gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span></div>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for SnakeGraph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;*---- Snake graph specific data ----*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1">#reprString += &#39;Name             : \&#39;%s\&#39;\n&#39; % (self.name)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Rational p/q     : </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Christoffel words:</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Upper word       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Lower word       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">reprString</span></div>

        
<span class="c1">#---------------------</span>
<div class="viewcode-block" id="TriangulatedGrid">
<a class="viewcode-back" href="../techDoc.html#graphs.TriangulatedGrid">[docs]</a>
<span class="k">class</span> <span class="nc">TriangulatedGrid</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the general Graph class for generating</span>
<span class="sd">    temporary triangulated grids of dimension n times m.</span>

<span class="sd">    *Parameters*:</span>
<span class="sd">        * n,m &gt; 0</span>
<span class="sd">        * valuationDomain = {&#39;min&#39;:m, &#39;max&#39;:M}</span>

<span class="sd">    Example of 5x5 triangulated grid instance:</span>

<span class="sd">    .. image:: triangular-5-5.png</span>
<span class="sd">       :alt: triangulated 5x5 grid</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">valuationMin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">valuationMax</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;triangulated-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">na</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ma</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ma</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gridNodes</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">na</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ma</span><span class="p">:</span>
                <span class="n">vertex</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">gridNodes</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gridnode&#39;</span><span class="p">,</span> <span class="s1">&#39;shortName&#39;</span><span class="p">:</span> <span class="n">vertex</span><span class="p">}</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gridNodes</span> <span class="o">=</span> <span class="n">gridNodes</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">valuationMin</span><span class="p">))</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">valuationMax</span><span class="p">))</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">((</span><span class="n">Max</span> <span class="o">+</span> <span class="n">Min</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Min</span><span class="p">,</span><span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Med</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">}</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># instantiate edges</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">elif</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">gridNodes</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">=</span> <span class="n">Min</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>

<div class="viewcode-block" id="TriangulatedGrid.showShort">
<a class="viewcode-back" href="../techDoc.html#graphs.TriangulatedGrid.showShort">[docs]</a>
    <span class="k">def</span> <span class="nf">showShort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- show summary --------------*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Triangular graph : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n x m            : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;order            : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;size             : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></div>
</div>


<span class="c1"># --------------------</span>

<div class="viewcode-block" id="TreeGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.TreeGraph">[docs]</a>
<span class="k">class</span> <span class="nc">TreeGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tree graphs generated from a given Prfer code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for Tree instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prueferCode</span>
            <span class="n">reprString</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;*---- Tree specific data ----*</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Prfer code  : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">code</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reprString</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">graph</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">graphs</span> <span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">TreeGraph</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span><span class="n">Graph</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">graph</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a tree graph instance must be given !&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">isTree</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">TreeGraph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prueferCode</span> <span class="o">=</span> <span class="n">TreeGraph</span><span class="o">.</span><span class="n">tree2Pruefer</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">gamma</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the provided graph instance is not a tree!&#39;</span><span class="p">)</span>
         
<div class="viewcode-block" id="TreeGraph.tree2Pruefer">
<a class="viewcode-back" href="../techDoc.html#graphs.TreeGraph.tree2Pruefer">[docs]</a>
    <span class="k">def</span> <span class="nf">tree2Pruefer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the Pruefer code of a given tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">vertices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;verticesList = &#39;</span><span class="p">,</span><span class="n">verticesList</span><span class="p">)</span>
        <span class="n">np</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">]</span>
        <span class="n">degree</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="n">degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;degrees = &#39;</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
        <span class="n">prueferCode</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">):</span>
            <span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verticesList</span> <span class="k">if</span> <span class="n">degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">leaves</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">leavesEdges</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span> <span class="k">if</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">e</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">leavesEdges</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">prueferCode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">degree</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">edges</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">leavesEdges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">prueferCode</span></div>


<div class="viewcode-block" id="TreeGraph.computeTreeCenters">
<a class="viewcode-back" href="../techDoc.html#graphs.TreeGraph.computeTreeCenters">[docs]</a>
    <span class="k">def</span> <span class="nf">computeTreeCenters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the centre(s) of the tree, i.e. the vertices with minimal maximal neighbourhood depths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph2Digraph</span><span class="p">()</span>
        <span class="n">centers</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">computeDigraphCentres</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">centers</span></div>


<div class="viewcode-block" id="TreeGraph.tree2OrientedTree">
<a class="viewcode-back" href="../techDoc.html#graphs.TreeGraph.tree2OrientedTree">[docs]</a>
    <span class="k">def</span> <span class="nf">tree2OrientedTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a TreeGraph object into a rooted and oriented tree digraph.</span>

<span class="sd">        When *root* == *None*, the first in alphabetic order of the tree centre(s) is chosen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#from copy import deepcopy</span>
        <span class="c1">#from digraphs import Digraph</span>
        <span class="n">dg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph2Digraph</span><span class="p">()</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;orientedTree&#39;</span>
        <span class="c1">#Max = dg.valuationdomain[&#39;max&#39;]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>  
        <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">centres</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">computeDigraphCentres</span><span class="p">()</span>
            <span class="n">centralKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">centres</span><span class="p">]</span>
            <span class="n">centralKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">centralKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">root</span><span class="o">=</span><span class="n">root</span>
        <span class="n">rootFollowers</span> <span class="o">=</span> <span class="p">[(</span><span class="n">root</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">root</span><span class="p">]))]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rootFollowers</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">rootFollowers</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rootFollowers</span><span class="p">:</span>
                <span class="n">xFollowers</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">xFollowers</span><span class="p">:</span>
                    <span class="n">dg</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="n">yFollowers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
                    <span class="n">yFollowers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">yFollowers</span> <span class="o">!=</span> <span class="p">[]:</span>
                        <span class="n">rootFollowers</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">yFollowers</span><span class="p">))</span>
                <span class="n">rootFollowers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">rootFollowers</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">dg</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dg</span> </div>


<div class="viewcode-block" id="TreeGraph.exportOrientedTreeGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.TreeGraph.exportOrientedTreeGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportOrientedTreeGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;downward&#39;</span><span class="p">,</span>
                                   <span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                                   <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                                   <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                   <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graphviz drawing of the rooted and oriented tree.</span>

<span class="sd">        When *root* == *None*, the first in alphabetic order of the tree centre(s) is chosen. If *direction* = &#39;best&#39;, the tree grows downwards, otherwise it grows upwards.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="n">TransitiveDigraph</span>
        
        <span class="n">dg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree2OrientedTree</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">)</span>
        <span class="n">dg</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">()</span>
        <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                                         <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                                         <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                                         <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                                         <span class="n">fontSize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">,</span>
                                         <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span></div>
</div>

<span class="c1"># -------------------</span>
<div class="viewcode-block" id="RandomTree">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomTree">[docs]</a>
<span class="k">class</span> <span class="nc">RandomTree</span><span class="p">(</span><span class="n">TreeGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instance of a tree generated from a random Prfer code.</span>

<span class="sd">    .. image:: randomTree.png</span>
<span class="sd">       :alt: radomTree instance</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">   </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for RandomTree instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prueferCode</span>
            <span class="n">reprString</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;*---- RandomTree specific data ----*</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Prfer code  : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">code</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reprString</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">prueferCode</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;randomTree&#39;</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prueferCode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prueferCode</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vertices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="n">vertexKey</span> <span class="o">=</span> <span class="s1">&#39;v</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">vertexKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span><span class="n">vertexKey</span><span class="p">),</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;random vertex&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vertices = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;valuationDomain = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>


        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="p">):</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
                <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;edges = &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prueferCode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prueferCode</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">prueferCode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prueferCode</span> <span class="o">=</span> <span class="n">prueferCode</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;prueferCode = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prueferCode</span><span class="p">)</span>

        <span class="n">degree</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="n">degree</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">degree</span><span class="p">[</span><span class="n">prueferCode</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;degrees = &#39;</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">degree</span><span class="p">[</span><span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">prueferCode</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">degree</span><span class="p">[</span><span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">degree</span><span class="p">[</span><span class="n">prueferCode</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">break</span>
        <span class="n">lastEdgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="k">if</span> <span class="n">degree</span><span class="p">[</span><span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">lastEdgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updated edges = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">(</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span></div>


 
<span class="c1">#------------------------</span>

<div class="viewcode-block" id="RandomSpanningForest">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomSpanningForest">[docs]</a>
<span class="k">class</span> <span class="nc">RandomSpanningForest</span><span class="p">(</span><span class="n">RandomTree</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Random instance of a spanning forest (one or more trees)</span>
<span class="sd">    generated from a random depth first search graph g traversal.</span>

<span class="sd">    .. image:: spanningForest.png</span>
<span class="sd">       :alt: randomSpanningForest instance</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_randomSpanningTree&#39;</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;valuationDomain = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>

        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="p">):</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;edges = &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">randomDepthFirstSearch</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dfs = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">)</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">component</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">component</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tree = &#39;</span><span class="p">,</span><span class="n">tree</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;component = &#39;</span><span class="p">,</span><span class="n">component</span><span class="p">)</span>
            <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;updated edges = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
   
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">(</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>

        <span class="n">prueferCodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">component</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">prueferCodes</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;component&#39;</span><span class="p">:</span> <span class="n">component</span><span class="p">,</span>
                                 <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree2Pruefer</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">component</span><span class="p">)</span>
                                 <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prueferCodes</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;component&#39;</span><span class="p">:</span> <span class="n">component</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[]})</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">prueferCodes</span> <span class="o">=</span> <span class="n">prueferCodes</span>

<div class="viewcode-block" id="RandomSpanningForest.computeAverageTreeDetermination">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomSpanningForest.computeAverageTreeDetermination">[docs]</a>
    <span class="k">def</span> <span class="nf">computeAverageTreeDetermination</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dfs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the mean average determinations of the spanning trees.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="k">if</span> <span class="n">dfs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span>
        <span class="n">maxWeights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">dfsx</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">maxWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfsx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">dfsx</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">dfsx</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
                    <span class="n">maxWeight</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span>
                <span class="n">maxWeights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">maxWeight</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">maxWeights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">averageTreeDetermination</span> <span class="o">=</span> <span class="n">maxWeights</span> 
        <span class="k">return</span>  </div>
</div>

        
<div class="viewcode-block" id="RandomSpanningTree">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomSpanningTree">[docs]</a>
<span class="k">class</span> <span class="nc">RandomSpanningTree</span><span class="p">(</span><span class="n">RandomTree</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uniform random instance of a spanning tree</span>
<span class="sd">    generated with Wilson&#39;s algorithm from a connected Graph g instance.</span>

<span class="sd">    .. Note::</span>

<span class="sd">         Wilson&#39;s algorithm only works for connecte graphs.</span>

<span class="sd">    .. image:: randomSpanningTree.png</span>
<span class="sd">       :alt: randomSpanningTree instance</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">copy</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">isConnected</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !: Wilson</span><span class="se">\&#39;</span><span class="s1">s algorithm requires a connected graph!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_randomSpanningTree&#39;</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;valuationDomain = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span>
        <span class="n">spannedVertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">spanningTree</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">randomWalk</span> <span class="o">=</span> <span class="p">[</span><span class="n">verticesList</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">randomWalk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">verticesList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">nextVertex</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">randomWalk</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
            <span class="n">randomWalk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nextVertex</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;random walk: &#39;</span><span class="p">,</span><span class="n">randomWalk</span><span class="p">)</span>
        <span class="n">spanningBranch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduceCycles</span><span class="p">(</span><span class="n">randomWalk</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">spanningTree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spanningBranch</span><span class="p">)</span>
        <span class="n">spannedVertices</span> <span class="o">=</span> <span class="n">spannedVertices</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">spanningBranch</span><span class="p">)</span>
        <span class="n">remainingVertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">verticesList</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">spanningBranch</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spanningBranch = &#39;</span><span class="p">,</span> <span class="n">spanningBranch</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spannedVertices = &#39;</span><span class="p">,</span> <span class="n">spannedVertices</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;remainingVertices = &#39;</span><span class="p">,</span><span class="n">remainingVertices</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spanningTree = &#39;</span><span class="p">,</span> <span class="n">spanningTree</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">remainingVertices</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">():</span>
            <span class="n">remainingVerticesList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">remainingVertices</span><span class="p">)</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">remainingVerticesList</span><span class="p">)</span>
            <span class="n">randomWalk</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">remainingVerticesList</span><span class="p">)]</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">randomWalk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spannedVertices</span><span class="p">:</span>
                <span class="n">nextVertex</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">randomWalk</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
                <span class="n">randomWalk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nextVertex</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;randomWalk = &#39;</span><span class="p">,</span><span class="n">randomWalk</span><span class="p">)</span>
            <span class="n">spanningBranch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduceCycles</span><span class="p">(</span><span class="n">randomWalk</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">spannedVertices</span> <span class="o">=</span> <span class="n">spannedVertices</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">spanningBranch</span><span class="p">)</span>
            <span class="n">remainingVertices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">remainingVerticesList</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">spanningBranch</span><span class="p">)</span>
            <span class="n">spanningTree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spanningBranch</span><span class="p">)</span>            
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spanningBranch = &#39;</span><span class="p">,</span> <span class="n">spanningBranch</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spannedVertices = &#39;</span><span class="p">,</span> <span class="n">spannedVertices</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;remainingVertices = &#39;</span><span class="p">,</span><span class="n">remainingVertices</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spanningTree = &#39;</span><span class="p">,</span> <span class="n">spanningTree</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">edgeKey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">spanningTree</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">branch</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">branch</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">branch</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;edges = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depthFirstSearch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prueferCode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree2Pruefer</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_reduceCycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">randomWalk</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;randomWalk&#39;</span><span class="p">,</span> <span class="n">randomWalk</span><span class="p">)</span>
        <span class="n">reducedWalk</span> <span class="o">=</span> <span class="p">[</span><span class="n">randomWalk</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">randomWalk</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">t</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">randomWalk</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">randomWalk</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">randomWalk</span><span class="p">[</span><span class="n">t</span><span class="p">:</span><span class="n">k</span><span class="p">])</span>
            <span class="n">reducedWalk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">randomWalk</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;reducedWalk&#39;</span><span class="p">,</span> <span class="n">reducedWalk</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">return</span> <span class="n">reducedWalk</span></div>

                      
<span class="c1">#----------</span>
<div class="viewcode-block" id="BestDeterminedSpanningForest">
<a class="viewcode-back" href="../techDoc.html#graphs.BestDeterminedSpanningForest">[docs]</a>
<span class="k">class</span> <span class="nc">BestDeterminedSpanningForest</span><span class="p">(</span><span class="n">RandomSpanningForest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructing the most determined spanning tree (or forest if not connected)</span>
<span class="sd">    using Kruskal&#39;s greedy algorithm on the dual valuation.</span>

<span class="sd">    Example Python session:</span>
<span class="sd">       &gt;&gt;&gt; from graphs import *</span>
<span class="sd">       &gt;&gt;&gt; g = RandomValuationGraph(seed=2)</span>
<span class="sd">       &gt;&gt;&gt; g.showShort()</span>
<span class="sd">       *---- short description of the graph ----*</span>
<span class="sd">       Name             : &#39;randomGraph&#39;</span>
<span class="sd">       Vertices         :  [&#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;, &#39;v4&#39;, &#39;v5&#39;]</span>
<span class="sd">       Valuation domain :  {&#39;med&#39;: Decimal(&#39;0&#39;), &#39;min&#39;: Decimal(&#39;-1&#39;), &#39;max&#39;: Decimal(&#39;1&#39;)}</span>
<span class="sd">       Gamma function   : </span>
<span class="sd">       v1 -&gt; [&#39;v2&#39;, &#39;v3&#39;]</span>
<span class="sd">       v2 -&gt; [&#39;v4&#39;, &#39;v1&#39;, &#39;v5&#39;, &#39;v3&#39;]</span>
<span class="sd">       v3 -&gt; [&#39;v1&#39;, &#39;v5&#39;, &#39;v2&#39;]</span>
<span class="sd">       v4 -&gt; [&#39;v5&#39;, &#39;v2&#39;]</span>
<span class="sd">       v5 -&gt; [&#39;v4&#39;, &#39;v2&#39;, &#39;v3&#39;]</span>
<span class="sd">       &gt;&gt;&gt; mt = BestDeterminedSpanningForest(g)</span>
<span class="sd">       &gt;&gt;&gt; mt.exportGraphViz(&#39;spanningTree&#39;,WithSpanningTree=True)</span>
<span class="sd">       *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">       Exporting to spanningTree.dot</span>
<span class="sd">       [[&#39;v4&#39;, &#39;v2&#39;, &#39;v1&#39;, &#39;v3&#39;, &#39;v1&#39;, &#39;v2&#39;, &#39;v5&#39;, &#39;v2&#39;, &#39;v4&#39;]]</span>
<span class="sd">       neato -Tpng spanningTree.dot -o spanningTree.png</span>

<span class="sd">    .. image:: spanningTree.png</span>
<span class="sd">       :alt: Colored bes determined panning tree</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for best determined spanning forests instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;*---- best determined spanning tree specific data ----*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Depth first search path(s) : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dfs</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Average determination(s)   : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">averageTreeDetermination</span><span class="p">)</span>
       
        <span class="k">return</span> <span class="n">reprString</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_randomSpanningForest&#39;</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;valuationDomain = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="p">):</span>
                <span class="n">edgeKey</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">verticesList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">verticesList</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edgeKey</span><span class="p">]</span>
        <span class="n">forest</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">weightedEdgesList</span> <span class="o">=</span> <span class="p">[(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">],</span><span class="n">e</span><span class="p">)</span> \
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span> <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span> <span class="p">]</span>
        <span class="n">weightedEdgesList</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">weightedEdgesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">weightedEdgesList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===&gt;&gt;&gt; &#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="n">edgeKeys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">Included</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">connectedSubtrees</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">forest</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
                <span class="n">test</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">edgeKeys</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># already connected</span>
                    <span class="n">Included</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;already included&#39;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># extending</span>
                    <span class="n">connectedSubtrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;extending&#39;</span><span class="p">,</span><span class="n">tree</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Included</span><span class="p">:</span>
                <span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>             
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;connecting subtrees&#39;</span><span class="p">,</span><span class="n">connectedSubtrees</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">connectedSubtrees</span> <span class="o">==</span> <span class="p">[]:</span>
                    <span class="n">forest</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span><span class="n">edgeKeys</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Add new subtree&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">connectedSubtrees</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">edgeKeys</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Extending an existing subtree&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>\
                            <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>\
                <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">edgeKeys</span>
                    <span class="n">forest</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">connectedSubtrees</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;connected two subtrees&#39;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">forest</span><span class="p">)</span>
                    
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;edges = &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">(</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gamma = &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depthFirstSearch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeAverageTreeDetermination</span><span class="p">()</span></div>


<div class="viewcode-block" id="Q_Coloring">
<a class="viewcode-back" href="../techDoc.html#graphs.Q_Coloring">[docs]</a>
<span class="k">class</span> <span class="nc">Q_Coloring</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a q-coloring of a Graph instance via a Gibbs MCMC sampler in</span>
<span class="sd">    nSim simulation steps (default = len(graph.edges)).</span>
<span class="sd">    </span>
<span class="sd">        Example 3-coloring of a grid 6x6 :</span>
<span class="sd">           &gt;&gt;&gt; from graphs import *</span>
<span class="sd">           &gt;&gt;&gt; g = GridGraph(n=6,m=6)</span>
<span class="sd">           &gt;&gt;&gt; g.showShort()</span>
<span class="sd">           *----- show short --------------*</span>
<span class="sd">           Grid graph    :  grid-6-6</span>
<span class="sd">           n             :  6</span>
<span class="sd">           m             :  6</span>
<span class="sd">           order         :  36</span>
<span class="sd">           size          :  60        </span>
<span class="sd">           &gt;&gt;&gt; g.exportGraphViz()</span>
<span class="sd">           *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">           Exporting to grid-6-6.dot</span>
<span class="sd">           neato -Tpng grid-6-6.dot -o grid-6-6.png</span>
<span class="sd">           &gt;&gt;&gt; qc = Q_Coloring(g,colors=[&#39;gold&#39;,&#39;lightblue&#39;,&#39;lightcoral&#39;])</span>
<span class="sd">           Iteration: 1</span>
<span class="sd">           Running a Gibbs Sampler for 1260 step !</span>
<span class="sd">           The q-coloring with 3 colors is feasible !!</span>
<span class="sd">           &gt;&gt;&gt; qc.exportGraphViz()</span>
<span class="sd">           *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">           Exporting to grid-6-6-qcoloring.dot</span>
<span class="sd">           fdp -Tpng grid-6-6-qcoloring.dot -o grid-6-6-qcoloring.png</span>
<span class="sd">           </span>
<span class="sd">        .. image:: grid-6-6-qcoloring.png</span>
<span class="sd">           :alt: 3 coloring of a 6x6 grid</span>
<span class="sd">           :width: 300 px</span>
<span class="sd">           :align: center</span>
<span class="sd">    &quot;&quot;&quot;</span> 

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="s1">&#39;lightblue&#39;</span><span class="p">],</span>
                 <span class="n">nSim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">maxIter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-qcoloring&#39;</span> <span class="o">%</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colors</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
<span class="c1">##        print(self.colors[0])</span>
<span class="c1">##        for v in self.vertices:</span>
<span class="c1">##            self.vertices[v][&#39;color&#39;] = colors[0]</span>
        <span class="k">if</span> <span class="n">nSim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nSim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span> <span class="o">=</span> <span class="n">nSim</span>
        <span class="n">infeasibleEdges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">])</span>
        <span class="n">_iter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">infeasibleEdges</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()</span> <span class="ow">and</span> <span class="n">_iter</span> <span class="o">&lt;</span> <span class="n">maxIter</span><span class="p">:</span>
            <span class="n">_iter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Iteration:&#39;</span><span class="p">,</span> <span class="n">_iter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generateFeasibleConfiguration</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">infeasibleEdges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkFeasibility</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">showConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
            
    <span class="k">def</span> <span class="nf">generateFeasibleConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">nSim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Reset</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>           
        <span class="k">if</span> <span class="n">nSim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nSim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running a Gibbs Sampler for </span><span class="si">%d</span><span class="s1"> step !&#39;</span> <span class="o">%</span> <span class="n">nSim</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSim</span><span class="p">):</span>
            <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">)</span>
            <span class="n">neighborColors</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>\
                                  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]]</span>
            <span class="n">feasibleColors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">neighborColors</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">feasibleColors</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;Warning !! Not feasible coloring&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">checkFeasibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">infeasibleEdges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                <span class="n">neighborColors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">neighborColors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Infeasible Confirguration !! See edge </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
                    <span class="n">infeasibleEdges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">neighborColors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">infeasibleEdges</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The q-coloring with </span><span class="si">%d</span><span class="s1"> colors is feasible !!&#39;</span>\
                      <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The q-coloring with </span><span class="si">%d</span><span class="s1"> colors is apparently not feasible !!&#39;</span>\
                      <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colors</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Either augment nSim=</span><span class="si">%d</span><span class="s1"> or add one more color&#39;</span>\
                      <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">infeasibleEdges</span>              

<div class="viewcode-block" id="Q_Coloring.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.Q_Coloring.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file  for q-coloring drawing filtering.</span>

<span class="sd">        The graph drawing layout is depending on the graph type, but can be forced to either</span>
<span class="sd">        &#39;fdp&#39;, &#39;circo&#39; or &#39;neato&#39; with the layout parameter.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; g = Graph(numberOfVertices=10,edgeProbability=0.4)</span>
<span class="sd">            &gt;&gt;&gt; g.showShort()</span>
<span class="sd">            *---- short description of the graph ----*</span>
<span class="sd">            Name : &#39;randomGraph&#39;</span>
<span class="sd">            Vertices :  [&#39;v1&#39;,&#39;v10&#39;,&#39;v2&#39;,&#39;v3&#39;,&#39;v4&#39;,&#39;v5&#39;,&#39;v6&#39;,&#39;v7&#39;,&#39;v8&#39;,&#39;v9&#39;]</span>
<span class="sd">            Valuation domain :  {&#39;max&#39;: 1, &#39;min&#39;: -1, &#39;med&#39;: 0}</span>
<span class="sd">            Gamma function   : </span>
<span class="sd">            v1 -&gt; [&#39;v7&#39;, &#39;v2&#39;, &#39;v3&#39;, &#39;v5&#39;]</span>
<span class="sd">            v10 -&gt; [&#39;v4&#39;]</span>
<span class="sd">            v2 -&gt; [&#39;v1&#39;, &#39;v7&#39;, &#39;v8&#39;]</span>
<span class="sd">            v3 -&gt; [&#39;v1&#39;, &#39;v7&#39;, &#39;v9&#39;]</span>
<span class="sd">            v4 -&gt; [&#39;v5&#39;, &#39;v10&#39;]</span>
<span class="sd">            v5 -&gt; [&#39;v6&#39;, &#39;v7&#39;, &#39;v1&#39;, &#39;v8&#39;, &#39;v4&#39;]</span>
<span class="sd">            v6 -&gt; [&#39;v5&#39;, &#39;v8&#39;]</span>
<span class="sd">            v7 -&gt; [&#39;v1&#39;, &#39;v5&#39;, &#39;v8&#39;, &#39;v2&#39;, &#39;v3&#39;]</span>
<span class="sd">            v8 -&gt; [&#39;v6&#39;, &#39;v7&#39;, &#39;v2&#39;, &#39;v5&#39;]</span>
<span class="sd">            v9 -&gt; [&#39;v3&#39;]</span>
<span class="sd">            &gt;&gt;&gt; qc = Q_Coloring(g,nSim=1000)</span>
<span class="sd">            Running a Gibbs Sampler for 1000 step !</span>
<span class="sd">            &gt;&gt;&gt; qc.checkFeasibility()</span>
<span class="sd">            The q-coloring with 3 colors is feasible !!</span>
<span class="sd">            &gt;&gt;&gt; qc.exportGraphViz()</span>
<span class="sd">            *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">            Exporting to randomGraph-qcoloring.dot</span>
<span class="sd">            fdp -Tpng randomGraph-qcoloring.dot -o randomGraph-qcoloring.png</span>

<span class="sd">        .. image:: randomGraph-qcoloring.png</span>
<span class="sd">            :alt: 3-coloring of a random graph</span>
<span class="sd">            :width: 300 px</span>
<span class="sd">            :align: center</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="c1">## if bestChoice != set():</span>
        <span class="c1">##     rankBestString = &#39;{rank=max; &#39;</span>
        <span class="c1">## if worstChoice != set():</span>
        <span class="c1">##     rankWorstString = &#39;{rank=min; &#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strict graph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2022&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">&#39;</span> \
                    <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span> <span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>

                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [dir=both,style=&quot;setlinewidth(1)&quot;,color=black, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">==</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [dir=both, color=grey, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="ow">in</span> <span class="p">(</span><span class="n">GridGraph</span><span class="p">,</span><span class="n">RandomTree</span><span class="p">):</span>
                <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;neato -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="o">==</span> <span class="n">CycleGraph</span><span class="p">:</span>
                <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;circo -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;fdp -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commandString</span> <span class="o">=</span> <span class="n">layout</span><span class="o">+</span><span class="s1">&#39; -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="IsingModel">
<a class="viewcode-back" href="../techDoc.html#graphs.IsingModel">[docs]</a>
<span class="k">class</span> <span class="nc">IsingModel</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of a Gibbs Sampler for the Ising model</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; from graphs import GridGraph, IsingModel</span>
<span class="sd">        &gt;&gt;&gt; g = GridGraph(n=15,m=15)</span>
<span class="sd">        &gt;&gt;&gt; g.showShort()</span>
<span class="sd">        *----- show short --------------*</span>
<span class="sd">        Grid graph    :  grid-15-15</span>
<span class="sd">        n             :  15</span>
<span class="sd">        m             :  15</span>
<span class="sd">        order         :  225</span>
<span class="sd">        size          :  420</span>
<span class="sd">        &gt;&gt;&gt; im = IsingModel(g,beta=0.3,nSim=100000,Debug=False)</span>
<span class="sd">        Running a Gibbs Sampler for 100000 step !</span>
<span class="sd">        &gt;&gt;&gt; im.exportGraphViz(colors=[&#39;lightblue&#39;,&#39;lightcoral&#39;])</span>
<span class="sd">        *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">        Exporting to grid-15-15-ising.dot</span>
<span class="sd">        fdp -Tpng grid-15-15-ising.dot -o grid-15-15-ising.png</span>

<span class="sd">    .. image:: grid-15-15-ising.png</span>
<span class="sd">       :alt: ising configuration of a 15x15 grid with beta=0.3 </span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">nSim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-ising&#39;</span> <span class="o">%</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">nSim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nSim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span> <span class="o">=</span> <span class="n">nSim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generateSpinConfiguration</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SpinEnergy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSpinEnergy</span><span class="p">()</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span> <span class="nf">generateSpinConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nSim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span><span class="p">,</span> <span class="n">random</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
        <span class="k">if</span> <span class="n">nSim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nSim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running a Gibbs Sampler for </span><span class="si">%d</span><span class="s1"> step !&#39;</span> <span class="o">%</span> <span class="n">nSim</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSim</span><span class="p">):</span>
            <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">)</span>
            <span class="n">plusNeighbors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">nPlus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plusNeighbors</span><span class="p">)</span>
            <span class="n">minusNeighbors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nMinus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">minusNeighbors</span><span class="p">)</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">nPlus</span><span class="o">-</span><span class="n">nMinus</span><span class="p">))</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="p">(</span><span class="n">numerator</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">U</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">U</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Spin energy: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeSpinEnergy</span><span class="p">())</span> <span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s,v,nPlus,nMinus,numerator,threshold,U,spin</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>\
                      <span class="n">s</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">nPlus</span><span class="p">,</span><span class="n">nMinus</span><span class="p">,</span><span class="n">numerator</span><span class="p">,</span><span class="n">threshold</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">])</span>

<div class="viewcode-block" id="IsingModel.computeSpinEnergy">
<a class="viewcode-back" href="../techDoc.html#graphs.IsingModel.computeSpinEnergy">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSpinEnergy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spin energy H(c) of a spin configuration is</span>
<span class="sd">        H(c) = -sum_{{x,y} in self.edges}[spin_c(x)*spin_c(y)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Hc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Hc</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Hc</span>        </div>

    
<div class="viewcode-block" id="IsingModel.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.IsingModel.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">edgeColor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;lightblue&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file  for Ising models drawing filtering.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="c1">## if bestChoice != set():</span>
        <span class="c1">##     rankBestString = &#39;{rank=max; &#39;</span>
        <span class="c1">## if worstChoice != set():</span>
        <span class="c1">##     rankWorstString = &#39;{rank=min; &#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strict graph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2022&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;spin&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span><span class="o">=</span><span class="kc">None</span>
            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">color</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span> <span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>

                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span>\
                                <span class="s1">&#39; [dir=both,style=&quot;setlinewidth(1)&quot;,color=&#39;</span><span class="o">+</span><span class="n">edgeColor</span><span class="o">+</span>\
                                <span class="s1">&#39; arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">==</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [dir=both, color=grey, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="ow">in</span> <span class="p">(</span><span class="n">GridGraph</span><span class="p">,</span><span class="n">TriangulatedGrid</span><span class="p">,</span><span class="n">RandomTree</span><span class="p">):</span>
            <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;neato -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="o">==</span> <span class="n">CycleGraph</span><span class="p">:</span>
            <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;circo -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;fdp -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="MetropolisChain">
<a class="viewcode-back" href="../techDoc.html#graphs.MetropolisChain">[docs]</a>
<span class="k">class</span> <span class="nc">MetropolisChain</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of the graph class for implementing a generic</span>
<span class="sd">    Metropolis Markov Chain Monte Carlo sampler with a given probability distribution</span>
<span class="sd">    probs = {&#39;v1&#39;: x, &#39;v2&#39;: y, ...}</span>

<span class="sd">    Usage example:</span>
<span class="sd">        &gt;&gt;&gt; from graphs import *</span>
<span class="sd">        &gt;&gt;&gt; g = Graph(numberOfVertices=5,edgeProbability=0.5)</span>
<span class="sd">        &gt;&gt;&gt; g.showShort()</span>
<span class="sd">        *---- short description of the graph ----*</span>
<span class="sd">        Name             : &#39;randomGraph&#39;</span>
<span class="sd">        Vertices         :  [&#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;, &#39;v4&#39;, &#39;v5&#39;]</span>
<span class="sd">        Valuation domain :  {&#39;max&#39;: 1, &#39;med&#39;: 0, &#39;min&#39;: -1}</span>
<span class="sd">        Gamma function   : </span>
<span class="sd">        v1 -&gt; [&#39;v2&#39;, &#39;v3&#39;, &#39;v4&#39;]</span>
<span class="sd">        v2 -&gt; [&#39;v1&#39;, &#39;v4&#39;]</span>
<span class="sd">        v3 -&gt; [&#39;v5&#39;, &#39;v1&#39;]</span>
<span class="sd">        v4 -&gt; [&#39;v2&#39;, &#39;v5&#39;, &#39;v1&#39;]</span>
<span class="sd">        v5 -&gt; [&#39;v3&#39;, &#39;v4&#39;]        </span>
<span class="sd">        &gt;&gt;&gt; probs = {}</span>
<span class="sd">        &gt;&gt;&gt; n = g.order</span>
<span class="sd">        &gt;&gt;&gt; i = 0</span>
<span class="sd">        &gt;&gt;&gt; verticesList = [x for x in g.vertices]</span>
<span class="sd">        &gt;&gt;&gt; verticesList.sort()</span>
<span class="sd">        &gt;&gt;&gt; for v in verticesList:</span>
<span class="sd">        ...     probs[v] = (n - i)/(n*(n+1)/2)</span>
<span class="sd">        ...     i += 1</span>
<span class="sd">        &gt;&gt;&gt; met = MetropolisChain(g,probs)</span>
<span class="sd">        &gt;&gt;&gt; frequency = met.checkSampling(verticesList[0],nSim=30000)</span>
<span class="sd">        &gt;&gt;&gt; for v in verticesList:</span>
<span class="sd">        ...     print(v,probs[v],frequency[v])</span>
<span class="sd">        v1 0.3333 0.3343</span>
<span class="sd">        v2 0.2666 0.2680</span>
<span class="sd">        v3 0.2    0.2030 </span>
<span class="sd">        v4 0.1333 0.1311</span>
<span class="sd">        v5 0.0666 0.0635</span>
<span class="sd">        &gt;&gt;&gt; met.showTransitionMatrix()</span>
<span class="sd">        * ---- Transition Matrix -----</span>
<span class="sd">          Pij  | &#39;v1&#39;    &#39;v2&#39;    &#39;v3&#39;    &#39;v4&#39;    &#39;v5&#39;	  </span>
<span class="sd">          -----|-------------------------------------</span>
<span class="sd">          &#39;v1&#39; |  0.23	 0.33	 0.30	 0.13	 0.00	 </span>
<span class="sd">          &#39;v2&#39; |  0.42   0.42 	 0.00	 0.17	 0.00	 </span>
<span class="sd">          &#39;v3&#39; |  0.50	 0.00	 0.33 	 0.00	 0.17	 </span>
<span class="sd">          &#39;v4&#39; |  0.33	 0.33	 0.00	 0.08 	 0.25	 </span>
<span class="sd">          &#39;v5&#39; |  0.00	 0.00	 0.50	 0.50	 0.00 	 </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span>
                 <span class="n">probs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-metro&#39;</span> <span class="o">%</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">probs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>       
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeTransitionMatrix</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">computeTransitionMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">transition</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">transition</span><span class="p">[</span><span class="n">si</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">di</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
            <span class="n">pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">si</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">sj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">si</span> <span class="o">!=</span> <span class="n">sj</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">si</span><span class="p">]:</span>
                        <span class="n">dj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
                        <span class="n">pj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">sj</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span>
                        <span class="n">transition</span><span class="p">[</span><span class="n">si</span><span class="p">][</span><span class="n">sj</span><span class="p">]</span> <span class="o">=</span>\
                                    <span class="n">Decimal</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,(</span><span class="n">pj</span><span class="o">*</span><span class="n">di</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">dj</span><span class="p">))</span><span class="o">/</span><span class="n">di</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">transition</span><span class="p">[</span><span class="n">si</span><span class="p">][</span><span class="n">sj</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sp</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">for</span> <span class="n">sx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">si</span><span class="p">]:</span>
                        <span class="n">dx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">sx</span><span class="p">])</span>
                        <span class="n">px</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">sx</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span>
                        <span class="n">sp</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,(</span><span class="n">px</span><span class="o">*</span><span class="n">di</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">dx</span><span class="p">))</span><span class="o">/</span><span class="n">di</span>
                    <span class="n">transition</span><span class="p">[</span><span class="n">si</span><span class="p">][</span><span class="n">sj</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">sp</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">transition</span>
                  
    <span class="k">def</span> <span class="nf">MCMCtransition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span><span class="n">choice</span>
        <span class="n">neighborsSi</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">si</span><span class="p">]]</span>
        <span class="n">di</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">si</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">di</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">si</span>
        <span class="n">pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">si</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span>
        <span class="n">sj</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">neighborsSi</span><span class="p">)</span>
        <span class="n">dj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">sj</span><span class="p">])</span>
        <span class="n">pj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">sj</span><span class="p">][</span><span class="s1">&#39;prob&#39;</span><span class="p">]</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,(</span><span class="n">pj</span><span class="o">*</span><span class="n">di</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">dj</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">si</span><span class="p">,</span><span class="n">di</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="n">sj</span><span class="p">,</span><span class="n">dj</span><span class="p">,</span><span class="n">pj</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">threshold</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">U</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">si</span>

    <span class="k">def</span> <span class="nf">checkSampling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">si</span><span class="p">,</span><span class="n">nSim</span><span class="p">):</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="n">frequency</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">si</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSim</span><span class="p">):</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MCMCtransition</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
            <span class="n">frequency</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">frequency</span><span class="p">:</span>
            <span class="n">frequency</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">/=</span> <span class="n">nSim</span>
        <span class="k">return</span> <span class="n">frequency</span>

<div class="viewcode-block" id="MetropolisChain.saveCSVTransition">
<a class="viewcode-back" href="../techDoc.html#graphs.MetropolisChain.saveCSVTransition">[docs]</a>
    <span class="k">def</span> <span class="nf">saveCSVTransition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;transition&#39;</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Persistent storage of the transition matrix in the form of</span>
<span class="sd">            a csv file. &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">csv</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving transition matrix P_ij into file: </span><span class="si">%s</span><span class="s1">.csv&gt; ---*&#39;</span> <span class="o">%</span>\
                  <span class="p">(</span><span class="n">fileName</span><span class="p">))</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">csvfo</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">)</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">verticesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">headerText</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;P_ij&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">verticesList</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">headerText</span><span class="p">)</span>
        <span class="n">csvfo</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">headerText</span><span class="p">)</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
            <span class="n">rowText</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">verticesList</span><span class="p">:</span>
                <span class="n">rowText</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]))</span> <span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">rowText</span><span class="p">)</span>
            <span class="n">csvfo</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">rowText</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="MetropolisChain.showTransitionMatrix">
<a class="viewcode-back" href="../techDoc.html#graphs.MetropolisChain.showTransitionMatrix">[docs]</a>
    <span class="k">def</span> <span class="nf">showTransitionMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                          <span class="n">IntegerValues</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                          <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                          <span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>\
                          <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>\
                          <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints on stdout the transition probabilities in</span>
<span class="sd">        vertices X vertices table format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">vertices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span>
        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeTransitionMatrix</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* ---- Transition Matrix -----&#39;</span><span class="p">)</span>
        <span class="c1"># print(&#39; S   | &#39;, end=&#39; &#39;)</span>
        <span class="n">verticesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
        <span class="c1"># for x in vertices:</span>
        <span class="c1">#     if isinstance(x,frozenset):</span>
        <span class="c1">#         try:</span>
        <span class="c1">#             verticesList += [(vertices[x][&#39;shortName&#39;],x)]</span>
        <span class="c1">#         except:</span>
        <span class="c1">#             verticesList += [(verticess[x][&#39;name&#39;],x)]</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         verticesList += [(str(x),x)]</span>
        <span class="c1"># if Sorted:</span>
        <span class="c1">#     verticesList.sort()</span>
        <span class="c1"># print(verticesList)</span>
        <span class="c1"># verticesList.sort()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Pij |&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39;</span><span class="se">\t</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----|------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39; | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">2.</span><span class="si">%d</span><span class="s1">f</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ReflexiveTerms</span><span class="p">:</span>
                        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">2.</span><span class="si">%d</span><span class="s1">f</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>  
                        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39; - </span><span class="se">\t</span><span class="s1">&#39;</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>                    
            <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
</div>

        
<div class="viewcode-block" id="MISModel">
<a class="viewcode-back" href="../techDoc.html#graphs.MISModel">[docs]</a>
<span class="k">class</span> <span class="nc">MISModel</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of a Gibbs Sampler for the hard code model,</span>
<span class="sd">    that is a random MIS generator.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; from graphs import MISModel</span>
<span class="sd">        &gt;&gt;&gt; from digraphs import CirculantDigraph        </span>
<span class="sd">        &gt;&gt;&gt; dg = CirculantDigraph(order=15)</span>
<span class="sd">        &gt;&gt;&gt; g = dg.digraph2Graph()</span>
<span class="sd">        &gt;&gt;&gt; g.showShort()</span>
<span class="sd">        *---- short description of the graph ----*</span>
<span class="sd">        Name             : &#39;c15&#39;</span>
<span class="sd">        Vertices         :  [&#39;1&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;, &#39;13&#39;, &#39;14&#39;,</span>
<span class="sd">                             &#39;15&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;,</span>
<span class="sd">                             &#39;8&#39;, &#39;9&#39;]</span>
<span class="sd">        Valuation domain :  {&#39;med&#39;: 0, &#39;min&#39;: -1, &#39;max&#39;: 1}</span>
<span class="sd">        Gamma function   : </span>
<span class="sd">        1 -&gt; [&#39;2&#39;, &#39;15&#39;]</span>
<span class="sd">        10 -&gt; [&#39;11&#39;, &#39;9&#39;]</span>
<span class="sd">        11 -&gt; [&#39;10&#39;, &#39;12&#39;]</span>
<span class="sd">        12 -&gt; [&#39;13&#39;, &#39;11&#39;]</span>
<span class="sd">        13 -&gt; [&#39;12&#39;, &#39;14&#39;]</span>
<span class="sd">        14 -&gt; [&#39;15&#39;, &#39;13&#39;]</span>
<span class="sd">        15 -&gt; [&#39;1&#39;, &#39;14&#39;]</span>
<span class="sd">        2 -&gt; [&#39;1&#39;, &#39;3&#39;]</span>
<span class="sd">        3 -&gt; [&#39;2&#39;, &#39;4&#39;]</span>
<span class="sd">        4 -&gt; [&#39;3&#39;, &#39;5&#39;]</span>
<span class="sd">        5 -&gt; [&#39;6&#39;, &#39;4&#39;]</span>
<span class="sd">        6 -&gt; [&#39;7&#39;, &#39;5&#39;]</span>
<span class="sd">        7 -&gt; [&#39;6&#39;, &#39;8&#39;]</span>
<span class="sd">        8 -&gt; [&#39;7&#39;, &#39;9&#39;]</span>
<span class="sd">        9 -&gt; [&#39;10&#39;, &#39;8&#39;]</span>
<span class="sd">        &gt;&gt;&gt; mis = MISModel(g)</span>
<span class="sd">        Running a Gibbs Sampler for 1050 step !</span>
<span class="sd">        &gt;&gt;&gt; mis.checkMIS()</span>
<span class="sd">        {&#39;2&#39;,&#39;4&#39;,&#39;7&#39;,&#39;9&#39;,&#39;11&#39;,&#39;13&#39;,&#39;15&#39;}  is maximal !</span>
<span class="sd">        &gt;&gt;&gt; mis.exportGraphViz()</span>
<span class="sd">        *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">        Exporting to c15-mis.dot</span>
<span class="sd">        fdp -Tpng c15-mis.dot -o c15-mis.png</span>

<span class="sd">    .. image:: c15-mis.png</span>
<span class="sd">       :alt: 15-cycle with colored MIS</span>
<span class="sd">       :width: 300 px</span>
<span class="sd">       :align: center</span>
<span class="sd">       </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span>
                 <span class="n">nSim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">maxIter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-mis&#39;</span> <span class="o">%</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;shortName&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nSim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nSim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span> <span class="o">=</span> <span class="n">nSim</span>
        <span class="n">unCovered</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">])</span>
        <span class="n">_iter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">unCovered</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">()</span> <span class="ow">and</span> <span class="n">_iter</span> <span class="o">&lt;</span> <span class="n">maxIter</span><span class="p">:</span>
            <span class="n">_iter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Iteration: &#39;</span><span class="p">,</span> <span class="n">_iter</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generateMIS</span><span class="p">(</span><span class="n">Reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">nSim</span><span class="o">=</span><span class="n">nSim</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">mis</span><span class="p">,</span><span class="n">misCover</span><span class="p">,</span><span class="n">unCovered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkMIS</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">generateMIS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">nSim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span>
        <span class="k">if</span> <span class="n">nSim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nSim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nSim</span>
        <span class="n">verticesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Reset</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">verticesKeys</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;mis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running a Gibbs Sampler for </span><span class="si">%d</span><span class="s1"> step !&#39;</span> <span class="o">%</span> <span class="n">nSim</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSim</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">verticesKeys</span><span class="p">)</span>
            <span class="n">Potential</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;mis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">Potential</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">Potential</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;mis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;mis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>               
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;s,v,neighbors,mis</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>\
                      <span class="n">s</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;mis&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mis</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">misCover</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">unCovered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkMIS</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>

<div class="viewcode-block" id="MISModel.checkMIS">
<a class="viewcode-back" href="../techDoc.html#graphs.MISModel.checkMIS">[docs]</a>
    <span class="k">def</span> <span class="nf">checkMIS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify maximality of independent set.</span>

<span class="sd">        .. note::</span>
<span class="sd">             Returns three sets: an independent choice,</span>
<span class="sd">             the covered vertices, and the remaining uncovered vertices.</span>
<span class="sd">             When the last set is empty, the independent choice is maximal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cover</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">mis</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;mis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">cover</span> <span class="o">=</span> <span class="n">cover</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="n">mis</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">misCover</span> <span class="o">=</span> <span class="n">mis</span> <span class="o">|</span> <span class="n">cover</span>
        <span class="n">unCovered</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="n">misCover</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unCovered</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">mis</span><span class="p">,</span><span class="s1">&#39; is maximal !&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">mis</span><span class="p">,</span><span class="s1">&#39; is not maximal, uncovered = &#39;</span><span class="p">,</span><span class="n">unCovered</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mis</span><span class="p">,</span><span class="n">misCover</span><span class="p">,</span><span class="n">unCovered</span></div>

    
<div class="viewcode-block" id="MISModel.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#graphs.MISModel.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">misColor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
                       <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports GraphViz dot file  for MIS models drawing filtering.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">vertexkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="c1">## if bestChoice != set():</span>
        <span class="c1">##     rankBestString = &#39;{rank=max; &#39;</span>
        <span class="c1">## if worstChoice != set():</span>
        <span class="c1">##     rankWorstString = &#39;{rank=min; &#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strict graph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz), R. Bisdorff, 2022&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;];</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [shape = &quot;circle&quot;, label = &quot;&#39;</span> <span class="o">+</span><span class="n">nodeName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;mis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">color</span><span class="o">=</span><span class="n">misColor</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span><span class="o">=</span><span class="kc">None</span>
            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;, style = &quot;filled&quot;, color = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">color</span>
            <span class="n">node</span> <span class="o">+=</span> <span class="s1">&#39;];</span><span class="se">\n</span><span class="s1">&#39;</span>                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span> <span class="p">[</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>

                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [dir=both,style=&quot;setlinewidth(1)&quot;,color=black, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertexkeys</span><span class="p">[</span><span class="n">j</span><span class="p">]])]</span> <span class="o">==</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">edge0</span> <span class="o">=</span> <span class="n">edge</span><span class="o">+</span><span class="s1">&#39;-- n&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; [dir=both, color=grey, arrowhead=none, arrowtail=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="ow">in</span> <span class="p">(</span><span class="n">GridGraph</span><span class="p">,</span><span class="n">RandomTree</span><span class="p">):</span>
            <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;neato -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gClass</span> <span class="o">==</span> <span class="n">CycleGraph</span><span class="p">:</span>           
            <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;circo -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;fdp -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>
</div>

                
<span class="c1">##########################</span>

<div class="viewcode-block" id="LineGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.LineGraph">[docs]</a>
<span class="k">class</span> <span class="nc">LineGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Line graphs represent the **adjacencies between edges** of a graph instance.</span>

<span class="sd">    Iterated line graph constructions are usually expanding, except for chordless cycles,</span>
<span class="sd">    where the same cycle is repeated. And, for non-closed paths (interupted cycles), where iterated line graphs</span>
<span class="sd">    progressively reduce one by one the number of vertices and edges and become eventually an empty graph. </span>

<span class="sd">    &gt;&gt;&gt; g = CycleGraph(order=5)</span>
<span class="sd">    &gt;&gt;&gt; g</span>
<span class="sd">    *------- Graph instance description ------*</span>
<span class="sd">    Instance class   : CycleGraph</span>
<span class="sd">    Instance name    : cycleGraph</span>
<span class="sd">    Graph Order      : 5</span>
<span class="sd">    Graph Size       : 5</span>
<span class="sd">    Valuation domain : [-1.00; 1.00]</span>
<span class="sd">    Attributes       : [&#39;name&#39;, &#39;order&#39;, &#39;vertices&#39;, &#39;valuationDomain&#39;,</span>
<span class="sd">                        &#39;edges&#39;, &#39;size&#39;, &#39;gamma&#39;]</span>
<span class="sd">    g.showShort()</span>
<span class="sd">    *---- short description of the graph ----*</span>
<span class="sd">    Name             : &#39;cycleGraph&#39;</span>
<span class="sd">    Vertices         :  [&#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;, &#39;v4&#39;, &#39;v5&#39;]</span>
<span class="sd">    Valuation domain :  {&#39;min&#39;: Decimal(&#39;-1&#39;), &#39;med&#39;: Decimal(&#39;0&#39;), &#39;max&#39;: Decimal(&#39;1&#39;)}</span>
<span class="sd">    Gamma function   : </span>
<span class="sd">    v1 -&gt; [&#39;v2&#39;, &#39;v5&#39;]</span>
<span class="sd">    v2 -&gt; [&#39;v1&#39;, &#39;v3&#39;]</span>
<span class="sd">    v3 -&gt; [&#39;v2&#39;, &#39;v4&#39;]</span>
<span class="sd">    v4 -&gt; [&#39;v3&#39;, &#39;v5&#39;]</span>
<span class="sd">    v5 -&gt; [&#39;v4&#39;, &#39;v1&#39;]</span>
<span class="sd">    degrees      :  [0, 1, 2, 3, 4]</span>
<span class="sd">    distribution :  [0, 0, 5, 0, 0]</span>
<span class="sd">    nbh depths   :  [0, 1, 2, 3, 4, &#39;inf.&#39;]</span>
<span class="sd">    distribution :  [0, 0, 5, 0, 0, 0]</span>
<span class="sd">    # the line graph of the 5-cycle graph</span>
<span class="sd">    &gt;&gt;&gt; lg = LineGraph(g)</span>
<span class="sd">    &gt;&gt;&gt; lg</span>
<span class="sd">    *------- Graph instance description ------*</span>
<span class="sd">    Instance class   : LineGraph</span>
<span class="sd">    Instance name    : line-cycleGraph</span>
<span class="sd">    Graph Order      : 5</span>
<span class="sd">    Graph Size       : 5</span>
<span class="sd">    Valuation domain : [-1.00; 1.00]</span>
<span class="sd">    Attributes       : [&#39;name&#39;, &#39;graph&#39;, &#39;valuationDomain&#39;, &#39;vertices&#39;,</span>
<span class="sd">                        &#39;order&#39;, &#39;edges&#39;, &#39;size&#39;, &#39;gamma&#39;]</span>
<span class="sd">    &gt;&gt;&gt; lg.showShort()</span>
<span class="sd">    *---- short description of the graph ----*</span>
<span class="sd">    Name             : &#39;line-cycleGraph&#39;</span>
<span class="sd">    Vertices         :  [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v1&#39;, &#39;v5&#39;}), frozenset({&#39;v2&#39;, &#39;v3&#39;}),</span>
<span class="sd">                         frozenset({&#39;v4&#39;, &#39;v3&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    Valuation domain :  {&#39;min&#39;: Decimal(&#39;-1&#39;), &#39;med&#39;: Decimal(&#39;0&#39;), &#39;max&#39;: Decimal(&#39;1&#39;)}</span>
<span class="sd">    Gamma function   : </span>
<span class="sd">    frozenset({&#39;v2&#39;, &#39;v1&#39;}) -&gt; [frozenset({&#39;v2&#39;, &#39;v3&#39;}), frozenset({&#39;v1&#39;, &#39;v5&#39;})]</span>
<span class="sd">    frozenset({&#39;v1&#39;, &#39;v5&#39;}) -&gt; [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    frozenset({&#39;v2&#39;, &#39;v3&#39;}) -&gt; [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v4&#39;, &#39;v3&#39;})]</span>
<span class="sd">    frozenset({&#39;v4&#39;, &#39;v3&#39;}) -&gt; [frozenset({&#39;v2&#39;, &#39;v3&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    frozenset({&#39;v4&#39;, &#39;v5&#39;}) -&gt; [frozenset({&#39;v4&#39;, &#39;v3&#39;}), frozenset({&#39;v1&#39;, &#39;v5&#39;})]</span>
<span class="sd">    degrees      :  [0, 1, 2, 3, 4]</span>
<span class="sd">    distribution :  [0, 0, 5, 0, 0]</span>
<span class="sd">    nbh depths   :  [0, 1, 2, 3, 4, &#39;inf.&#39;]</span>
<span class="sd">    distribution :  [0, 0, 5, 0, 0, 0]</span>

<span class="sd">    MISs in line graphs provide maximal matchings - maximal sets of independent edges - in the original graph.</span>

<span class="sd">    &gt;&gt;&gt; c8 = CycleGraph(order=8)</span>
<span class="sd">    &gt;&gt;&gt; lc8 = LineGraph(c8)</span>
<span class="sd">    &gt;&gt;&gt; lc8.showMIS()</span>
<span class="sd">    *---  Maximal Independent Sets ---*</span>
<span class="sd">    [frozenset({&#39;v3&#39;, &#39;v4&#39;}), frozenset({&#39;v5&#39;, &#39;v6&#39;}), frozenset({&#39;v1&#39;, &#39;v8&#39;})]</span>
<span class="sd">    [frozenset({&#39;v2&#39;, &#39;v3&#39;}), frozenset({&#39;v5&#39;, &#39;v6&#39;}), frozenset({&#39;v1&#39;, &#39;v8&#39;})]</span>
<span class="sd">    [frozenset({&#39;v8&#39;, &#39;v7&#39;}), frozenset({&#39;v2&#39;, &#39;v3&#39;}), frozenset({&#39;v5&#39;, &#39;v6&#39;})]</span>
<span class="sd">    [frozenset({&#39;v8&#39;, &#39;v7&#39;}), frozenset({&#39;v2&#39;, &#39;v3&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    [frozenset({&#39;v7&#39;, &#39;v6&#39;}), frozenset({&#39;v3&#39;, &#39;v4&#39;}), frozenset({&#39;v1&#39;, &#39;v8&#39;})]</span>
<span class="sd">    [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v8&#39;, &#39;v7&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v7&#39;, &#39;v6&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v7&#39;, &#39;v6&#39;}), frozenset({&#39;v3&#39;, &#39;v4&#39;})]</span>
<span class="sd">    [frozenset({&#39;v7&#39;, &#39;v6&#39;}), frozenset({&#39;v2&#39;, &#39;v3&#39;}), frozenset({&#39;v1&#39;, &#39;v8&#39;}), frozenset({&#39;v4&#39;, &#39;v5&#39;})]</span>
<span class="sd">    [frozenset({&#39;v2&#39;, &#39;v1&#39;}), frozenset({&#39;v8&#39;, &#39;v7&#39;}), frozenset({&#39;v3&#39;, &#39;v4&#39;}), frozenset({&#39;v5&#39;, &#39;v6&#39;})]</span>
<span class="sd">    number of solutions:  10</span>
<span class="sd">    cardinality distribution</span>
<span class="sd">    card.:  [0, 1, 2, 3, 4, 5, 6, 7, 8]</span>
<span class="sd">    freq.:  [0, 0, 0, 8, 2, 0, 0, 0, 0]</span>
<span class="sd">    execution time: 0.00029 sec.</span>

<span class="sd">    The two last MISs of cardinality 4 (see Lines 14-15 above) give</span>
<span class="sd">    **isomorphic perfect maximum matchings** of the 8-cycle graph.</span>
<span class="sd">    Every vertex of the cycle is adjacent to a matching edge.</span>
<span class="sd">    Odd cyle graphs do not admid any perfect matching.</span>

<span class="sd">    &gt;&gt;&gt; maxMatching = c8.computeMaximumMatching()</span>
<span class="sd">    &gt;&gt;&gt; c8.exportGraphViz(fileName=&#39;maxMatchingcycleGraph&#39;,</span>
<span class="sd">    ...                   matching=maxMatching)</span>
<span class="sd">    *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">    Exporting to maxMatchingcyleGraph.dot</span>
<span class="sd">    Matching:  {frozenset({&#39;v1&#39;, &#39;v2&#39;}), frozenset({&#39;v5&#39;, &#39;v6&#39;}),</span>
<span class="sd">                frozenset({&#39;v3&#39;, &#39;v4&#39;}), frozenset({&#39;v7&#39;, &#39;v8&#39;}) }</span>
<span class="sd">    circo -Tpng maxMatchingcyleGraph.dot -o maxMatchingcyleGraph.png</span>

<span class="sd">    .. image:: maxMatchingcycleGraph.png</span>
<span class="sd">        :alt: maximum matching colored c8</span>
<span class="sd">        :width: 300 px</span>
<span class="sd">        :align: center </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">graphs</span> <span class="kn">import</span> <span class="n">CycleGraph</span>
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">omin</span>

        <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">CycleGraph</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">CycleGraph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;line-&#39;</span> <span class="o">+</span> <span class="n">graph</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>      
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                <span class="n">vertices</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">edge</span><span class="p">))}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">v1</span> <span class="o">!=</span> <span class="n">v2</span><span class="p">:</span>
                    <span class="n">intv</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">&amp;</span> <span class="n">v2</span>
                    <span class="n">unv</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">|</span> <span class="n">v2</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">intv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">v1</span><span class="p">),</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">v2</span><span class="p">)])]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">v1</span><span class="p">],</span><span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">v2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">v1</span><span class="p">),</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">v2</span><span class="p">)])]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span></div>


<span class="c1">####################</span>

<div class="viewcode-block" id="PermutationGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.PermutationGraph">[docs]</a>
<span class="k">class</span> <span class="nc">PermutationGraph</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Martin Ch. Gulombic, Agorithmic Graph Theory and Perfect Graphs 2nd Ed.,</span>
<span class="sd">    Annals of Discrete Mathematics 57, Elsevier, Chapter 7, pp 157-170.</span>

<span class="sd">    &gt;&gt;&gt; from graphs import PermutationGraph</span>
<span class="sd">    &gt;&gt;&gt; g = PermutationGraph()</span>
<span class="sd">    &gt;&gt;&gt; g</span>
<span class="sd">    *------- Graph instance description ------*</span>
<span class="sd">    Instance class   : PermutationGraph</span>
<span class="sd">    Instance name    : permutationGraph</span>
<span class="sd">    Graph Order      : 6</span>
<span class="sd">    Permutation      : [4, 3, 6, 1, 5, 2]</span>
<span class="sd">    Graph Size       : 9</span>
<span class="sd">    Valuation domain : [-1.00; 1.00]</span>
<span class="sd">    Attributes       : [&#39;name&#39;, &#39;vertices&#39;, &#39;order&#39;, &#39;permutation&#39;,</span>
<span class="sd">                        &#39;valuationDomain&#39;, &#39;edges&#39;, &#39;size&#39;, &#39;gamma&#39;]</span>
<span class="sd">    &gt;&gt;&gt; g.exportGraphViz()</span>
<span class="sd">    *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">    Exporting to permutationGraph.dot</span>
<span class="sd">    fdp -Tpng permutationGraph.dot -o permutationGraph.png</span>

<span class="sd">    .. image:: permutationGraph.png</span>
<span class="sd">        :alt: Default permutation graph</span>
<span class="sd">        :width: 300 px</span>
<span class="sd">        :align: center </span>
<span class="sd"> </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">permutation</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;permutationGraph&#39;</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">vertices</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        
        <span class="n">edges</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">invi</span> <span class="o">=</span> <span class="n">permutation</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">invj</span> <span class="o">=</span> <span class="n">permutation</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i,invi, j, invj&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">invi</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">invj</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">invi</span> <span class="o">-</span> <span class="n">invj</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">invi</span> <span class="o">-</span> <span class="n">invj</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)])]</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)])]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>

<div class="viewcode-block" id="PermutationGraph.transitiveOrientation">
<a class="viewcode-back" href="../techDoc.html#graphs.PermutationGraph.transitiveOrientation">[docs]</a>
    <span class="k">def</span> <span class="nf">transitiveOrientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a digraph where each edge of the permutation graph *self*</span>
<span class="sd">        is converted into an arc oriented in increasing order of the adjacent vertices&#39; numbers.</span>
<span class="sd">        This orientation is always transitive and delivers a weak ordering of the vertices.</span>
<span class="sd">    </span>
<span class="sd">        &gt;&gt;&gt; from graphs import PermutationGraph</span>
<span class="sd">        &gt;&gt;&gt; g = PermutationGraph()</span>
<span class="sd">        &gt;&gt;&gt; dg = g.transitiveOrientation()</span>
<span class="sd">        &gt;&gt;&gt; dg</span>
<span class="sd">        *------- Digraph instance description ------*</span>
<span class="sd">        Instance class   : TransitiveDigraph</span>
<span class="sd">        Instance name    : oriented_permutationGraph</span>
<span class="sd">        Digraph Order      : 6</span>
<span class="sd">        Digraph Size       : 9</span>
<span class="sd">        Valuation domain : [-1.00; 1.00]</span>
<span class="sd">        Determinateness  : 100.000</span>
<span class="sd">        Attributes       : [&#39;name&#39;, &#39;order&#39;, &#39;actions&#39;, &#39;valuationdomain&#39;,</span>
<span class="sd">                            &#39;relation&#39;, &#39;gamma&#39;, &#39;notGamma&#39;, &#39;size&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dg.exportGraphViz()</span>
<span class="sd">        *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">        Exporting to oriented_permutationGraph.dot</span>
<span class="sd">        0 { rank = same; 1; 2; }</span>
<span class="sd">        1 { rank = same; 5; 3; }</span>
<span class="sd">        2 { rank = same; 4; 6; }</span>
<span class="sd">        dot -Grankdir=TB -Tpng oriented_permutationGraph.dot -o oriented_permutationGraph.png</span>

<span class="sd">        .. image:: oriented_permutationGraph.png</span>
<span class="sd">            :alt: Transitive orientation of a permutation graph</span>
<span class="sd">            :width: 200 px</span>
<span class="sd">            :align: center </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">EmptyDigraph</span>
        <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="n">TransitiveDigraph</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        
        <span class="n">g</span> <span class="o">=</span> <span class="n">EmptyDigraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">TransitiveDigraph</span>
        <span class="n">g</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;oriented_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">g</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationDomain</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="n">g</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="n">g</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">g</span></div>


<div class="viewcode-block" id="PermutationGraph.computeMinimalVertexColoring">
<a class="viewcode-back" href="../techDoc.html#graphs.PermutationGraph.computeMinimalVertexColoring">[docs]</a>
    <span class="k">def</span> <span class="nf">computeMinimalVertexColoring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a vertex coloring by using a minimal number of color queues for sorting the</span>
<span class="sd">        given permutation. Sets by the way the chromatic number of the graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">permutation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permutation</span>
        <span class="n">vertexKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span><span class="s1">&#39;lightyellow&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>\
                  <span class="s1">&#39;lightpink&#39;</span><span class="p">,</span><span class="s1">&#39;seagreen1&#39;</span><span class="p">,</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span><span class="s1">&#39;wheat1&#39;</span><span class="p">,</span><span class="s1">&#39;lightsalmon&#39;</span><span class="p">,</span><span class="s1">&#39;wheat&#39;</span><span class="p">]</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">jQpt</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Error: The number of available colors </span><span class="si">%d</span><span class="s1"> is not sufficient !!!&#39;</span> <span class="o">%</span> <span class="n">nc</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">if</span> <span class="n">permutation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">jQpt</span><span class="p">]:</span>
                    <span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">permutation</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
        <span class="n">vertexColor</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="n">chromNumber</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">nj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">nj</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">chromNumber</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nj</span><span class="p">):</span>
                    <span class="n">k</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="n">vertexColor</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chromaticNumber</span> <span class="o">=</span> <span class="n">chromNumber</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">vertexColor</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">chromNumber</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">vertexKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertexColor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vertex </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vertexKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertexColor</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span></div>
</div>

    
<div class="viewcode-block" id="RandomPermutationGraph">
<a class="viewcode-back" href="../techDoc.html#graphs.RandomPermutationGraph">[docs]</a>
<span class="k">class</span> <span class="nc">RandomPermutationGraph</span><span class="p">(</span><span class="n">PermutationGraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A generator for random permutation graphs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">permutation</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">PermutationGraph</span><span class="p">(</span><span class="n">permutation</span><span class="o">=</span><span class="n">permutation</span><span class="p">)</span>
        <span class="n">att</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">att</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;randomPermGraph&#39;</span></div>

        
<span class="c1"># --------------testing the module ----</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Digraph3 graphs module                           *</span>
<span class="s2">    * Copyright (C) 2010-2021 Raymond Bisdorff         *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">cg</span> <span class="o">=</span> <span class="n">CompleteGraph</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">verticesIdPrefix</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">cg1</span> <span class="o">=</span> <span class="n">CompleteGraph</span><span class="p">(</span><span class="n">verticesKeys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">,</span><span class="s1">&#39;v2&#39;</span><span class="p">,</span><span class="s1">&#39;v3&#39;</span><span class="p">])</span>
    <span class="n">bpg</span> <span class="o">=</span> <span class="n">CompleteBipartiteGraph</span><span class="p">([</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span><span class="s1">&#39;a2&#39;</span><span class="p">,</span><span class="s1">&#39;a3&#39;</span><span class="p">],[</span><span class="s1">&#39;b1&#39;</span><span class="p">,</span><span class="s1">&#39;b2&#39;</span><span class="p">,</span><span class="s1">&#39;b3&#39;</span><span class="p">,</span><span class="s1">&#39;b4&#39;</span><span class="p">])</span>
    <span class="n">bpg</span><span class="o">.</span><span class="n">showShort</span><span class="p">()</span>
    <span class="n">bpg</span><span class="o">.</span><span class="n">showEdgesCharacteristicValues</span><span class="p">()</span>
    <span class="n">bpg</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">()</span>    

<span class="c1">##    t = RandomTree(prueferCode=[&#39;v11&#39;, &#39;v4&#39;, &#39;v8&#39;, &#39;v7&#39;, &#39;v7&#39;, &#39;v10&#39;, &#39;v9&#39;, &#39;v10&#39;, &#39;v2&#39;, &#39;v7&#39;])</span>
<span class="c1">##    #print(t.computeTreeCenters())</span>
<span class="c1">##    #t.exportGraphViz(&#39;test&#39;)</span>
<span class="c1">##    print(t)</span>
<span class="c1">##    #dg = t.tree2OrientedTree(root=None,Debug=True)</span>
<span class="c1">##    #print(dg)</span>
<span class="c1">##    t.exportOrientedTreeGraphViz(root=None,fileName=&#39;testOr&#39;)</span>
<span class="c1">##    t.save(&#39;testT&#39;)</span>
<span class="c1">##    t = TreeGraph(&#39;testT&#39;)</span>
<span class="c1">##    print(t)</span>
<span class="c1">##    print(t.computeGraphCentres())</span>
<span class="c1">##    </span>
<span class="c1">##</span>
<span class="c1">##    from graphs import MetropolisChain</span>
<span class="c1">##    g = Graph(numberOfVertices=5,edgeProbability=0.5)</span>
<span class="c1">##    g.showShort()</span>
<span class="c1">##    probs = {}  # initialize a potential stationary probability vector</span>
<span class="c1">##    n = g.order # for instance: probs[v_i] = n-i/Sum(1:n) for i in 1:n</span>
<span class="c1">##    i = 0</span>
<span class="c1">##    verticesList = [x for x in g.vertices]</span>
<span class="c1">##    verticesList.sort()</span>
<span class="c1">##    for v in verticesList:</span>
<span class="c1">##        probs[v] = (n - i)/(n*(n+1)/2)</span>
<span class="c1">##        i += 1</span>
<span class="c1">##    met = MetropolisChain(g,probs)</span>
<span class="c1">##    print(met)</span>
<span class="c1">##    print(met.vertices)</span>
<span class="c1">##    frequency = met.checkSampling(verticesList[0],nSim=30000)</span>
<span class="c1">##    for v in verticesList:</span>
<span class="c1">##        print(v,probs[v],frequency[v]) </span>
<span class="c1">##    met.showTransitionMatrix()</span>
<span class="c1">##    # g.exportGraphViz()</span>
<span class="c1">##    # #print(g.breadthFirstSearch(&#39;v1&#39;,Debug=False))</span>
<span class="c1">##    # print(g.isPerfectGraph(Comments=True))</span>
<span class="c1">##    # g.computeGirth(girthType=&quot;odd&quot;,Comments=True)</span>
<span class="c1">##    # g.computeGirth(girthType=&quot;even&quot;,Comments=True)</span>
<span class="c1">##    # g.computeGirth(Comments=True)</span>
    
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>
<span class="c1">#####################################</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2025, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Mar 24, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>