

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>transitiveDigraphs &mdash; Digraph3 3.13.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=a126d08a"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=15d7cbb8"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">transitiveDigraphs</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for transitiveDigraphs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Digraph3 module for working with transitive digraphs. </span>
<span class="sd">Copyright (C) 2006-2025  Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#######################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.13.2&quot;</span>

<span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1">#from multiprocessing import Process, active_children, cpu_count</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="s1">&#39;spawn&#39;</span><span class="p">)</span>
<span class="n">Process</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Process</span>
<span class="n">active_children</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">active_children</span>
<span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>


<div class="viewcode-block" id="TransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">TransitiveDigraph</span><span class="p">(</span><span class="n">Digraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class for specialized methods addressing transitive digraphs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;abstract root class&#39;</span><span class="p">)</span>

   
            
        
<span class="c1">##        for comp in components.values():</span>
<span class="c1">##            #comp = self.components[cki]</span>
<span class="c1">##            pg = comp[&#39;subGraph&#39;]</span>
<span class="c1">##            if rankingRule == &#39;Copeland&#39;:</span>
<span class="c1">##                opg = CopelandOrder(pg)</span>
<span class="c1">##                ranking += opg.copelandRanking</span>
<span class="c1">##            elif rankingRule == &#39;NetFlows&#39;:</span>
<span class="c1">##                opg = NetFlowsOrder(pg)</span>
<span class="c1">##                ranking += opg.netFlowsRanking</span>
<span class="c1">##            elif rankingRule == &#39;Kohler&#39;:</span>
<span class="c1">##                opg = KohlerOrder(pg)</span>
<span class="c1">##                ranking += opg.kohlerRanking</span>
<span class="c1">##        return ranking</span>

<div class="viewcode-block" id="TransitiveDigraph.computeBoostedOrdering">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.computeBoostedOrdering">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBoostedOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">orderingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders an ordred list of decision actions ranked in</span>
<span class="sd">        increasing preference direction following the orderingRule</span>
<span class="sd">        on each component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBoostedRanking</span><span class="p">(</span><span class="n">rankingRule</span><span class="o">=</span><span class="n">orderingRule</span><span class="p">)</span>
        <span class="n">ranking</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ranking</span></div>

    
        
<div class="viewcode-block" id="TransitiveDigraph.showPartialOrder">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.showPartialOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">showPartialOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A dummy for the showTransitiveDigraph() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="n">WithCoverCredibility</span><span class="p">)</span></div>


<div class="viewcode-block" id="TransitiveDigraph.showPartialRanking">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.showPartialRanking">[docs]</a>
    <span class="k">def</span> <span class="nf">showPartialRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A dummy for the showTransitiveDigraph() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="n">WithCoverCredibility</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TransitiveDigraph.showTransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.showTransitiveDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A show method for self.rankinByChoosing result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rankingByChoosing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1">#print(&#39;Error: You must first run self.computeRankingByChoosing(CoDual=False(default)|True) !&#39;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">computeRankingByChoosing</span><span class="p">()</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
<span class="c1">##            else:</span>
<span class="c1">##                try:</span>
<span class="c1">##                    rankingByChoosing = self.rankingByLastChoosing[&#39;result&#39;]</span>
<span class="c1">##                except:</span>
<span class="c1">##                    #print(&#39;Error: You must first run self.computeRankingByChoosing(CoDual=False(default)|True) !&#39;)</span>
<span class="c1">##                    self.computeRankingByLastChoosing()</span>
<span class="c1">##                    rankingByChoosing = self.rankingByLastChoosing[&#39;result&#39;]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking by recursively first and last choosing&#39;</span><span class="p">)</span>
        <span class="n">space</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;st&#39;</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;nd&#39;</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;rd&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;th&#39;</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iwch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iach</span> <span class="o">=</span> <span class="n">iwch</span> <span class="o">&amp;</span> <span class="n">ibch</span>
            <span class="c1">#print &#39;ibch, iwch, iach&#39;, i, ibch,iwch,iach</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ibch</span><span class="p">)</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">WithCoverCredibility</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s%s%s</span><span class="s1"> ranked </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nstr</span><span class="p">,</span><span class="n">ch</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s%s%s</span><span class="s1"> ranked </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nstr</span><span class="p">,</span><span class="n">ch</span><span class="p">)</span> <span class="p">)</span>
                
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iach</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> Ambiguous Choice </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">iach</span><span class="p">)))</span>
                <span class="n">space</span> <span class="o">+=</span> <span class="s1">&#39;  &#39;</span>
            <span class="n">space</span> <span class="o">+=</span> <span class="s1">&#39;  &#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;st&#39;</span>
            <span class="k">elif</span> <span class="n">n</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;nd&#39;</span>
            <span class="k">elif</span> <span class="n">n</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;rd&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nstr</span><span class="o">=</span><span class="s1">&#39;th&#39;</span>
            <span class="n">space</span> <span class="o">=</span> <span class="n">space</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iwch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">iach</span> <span class="o">=</span> <span class="n">iwch</span> <span class="o">&amp;</span> <span class="n">ibch</span>
            <span class="c1">#print &#39;ibch, iwch, iach&#39;, i, ibch,iwch,iach</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iwch</span><span class="p">)</span>
            <span class="n">ch</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iach</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">space</span> <span class="o">=</span> <span class="n">space</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> Ambiguous Choice </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">iach</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">WithCoverCredibility</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s%s%s</span><span class="s1"> last ranked </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">nstr</span><span class="p">,</span><span class="n">ch</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s%s%s</span><span class="s1"> last ranked </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">nstr</span><span class="p">,</span><span class="n">ch</span><span class="p">)</span> <span class="p">)</span></div>

                

<div class="viewcode-block" id="TransitiveDigraph.showRankingByChoosing">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.showRankingByChoosing">[docs]</a>
    <span class="k">def</span> <span class="nf">showRankingByChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy name for showTransitiveDigraph() method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="n">rankingByChoosing</span><span class="p">,</span>
                                   <span class="n">WithCoverCredibility</span><span class="o">=</span><span class="n">WithCoverCredibility</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TransitiveDigraph.showOrderedRelationTable">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.showOrderedRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showOrderedRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;decreasing&quot;</span><span class="p">,</span><span class="n">originalRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Showing the relation table in decreasing (default) or increasing order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;decreasing&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decreasing Weak Ordering&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showRankingByBestChoosing</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;increasing&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Increasing Weak Ordering&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showRankingByLastChoosing</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Direction error !: </span><span class="si">%s</span><span class="s1"> is not a correct instruction (decreasing=default or increasing)&#39;</span> <span class="o">%</span> <span class="n">direction</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">ordering</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]:</span>
            <span class="c1">#print(eq[1])</span>
            <span class="n">eq</span> <span class="o">=</span> <span class="n">eq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">eq</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eq</span><span class="p">:</span>
                <span class="n">actionsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !: missing action(s) </span><span class="si">%s</span><span class="s1"> in ordered table.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">originalRelation</span><span class="p">:</span>
            <span class="n">showRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">originalRelation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">showRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
            
        <span class="n">Digraph</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                                <span class="n">relation</span><span class="o">=</span><span class="n">showRelation</span><span class="p">,</span>
                                <span class="n">Sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="TransitiveDigraph.exportDigraphGraphViz">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.exportDigraphGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportDigraphGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bestChoice</span><span class="o">=</span><span class="nb">set</span><span class="p">(),</span><span class="n">worstChoice</span><span class="o">=</span><span class="nb">set</span><span class="p">(),</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for digraph drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Digraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                               <span class="n">bestChoice</span><span class="o">=</span><span class="n">bestChoice</span><span class="p">,</span>
                               <span class="n">worstChoice</span><span class="o">=</span><span class="n">worstChoice</span><span class="p">,</span>
                               <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                               <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                               <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">)</span></div>


<span class="c1">#     def exportTopologicalGraphViz(self,fileName=None,</span>
<span class="c1">#                                   relation=None,direction=&#39;best&#39;,</span>
<span class="c1">#                                   Comments=True,graphType=&#39;png&#39;,</span>
<span class="c1">#                                   graphSize=&#39;7,7&#39;,</span>
<span class="c1">#                                   fontSize=10,Debug=True):</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         export GraphViz dot file for Hasse diagram drawing filtering.</span>
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         import os</span>
<span class="c1">#         from copy import copy as deepcopy</span>
            
<span class="c1">#         def _safeName(t0):</span>
<span class="c1">#             t = t0.split(sep=&quot;-&quot;)</span>
<span class="c1">#             t1 = t[0]</span>
<span class="c1">#             n = len(t)</span>
<span class="c1">#             if n &gt; 1:</span>
<span class="c1">#                 for i in range(1,n):</span>
<span class="c1">#                     t1 += &#39;%s%s&#39; % (&#39;_&#39;,t[i])</span>
<span class="c1">#             return t1</span>
<span class="c1">#         # working on a deepcopy of self</span>
<span class="c1">#         digraph = deepcopy(self)</span>
<span class="c1">#         digraph.computeTopologicalRanking()</span>
<span class="c1">#         if not digraph.Acyclic:</span>
<span class="c1">#             print(&#39;Error: not a transitive digraph !!!&#39;)</span>
<span class="c1">#             return</span>
<span class="c1">#         topologicalRanking = digraph.computeTopologicalRanking()</span>
<span class="c1">#         if Debug:</span>
<span class="c1">#             print(topologicalRanking)</span>
<span class="c1"># ##        if direction == &#39;best&#39;:</span>
<span class="c1"># ##            try:</span>
<span class="c1"># ##                rankingByChoosing = digraph.rankingByBestChoosing[&#39;result&#39;]</span>
<span class="c1"># ##            except:</span>
<span class="c1"># ##                digraph.computeRankingByBestChoosing()</span>
<span class="c1"># ##                rankingByChoosing = digraph.rankingByBestChoosing[&#39;result&#39;]</span>
<span class="c1"># ##        else:</span>
<span class="c1"># ##            try:</span>
<span class="c1"># ##                rankingByChoosing = digraph.rankingByLastChoosing[&#39;result&#39;]</span>
<span class="c1"># ##            except:</span>
<span class="c1"># ##                digraph.computeRankingByLastChoosing()</span>
<span class="c1"># ##                rankingByChoosing = digraph.rankingByLastChoosing[&#39;result&#39;]</span>
<span class="c1"># ##        if Debug:</span>
<span class="c1"># ##            print(rankingByChoosing)</span>
        
<span class="c1">#         if Comments:</span>
<span class="c1">#             print(&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;)</span>
<span class="c1">#         actionKeys = [x for x in digraph.actions]</span>
<span class="c1">#         n = len(actionKeys)</span>
<span class="c1">#         if relation is None:</span>
<span class="c1">#             relation = deepcopy(digraph.relation)</span>
<span class="c1">#         Med = digraph.valuationdomain[&#39;med&#39;]</span>
<span class="c1">#         i = 0</span>
<span class="c1">#         if fileName is None:</span>
<span class="c1">#             name = digraph.name</span>
<span class="c1">#         else:</span>
<span class="c1">#             name = fileName</span>
<span class="c1">#         dotName = name+&#39;.dot&#39;</span>
<span class="c1">#         if Comments:</span>
<span class="c1">#             print(&#39;Exporting to &#39;+dotName)</span>
<span class="c1"># ##        if bestChoice != set():</span>
<span class="c1"># ##            rankBestString = &#39;{rank=max; &#39;</span>
<span class="c1"># ##        if worstChoice != set():</span>
<span class="c1"># ##            rankWorstString = &#39;{rank=min; &#39;</span>
<span class="c1">#         fo = open(dotName,&#39;w&#39;)</span>
<span class="c1">#         fo.write(&#39;digraph G {\n&#39;)</span>
<span class="c1">#         fo.write(&#39;graph [ bgcolor = cornsilk, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,\n fontsize = 12,\n label = &quot;&#39;)</span>
<span class="c1">#         fo.write(&#39;\\nDigraph3 (graphviz)\\n R. Bisdorff, 2020&quot;, size=&quot;&#39;)</span>
<span class="c1">#         fo.write(graphSize),fo.write(&#39;&quot;,fontsize=%d];\n&#39; % fontSize)</span>
<span class="c1">#         # nodes</span>
<span class="c1">#         for x in actionKeys:  </span>
<span class="c1">#             try:</span>
<span class="c1">#                 nodeName = digraph.actions[x][&#39;shortName&#39;]</span>
<span class="c1">#             except:</span>
<span class="c1">#                 nodeName = str(x)</span>
<span class="c1">#             node = &#39;%s [shape = &quot;circle&quot;, label = &quot;%s&quot;, fontsize=%d];\n&#39;\</span>
<span class="c1">#                    % (str(_safeName(x)),_safeName(nodeName),fontSize)</span>
<span class="c1">#             fo.write(node)</span>
<span class="c1">#         # same ranks for Hasses equivalence classes</span>
<span class="c1">#         k = len(topologicalRanking)</span>
<span class="c1">#         i = 1</span>
<span class="c1">#         for ich in topologicalRanking:</span>
<span class="c1">#             sameRank = &#39;subGraph { rank = %d ; &#39; % i</span>
<span class="c1">#             for x in topologicalRanking[ich]:</span>
<span class="c1">#                 sameRank += str(_safeName(x))+&#39;; &#39;</span>
<span class="c1">#             sameRank += &#39;}\n&#39;</span>
<span class="c1">#             print(i,sameRank)</span>
<span class="c1">#             fo.write(sameRank)</span>
<span class="c1">#             i += 1</span>
<span class="c1"># ##        k = len(rankingByChoosing)</span>
<span class="c1"># ##        for i in range(k):</span>
<span class="c1"># ##            sameRank = &#39;{ rank = same; &#39;</span>
<span class="c1"># ##            ich = rankingByChoosing[i][1]</span>
<span class="c1"># ##            for x in ich:</span>
<span class="c1"># ##                sameRank += str(_safeName(x))+&#39;; &#39;</span>
<span class="c1"># ##            sameRank += &#39;}\n&#39;</span>
<span class="c1"># ##            print(i,sameRank)</span>
<span class="c1"># ##            fo.write(sameRank)</span>

<span class="c1">#         # save original relation</span>
<span class="c1">#         #originalRelation = deepcopy(relation)</span>
<span class="c1">#         #digraph.closeTransitive(Reverse=False)</span>
<span class="c1">#         relation = digraph.closeTransitive(Reverse=True,InSite=False)</span>
<span class="c1">#         k = len(topologicalRanking)</span>
<span class="c1">#         for i in range(1,k+1):</span>
<span class="c1">#             ich = topologicalRanking[i]</span>
<span class="c1">#             for x in ich:</span>
<span class="c1">#                 for j in range(i+1,k+1):</span>
<span class="c1">#                     jch = topologicalRanking[j]</span>
<span class="c1">#                     for y in jch:</span>
<span class="c1">#                         if relation[x][y] &gt; digraph.valuationdomain[&#39;med&#39;]:</span>
<span class="c1">#                             arcColor = &#39;black&#39;</span>
<span class="c1">#                             edge = &#39;%s-&gt; %s [style=&quot;setlinewidth(%d)&quot;,color=%s] ;\n&#39; %\</span>
<span class="c1">#                                 (_safeName(x),_safeName(y),1,arcColor)</span>
<span class="c1">#                             fo.write(edge)                                                  </span>
<span class="c1">#         fo.write(&#39;}\n \n&#39;)</span>
<span class="c1">#         fo.close()</span>
        
<span class="c1">#         commandString = &#39;dot -Grankdir=TB -T&#39;+graphType+&#39; &#39; + \</span>
<span class="c1">#                            dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
<span class="c1">#             #commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
<span class="c1">#         if Comments:</span>
<span class="c1">#             print(commandString)</span>
<span class="c1">#         try:</span>
<span class="c1">#             os.system(commandString)</span>
<span class="c1">#         except:</span>
<span class="c1">#             if Comments:</span>
<span class="c1">#                 print(&#39;graphViz tools not avalaible! Please check installation.&#39;)</span>

<div class="viewcode-block" id="TransitiveDigraph.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.TransitiveDigraph.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
                       <span class="n">WithBestPathDecoration</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">WithRatingDecoration</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">ArrowHeads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for Hasse diagram drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
            
        <span class="k">def</span> <span class="nf">_safeName</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">t1</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">t1</span>
        <span class="c1"># working on a deepcopy of self</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByBestChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">()</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByBestChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByLastChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">()</span>
                <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByLastChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">)</span>
        <span class="c1">#if relation is None:</span>
        <span class="c1">#    relation = deepcopy(digraph.relation)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
<span class="c1">##        if bestChoice != set():</span>
<span class="c1">##            rankBestString = &#39;{rank=max; &#39;</span>
<span class="c1">##        if worstChoice != set():</span>
<span class="c1">##            rankWorstString = &#39;{rank=min; &#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="n">bgcolor</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz)</span><span class="se">\\</span><span class="s1">n R. Bisdorff, 2020&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;,fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fontSize</span><span class="p">)</span>
        <span class="c1"># nodes</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">WithRatingDecoration</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                    <span class="n">cat</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; -&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">nodeName</span> <span class="o">=</span> <span class="s1">&#39;- &#39;</span> <span class="o">+</span><span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;box&quot;, fillcolor=lightcoral, style=filled, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">nodeName</span><span class="p">,</span><span class="n">fontSize</span><span class="p">)</span>           
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>       
            <span class="k">elif</span> <span class="n">WithBestPathDecoration</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                    
                <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">optimalPath</span><span class="p">:</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, fillcolor=lightcoral, style=filled, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>           
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>       
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># same ranks for Hasses equivalence classes</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">sameRank</span> <span class="o">=</span> <span class="s1">&#39;subgraph { rank=same; &#39;</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="n">sameRank</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;; &#39;</span>
            <span class="n">sameRank</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sameRank</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sameRank</span><span class="p">)</span>

        <span class="c1"># open transitive links and write the positive arcs</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">InSite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                    <span class="n">jch</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">jch</span><span class="p">:</span>
                        <span class="c1">#edge = &#39;n&#39;+str(i+1)+&#39;-&gt; n&#39;+str(i+2)+&#39; [dir=forward,style=&quot;setlinewidth(1)&quot;,color=black, arrowhead=normal] ;\n&#39;</span>
                        <span class="k">if</span> <span class="n">WithBestPathDecoration</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">optimalPath</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">optimalPath</span><span class="p">:</span>
                                <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span>
                                <span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">2</span>
                                <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                                    <span class="c1">#arcColor = &#39;black&#39;</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [label=&quot;</span><span class="si">%.0f</span><span class="s1">&quot;,style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                        <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">digraph</span><span class="o">.</span><span class="n">costs</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                                <span class="k">elif</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                                    <span class="c1">#arcColor = &#39;black&#39;</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [label=&quot;</span><span class="si">%.0f</span><span class="s1">&quot;,style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                        <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">digraph</span><span class="o">.</span><span class="n">costs</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">],</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">arcColor</span><span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
                                <span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">1</span>
                                <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                                    <span class="c1">#arcColor = &#39;black&#39;</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                        <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                                <span class="k">elif</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                                    <span class="c1">#arcColor = &#39;black&#39;</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                        <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">lineWidth</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                                <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                                <span class="k">if</span> <span class="n">ArrowHeads</span><span class="p">:</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">,arrowhead=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>                                    
                                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                                <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                                <span class="k">if</span> <span class="n">ArrowHeads</span><span class="p">:</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">,arrowhead=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                    
                                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                                                  
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># restore original relation</span>
        <span class="c1">#relation = deepcopy(originalRelation)</span>
        
        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;dot -Grankdir=TB -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span>\
                        <span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="c1">#commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="RankingsFusionDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingsFusionDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RankingsFusionDigraph</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the abstract TransitiveDigraph class for </span>
<span class="sd">    digraphs resulting from the epistemic</span>
<span class="sd">    disjunctive or conjunctive fusion (omax|omin operator) of a list of rankings.</span>

<span class="sd">    *Parameters*:</span>
<span class="sd">    </span>
<span class="sd">        * other = either a Digraph or a PerformanceTableau object;</span>
<span class="sd">        * fusionOperator = &#39;o-max&#39; (default) | &#39;o-min&#39; : Disjunctive, resp. conjuntive epistemic fusion.</span>

<span class="sd">    Example application:</span>

<span class="sd">    &gt;&gt;&gt; from transitiveDigraphs import RankingsFusionDigraph</span>
<span class="sd">    &gt;&gt;&gt; from sparseOutrankingDigraphs import PreRankedOutrankingDigraph</span>
<span class="sd">    &gt;&gt;&gt; t = RandomPerformanceTableau(seed=1)</span>
<span class="sd">    &gt;&gt;&gt; pr = PreRankedOutrankingDigraph(t,10,quantilesOrderingStrategy=&#39;average&#39;)</span>
<span class="sd">    &gt;&gt;&gt; r1 = pr.boostedRanking</span>
<span class="sd">    &gt;&gt;&gt; pro = PreRankedOutrankingDigraph(t,10,quantilesOrderingStrategy=&#39;optimistic&#39;)</span>
<span class="sd">    &gt;&gt;&gt; r2 = pro.boostedRanking</span>
<span class="sd">    &gt;&gt;&gt; prp = PreRankedOutrankingDigraph(t,10,quantilesOrderingStrategy=&#39;pessimistic&#39;)</span>
<span class="sd">    &gt;&gt;&gt; r3 = prp.boostedRanking</span>
<span class="sd">    &gt;&gt;&gt; wqr = RankingsFusionDigraph(pr,[r1,r2,r3])</span>
<span class="sd">    &gt;&gt;&gt; wqr.boostedRanking</span>
<span class="sd">    [&#39;a07&#39;, &#39;a10&#39;, &#39;a06&#39;, &#39;a11&#39;, &#39;a02&#39;, &#39;a08&#39;, &#39;a04&#39;, &#39;a03&#39;, &#39;a01&#39;, &#39;a09&#39;, &#39;a12&#39;, &#39;a13&#39;, &#39;a05&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">rankings</span><span class="p">,</span><span class="n">fusionOperator</span><span class="o">=</span><span class="s1">&#39;o-max&#39;</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">ranking2preorder</span><span class="p">,</span> <span class="n">omax</span><span class="p">,</span> <span class="n">omin</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rankings</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankings</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: several rankings have to be provided!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_wk&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankings</span> <span class="o">=</span> <span class="n">rankings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fusionOperator</span> <span class="o">=</span> <span class="n">fusionOperator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">relations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="n">rankings</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">rel</span><span class="p">)</span>
            <span class="n">relations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computePreorderRelation</span><span class="p">(</span><span class="n">ranking2preorder</span><span class="p">(</span><span class="n">rel</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">relations</span><span class="p">)</span>

        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">relations</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">))]</span>
                <span class="k">if</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s1">&#39;o-max&#39;</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omax</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s1">&#39;o-min&#39;</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omin</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: incorrect fusion operator </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fusionOperator</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RankingsFusion">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingsFusion">[docs]</a>
<span class="k">class</span> <span class="nc">RankingsFusion</span><span class="p">(</span><span class="n">RankingsFusionDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obsolete dummy for the RankingsFusionDigraph class</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="KemenyOrdersFusion">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.KemenyOrdersFusion">[docs]</a>
<span class="k">class</span> <span class="nc">KemenyOrdersFusion</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the abstract TransitiveDigraph class for </span>
<span class="sd">    transitive digraphs resulting from the epistemic</span>
<span class="sd">    disjunctive (default) or conjunctive fusion of</span>
<span class="sd">    all potential Kemeny linear orderings.</span>

<span class="sd">    *Parameter*:</span>

<span class="sd">         * fusionOperator = &#39;o-max&#39; (default) | &#39;o-min&#39; : Disjunctive, resp. conjuntive epistemic fusion.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">orderLimit</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">fusionOperator</span><span class="o">=</span><span class="s1">&#39;o-max&#39;</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">order</span> <span class="o">&gt;</span> <span class="n">orderLimit</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Digraph order </span><span class="si">%d</span><span class="s1"> to high. The default limit (7) may be changed with the oderLimit argument.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
                  
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">ranking2preorder</span><span class="p">,</span> <span class="n">omax</span><span class="p">,</span> <span class="n">omin</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_wk&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="c1">#relation = copy(other.relation)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeKemenyRanking</span><span class="p">(</span><span class="n">orderLimit</span><span class="o">=</span><span class="n">orderLimit</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># [0] = ordered actions list, [1] = maximal Kemeny index</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Intantiation error: unable to compute the Kemeny Order !!!&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Digraph order </span><span class="si">%d</span><span class="s1"> is required to be lower than 8!&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">kemenyRankings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximalRankings</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">kemenyRankings</span><span class="p">)</span>
        <span class="n">relations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rel</span> <span class="ow">in</span> <span class="n">kemenyRankings</span><span class="p">:</span>
            <span class="c1">#print(rel)</span>
            <span class="n">relations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computePreorderRelation</span><span class="p">(</span><span class="n">ranking2preorder</span><span class="p">(</span><span class="n">rel</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">relations</span><span class="p">)</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">relations</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relations</span><span class="p">))]</span>
                <span class="k">if</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s1">&#39;o-max&#39;</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omax</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s1">&#39;o-min&#39;</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omin</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: incorrect fusion operator </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fusionOperator</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="c1">#print(self.relation)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span></div>


<span class="c1"># myThread for KohlerArrawRaynaudFusion</span>
<span class="c1">##        if Threading:</span>
<span class="c1">##            from multiprocessing import Process, Lock, active_children, cpu_count</span>
<span class="k">class</span> <span class="nc">_myKARThread</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span> <span class="n">Debug</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span> <span class="o">=</span> <span class="n">tempDirName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">KohlerOrder</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
        <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
        <span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">setrecursionlimit</span>
        <span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working in </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c1">#threadLock.acquire()</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpDigraph.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ko.py&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">ko</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">ko</span><span class="o">.</span><span class="n">relation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;worst&#39;</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ar.py&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">ar</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">((</span><span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">digraph</span><span class="p">)))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">relation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1">#threadLock.release()</span>



<div class="viewcode-block" id="KohlerArrowRaynaudFusion">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.KohlerArrowRaynaudFusion">[docs]</a>
<span class="k">class</span> <span class="nc">KohlerArrowRaynaudFusion</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the abstract TransitiveDigraph class for </span>
<span class="sd">    ranking-by-choosing orderings resulting from the epistemic</span>
<span class="sd">    disjunctive (o-max) or conjunctive (o-min) fusion of a</span>
<span class="sd">    Kohler linear best ordering and an Arrow-Raynaud linear worst ordering. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outrankingDigraph</span><span class="p">,</span>
                 <span class="n">fusionOperator</span><span class="o">=</span><span class="s1">&#39;o-max&#39;</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">ranking2preorder</span><span class="p">,</span> <span class="n">omax</span><span class="p">,</span> <span class="n">omin</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
        <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">KohlerOrder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Threading</span> <span class="o">=</span> <span class="n">Threading</span>
        
                    
        <span class="n">digraph</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">outrankingDigraph</span><span class="p">)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="c1">#self.__class__ = digraph.__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originalRelation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">relation</span>

        <span class="k">if</span> <span class="n">Threading</span> <span class="ow">and</span> <span class="n">cpu_count</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threading ...&#39;</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
            <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
                <span class="n">digraphFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpDigraph.py&#39;</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temDirName, digraphFileName&#39;</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span><span class="n">digraphFileName</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">digraphFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">threadBest</span> <span class="o">=</span> <span class="n">_myKARThread</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;ComputeBest&quot;</span><span class="p">,</span><span class="s2">&quot;best&quot;</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                <span class="n">threadWorst</span> <span class="o">=</span> <span class="n">_myKARThread</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;ComputeWorst&quot;</span><span class="p">,</span><span class="s2">&quot;worst&quot;</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                <span class="n">threadBest</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="n">threadWorst</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="k">pass</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting computing threads&#39;</span><span class="p">)</span>
                <span class="n">koFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/ko.py&#39;</span>          
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">koFileName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">KohlerRelation</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">arFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span> <span class="s1">&#39;/ar.py&#39;</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">arFileName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">ArrowRaynaudRelation</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ko</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">)</span>
            <span class="n">ar</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">((</span><span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">digraph</span><span class="p">)))</span>
            <span class="n">KohlerRelation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">ko</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="n">ArrowRaynaudRelation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kohler = &#39;</span><span class="p">,</span> <span class="n">KohlerRelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ArrowRaynaud = &#39;</span><span class="p">,</span> <span class="n">ArrowRaynaudRelation</span><span class="p">)</span>
            
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">KohlerRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span><span class="n">ArrowRaynaudRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s2">&quot;o-max&quot;</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omax</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s2">&quot;o-min&quot;</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omin</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: invalid epistemic fusion operator </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fusionOperator</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">KohlerRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span>
                          <span class="n">ArrowRaynaudRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span><span class="n">relFusion</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span></div>


<span class="c1">#---------------------</span>
<span class="c1"># my Thread for the RankingByChoosing class</span>
<span class="k">class</span> <span class="nc">_myRBCThread</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span> <span class="n">CoDual</span><span class="p">,</span> <span class="n">Debug</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span> <span class="o">=</span> <span class="n">tempDirName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDual</span> <span class="o">=</span> <span class="n">CoDual</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
        <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
        <span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">setrecursionlimit</span>
        <span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">Debug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span>
        <span class="n">CoDual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDual</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working in </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c1">#threadLock.acquire()</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpDigraph.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rbbc.py&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">rbbc</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">rbbc</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;worst&#39;</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;rbwc.py&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">rbwc</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">rbwc</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="RankingByChoosingDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByChoosingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RankingByChoosingDigraph</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the abstract TransitiveDigraph class for </span>
<span class="sd">    ranking-by-Rubis-choosing orderings.</span>
<span class="sd">    </span>
<span class="sd">    Example python3 session:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from outrankingDigraphs import *</span>
<span class="sd">    &gt;&gt;&gt; t = RandomCBPerformanceTableau(numberOfActions=7,</span>
<span class="sd">    ...            numberOfCriteria=5,</span>
<span class="sd">    ...            weightDistribution=&#39;equiobjectives&#39;)</span>
<span class="sd">    &gt;&gt;&gt; g = BipolarOutrankingDigraph(t,Normalized=True)</span>
<span class="sd">    &gt;&gt;&gt; g.showRelationTable()</span>
<span class="sd">    * ---- Relation Table -----</span>
<span class="sd">       r   |  &#39;a1&#39;   &#39;a2&#39;   &#39;a3&#39;   &#39;a4&#39;   &#39;a5&#39;   &#39;a6&#39;   &#39;a7&#39;   </span>
<span class="sd">    -----|------------------------------------------------------------</span>
<span class="sd">    &#39;a1&#39; |    +1.00  +1.00  +0.67  +0.33  +0.33  -0.17  +0.00  </span>
<span class="sd">    &#39;a2&#39; |   -1.00   +1.00  +0.00  +0.00  +1.00  +0.00  +0.50  </span>
<span class="sd">    &#39;a3&#39; |   -0.33  +0.00   +1.00  +0.17  +0.17  -0.17  +0.00  </span>
<span class="sd">    &#39;a4&#39; |   +0.00  +0.00  +0.50   +1.00  +0.17  -0.33  -0.50  </span>
<span class="sd">    &#39;a5&#39; |   -0.33  -1.00  +0.00  -0.17   +1.00  +0.17  +0.00  </span>
<span class="sd">    &#39;a6&#39; |   +0.17  +0.00  +0.42  +0.33  -0.17   +1.00  +0.00  </span>
<span class="sd">    &#39;a7&#39; |   +0.00  +0.42  +0.00  +0.50  +0.00  +0.00   +1.00  </span>
<span class="sd">    Valuation domain: [-1.000; 1.000]</span>
<span class="sd">    &gt;&gt;&gt; from transitiveDigraphs import RankingByChoosingDigraph</span>
<span class="sd">    &gt;&gt;&gt; rbc = RankingByChoosingDigraph(g)</span>
<span class="sd">    Threading ...</span>
<span class="sd">    Exiting computing threads</span>
<span class="sd">    &gt;&gt;&gt; rbc.showTransitiveDigraph()</span>
<span class="sd">    Ranking by Choosing and Rejecting</span>
<span class="sd">     1st ranked [&#39;a3&#39;, &#39;a5&#39;, &#39;a6&#39;]</span>
<span class="sd">       2nd ranked [&#39;a4&#39;]</span>
<span class="sd">       2nd last ranked [&#39;a7&#39;])</span>
<span class="sd">     1st last ranked [&#39;a1&#39;, &#39;a2&#39;])</span>
<span class="sd">    &gt;&gt;&gt; rbc.showOrderedRelationTable(direction=&quot;decreasing&quot;)</span>
<span class="sd">    Decreasing Weak Ordering</span>
<span class="sd">    Ranking by recursively best-choosing</span>
<span class="sd">     1st Best Choice [&#39;a3&#39;, &#39;a6&#39;] (0.07)</span>
<span class="sd">       2nd Best Choice [&#39;a5&#39;] (0.08)</span>
<span class="sd">         3rd Best Choice [&#39;a1&#39;, &#39;a4&#39;] (0.17)</span>
<span class="sd">           4th Best Choice [&#39;a7&#39;] (-0.67)</span>
<span class="sd">             5th Best Choice [&#39;a2&#39;] (1.00)</span>
<span class="sd">    * ---- Relation Table -----</span>
<span class="sd">      S   |  &#39;a3&#39;	  &#39;a6&#39;	  &#39;a5&#39;	  &#39;a1&#39;	  &#39;a4&#39;	  &#39;a7&#39;	  &#39;a2&#39;	  </span>
<span class="sd">    ------|-------------------------------------------</span>
<span class="sd">     &#39;a3&#39; |   - 	 0.00	 0.00	 0.67	 0.33	 0.00	 1.00	 </span>
<span class="sd">     &#39;a6&#39; |  0.00	  - 	 0.00	 0.00	 0.00	 0.00	 0.17	 </span>
<span class="sd">     &#39;a5&#39; |  0.00	 0.00	  - 	 0.33	 0.25	 0.17	 0.17	 </span>
<span class="sd">     &#39;a1&#39; |  -0.67	 0.00	 -0.33	  - 	 0.00	 0.00	 0.00	 </span>
<span class="sd">     &#39;a4&#39; |  0.00	 0.00	 0.00	 0.00	  - 	 0.33	 0.33	 </span>
<span class="sd">     &#39;a7&#39; |  0.00	 0.00	 0.00	 0.00	 0.00	  - 	 0.67	 </span>
<span class="sd">     &#39;a2&#39; |  -1.00	 -0.17	 -0.17	 0.00	 -0.33	 -0.67	  - 	 </span>
<span class="sd">    Valuation domain: [-1.00;1.00]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Presentation method for RankingByChoosing Digraph instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">String</span> <span class="o">=</span>  <span class="s1">&#39;*-----  Object instance description -----------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Instance class      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Instance name       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Actions             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Valuation domain    : [</span><span class="si">%.2f</span><span class="s1">-</span><span class="si">%.2f</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                  <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Size                : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Attributes: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Determinateness (</span><span class="si">%%</span><span class="s1">) : </span><span class="si">%.1f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                  <span class="bp">self</span><span class="o">.</span><span class="n">computeDeterminateness</span><span class="p">(</span><span class="n">InPercents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;*------  Constructor run times (in sec.) ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Threads             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Total time          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Data input          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Ranking-by-choosing : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;bestLast&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute fusion      : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;fusing&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Store results       : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;storing&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">String</span> 

                    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span>
                 <span class="n">fusionOperator</span> <span class="o">=</span> <span class="s2">&quot;o-max&quot;</span><span class="p">,</span>
                 <span class="n">CoDual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="c1">#CppAgrum=False,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">ranking2preorder</span><span class="p">,</span> <span class="n">omax</span><span class="p">,</span> <span class="n">omin</span>        
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span>
        <span class="c1">#self.CppAgrum = CppAgrum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Threading</span> <span class="o">=</span> <span class="n">Threading</span>

        <span class="n">runTimes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="c1">#if Threading:</span>
        <span class="n">digraph</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="c1">#self.__class__ = digraph.__class__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originalRelation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute ranking by best and by last choosing</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Threading</span> <span class="ow">and</span> <span class="n">cpu_count</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threading ...&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
            <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
                <span class="n">digraphFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpDigraph.py&#39;</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temDirName, digraphFileName&#39;</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span><span class="n">digraphFileName</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">digraphFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">threadBest</span> <span class="o">=</span> <span class="n">_myRBCThread</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;ComputeBest&quot;</span><span class="p">,</span><span class="s2">&quot;best&quot;</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                <span class="n">threadWorst</span> <span class="o">=</span> <span class="n">_myRBCThread</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;ComputeWorst&quot;</span><span class="p">,</span><span class="s2">&quot;worst&quot;</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                <span class="n">threadBest</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="n">threadWorst</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="k">pass</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting computing threads&#39;</span><span class="p">)</span>
                <span class="n">rbbcFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/rbbc.py&#39;</span>          
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rbbcFileName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">rbwcFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span> <span class="s1">&#39;/rbwc.py&#39;</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rbwcFileName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">setrecursionlimit</span>
            <span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;bestLast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t1</span>

        <span class="c1"># compute ranking fusion</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">relBest</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosingRelation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">digraph</span><span class="o">.</span><span class="n">showRankingByBestChoosing</span><span class="p">()</span>
        <span class="n">relLast</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosingRelation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">digraph</span><span class="o">.</span><span class="n">showRankingByLastChoosing</span><span class="p">()</span>
        <span class="n">relFusion</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">relFusion</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fx</span> <span class="o">=</span> <span class="n">relFusion</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">bx</span> <span class="o">=</span> <span class="n">relBest</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">lx</span> <span class="o">=</span> <span class="n">relLast</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">bx</span><span class="p">[</span><span class="n">y</span><span class="p">],</span><span class="n">lx</span><span class="p">[</span><span class="n">y</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s2">&quot;o-max&quot;</span><span class="p">:</span>
                    <span class="n">fx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omax</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fusionOperator</span> <span class="o">==</span> <span class="s2">&quot;o-min&quot;</span><span class="p">:</span>
                    <span class="n">fx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">omin</span><span class="p">(</span><span class="n">Med</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: invalid epistemic fusion operator </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">operator</span><span class="p">)</span>
                    <span class="k">return</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;fusing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t2</span>
        <span class="c1"># storing results</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="o">=</span><span class="n">relFusion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">rankingByLastChoosing</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">rankingByBestChoosing</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">computeRankingByChoosing</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showRankingByChoosing</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;storing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span><span class="n">t3</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="n">runTimes</span>

<div class="viewcode-block" id="RankingByChoosingDigraph.showTransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByChoosingDigraph.showTransitiveDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rankingStrategy</span><span class="o">=</span><span class="s1">&#39;optimistic&#39;</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialization of generic method.</span>
<span class="sd">        Without argument, a weak ordering is recomputed from the</span>
<span class="sd">        valued self relation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rankingByChoosing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rankingStrategy</span> <span class="o">==</span> <span class="s1">&#39;optimistic&#39;</span><span class="p">:</span>  
                <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">rankingByChoosing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">rankingByChoosing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="n">rankingByChoosing</span><span class="p">)</span></div>




<div class="viewcode-block" id="RankingByChoosingDigraph.showRankingByChoosing">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByChoosingDigraph.showRankingByChoosing">[docs]</a>
    <span class="k">def</span> <span class="nf">showRankingByChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rankingStrategy</span><span class="o">=</span><span class="s1">&#39;optimistic&#39;</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for showTransitiveDigraph method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="o">=</span><span class="n">rankingByChoosing</span><span class="p">,</span>
                                   <span class="n">rankingStrategy</span><span class="o">=</span><span class="n">rankingStrategy</span><span class="p">,</span>
                                   <span class="n">WithCoverCredibility</span><span class="o">=</span><span class="n">WithCoverCredibility</span><span class="p">)</span></div>


<div class="viewcode-block" id="RankingByChoosingDigraph.computeRankingByBestChoosing">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByChoosingDigraph.computeRankingByBestChoosing">[docs]</a>
    <span class="k">def</span> <span class="nf">computeRankingByBestChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Forced</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for blocking recomputing without forcing. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Forced</span><span class="p">:</span>
            <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CoDual</span><span class="p">)</span></div>


<div class="viewcode-block" id="RankingByChoosingDigraph.computeRankingByLastChoosing">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByChoosingDigraph.computeRankingByLastChoosing">[docs]</a>
    <span class="k">def</span> <span class="nf">computeRankingByLastChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Forced</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for blocking recomputing without forcing. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Forced</span><span class="p">:</span>
            <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CoDual</span><span class="p">)</span></div>
</div>


<span class="c1">#--------------------</span>
<div class="viewcode-block" id="RankingByBestChoosingDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByBestChoosingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RankingByBestChoosingDigraph</span><span class="p">(</span><span class="n">RankingByChoosingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of abstract TransitiveDigraph class for computing a ranking by best-choosing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">digraph</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
        <span class="n">digraphName</span> <span class="o">=</span> <span class="s1">&#39;ranking-by-best&#39;</span><span class="o">+</span><span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraphName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByBestChoosingRelation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Normalized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
        
<div class="viewcode-block" id="RankingByBestChoosingDigraph.showTransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByBestChoosingDigraph.showTransitiveDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation of showTransitiveDigraph() for ranking-by-best-choosing results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showRankingByBestChoosing</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="RankingByLastChoosingDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByLastChoosingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RankingByLastChoosingDigraph</span><span class="p">(</span><span class="n">RankingByChoosingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of abstract TransitiveDigraph class for computing a ranking by rejecting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">digraph</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
        <span class="n">digraphName</span> <span class="o">=</span> <span class="s1">&#39;ranking-by-last&#39;</span><span class="o">+</span><span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraphName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByLastChoosingRelation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Normalized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>
    
<div class="viewcode-block" id="RankingByLastChoosingDigraph.showTransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByLastChoosingDigraph.showTransitiveDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation of showTransitiveDigraph() for ranking-by-last-choosing results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showRankingByLastChoosing</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="RankingByPrudentChoosingDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.RankingByPrudentChoosingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">RankingByPrudentChoosingDigraph</span><span class="p">(</span><span class="n">RankingByChoosingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization for ranking-by-rejecting results with prudent single elimination of chordless circuits. By default, the cut level for circuits elimination is set to 20% of the valuation domain maximum (1.0).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">digraph</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Odd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Limited</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">SplitCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>          
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------- Commenting ranking by prudent choosing ------&#39;</span><span class="p">)</span>
        <span class="n">digraph_</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">digraph</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Normalized</span><span class="p">:</span>
            <span class="n">digraph_</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">digraphName</span> <span class="o">=</span> <span class="s1">&#39;sorting-by-prudent-choosing&#39;</span><span class="o">+</span><span class="n">digraph_</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">digraphName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">digraph_</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">digraph_</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">RankingByLastChoosingDigraph</span><span class="p">(</span><span class="n">digraph_</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">RankingByBestChoosingDigraph</span><span class="p">(</span><span class="n">digraph_</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">fus</span> <span class="o">=</span> <span class="n">FusionDigraph</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">)</span>
        <span class="n">cutLevel</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">digraph_</span><span class="o">.</span><span class="n">minimalValuationLevelForCircuitsElimination</span><span class="p">(</span><span class="n">Odd</span><span class="o">=</span><span class="n">Odd</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">),</span><span class="n">Decimal</span><span class="p">(</span><span class="n">Limited</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutLevel</span> <span class="o">=</span> <span class="n">cutLevel</span>
        <span class="k">if</span> <span class="n">cutLevel</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">cutLevel</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]:</span>
                <span class="n">gp</span> <span class="o">=</span> <span class="n">PolarisedDigraph</span><span class="p">(</span><span class="n">digraph_</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="n">cutLevel</span><span class="p">,</span><span class="n">StrictCut</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gp</span> <span class="o">=</span> <span class="n">PolarisedDigraph</span><span class="p">(</span><span class="n">digraph_</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="n">cutLevel</span><span class="p">,</span><span class="n">StrictCut</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">s1p</span> <span class="o">=</span> <span class="n">RankingByLastChoosingDigraph</span><span class="p">(</span><span class="n">gp</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">s2p</span> <span class="o">=</span> <span class="n">RankingByBestChoosingDigraph</span><span class="p">(</span><span class="n">gp</span><span class="p">,</span><span class="n">CoDual</span><span class="o">=</span><span class="n">CoDual</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">fusp</span> <span class="o">=</span> <span class="n">FusionDigraph</span><span class="p">(</span><span class="n">s1p</span><span class="p">,</span><span class="n">s2p</span><span class="p">)</span>
            <span class="n">corrgp</span> <span class="o">=</span> <span class="n">digraph_</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="n">fusp</span><span class="p">)</span>
            <span class="n">corrg</span> <span class="o">=</span> <span class="n">digraph_</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="n">fus</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correlation with cutting    : </span><span class="si">%.3f</span><span class="s1"> x </span><span class="si">%.3f</span><span class="s1"> = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span><span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span><span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correlation without cutting : </span><span class="si">%.3f</span><span class="s1"> x </span><span class="si">%.3f</span><span class="s1"> = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span><span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span><span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">SplitCorrelation</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]:</span>           
                    <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">fusp</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">sp2</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">sp1</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">corrgp</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">corrg</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">fusp</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">sp2</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">sp1</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>                
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingByBestChoosing</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">rankingByBestChoosing</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingByLastChoosing</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">rankingByLastChoosing</span>

        <span class="c1">#self.rankingByChoosing = self.computeRankingByChoosing(CoDual=CoDual)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">gdeter</span> <span class="o">=</span> <span class="n">digraph_</span><span class="o">.</span><span class="n">computeDeterminateness</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Circuits cutting level limit  : </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Limited</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Circuits elimination cut level: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutLevel</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ordinal Correlation with given outranking&#39;</span><span class="p">)</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="n">digraph_</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correlation     : </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">corr</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Determinateness : </span><span class="si">%.3f</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">corr</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span><span class="n">gdeter</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Execution time  : </span><span class="si">%.4f</span><span class="s1"> sec.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span></div>


<span class="c1"># multiprocessing thread for the principal fusion class</span>
<span class="c1">#from multiprocessing import Process, Lock, active_children, cpu_count</span>
<span class="k">class</span> <span class="nc">_myPRIODThread</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span>
                 <span class="n">tempDirName</span><span class="p">,</span> <span class="n">imageType</span><span class="p">,</span> <span class="n">plotFileName</span><span class="p">,</span> <span class="n">Debug</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span> <span class="o">=</span> <span class="n">tempDirName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imageType</span> <span class="o">=</span> <span class="n">imageType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFileName</span> <span class="o">=</span> <span class="n">plotFileName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
        <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
        <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">PrincipalOrder</span>
        <span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working in </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpDigraph.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;col&#39;</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;priCol.py&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">pc</span> <span class="o">=</span> <span class="n">PrincipalOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span>
                                <span class="n">Colwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">imageType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">imageType</span><span class="p">,</span>
                                <span class="n">plotFileName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFileName</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;row&#39;</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;priRow.py&#39;</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">pl</span> <span class="o">=</span> <span class="n">PrincipalOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span>
                                <span class="n">Colwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">imageType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">imageType</span><span class="p">,</span>
                                <span class="n">plotFileName</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFileName</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="PrincipalInOutDegreesOrderingFusion">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PrincipalInOutDegreesOrderingFusion">[docs]</a>
<span class="k">class</span> <span class="nc">PrincipalInOutDegreesOrderingFusion</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of abstract TransitiveDigraph class for ranking by fusion</span>
<span class="sd">    of the principal orders of the variance-covariance of in- </span>
<span class="sd">    (Colwise) and outdegrees (Rowwise).</span>
<span class="sd">    </span>
<span class="sd">    Example Python3 session with same outranking digraph g as shown in the RankingByChoosingDigraph example session (see below). </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from transitiveDigraphs import *</span>
<span class="sd">    &gt;&gt;&gt; from votingProfiles import *</span>
<span class="sd">    &gt;&gt;&gt; v = RandomLinearVotingProfile(numberOfVoters=99,</span>
<span class="sd">    ...                               numberOfCandidates=9,seed=201)</span>
<span class="sd">    &gt;&gt;&gt; g = CondorcetDigraph(v)</span>
<span class="sd">    &gt;&gt;&gt; pro = PrincipalInOutDegreesOrdering(g,imageType=&quot;png&quot;, </span>
<span class="sd">    ...                 plotFileName=&quot;proTransitiveDigraphing&quot;)</span>
<span class="sd">        Threading ...</span>
<span class="sd">        Exiting both computing threads</span>
<span class="sd">    &gt;&gt;&gt; pro.showTransitiveDigraph()</span>
<span class="sd">    Ranking by Choosing and Rejecting</span>
<span class="sd">     1st ranked [&#39;c9&#39;]</span>
<span class="sd">       2nd ranked [&#39;c8&#39;]</span>
<span class="sd">         3rd ranked [&#39;c4&#39;]</span>
<span class="sd">           4th ranked [&#39;c5&#39;]</span>
<span class="sd">             5th ranked [&#39;c2&#39;]</span>
<span class="sd">             5th last ranked [&#39;c2&#39;])</span>
<span class="sd">           4th last ranked [&#39;c3&#39;])</span>
<span class="sd">         3rd last ranked [&#39;c6&#39;])</span>
<span class="sd">       2nd last ranked [&#39;c7&#39;])</span>
<span class="sd">     1st last ranked [&#39;c1&#39;])</span>
<span class="sd">    &gt;&gt;&gt; pro.showPrincipalScores(ColwiseOrder=True)</span>
<span class="sd">    List of principal scores</span>
<span class="sd">    Column wise covariance ordered</span>
<span class="sd">    action 	 colwise 	 rowwise</span>
<span class="sd">    c9 	 0.23974 	 0.23974</span>
<span class="sd">    c8 	 0.15961 	 0.15961</span>
<span class="sd">    c4 	 0.14299 	 0.14299</span>
<span class="sd">    c5 	 0.04205 	 0.04205</span>
<span class="sd">    c2 	 -0.04186 	 -0.04186</span>
<span class="sd">    c3 	 -0.04552 	 -0.04552</span>
<span class="sd">    c6 	 -0.11143 	 -0.11143</span>
<span class="sd">    c7 	 -0.16567 	 -0.16567</span>
<span class="sd">    c1 	 -0.21991 	 -0.21991</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">fusionOperator</span><span class="o">=</span><span class="s2">&quot;o-max&quot;</span><span class="p">,</span>
                 <span class="n">imageType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">plotFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">PrincipalOrder</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>

        <span class="c1">#if Threading:</span>

        <span class="n">digraph</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="c1">#self.__class__ = digraph.__class__</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span>

        <span class="k">if</span> <span class="n">Threading</span> <span class="ow">and</span> <span class="n">cpu_count</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threading ...&#39;</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
            <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
                <span class="n">digraphFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpDigraph.py&#39;</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temDirName, digraphFileName&#39;</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span><span class="n">digraphFileName</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">digraphFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">threadCol</span> <span class="o">=</span> <span class="n">_myPRIODThread</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;ComputeCol&quot;</span><span class="p">,</span><span class="s2">&quot;col&quot;</span><span class="p">,</span>
                                     <span class="n">tempDirName</span><span class="p">,</span>
                                     <span class="n">imageType</span><span class="o">=</span><span class="n">imageType</span><span class="p">,</span>
                                     <span class="n">plotFileName</span><span class="o">=</span><span class="n">plotFileName</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
                <span class="n">threadRow</span> <span class="o">=</span> <span class="n">_myPRIODThread</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;ComputeRow&quot;</span><span class="p">,</span><span class="s2">&quot;row&quot;</span><span class="p">,</span>
                                     <span class="n">tempDirName</span><span class="p">,</span>
                                     <span class="n">imageType</span><span class="o">=</span><span class="n">imageType</span><span class="p">,</span>
                                     <span class="n">plotFileName</span><span class="o">=</span><span class="n">plotFileName</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
                <span class="n">threadCol</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="n">threadRow</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="k">pass</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting both computing threads&#39;</span><span class="p">)</span>
                <span class="n">priColFileName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/priCol.py&#39;</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">priColFileName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">pc</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">priRowFileName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/priRow.py&#39;</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">priRowFileName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">pl</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pc</span> <span class="o">=</span> <span class="n">PrincipalOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="n">Colwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">imageType</span><span class="o">=</span><span class="n">imageType</span><span class="p">,</span>
                                <span class="n">plotFileName</span><span class="o">=</span><span class="n">plotFileName</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">pl</span> <span class="o">=</span> <span class="n">PrincipalOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="n">Colwise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">imageType</span><span class="o">=</span><span class="n">imageType</span><span class="p">,</span>
                                <span class="n">plotFileName</span><span class="o">=</span><span class="n">plotFileName</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Row wise: &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">principalRowwiseScores</span><span class="p">)</span>
            <span class="n">pl</span><span class="o">.</span><span class="n">computeOrder</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pl</span><span class="o">.</span><span class="n">principalRowwiseScores</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">principalRowwiseScores</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">principalRowwiseScores</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pl</span><span class="o">.</span><span class="n">principalRowwiseScores</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;principalRowwiseScore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column wise: &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">principalColwiseScores</span><span class="p">)</span>
            <span class="n">pc</span><span class="o">.</span><span class="n">computeOrder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">principalColwiseScores</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">principalColwiseScores</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pc</span><span class="o">.</span><span class="n">principalColwiseScores</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;principalColwiseScore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pf</span> <span class="o">=</span> <span class="n">FusionDigraph</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span><span class="n">pc</span><span class="p">,</span><span class="n">operator</span><span class="o">=</span><span class="n">fusionOperator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="c1">#self.computeRankingByChoosing()</span>
        <span class="c1">#self.rankingByBestChoosing = pl.computeRankingByBestChoosing()</span>
        <span class="c1">#self.rankingByLastChoosing = pc.computeRankingByLastChoosing()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="n">digraph</span><span class="p">))</span>

<div class="viewcode-block" id="PrincipalInOutDegreesOrderingFusion.showPrincipalScores">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PrincipalInOutDegreesOrderingFusion.showPrincipalScores">[docs]</a>
    <span class="k">def</span> <span class="nf">showPrincipalScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ColwiseOrder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">RowwiseOrder</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        showing the principal in- (Colwise) and out-degrees (Rowwise) scores.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;List of principal scores&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ColwiseOrder</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">RowwiseOrder</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action </span><span class="se">\t</span><span class="s1"> colwise </span><span class="se">\t</span><span class="s1"> rowwise&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.5f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;principalColwiseScore&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;principalRowwiseScore&#39;</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="n">ColwiseOrder</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column wise covariance ordered&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action </span><span class="se">\t</span><span class="s1"> colwise </span><span class="se">\t</span><span class="s1"> rowwise&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">principalColwiseScores</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.5f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;principalColwiseScore&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;principalRowwiseScore&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Row wise covariance ordered&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action </span><span class="se">\t</span><span class="s1"> colwise </span><span class="se">\t</span><span class="s1"> rowwise&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">principalRowwiseScores</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.5f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;principalColwiseScore&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;principalRowwiseScore&#39;</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PrincipalInOutDegreesOrderingFusion.computeTransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PrincipalInOutDegreesOrderingFusion.computeTransitiveDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">computeTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ColwiseOrder</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation for PrincipalInOutDegreesOrderings.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="n">ColwiseOrder</span><span class="p">:</span>
            <span class="n">lps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">principalColwiseScores</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">principalRowwiseScores</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lps</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">n2</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">TransitiveDigraphing</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result&#39;</span><span class="p">:</span><span class="n">ordering</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">TransitiveDigraphing</span></div>

                
<div class="viewcode-block" id="PrincipalInOutDegreesOrderingFusion.showTransitiveDigraph">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PrincipalInOutDegreesOrderingFusion.showTransitiveDigraph">[docs]</a>
    <span class="k">def</span> <span class="nf">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ColwiseOrder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation for PrincipalInOutDegreesOrderings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">##        if rankingByChoosing is None:</span>
<span class="c1">##            try:</span>
<span class="c1">##                TransitiveDigraphing = self.rankingByChoosing</span>
<span class="c1">##            except:</span>
<span class="c1">##                TransitiveDigraphing = self.computeRankingByChoosing(CoDual=False,CppAgrum=False)</span>
        
        <span class="k">if</span> <span class="n">ColwiseOrder</span><span class="p">:</span>
            <span class="n">lps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">principalColwiseScores</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">principalRowwiseScores</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lps</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">n2</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">lps</span><span class="p">[</span><span class="n">n2</span><span class="p">]</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span> <span class="p">)</span>

        <span class="n">TransitiveDigraphing</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result&#39;</span><span class="p">:</span><span class="n">ordering</span><span class="p">}</span>
        <span class="c1">#print(TransitiveDigraphing)</span>

        <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">TransitiveDigraphing</span><span class="p">)</span></div>

            

<div class="viewcode-block" id="PrincipalInOutDegreesOrderingFusion.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PrincipalInOutDegreesOrderingFusion.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;ColwiseOrder&#39;</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation for PincipalInOutDegrees class.</span>

<span class="sd">        direction = &quot;Colwise&quot; (best to worst, default) | &quot;Rowwise&quot; (worst to best)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;Colwise&quot;</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;worst&#39;</span>
        <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                            <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                            <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                            <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                            <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                            <span class="n">fontSize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span></div>
</div>


<span class="c1">##################</span>

<span class="k">def</span> <span class="nf">_jobTaskRubis</span><span class="p">(</span><span class="n">categID</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task definition for multiprocessing threaded local RubisChoice jobs in the QantilesRankingDigraph contructor.</span>
<span class="sd">    </span>
<span class="sd">    .. note::</span>
<span class="sd">          Parameter maxContent: maximum allowed local catContent for RankingByRubisChoice </span>
<span class="sd">          is set to 30. Above this cardinality, the PrincipalInOutDegreesOrdering is used.</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
    <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span><span class="p">,</span> <span class="n">chdir</span>
    <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
    <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
    <span class="c1">#from linearOrders import RankedPairsOrder, KohlerOrder</span>
    <span class="kn">from</span> <span class="nn">TransitiveDigraphs</span> <span class="kn">import</span> <span class="n">PrincipalInOutDegreesOrdering</span>
    <span class="n">maxCatContent</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">Comments</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working on category </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categID</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">fiName</span> <span class="o">=</span> <span class="s1">&#39;partialPerfTab-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span>
        <span class="n">chdir</span><span class="p">(</span><span class="n">tempDirName</span><span class="p">)</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">catContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">catContent</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">maxCatContent</span><span class="p">)</span>
        <span class="c1">#print(catContent)</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&lt;=</span> <span class="n">maxCatContent</span><span class="p">:</span>
            <span class="n">currActions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">catContent</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">catCRbc</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByChoosing</span><span class="p">(</span><span class="n">CoDual</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt;&gt; Failed RBC: Principal ranking&#39;</span><span class="p">)</span>
<span class="c1">##              rp = RankedPairsOrder(digraph)</span>
<span class="c1">##              catRbc = rp.computeRankingByChoosing()</span>
<span class="c1">##                ko = KohlerOrder(digraph)</span>
<span class="c1">##                catCRbc = ko.computeRankingByChoosing()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pri</span> <span class="o">=</span> <span class="n">PrincipalInOutDegreesOrdering</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">catCRbc</span> <span class="o">=</span> <span class="n">pri</span><span class="o">.</span><span class="n">computeTransitiveDigraph</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">catCRbc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result&#39;</span><span class="p">:</span> \
                               <span class="p">[((</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="n">catContent</span><span class="p">),</span>
                                <span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="n">catContent</span><span class="p">))]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt;&gt; Exceeds </span><span class="si">%d</span><span class="s1">: Principal ranking&#39;</span> <span class="o">%</span> <span class="n">maxCatContent</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pri</span> <span class="o">=</span> <span class="n">PrincipalInOutDegreesOrdering</span><span class="p">(</span><span class="n">digraph</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">catCRbc</span> <span class="o">=</span> <span class="n">pri</span><span class="o">.</span><span class="n">computeTransitiveDigraph</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">catCRbc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result&#39;</span><span class="p">:</span> <span class="p">[((</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="n">catContent</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="n">catContent</span><span class="p">))]}</span>

        <span class="n">splitCatRelation</span> <span class="o">=</span> <span class="p">[</span><span class="n">catCRbc</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]]</span>
        <span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
    <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;splitCatRelation-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>                                            
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">splitCatRelation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">writestr</span> <span class="o">=</span> <span class="s1">&#39;Finished category </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categID</span><span class="p">,</span><span class="n">nc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">writestr</span>
<span class="c1">#####</span>
<span class="k">def</span> <span class="nf">_jobTaskKohler</span><span class="p">(</span><span class="n">categID</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task definition for multiprocessing threaded jobs in QsRbcRanking.</span>
<span class="sd">    </span>
<span class="sd">    .. Note::</span>
<span class="sd">    </span>
<span class="sd">          The indiviual quantile classes are linarly order with</span>
<span class="sd">          Kohler&#39;s ranking rule.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
    <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">KohlerOrder</span>
    <span class="kn">from</span> <span class="nn">TransitiveDigraphs</span> <span class="kn">import</span> <span class="n">PrincipalInOutDegreesOrdering</span>
    <span class="n">Comments</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working on category </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categID</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">fiName</span> <span class="o">=</span> <span class="s1">&#39;partialPerfTab-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">digraph</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">order</span>
    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
    <span class="n">ko</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">)</span>
    <span class="n">catCRbc</span> <span class="o">=</span> <span class="n">ko</span><span class="o">.</span><span class="n">computeRankingByChoosing</span><span class="p">()</span>
    <span class="n">splitCatRelation</span> <span class="o">=</span> <span class="p">[</span><span class="n">catCRbc</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]]</span>
    <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;splitCatRelation-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>                                            
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">splitCatRelation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">writestr</span> <span class="o">=</span> <span class="s1">&#39;Finished category </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categID</span><span class="p">,</span><span class="n">nc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">writestr</span>

<span class="c1">#####</span>
<span class="k">def</span> <span class="nf">_jobTaskKohlerFusion</span><span class="p">(</span><span class="n">categID</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task definition for multiprocessing threaded jobs in Quantiles Ranking.</span>
<span class="sd">    </span>
<span class="sd">    .. Note::</span>
<span class="sd">    </span>
<span class="sd">          The indiviual quantile classes are linarly order with a</span>
<span class="sd">          fusion between Kohler&#39;s and Arrow-Raynaud&#39;s ranking rules.</span>
<span class="sd">          The latter corresponds to Kohler&#39;s rule applied to the codual</span>
<span class="sd">          outranking digraph.</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
    <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">KohlerOrder</span>
    <span class="kn">from</span> <span class="nn">TransitiveDigraphs</span> <span class="kn">import</span> <span class="n">PrincipalInOutDegreesOrdering</span>
    <span class="n">Comments</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working on category </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categID</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">fiName</span> <span class="o">=</span> <span class="s1">&#39;partialPerfTab-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">digraph</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">order</span>
    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
    <span class="n">ko</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">(</span><span class="n">digraph</span><span class="p">)</span>
    <span class="n">kos</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">((</span><span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">digraph</span><span class="p">)))</span>
    <span class="n">fk</span> <span class="o">=</span> <span class="n">FusionDigraph</span><span class="p">(</span><span class="n">ko</span><span class="p">,</span><span class="n">kos</span><span class="p">)</span>
    <span class="n">catCRbc</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="o">.</span><span class="n">computeRankingByChoosing</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span>
    <span class="c1">#catRbc = deepcopy(catCRbc[&#39;result&#39;])</span>
    <span class="n">splitCatRelation</span> <span class="o">=</span> <span class="p">[</span><span class="n">catCRbc</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]]</span>
    <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;splitCatRelation-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">categID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>                                            
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">splitCatRelation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">writestr</span> <span class="o">=</span> <span class="s1">&#39;Finished category </span><span class="si">%d</span><span class="s1"> </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categID</span><span class="p">,</span><span class="n">nc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">writestr</span>




<span class="c1">#####</span>

<div class="viewcode-block" id="WeakCopelandOrder">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.WeakCopelandOrder">[docs]</a>
<span class="k">class</span> <span class="nc">WeakCopelandOrder</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    instantiates the Weak Copeland Order from</span>
<span class="sd">    a given bipolar-valued Digraph instance</span>

<span class="sd">    If *SelfCoDual* == *True*, strict incomparabilities are coded</span>
<span class="sd">    as *indeterminate* situations. Only the asymmetric part of the preorder is</span>
<span class="sd">    instantiated. Otherwise, the classic definition of the weak order</span>
<span class="sd">    as complement of the preorder is instantiated.</span>

<span class="sd">    Note: *WithFairestRanking=True*, requires *other* to be</span>
<span class="sd">    a valid outranking digraph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">WithFairestRanking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">SelfCoDual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constructor for generating a weak order</span>
<span class="sd">        from a given other digraph following</span>
<span class="sd">        the Copeland ordering rule.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">all_partial_perms</span>

        <span class="c1">#timings</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">runTimes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># prepare local variables</span>
        <span class="n">otherRelation</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">gamma</span>
        <span class="n">selfRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
        <span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span>
                           <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span>
                           <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">Max</span><span class="p">}</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;prepareLocals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span>
        
        <span class="c1"># compute Copeland scores</span>
        <span class="n">tnf</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">PolarisedDigraph</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="n">cRelation</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">copelandScores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
<span class="c1">##            gx = gamma[x]</span>
            <span class="n">copelandScore</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">copelandScore</span> <span class="o">+=</span> <span class="n">cRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">cRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
<span class="c1">##            copelandScore = len(gx[0]) - len(gx[1])</span>
            <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">copelandScore</span>
            <span class="n">copelandScores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copelandScore</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="c1"># sorting with keeping the actions initial ordering</span>
        <span class="c1"># in case of ties</span>
        <span class="n">copelandScores</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">copelandOrder</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">copelandScores</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copelandOrder</span> <span class="o">=</span> <span class="n">copelandOrder</span>       
        <span class="n">copelandScores</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">copelandRanking</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">copelandScores</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copelandRanking</span> <span class="o">=</span> <span class="n">copelandRanking</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copelandScores</span> <span class="o">=</span> <span class="n">copelandScores</span>
        <span class="c1"># computing the Copeland preorder</span>
        <span class="n">pl</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">copelandScores</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pl</span><span class="p">[</span><span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">pl</span><span class="p">[</span><span class="n">score</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">score</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">plist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">pl</span><span class="p">:</span>
            <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="p">[</span><span class="n">eq</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copelandPreRanking</span> <span class="o">=</span> <span class="n">plist</span>
        <span class="c1"># computing the Copeland permutations</span>
        <span class="c1"># and fairest Copeland Ranking</span>
        <span class="c1"># Requires *other* to be an outranking digraph instance</span>
        <span class="k">if</span> <span class="n">WithFairestRanking</span><span class="p">:</span>
            <span class="n">perms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">fairestPerms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_partial_perms</span><span class="p">(</span><span class="n">plist</span><span class="p">):</span>
                <span class="n">perms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pRes</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">computeRankingConsensusQuality</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: WithFairestRanking is only available for outranking instances!&#39;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="n">fairestPerms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">pRes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">pRes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">pRes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="n">pRes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">corr</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span><span class="n">p</span><span class="p">])</span>
            <span class="n">fairestPerms</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">copelandPermutations</span> <span class="o">=</span> <span class="n">fairestPerms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fairestCopelandRanking</span> <span class="o">=</span> <span class="n">fairestPerms</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
        <span class="c1"># mearsuring run time</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;copeland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tnf</span>

        <span class="c1"># init relation</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">SelfCoDual</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                <span class="n">sx</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
                <span class="n">sy</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sx</span> <span class="o">&gt;</span> <span class="n">sy</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">elif</span> <span class="n">SelfCoDual</span> <span class="ow">and</span> <span class="n">sx</span> <span class="o">==</span> <span class="n">sy</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;relation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tr</span>      
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ranked&#39;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">valuationdomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">selfRelation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="n">runTimes</span>

    <span class="k">def</span> <span class="nf">showScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Copeland scores in </span><span class="si">%s</span><span class="s1"> order&#39;</span> <span class="o">%</span> <span class="n">direction</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action </span><span class="se">\t</span><span class="s1"> score&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;descending&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copelandScores</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copelandScores</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>


<div class="viewcode-block" id="WeakNetFlowsOrder">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.WeakNetFlowsOrder">[docs]</a>
<span class="k">class</span> <span class="nc">WeakNetFlowsOrder</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates the Weak NetFlows Order from</span>
<span class="sd">    a given bipolar-valued Digraph instance.</span>

<span class="sd">    If *SelfCoDual* == *True*, strict incomparabilities are coded as</span>
<span class="sd">    *indeterminate* situations. Only the asymmetric part of the preorder is</span>
<span class="sd">    instantiated. Otherwise, the classic definition of the weak order as</span>
<span class="sd">    complement of the preorder is instantiated.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">SelfCoDual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for generating a weak order</span>
<span class="sd">        from a given other digraph following</span>
<span class="sd">        the NetFlows ordering rule</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#from copy import deepcopy</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="c1">#timings</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">runTimes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># prepare local variables</span>
        <span class="n">otherRelation</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">gamma</span>
        <span class="n">selfRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
        <span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span>
                           <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span>
                           <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">Max</span><span class="p">}</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;prepareLocals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span>
        
        <span class="c1"># compute net flows</span>
        <span class="n">tnf</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">netFlowScores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">netFlowScore</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">netFlowScore</span> <span class="o">+=</span> <span class="n">otherRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">otherRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">otherRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span><span class="n">otherRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">],</span><span class="n">netFlowScore</span><span class="p">)</span>
            <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">netFlowScore</span>
            <span class="n">netFlowScores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">netFlowScore</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="c1"># reversed sorting with keeping the actions initial ordering</span>
        <span class="c1"># in case of ties</span>
        <span class="n">netFlowScores</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">netFlowScores</span> <span class="o">=</span> <span class="n">netFlowScores</span>

        <span class="n">netFlowsRanking</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">netFlowScores</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">netFlowsRanking</span> <span class="o">=</span> <span class="n">netFlowsRanking</span>
        <span class="n">netFlowsOrder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">netFlowsRanking</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">netFlowsOrder</span> <span class="o">=</span> <span class="n">netFlowsOrder</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;netFlows&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tnf</span>

        <span class="c1"># init relation</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">SelfCoDual</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                <span class="n">sx</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
                <span class="n">sy</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sx</span> <span class="o">&gt;</span> <span class="n">sy</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">elif</span> <span class="n">SelfCoDual</span> <span class="ow">and</span> <span class="n">sx</span> <span class="o">==</span> <span class="n">sy</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;relation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tr</span>      
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ranked&#39;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">valuationdomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">selfRelation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="n">runTimes</span>

    <span class="k">def</span> <span class="nf">showScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NetFlows scores in </span><span class="si">%s</span><span class="s1"> order&#39;</span> <span class="o">%</span> <span class="n">direction</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action </span><span class="se">\t</span><span class="s1"> score&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;descending&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">netFlowScores</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">netFlowScores</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>



<div class="viewcode-block" id="PartialBachetRanking">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PartialBachetRanking">[docs]</a>
<span class="k">class</span> <span class="nc">PartialBachetRanking</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses by default the :py:class:`linearOrders.PolarisedBachetRanking` class for generating a number</span>
<span class="sd">    of best correlated Bachet rankings.</span>

<span class="sd">    The :py:class:`~transitiveDigraphs.RankingsFusionDigraph` uses</span>
<span class="sd">    these *Bachet* rankings for contructing a partial *Bachet* ranking result.</span>

<span class="sd">    - *g* is any normalized bipolar-valued Digraph instance.</span>
<span class="sd">    - *randomized = integer* (default = 100) gives the number of random permutations</span>
<span class="sd">      used for generating different Bachet ranking results.</span>
<span class="sd">    - *maxNbrOfRanking = integer* (defaut = 5) is the number of best correlated</span>
<span class="sd">      rankings that are used for constructing the *RankingsFusionDigraph* instance.</span>
<span class="sd">    - *Polarised = {True (default) | False}*, When Polarised = False, the</span>
<span class="sd">      :py:class:`linearOrders.ValuedBachetRanking` class is used.</span>

<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomCBPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; t = RandomCBPerformanceTableau(numberOfActions=20,</span>
<span class="sd">    ...                 numberOfCriteria=13,seed=100)</span>
<span class="sd">    &gt;&gt;&gt; from outrankingDigraphs import BipolarOutrankingDigraph</span>
<span class="sd">    &gt;&gt;&gt; g = BipolarOutrankingDigraph(t)</span>
<span class="sd">    &gt;&gt;&gt; from transitiveDigraphs import PartialBachetRanking</span>
<span class="sd">    &gt;&gt;&gt; pbr = PartialBachetRanking(g,randomized=100,seed=100,</span>
<span class="sd">    ...                       maxNbrOfRankings=10)</span>
<span class="sd">    &gt;&gt;&gt; pbr.showTransitiveDigraph(WithCoverCredibility=True)</span>
<span class="sd">     Ranking by Choosing and Rejecting</span>
<span class="sd">      1st ranked [&#39;a04&#39;] (1.00)</span>
<span class="sd">        2nd ranked [&#39;a02&#39;, &#39;a05&#39;, &#39;a06&#39;, &#39;a11&#39;, &#39;a18&#39;, &#39;a20&#39;] (0.70)</span>
<span class="sd">          3rd ranked [&#39;a09&#39;, &#39;a14&#39;, &#39;a16&#39;] (0.33)</span>
<span class="sd">          3rd last ranked [&#39;a09&#39;, &#39;a10&#39;, &#39;a14&#39;]) (0.33)</span>
<span class="sd">        2nd last ranked [&#39;a01&#39;, &#39;a03&#39;, &#39;a12&#39;, &#39;a13&#39;, &#39;a15&#39;]) (0.60)</span>
<span class="sd">      1st last ranked [&#39;a07&#39;, &#39;a08&#39;, &#39;a17&#39;, &#39;a19&#39;]) (0.80)</span>
<span class="sd">    &gt;&gt;&gt; vpbr = PartialBachetRanking(g,Polarised=False,randomized=100,</span>
<span class="sd">    ...                      seed=100,maxNbrOfRankings=10)</span>
<span class="sd">    &gt;&gt;&gt; vpbr.showTransitiveDigraph(WithCoverCredibility=True)</span>
<span class="sd">     Ranking by Choosing and Rejecting</span>
<span class="sd">      1st ranked [&#39;a04&#39;] (1.00)</span>
<span class="sd">        2nd ranked [&#39;a02&#39;, &#39;a05&#39;, &#39;a06&#39;, &#39;a18&#39;] (0.77)</span>
<span class="sd">          3rd ranked [&#39;a09&#39;, &#39;a11&#39;, &#39;a16&#39;, &#39;a20&#39;] (0.55)</span>
<span class="sd">            4th ranked [&#39;a14&#39;] (1.00)</span>
<span class="sd">            4th last ranked [&#39;a14&#39;] (1.00)</span>
<span class="sd">          3rd last ranked [&#39;a01&#39;, &#39;a12&#39;, &#39;a13&#39;, &#39;a15&#39;] (0.55)</span>
<span class="sd">        2nd last ranked [&#39;a03&#39;, &#39;a07&#39;, &#39;a08&#39;, &#39;a10&#39;, &#39;a17&#39;] (0.69)</span>
<span class="sd">      1st last ranked [&#39;a19&#39;] (1.00)</span>

<span class="sd">    The cover credibities shown above represent in fact the mean outranking, respectively outranked, characteristic value of the complement of the nth choice or rejection. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">randomized</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">maxNbrOfRankings</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Polarised</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="k">if</span> <span class="n">Polarised</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">PolarisedBachetRanking</span> <span class="k">as</span> <span class="n">BachetRanking</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">ValuedBachetRanking</span> <span class="k">as</span> <span class="n">BachetRanking</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">statistics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randomized</span><span class="p">):</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">ba</span> <span class="o">=</span> <span class="n">BachetRanking</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">actionsList</span><span class="o">=</span><span class="n">actions</span><span class="p">,</span><span class="n">BestQualified</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">corrKey</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ba</span><span class="o">.</span><span class="n">correlation</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">statistics</span><span class="p">[</span><span class="n">corrKey</span><span class="p">][</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">corrKey</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">corrKey</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                <span class="n">statistics</span><span class="p">[</span><span class="n">corrKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">j</span><span class="p">,</span>
                                       <span class="s1">&#39;permutation&#39;</span><span class="p">:</span> <span class="n">actions</span><span class="p">,</span>
                                       <span class="s1">&#39;ranking&#39;</span><span class="p">:</span> <span class="n">ba</span><span class="o">.</span><span class="n">bachetRanking</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">statistics</span><span class="p">)</span>
        <span class="n">resStat</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">statistics</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">statistics</span><span class="p">]</span>
        <span class="n">resStat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">resStat</span><span class="p">,</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resStat</span><span class="p">))</span>
        <span class="n">bachetRankings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resStat</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">maxNbrOfRankings</span><span class="p">:</span>
            <span class="n">maxNbrOfRankings</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">resStat</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxNbrOfRankings</span><span class="p">):</span>
            <span class="n">bachetRankings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">resStat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">resStat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;ranking&#39;</span><span class="p">]))</span>
        <span class="n">rankings</span> <span class="o">=</span> <span class="p">[</span><span class="n">bachetRankings</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxNbrOfRankings</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">bachetRankings</span><span class="p">)</span>
        <span class="n">ba1</span> <span class="o">=</span> <span class="n">RankingsFusionDigraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">rankings</span><span class="p">)</span>
        <span class="c1">#ba1.resStat = resStat</span>
        <span class="n">ba1</span><span class="o">.</span><span class="n">bachetRankings</span> <span class="o">=</span> <span class="n">bachetRankings</span>
        <span class="c1">#ba1.rankings = rankings</span>
        <span class="n">atts</span> <span class="o">=</span> <span class="p">[</span><span class="n">att</span> <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="n">ba1</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">atts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;vetos&#39;</span><span class="p">)</span>
            <span class="n">atts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;negativeVetos&#39;</span><span class="p">)</span>
            <span class="n">atts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;methodData&#39;</span><span class="p">)</span>
            <span class="n">atts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;concordanceRelation&#39;</span><span class="p">)</span>
            <span class="n">atts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;largePerformanceDifferencesCount&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">atts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;fusionOperator&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="n">atts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">ba1</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">att</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">ba1</span><span class="o">.</span><span class="n">showRankingByChoosing</span><span class="p">()</span>
        <span class="c1"># store attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">randomized</span> <span class="o">=</span> <span class="n">randomized</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxNbrOfRankings</span> <span class="o">=</span> <span class="n">maxNbrOfRankings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Polarised</span> <span class="o">=</span> <span class="n">Polarised</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partialBachetCorrelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="n">ba1</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="n">WithCoverCredibility</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">##    def computeBoostedRanking(self):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Renders an ordred list of decision actions ranked in</span>
<span class="c1">##        decreasing preference direction following the rankingRule</span>
<span class="c1">##        on each component.</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        ranking = []</span>
<span class="c1">##        components = self.computeRankingByChoosing()</span>
<span class="c1">##        for i in range(len(components[&#39;result&#39;])):</span>
<span class="c1">##            ranking += components[&#39;result&#39;][i][0][1]</span>
<span class="c1">##        ordering = []</span>
<span class="c1">##        components = self.computeRankingByChoosing()</span>
<span class="c1">##        for i in range(len(components[&#39;result&#39;])):</span>
<span class="c1">##            ordering += components[&#39;result&#39;][i][1][1]</span>
<span class="c1">##        boostedRanking = ranking</span>
<span class="c1">##        for x in reversed(ordering):</span>
<span class="c1">##            if x not in ranking:</span>
<span class="c1">##                boostedRanking.append(x)</span>
<span class="c1">##        return boostedRanking</span>
<span class="c1">##</span>
<span class="c1">##    def computeBoostedOrdering(self):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Renders an ordred list of decision actions ranked in</span>
<span class="c1">##        decreasing preference direction following the rankingRule</span>
<span class="c1">##        on each component.</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        ranking = []</span>
<span class="c1">##        components = self.rankingByChoosing</span>
<span class="c1">##        for i in range(len(components[&#39;result&#39;])):</span>
<span class="c1">##            ranking += components[&#39;result&#39;][i][0][1]</span>
<span class="c1">##        ordering = []</span>
<span class="c1">##        components = self.rankingByChoosing</span>
<span class="c1">##        for i in range(len(components[&#39;result&#39;])):</span>
<span class="c1">##            ordering += components[&#39;result&#39;][i][1][1]</span>
<span class="c1">##        boostedOrdering = ordering</span>
<span class="c1">##        for x in reversed(ranking):</span>
<span class="c1">##            if x not in ordering:</span>
<span class="c1">##                boostedOrdering.append(x)</span>
<span class="c1">##        return boostedOrdering</span>

<div class="viewcode-block" id="PartialBachetRanking.computePartialOutrankingConsensusQuality">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PartialBachetRanking.computePartialOutrankingConsensusQuality">[docs]</a>
    <span class="k">def</span> <span class="nf">computePartialOutrankingConsensusQuality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders or shows the consensus data of apartial Bachet ranking</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">OutrankingDigraph</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">OutrankingDigraph</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computePartialOutrankingConsensusQuality</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                <span class="n">ValuedCorrelation</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">Polarised</span><span class="p">,</span>
                                <span class="n">Sorted</span><span class="o">=</span><span class="n">Sorted</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the partial ranking is not of OutrankingDigraph type !!!&#39;</span><span class="p">)</span>
            <span class="n">cons</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">PartialBachetRanking</span>
        <span class="k">return</span> <span class="n">cons</span></div>


<div class="viewcode-block" id="PartialBachetRanking.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PartialBachetRanking.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ArrowHeads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for Hasse diagram drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
            
        <span class="k">def</span> <span class="nf">_safeName</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">t1</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">t1</span>
        <span class="c1"># working on a deepcopy of self</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">computeRankingByChoosing</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="n">rbcp</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span>
        <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rbcp</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rbcp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rbcp</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt;&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">ci</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;==&gt;&gt;&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ci</span><span class="p">)</span>                
            <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">ci</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rbcp: &#39;</span><span class="p">,</span> <span class="n">rbcp</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rankingByChoosing:&#39;</span><span class="p">,</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="n">bgcolor</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz)</span><span class="se">\\</span><span class="s1">n R. Bisdorff, 2020&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;,fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fontSize</span><span class="p">)</span>
        <span class="c1"># nodes</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                   <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># same ranks for Hasses equivalence classes</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">sameRank</span> <span class="o">=</span> <span class="s1">&#39;subGraph { rank = same; &#39;</span>
            <span class="c1">#sameRank = &#39;{ rank = i; &#39;</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="n">sameRank</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;; &#39;</span>
            <span class="n">sameRank</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sameRank</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sameRank</span><span class="p">)</span>

        <span class="c1"># open transitive links and write the positive arcs</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">InSite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                    <span class="n">jch</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">jch</span><span class="p">:</span>
                        <span class="c1">#edge = &#39;n&#39;+str(i+1)+&#39;-&gt; n&#39;+str(i+2)+&#39; [dir=forward,style=&quot;setlinewidth(1)&quot;,color=black, arrowhead=normal] ;\n&#39;</span>
                        <span class="k">if</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                            <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                            <span class="k">if</span> <span class="n">ArrowHeads</span><span class="p">:</span>
                                <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">,arrowhead=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>                                
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">relation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                            <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                            <span class="k">if</span> <span class="n">ArrowHeads</span><span class="p">:</span>
                                <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">,arrowhead=none] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                                
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                                                  
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># restore original relation</span>
        <span class="c1">#relation = deepcopy(originalRelation)</span>
        
        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;dot -Grankdir=TB -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span>\
                        <span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="c1">#commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>
</div>

         
<span class="c1">#########</span>
<span class="c1"># compatibility with obsolete weakOrders module</span>
<span class="c1">#######################</span>

<div class="viewcode-block" id="PartialRanking">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PartialRanking">[docs]</a>
<span class="k">class</span> <span class="nc">PartialRanking</span><span class="p">(</span><span class="n">RankingsFusion</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    dummy class for backward compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="KemenyWeakOrder">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.KemenyWeakOrder">[docs]</a>
<span class="k">class</span> <span class="nc">KemenyWeakOrder</span><span class="p">(</span><span class="n">KemenyOrdersFusion</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    dummy class for backward compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="PrincipalInOutDegreesOrdering">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.PrincipalInOutDegreesOrdering">[docs]</a>
<span class="k">class</span> <span class="nc">PrincipalInOutDegreesOrdering</span><span class="p">(</span><span class="n">PrincipalInOutDegreesOrderingFusion</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    dummy class for backward compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="WeakOrder">
<a class="viewcode-back" href="../techDoc.html#transitiveDigraphs.WeakOrder">[docs]</a>
<span class="k">class</span> <span class="nc">WeakOrder</span><span class="p">(</span><span class="n">TransitiveDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    dummy class for backward compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<span class="c1">####################</span>

<span class="c1">#----------test outrankingDigraphs classes ----------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">sortingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">votingProfiles</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Digraph3 transitiveDigraphs module               *</span>
<span class="s2">    * depends on BipolarOutrankingDigraph and          *</span>
<span class="s2">    * $Revision$ Python3.13                            *</span>
<span class="s2">    * Copyright (C) 2010-2025 Raymond Bisdorff         *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">pt</span> <span class="o">=</span> <span class="n">RandomCBPerformanceTableau</span><span class="p">(</span><span class="n">numberOfActions</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">numberOfCriteria</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
    <span class="n">pbr</span> <span class="o">=</span> <span class="n">PartialBachetRanking</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">randomized</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Polarised</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pbr</span><span class="p">)</span>
    <span class="n">pbr</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">()</span>
    <span class="n">pbr</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="s1">&#39;wbg&#39;</span><span class="p">)</span>
    <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="n">pbr</span><span class="p">,</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2025, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Sep 09, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>