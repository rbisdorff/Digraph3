<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>perfTabs &mdash; Digraph3 3.13.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/sphinx_rtd_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f92f4e34"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=15d7cbb8"></script>
        <script src="../_static/js/hoverxref.js?v=4352a7d3"></script>
        <script src="../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
        <script src="../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Python 3.13
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">perfTabs</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for perfTabs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Python3 implementation of digraphs</span>
<span class="sd">Module for working with performance tableaux  </span>
<span class="sd">Copyright (C) 2011-2025  Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#######################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.13.2&quot;</span>

<span class="kn">from</span> <span class="nn">perfTabs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">decimal</span>
<span class="c1"># from digraphsTools import *</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>

<div class="viewcode-block" id="PerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">PerformanceTableau</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">In this *Digraph3* module, the root :py:class:`perfTabs.PerformanceTableau` class provides a generic **performance table model**. A given object of this class consists in:</span>

<span class="sd">     * A set of potential decision **actions** : an ordered dictionary describing the potential decision actions or alternatives with &#39;name&#39; and &#39;comment&#39; attributes,</span>
<span class="sd">     * An optional set of decision **objectives**: an ordered dictionary with name, comment, weight and list of concerned criteria per objective,</span>
<span class="sd">     * A coherent family of **criteria**: a ordered dictionary of criteria functions used for measuring the performance of each potential decision action with respect to the preference dimension captured by each criterion,</span>
<span class="sd">     * The **evaluation**: a dictionary of performance evaluations for each decision action or alternative on each criterion function,</span>
<span class="sd">     * The NA numerical symbol: Decimal(&#39;-999&#39;) by default representing missing evaluation data.</span>

<span class="sd">Structure::</span>

<span class="sd">       actions = OrderedDict([(&#39;a1&#39;, {&#39;name&#39;: ..., &#39;comment&#39;: ...}),</span>
<span class="sd">                  (&#39;a2&#39;, {&#39;name&#39;: ..., &#39;comment&#39;: ...}),</span>
<span class="sd">                  ...])</span>
<span class="sd">       objectives = OrderedDict([</span>
<span class="sd">                   (&#39;obj1&#39;, {&#39;name&#39;: ..., &#39;comment&#39;: ..., &#39;weight&#39;: ..., &#39;criteria&#39;: [&#39;g1&#39;, ...]}),</span>
<span class="sd">                   (&#39;obj2&#39;, {&#39;name&#39;: ..., &#39;comment&#39;, ..., &#39;weight&#39;: ..., &#39;criteria&#39;: [&#39;g2&#39;, ...]}),</span>
<span class="sd">                   ...])</span>
<span class="sd">       criteria = OrderedDict([</span>
<span class="sd">            (&#39;g1&#39;, {&#39;weight&#39;:Decimal(&quot;3.00&quot;),</span>
<span class="sd">                    &#39;scale&#39;: (Decimal(&quot;0.00&quot;),Decimal(&quot;100.00&quot;)),</span>
<span class="sd">                    &#39;thresholds&#39; : {&#39;pref&#39;: (Decimal(&#39;20.0&#39;), Decimal(&#39;0.0&#39;)),</span>
<span class="sd">                                    &#39;ind&#39;: (Decimal(&#39;10.0&#39;), Decimal(&#39;0.0&#39;)),</span>
<span class="sd">                                    &#39;veto&#39;: (Decimal(&#39;80.0&#39;), Decimal(&#39;0.0&#39;))},</span>
<span class="sd">                    &#39;objective&#39;: &#39;obj1&#39;,</span>
<span class="sd">                    }),</span>
<span class="sd">            (&#39;g2&#39;, {&#39;weight&#39;:Decimal(&quot;5.00&quot;),</span>
<span class="sd">                    &#39;scale&#39;: (Decimal(&quot;0.00&quot;),Decimal(&quot;100.00&quot;)),</span>
<span class="sd">                    &#39;thresholds&#39; : {&#39;pref&#39;: (Decimal(&#39;20.0&#39;), Decimal(&#39;0.0&#39;)),</span>
<span class="sd">                                          &#39;ind&#39;: (Decimal(&#39;10.0&#39;), Decimal(&#39;0.0&#39;)),</span>
<span class="sd">                                          &#39;veto&#39;: (Decimal(&#39;80.0&#39;), Decimal(&#39;0.0&#39;))},</span>
<span class="sd">                    &#39;objective&#39;: &#39;obj2&#39;,</span>
<span class="sd">                    }),</span>
<span class="sd">            ...])</span>
<span class="sd">       evaluation = {&#39;g1&#39;: {&#39;a1&#39;:Decimal(&quot;57.28&quot;),&#39;a2&#39;:Decimal(&quot;99.85&quot;), ...},</span>
<span class="sd">                     &#39;g2&#39;: {&#39;a1&#39;:Decimal(&quot;88.12&quot;),&#39;a2&#39;:Decimal(&quot;-999&quot;), ...},</span>
<span class="sd">                     ...}</span>


<span class="sd">With the help of the :py:class:`perfTabs.RandomPerformanceTableau` class let us generate for illustration a random performance tableau concerning 7 decision actions or alternatives denoted *a01*, *a02*, ..., *a07*:</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; rt = RandomPerformanceTableau(seed=100)</span>
<span class="sd">    &gt;&gt;&gt; rt.showActions()</span>
<span class="sd">        *----- show decision action --------------*</span>
<span class="sd">        key:  a01</span>
<span class="sd">          short name: a01</span>
<span class="sd">          name:       random decision action</span>
<span class="sd">          comment:    RandomPerformanceTableau() generated.</span>
<span class="sd">        key:  a02</span>
<span class="sd">          short name: a02</span>
<span class="sd">          name:       random decision action</span>
<span class="sd">          comment:    RandomPerformanceTableau() generated.</span>
<span class="sd">        key:  a03</span>
<span class="sd">          short name: a03</span>
<span class="sd">          name:       random decision action</span>
<span class="sd">          comment:    RandomPerformanceTableau() generated.</span>
<span class="sd">        ...</span>
<span class="sd">        ...</span>
<span class="sd">        key:  a07</span>
<span class="sd">        name:       random decision action</span>
<span class="sd">        comment:    RandomPerformanceTableau() generated.</span>
<span class="sd">   </span>
<span class="sd">In this example we consider furthermore a family of seven equisignificant cardinal criteria functions *g01*, *g02*, ..., *g07*, measuring the performance of each alternative on a rational scale form 0.0 to 100.00. In order to capture the evaluation&#39;s uncertainty and imprecision, each criterion function *g1* to *g7* admits three performance discrimination thresholds of 10, 20 and 80 pts for warranting respectively any indifference, preference and veto situations: </span>
<span class="sd">    &gt;&gt;&gt; rt.showCriteria(IntegerWeights=True)</span>
<span class="sd">    *----  criteria -----*</span>
<span class="sd">    g1 RandomPerformanceTableau() instance</span>
<span class="sd">      Preference direction: max</span>
<span class="sd">      Scale = (0.00, 100.00)</span>
<span class="sd">      Weight = 1 </span>
<span class="sd">      Threshold ind : 2.50 + 0.00x ; percentile: 6.06</span>
<span class="sd">      Threshold pref : 5.00 + 0.00x ; percentile: 12.12</span>
<span class="sd">      Threshold veto : 80.00 + 0.00x ; percentile: 100.00</span>
<span class="sd">    g2 RandomPerformanceTableau() instance</span>
<span class="sd">      Preference direction: max</span>
<span class="sd">      Scale = (0.00, 100.00)</span>
<span class="sd">      Weight = 1 </span>
<span class="sd">      Threshold ind : 2.50 + 0.00x ; percentile: 7.69</span>
<span class="sd">      Threshold pref : 5.00 + 0.00x ; percentile: 14.10</span>
<span class="sd">      Threshold veto : 80.00 + 0.00x ; percentile: 100.00</span>
<span class="sd">    g3 RandomPerformanceTableau() instance</span>
<span class="sd">      Preference direction: max</span>
<span class="sd">      Scale = (0.00, 100.00)</span>
<span class="sd">      Weight = 1 </span>
<span class="sd">      Threshold ind : 2.50 + 0.00x ; percentile: 6.41</span>
<span class="sd">      Threshold pref : 5.00 + 0.00x ; percentile: 6.41</span>
<span class="sd">      Threshold veto : 80.00 + 0.00x ; percentile: 100.00</span>
<span class="sd">        ...</span>
<span class="sd">        ...</span>
<span class="sd">    g7 RandomPerformanceTableau() instance</span>
<span class="sd">      Preference direction: max</span>
<span class="sd">      Scale = (0.00, 100.00)</span>
<span class="sd">      Weight = 1 </span>
<span class="sd">      Threshold ind : 2.50 + 0.00x ; percentile: 3.85</span>
<span class="sd">      Threshold pref : 5.00 + 0.00x ; percentile: 11.54</span>
<span class="sd">      Threshold veto : 80.00 + 0.00x ; percentile: 100.00</span>

<span class="sd">The performance evaluations of each decision alternative on each criterion are gathered in a *performance tableau*:</span>
<span class="sd">    &gt;&gt;&gt; rt.showPerformanceTableau()</span>
<span class="sd">    *----  performance tableau -----*</span>
<span class="sd">    Criteria |  &#39;g1&#39;    &#39;g2&#39;    &#39;g3&#39;    &#39;g4&#39;    &#39;g5&#39;    &#39;g6&#39;    &#39;g7&#39;   </span>
<span class="sd">    Actions  |    1       1       1       1       1       1       1    </span>
<span class="sd">    ---------|-------------------------------------------------------</span>
<span class="sd">     &#39;a01&#39;   |  15.17   62.22   39.35   31.83   38.81   56.93   64.96  </span>
<span class="sd">     &#39;a02&#39;   |  44.51   44.23   32.06   69.98   67.45   65.57   79.38  </span>
<span class="sd">     &#39;a03&#39;   |  57.87   19.10   47.67   48.80   38.93   83.87   75.11  </span>
<span class="sd">     &#39;a04&#39;   |  58.00   27.73   14.81   82.88   19.26   34.99   49.30  </span>
<span class="sd">     &#39;a05&#39;   |  24.22   41.46   79.70   41.66   94.95   49.56   43.74  </span>
<span class="sd">     &#39;a06&#39;   |  29.10   22.41   67.48   12.82   65.63   79.43   15.31  </span>
<span class="sd">     &#39;a07&#39;   |   NA     21.52   13.97   21.92   48.00   42.37   59.94  </span>
<span class="sd">     &#39;a08&#39;   |  82.29   56.90   90.72   75.74    7.97   42.39   31.39  </span>
<span class="sd">     &#39;a09&#39;   |  43.90   46.37   80.16   15.45   34.86   33.75   26.80  </span>
<span class="sd">     &#39;a10&#39;   |  38.75   16.22   69.62   6.05    71.81   38.60   59.02  </span>
<span class="sd">     &#39;a11&#39;   |  35.84   21.53   45.49    9.96   31.66   57.38   40.85  </span>
<span class="sd">     &#39;a12&#39;   |  29.12   51.16   22.03   60.55   41.14   62.34   49.12  </span>
<span class="sd">     &#39;a13&#39;   |  34.79   77.01   33.83   27.88   53.58   34.95   45.20  </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default presentation method for PerformanceTableau instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="s1">&#39;*------- PerformanceTableau instance description ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class     : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Seed               : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">randomSeed</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Actions            : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Objectives         : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>       
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Criteria           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;NaN proportion (</span><span class="si">%%</span><span class="s1">) : </span><span class="si">%.1f</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeMissingDataProportion</span><span class="p">(</span><span class="n">InPercents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> \
                    <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>     
        <span class="k">return</span> <span class="n">reprString</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filePerfTab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">isEmpty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="k">if</span> <span class="n">filePerfTab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">filePerfTab</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filePerfTab</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="c1">###</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;actionset&#39;</span><span class="p">]</span>
            <span class="c1">###</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;objectives&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="c1">####</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weightset</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;weightset&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;criteria&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weightset</span><span class="p">[</span><span class="n">g</span><span class="p">])),</span>
                                        <span class="s1">&#39;thresholds&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="n">g</span><span class="p">]}</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;weightorder&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setObjectiveWeights</span><span class="p">()</span>
            <span class="c1">###</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>
            <span class="n">evaluation</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;evaluation&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">):</span>
                        <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
            
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">isEmpty</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
            <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="n">RandomPerformanceTableau</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">RandomPerformanceTableau</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;empty_instance&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>
            
<div class="viewcode-block" id="PerformanceTableau.replaceNA">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.replaceNA">[docs]</a>
    <span class="k">def</span> <span class="nf">replaceNA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">newNA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces the current self.NA symbol with the *newNA* symbol of type &lt;Decimal&gt;. If newNA is None, the defauklt value Decimal(&#39;-999&#39;) is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">newNA</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">newNA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">newNA</span> <span class="o">&gt;=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> \
                         <span class="ow">and</span> <span class="n">newNA</span> <span class="o">&lt;=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning!!: newNA included in criterion </span><span class="si">%s</span><span class="s1"> scale&#39;</span> \
                                                                <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">],</span><span class="n">newNA</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">newNA</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> \
                   <span class="ow">and</span> <span class="n">newNA</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning!!: newNA included in criterion </span><span class="si">%s</span><span class="s1"> scale&#39;</span> \
                                                               <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">newNA</span><span class="p">,</span>
                          <span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">newNA</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;replaced </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">NA</span><span class="p">,</span> <span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="n">newNA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">newNA</span></div>


<div class="viewcode-block" id="PerformanceTableau.setObjectiveWeights">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.setObjectiveWeights">[docs]</a>
    <span class="k">def</span> <span class="nf">setObjectiveWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the objective weights to the sum of the corresponding criteria significance weights.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">objWeights</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectives</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">objWeights</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">+=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">objWeights</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectives</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">objWeights</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span></div>

            
<div class="viewcode-block" id="PerformanceTableau.hasOddWeightAlgebra">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.hasOddWeightAlgebra">[docs]</a>
    <span class="k">def</span> <span class="nf">hasOddWeightAlgebra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify if the given criteria[self][&#39;weight&#39;] are odd or not.</span>
<span class="sd">        Return a Boolen value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="n">powerset</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">w</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;weights = &#39;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
        <span class="n">Eorig</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)))</span>
        <span class="n">E</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">Eorig</span><span class="p">)</span>
        <span class="n">OddWeightAlgebra</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">powerset</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
            <span class="n">Xc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">Eorig</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Xc</span><span class="p">)</span>
            <span class="n">sumX</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
                <span class="n">sumX</span> <span class="o">+=</span> <span class="n">w</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">sumXc</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Xc</span><span class="p">:</span>
                <span class="n">sumXc</span> <span class="o">+=</span> <span class="n">w</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">sumX</span><span class="p">,</span> <span class="n">sumXc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sumX</span> <span class="o">==</span> <span class="n">sumXc</span><span class="p">:</span>
                <span class="c1">#print sumX, sumXc</span>
                <span class="n">OddWeightAlgebra</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">OddWeightAlgebra</span></div>


        
<div class="viewcode-block" id="PerformanceTableau.computeWeightedAveragePerformances">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeWeightedAveragePerformances">[docs]</a>
    <span class="k">def</span> <span class="nf">computeWeightedAveragePerformances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">isNormalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lowValue</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">highValue</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">isListRanked</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute normalized weighted average scores by ignoring missing data.</span>
<span class="sd">        When *isNormalized* == True (False by default), </span>
<span class="sd">        transforms all the scores into a common 0-100 scale. </span>
<span class="sd">        A lowValue and highValue parameter</span>
<span class="sd">        can be provided for a specific normalisation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">if</span> <span class="n">isNormalized</span><span class="p">:</span>
            <span class="n">normSelf</span> <span class="o">=</span> <span class="n">NormalizedPerformanceTableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lowValue</span><span class="o">=</span><span class="n">lowValue</span><span class="p">,</span><span class="n">highValue</span><span class="o">=</span><span class="n">highValue</span><span class="p">)</span>
            <span class="n">evaluation</span> <span class="o">=</span> <span class="n">normSelf</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>

        <span class="c1">#sumWeights = Decimal(&#39;0.0&#39;)</span>
        <span class="c1">#for g in dict.keys(criteria):</span>
        <span class="c1">#    sumWeights += abs(criteria[g][&#39;weight&#39;])</span>

        <span class="n">weightedAverage</span> <span class="o">=</span> <span class="p">{}</span> 
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
            <span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
            <span class="n">weightedAverage</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">sumWeights</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                    <span class="n">weightedAverage</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> \
                        <span class="o">+=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> \
                                            <span class="o">/</span> <span class="n">sumWeights</span>
        <span class="k">if</span> <span class="n">isListRanked</span><span class="p">:</span>
            <span class="n">ranked</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">weightedAverage</span><span class="p">:</span>
                <span class="n">ranked</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">weightedAverage</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">x</span><span class="p">))</span>
            <span class="n">ranked</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">ranked</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">weightedAverage</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.showActions">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showActions">[docs]</a>
    <span class="k">def</span> <span class="nf">showActions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Alphabetic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        presentation methods for decision actions or alternatives</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- show decision action --------------*&#39;</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">if</span> <span class="n">Alphabetic</span><span class="p">:</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
            <span class="n">actionsKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;key: &#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  short name:&#39;</span><span class="p">,</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  name:      &#39;</span><span class="p">,</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  comment:   &#39;</span><span class="p">,</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="nb">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;key: &#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  short name:&#39;</span><span class="p">,</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  name:      &#39;</span><span class="p">,</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  comment:   &#39;</span><span class="p">,</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="nb">print</span><span class="p">()</span></div>


<div class="viewcode-block" id="PerformanceTableau.showPairwiseComparison">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showPairwiseComparison">[docs]</a>
    <span class="k">def</span> <span class="nf">showPairwiseComparison</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span>
                               <span class="c1">#hasSymetricThresholds=True,</span>
                               <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">hasSymmetricThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the pairwise comprison parameters on all criteria</span>
<span class="sd">        in html format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a,b =&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span>  <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;Pairwise Comparison&lt;/h1&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h2&gt;Comparing actions : (</span><span class="si">%s</span><span class="s1">,</span><span class="si">%s</span><span class="s1">)&lt;/h2&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White&quot; border=&quot;1&quot;&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;crit.&lt;/th&gt;&lt;th&gt;wght.&lt;/th&gt; &lt;th&gt;g(x)&lt;/th&gt; &lt;th&gt;g(y)&lt;/th&gt; &lt;th&gt;diff&lt;/th&gt; &lt;th&gt;ind&lt;/th&gt; &lt;th&gt;wp&lt;/th&gt; &lt;th&gt;p&lt;/th&gt; &lt;th&gt;concord&lt;/th&gt; &lt;th&gt;wv&lt;/th&gt; &lt;th&gt;v&lt;/th&gt; &lt;th&gt;polarisation&lt;/th&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------  pairwise comparison ----*&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Comparing actions : (</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;crit. wght.  g(x)  g(y)    diff  </span><span class="se">\t</span><span class="s1">| ind     wp      p    concord </span><span class="se">\t</span><span class="s1">|  wv   v   weak veto veto&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------  </span><span class="se">\t</span><span class="s1"> ----------------------------- </span><span class="se">\t</span><span class="s1"> ----------------&#39;</span><span class="p">)</span>                
            <span class="n">concordance</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">sumWeights</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">]</span>
            <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">sumWeights</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span> <span class="ow">and</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>		
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">indx</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">indy</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">hasSymmetricThresholds</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">indx</span> <span class="o">+</span><span class="n">indy</span> \
                                 <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]),</span>
                                       <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ind</span> <span class="o">=</span> <span class="n">indx</span> <span class="o">+</span><span class="n">indy</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">wpx</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">wpy</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">hasSymmetricThresholds</span><span class="p">:</span>
                            <span class="n">wp</span> <span class="o">=</span> <span class="n">wpx</span> <span class="o">+</span> <span class="n">wpy</span> \
                                <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]),</span>
                                      <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">wp</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">px</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">py</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">hasSymmetricThresholds</span><span class="p">:</span>
                            <span class="n">p</span> <span class="o">=</span> <span class="n">px</span> <span class="o">+</span> <span class="n">py</span> \
                                <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]),</span>
                                      <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">p</span> <span class="o">=</span> <span class="n">px</span> <span class="o">+</span> <span class="n">py</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">-</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">d</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                    <span class="n">lc0</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="o">.</span><span class="n">_localConcordance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                                     <span class="n">d</span><span class="p">,</span><span class="n">ind</span><span class="p">,</span>
                                                                     <span class="n">wp</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">wp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">wp</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#FFEEAA&quot; align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt; &lt;td&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/td&gt; &lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt; &lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;  &lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;  &lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;   &lt;td&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">],</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">],</span><span class="n">d</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">lc0</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                         <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">&#39;  </span><span class="si">%.2f</span><span class="s1">  </span><span class="si">%2.2f</span><span class="s1">  </span><span class="si">%2.2f</span><span class="s1">  </span><span class="si">%+2.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1">| </span><span class="si">%s</span><span class="s1">  </span><span class="si">%s</span><span class="s1">  </span><span class="si">%s</span><span class="s1">   </span><span class="si">%+.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1">|&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">],</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">],</span><span class="n">d</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">lc0</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">concordance</span> <span class="o">=</span> <span class="n">concordance</span> \
                                  <span class="o">+</span> <span class="p">(</span><span class="n">lc0</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">wvx</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">wvy</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">hasSymmetricThresholds</span><span class="p">:</span>
                            <span class="n">wv</span> <span class="o">=</span> <span class="n">wvx</span> <span class="o">+</span> <span class="n">wvy</span> \
                                 <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]),</span>
                                       <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">wv</span> <span class="o">=</span> <span class="n">wvx</span> <span class="o">+</span> <span class="n">wvy</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">wv</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">vx</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">vy</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">hasSymmetricThresholds</span><span class="p">:</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="n">vx</span> <span class="o">+</span> <span class="n">vy</span> \
                                <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]),</span>
                                      <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="n">vx</span> <span class="o">+</span> <span class="n">vy</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">veto</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="o">.</span><span class="n">_localVeto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">wv</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">negativeVeto</span> \
                         <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="o">.</span><span class="n">_localNegativeVeto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                                      <span class="n">d</span><span class="p">,</span><span class="n">wv</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
                        <span class="n">hasBipolarVeto</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">hasBipolarVeto</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">hasBipolarVeto</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">v</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     </span><span class="si">%2.2f</span><span class="s1">       </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> \
                                              <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">negativeVeto</span><span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt; &lt;td&gt; </span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td bgcolor=&quot;#ddffdd&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">negativeVeto</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">v</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;     </span><span class="si">%2.2f</span><span class="s1">       </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> \
                                          <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt; &lt;td&gt; </span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td bgcolor=&quot;#ffddff&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>                                
                                    <span class="nb">print</span><span class="p">()</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
                        <span class="k">elif</span> <span class="n">wv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">wv</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%2.2f</span><span class="s1">      </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> \
                                          <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="n">negativeVeto</span><span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td bgcolor=&quot;#ddffdd&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="n">negativeVeto</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">wv</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%2.2f</span><span class="s1">      </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt;&lt;td&gt;&lt;/td&gt; &lt;td bgcolor=&quot;#ffddff&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">()</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">()</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">## unipolar case  Electre III for instance</span>
                        <span class="k">if</span> <span class="n">veto</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-1.0&quot;</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">wv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%2.2f</span><span class="s1"> </span><span class="si">%2.2f</span><span class="s1"> </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> \
                                              <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">veto</span><span class="p">))</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td&gt; </span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td bgcolor=&quot;#ffddff&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">veto</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%2.2f</span><span class="s1">       </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">))</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;td bgcolor=&quot;#ffddff&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wv</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;       </span><span class="si">%2.2f</span><span class="s1"> </span><span class="si">%+2.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">veto</span><span class="p">))</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt; &lt;td&gt;</span><span class="si">%2.2f</span><span class="s1">&lt;/td&gt; &lt;td bgcolor=&quot;#ffddff&quot;&gt;</span><span class="si">%+2.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">veto</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">()</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
                        
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">:</span>
                        <span class="n">eval_c_a</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">eval_c_a</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%2.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">a</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">:</span>
                        <span class="n">eval_c_b</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">eval_c_b</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%2.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>
                    
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eval_c_a</span><span class="p">,</span><span class="n">eval_c_b</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#FFEEAA&quot; align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt; &lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="n">eval_c_a</span><span class="p">,</span><span class="n">eval_c_b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;             ----------------------------------------&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Valuation in range: </span><span class="si">%+.2f</span><span class="s1"> to </span><span class="si">%+.2f</span><span class="s1">; global concordance: </span><span class="si">%+.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">concordance</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&lt;/table&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;b&gt;Valuation in range: </span><span class="si">%+.2f</span><span class="s1"> to </span><span class="si">%+.2f</span><span class="s1">; global concordance: </span><span class="si">%+.2f</span><span class="s1"> &lt;/b&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">concordance</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">html</span></div>


    
<div class="viewcode-block" id="PerformanceTableau.showCriteria">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showCriteria">[docs]</a>
    <span class="k">def</span> <span class="nf">showCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Alphabetic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ByObjectives</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        print Criteria with thresholds and weights.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">ByObjectives</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----  criteria -----*&#39;</span><span class="p">)</span>
<span class="c1">##        sumWeights = Decimal(&#39;0.0&#39;)</span>
<span class="c1">##        for g in criteria:</span>
<span class="c1">##            sumWeights += criteria[g][&#39;weight&#39;]</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ByObjectives</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectives</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span> <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">obj</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">criterionName</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/&#39;</span> <span class="o">%</span> <span class="n">objectives</span><span class="p">[</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>                                        
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">criterionName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">criterionName</span> <span class="o">+=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">criterionName</span><span class="p">))</span>
                    
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Scale =&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">IntegerWeights</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Weight = </span><span class="si">%d</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">weightg</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">sumWeights</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Weight = </span><span class="si">%.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">weightg</span><span class="p">))</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt;&gt;&#39;</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Threshold </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%.2f</span><span class="s1"> + </span><span class="si">%.2f</span><span class="s1">x&#39;</span> \
                                  <span class="o">%</span> <span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;; percentile: </span><span class="si">%.2f</span><span class="s1">&#39;</span> \
                            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeVariableThresholdPercentile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="nb">print</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">Alphabetic</span><span class="p">:</span>
                <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">cg</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">cg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">prefDir</span> <span class="o">=</span> <span class="n">cg</span><span class="p">[</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">prefDir</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Preference direction:&#39;</span><span class="p">,</span> <span class="n">prefDir</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Scale = (</span><span class="si">%.2f</span><span class="s1">, </span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span>\
                        <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">cg</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">if</span> <span class="n">IntegerWeights</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Weight = </span><span class="si">%d</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weightg</span> <span class="o">=</span> <span class="n">cg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">sumWeights</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Weight = </span><span class="si">%.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">weightg</span><span class="p">))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">cg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt;&gt;&#39;</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span><span class="n">cg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                              <span class="n">cg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Threshold </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%.2f</span><span class="s1"> + </span><span class="si">%.2f</span><span class="s1">x&#39;</span>\
                            <span class="o">%</span> <span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="n">cg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                               <span class="n">cg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                        <span class="c1">#print self.criteria[g][&#39;thresholds&#39;][th]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;; percentile: </span><span class="si">%.2f</span><span class="s1">&#39;</span> \
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeVariableThresholdPercentile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">th</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="nb">print</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">showObjectives</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;objectives&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------ decision objectives -------&quot;&#39;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">:</span>
                                                   
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
                                                   
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                                                   
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Total weight: </span><span class="si">%.2f</span><span class="s1"> (</span><span class="si">%d</span><span class="s1"> criteria)</span><span class="se">\n</span><span class="s1">&#39;</span>\
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span>
                         <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The performance tableau does not contain objectives.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="PerformanceTableau.showWeightPreorder">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showWeightPreorder">[docs]</a>
    <span class="k">def</span> <span class="nf">showWeightPreorder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a preordering of the the criteria signficance weights. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------- weights preordering --------*&#39;</span><span class="p">)</span>
        <span class="n">wpo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">wpo</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">wpo</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">) &lt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">wpo</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">wpo</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">wpo</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span></div>

            
<div class="viewcode-block" id="PerformanceTableau.convertInsite2Standard">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertInsite2Standard">[docs]</a>
    <span class="k">def</span> <span class="nf">convertInsite2Standard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert in site a bigData formated Performance tableau back into a standard formated PerformanceTableau instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertDiscriminationThresholds2Decimal</span><span class="p">()</span></div>


<div class="viewcode-block" id="PerformanceTableau.convertInsite2BigData">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertInsite2BigData">[docs]</a>
    <span class="k">def</span> <span class="nf">convertInsite2BigData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert in site a standard formated Performance tableau into a bigData formated instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Integer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Float</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertDiscriminationThresholds2Float</span><span class="p">()</span></div>


<div class="viewcode-block" id="PerformanceTableau.convert2BigData">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convert2BigData">[docs]</a>
    <span class="k">def</span> <span class="nf">convert2BigData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a cPerformanceTableau instance, by converting the action keys to integers and evaluations to floats, including the discrimination thresholds, the case given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">cRandPerfTabs</span> <span class="kn">import</span> <span class="n">cPerformanceTableau</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">isEmpty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;bgd_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">att</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">]</span>
        <span class="n">att</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="n">att</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;actions&#39;</span><span class="p">)</span>
        <span class="n">att</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;evaluation&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">att</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
        <span class="c1"># convert action keys to integers</span>
        <span class="n">t</span><span class="o">.</span><span class="n">convertWeight2Integer</span><span class="p">()</span>
        <span class="n">t</span><span class="o">.</span><span class="n">convertDiscriminationThresholds2Float</span><span class="p">()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">newActions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
            <span class="n">newKey</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">newActions</span><span class="p">[</span><span class="n">newKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="c1"># convert evaluation access keys</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">newEvaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
            <span class="n">newEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
                <span class="n">newKey</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">newEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">newKey</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
        <span class="n">t</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">newActions</span>
        <span class="n">t</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">newEvaluation</span>
        <span class="c1"># change the object class</span>
        <span class="n">t</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">cPerformanceTableau</span>
        <span class="k">return</span> <span class="n">t</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.convertWeight2Integer">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertWeight2Integer">[docs]</a>
    <span class="k">def</span> <span class="nf">convertWeight2Integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert significance weights from Decimal format</span>
<span class="sd">        to int format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span></div>


<div class="viewcode-block" id="PerformanceTableau.convertEvaluation2Float">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertEvaluation2Float">[docs]</a>
    <span class="k">def</span> <span class="nf">convertEvaluation2Float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert evaluations from decimal format to float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span></div>


    <span class="k">def</span> <span class="nf">convertDiscriminationThresholds2Float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">]</span>
                <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">]</span> <span class="o">=</span> <span class="n">d1</span>

    <span class="k">def</span> <span class="nf">convertDiscriminationThresholds2Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">]</span>
                <span class="n">d1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">]</span> <span class="o">=</span> <span class="n">d1</span>

 
<div class="viewcode-block" id="PerformanceTableau.convertWeight2Decimal">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertWeight2Decimal">[docs]</a>
    <span class="k">def</span> <span class="nf">convertWeight2Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert significance weights from obsolete float format</span>
<span class="sd">        to decimal format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span></div>


<div class="viewcode-block" id="PerformanceTableau.convertEvaluation2Decimal">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertEvaluation2Decimal">[docs]</a>
    <span class="k">def</span> <span class="nf">convertEvaluation2Decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert evaluations from obsolete float format to decimal format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span></div>


<div class="viewcode-block" id="PerformanceTableau.convertWeights2Negative">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertWeights2Negative">[docs]</a>
    <span class="k">def</span> <span class="nf">convertWeights2Negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Negates the weights of criteria to be minimzed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">critg</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                <span class="n">valg</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">valg</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">valg</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="c1">#print(g,x,valg[x])</span>
                        <span class="n">valg</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">valg</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span></div>


<div class="viewcode-block" id="PerformanceTableau.convertWeights2Positive">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.convertWeights2Positive">[docs]</a>
    <span class="k">def</span> <span class="nf">convertWeights2Positive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets negative weights back to positive weights and negates corresponding evaluation grades.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">critg</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                <span class="n">valg</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">valg</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">valg</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="c1">#print(g,x,valg[x])</span>
                        <span class="n">valg</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">valg</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.computePerformanceDifferences">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computePerformanceDifferences">[docs]</a>
    <span class="k">def</span> <span class="nf">computePerformanceDifferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">Debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">NotPermanentDiffs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">WithMaxMin</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds to the criteria dictionary the ordered list of all observed performance differences.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute performance differences on each criterion&#39;</span><span class="p">)</span>
        <span class="c1">#criteriaList = [x for x in self.criteria]</span>
        <span class="c1">#criteriaList.sort()</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">NotPermanentDiffs</span><span class="p">:</span>
            <span class="n">performanceDifferences</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ed</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">md</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="c1">#diff = set()</span>
            <span class="n">diffList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">xi</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">xi</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">xj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
                        <span class="k">if</span> <span class="n">xj</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                            <span class="n">delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">ed</span><span class="p">:</span>
                                <span class="n">ed</span> <span class="o">=</span> <span class="n">delta</span>
                            <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">md</span><span class="p">:</span>
                                <span class="n">md</span> <span class="o">=</span> <span class="n">delta</span>
                            <span class="c1">#diff.add(delta)</span>
                            <span class="n">diffList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt; i,j, evaluation[actionsList[i]],evaluation[actionsList[j]], delta, ed,md&#39;</span><span class="p">,</span>\
             <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span>\
             <span class="n">delta</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span><span class="n">md</span><span class="p">,</span><span class="n">diffList</span><span class="p">)</span>
            <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimalPerformanceDifference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ed</span>
            <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximalPerformanceDifference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">md</span>
            <span class="c1">#diffList = list(diff)</span>
            <span class="n">diffList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">NotPermanentDiffs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">WithMaxMin</span><span class="p">:</span>
                    <span class="n">performanceDifferences</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">diffList</span><span class="p">,</span><span class="n">ed</span><span class="p">,</span><span class="n">md</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">performanceDifferences</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">diffList</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;performanceDifferences&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diffList</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; --&gt;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span>
                          <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimalPerformanceDifference&#39;</span><span class="p">],</span>\
                          <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximalPerformanceDifference&#39;</span><span class="p">])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;performanceDifferences&#39;</span><span class="p">]),</span>
                          <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;performanceDifferences&#39;</span><span class="p">])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;performanceDifferences&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                          <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;performanceDifferences&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">NotPermanentDiffs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">performanceDifferences</span></div>

        
<span class="c1">##    def mpComputePerformanceDifferences(self,NotPermanentDiffs=True,nbrCores=None,Debug=False):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Adds to the criteria dictionary the ordered list of all observed performance differences.</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        criteria = self.criteria</span>
<span class="c1">##        #from multiprocessing import Pool</span>
<span class="c1">##        #from os import cpu_count</span>
<span class="c1">##        import multiprocessing as mp</span>
<span class="c1">##        mpctx = mp.get_context(&#39;fork&#39;)</span>
<span class="c1">##        Pool = mpctx.Pool</span>
<span class="c1">##        cpu_count = mpctx.cpu_count</span>
<span class="c1">##</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(&#39;Compute performance differences on each criterion in parallel&#39;)</span>
<span class="c1">##       </span>
<span class="c1">##        criteriaList = [x for x in self.criteria]</span>
<span class="c1">##        #criteriaList.sort()</span>
<span class="c1">##</span>
<span class="c1">##        with Pool(nbrCores) as proc:</span>
<span class="c1">##            performanceDifferences = proc.map(self.computeCriterionPerformanceDifferences,criteriaList)</span>
<span class="c1">##        </span>
<span class="c1">##        #for i in range(len(criteriaList)):</span>
<span class="c1">##        #    c = criteriaList[i]</span>
<span class="c1">##        for c in criteria.keys():</span>
<span class="c1">##            if not NotPermanentDiffs:</span>
<span class="c1">##                criteria[c][&#39;performanceDifferences&#39;] = performanceDifferences[i][0]</span>
<span class="c1">##            criteria[c][&#39;minimalPerformanceDifference&#39;] = performanceDifferences[i][1]</span>
<span class="c1">##            criteria[c][&#39;maximalPerformanceDifference&#39;] = performanceDifferences[i][2]</span>
<span class="c1">##</span>
<span class="c1">##        return performanceDifferences</span>


<div class="viewcode-block" id="PerformanceTableau.computeCriterionPerformanceDifferences">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeCriterionPerformanceDifferences">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCriterionPerformanceDifferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">c</span><span class="p">,</span> <span class="n">Comments</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">Debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the ordered list of all observed performance differences on the given criterion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute performance differences on criterion </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">ed</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span> <span class="o">-</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="c1">#diff = set()</span>
        <span class="n">diffList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">xi</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">xj</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
                    <span class="k">if</span> <span class="n">xj</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="n">delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">ed</span><span class="p">:</span>
                            <span class="n">ed</span> <span class="o">=</span> <span class="n">delta</span>
                        <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">md</span><span class="p">:</span>
                            <span class="n">md</span> <span class="o">=</span> <span class="n">delta</span>
                        <span class="c1">#diff.add(delta)</span>
                        <span class="n">diffList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt; i,j, evaluation[actionsList[i]],evaluation[actionsList[j]], delta, ed,md&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                                  <span class="n">evaluation</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span>
                                  <span class="n">delta</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span><span class="n">md</span><span class="p">,</span><span class="n">diffList</span><span class="p">)</span>
        <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimalPerformanceDifference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ed</span>
        <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximalPerformanceDifference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">md</span>
        <span class="c1">#diffList = list(diff)</span>
        <span class="n">diffList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; --&gt;&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span>
                  <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimalPerformanceDifference&#39;</span><span class="p">],</span>
                  <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximalPerformanceDifference&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diffList</span><span class="p">),</span><span class="n">diffList</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">diffList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diffList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">diffList</span><span class="p">,</span><span class="n">ed</span><span class="p">,</span><span class="n">md</span><span class="p">)</span></div>

            
<div class="viewcode-block" id="PerformanceTableau.computeActionCriterionPerformanceDifferences">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeActionCriterionPerformanceDifferences">[docs]</a>
    <span class="k">def</span> <span class="nf">computeActionCriterionPerformanceDifferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">refAction</span><span class="p">,</span><span class="n">refCriterion</span><span class="p">,</span><span class="n">comments</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">Debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        computes the performances differences observed between the reference action and the others on the given criterion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">comments</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Compute performance differences for action </span><span class="si">%s</span><span class="s1"> on criterion </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">refAction</span><span class="p">,</span> <span class="n">refCriterion</span><span class="p">))</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">refAction</span><span class="p">:</span>
                <span class="n">xr</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">refCriterion</span><span class="p">][</span><span class="n">refAction</span><span class="p">]</span>
                <span class="n">xo</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">refCriterion</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">xr</span> <span class="o">!=</span> <span class="n">NA</span> <span class="ow">and</span> <span class="n">xo</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">refCriterion</span><span class="p">][</span><span class="n">refAction</span><span class="p">]</span> <span class="o">-</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">refCriterion</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                    <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt; refAction, x, evaluation[refAction], evaluation[x], delta,diff&#39;</span><span class="p">,</span> <span class="n">refAction</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">refCriterion</span><span class="p">][</span><span class="n">refAction</span><span class="p">],</span>
                              <span class="n">evaluation</span><span class="p">[</span><span class="n">refCriterion</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> <span class="n">delta</span><span class="p">,</span><span class="n">diff</span><span class="p">)</span>

        <span class="n">diff</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">diff</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeActionCriterionQuantile">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeActionCriterionQuantile">[docs]</a>
    <span class="k">def</span> <span class="nf">computeActionCriterionQuantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">criterion</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the quantile of the performance of action on criterion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">perfsy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span><span class="n">criterion</span><span class="p">)</span>
        <span class="n">perfx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="n">action</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">perfx</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>\
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">perfx</span>
                <span class="c1">## indx = self.criteria[criterion][&#39;thresholds&#39;][&#39;ind&#39;][0] + self.criteria[criterion][&#39;thresholds&#39;][&#39;pref&#39;][1]*perfx</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            <span class="n">validperfsy</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">perfsy</span>\
                           <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">perfsy</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">)]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">validperfsy</span><span class="p">)</span>
            <span class="n">qhigh</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">validperfsy</span> <span class="k">if</span> <span class="p">(</span><span class="n">perfsy</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">perfx</span><span class="p">)]</span>
            <span class="n">nqhigh</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qhigh</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                <span class="n">qlow</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">validperfsy</span> <span class="k">if</span> <span class="p">(</span><span class="n">perfsy</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">perfx</span><span class="p">)]</span>
                <span class="n">nqlow</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">qlow</span><span class="p">)</span>
                <span class="n">quantile</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nqlow</span> <span class="o">+</span> <span class="n">nqhigh</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quantile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nqhigh</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">quantile</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;NA&#39;</span></div>


    <span class="k">def</span> <span class="nf">_computeLimitingQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">frequencies</span><span class="p">,</span><span class="n">LowerClosed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">PrefThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the list of limiting quantiles *q(p)* on criteria *g* for *p* in *frequencies* </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">gValues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g,x,evaluation[g][x]&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                <span class="n">gValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
        <span class="n">gValues</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">PrefThresholds</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>            
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gValues</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g,n,gValues&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">gValues</span><span class="p">)</span>
<span class="c1">##        if n &gt; 0:</span>
<span class="c1">##        nf = Decimal(str(n+1))</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">))</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">frequencies</span><span class="p">]</span>
        <span class="n">limitingQuantiles</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">limitingQuantiles</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="c1"># computing the quantiles on criterion g</span>
        <span class="n">gQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="c1"># we ignorethe 1.00 quantile and replace it with +infty</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">limitingQuantiles</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r,rq&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rq</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]</span>\
                        <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rq</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">rq</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">PrefThresholds</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">+</span> <span class="n">quantile</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="c1">#quantile = Decimal(&#39;100.0&#39;)</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#quantile = Decimal(&#39;200.0&#39;)</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span><span class="n">quantile</span><span class="p">)</span>
                <span class="n">gQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantile</span><span class="p">)</span>               

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># upper closed categories</span>
            <span class="c1"># we ignore the quantile 0.0 and replace it with -\infty            </span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">limitingQuantiles</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r,rq&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rq</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="c1">#quantile = Decimal(&#39;-200.0&#39;)</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#quantile = Decimal(&#39;-100.0&#39;)</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">gValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">rq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]</span>\
                        <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rq</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">PrefThresholds</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">-=</span> <span class="n">gPrefThrCst</span> <span class="o">-</span> <span class="n">quantile</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-200.0&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-100.0&#39;</span><span class="p">)</span>     
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span><span class="n">quantile</span><span class="p">)</span>
                <span class="n">gQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantile</span><span class="p">)</span>
<span class="c1">##        else:</span>
<span class="c1">##            gQuantiles = []</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">LowerClosed</span><span class="p">,</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">],</span><span class="n">gQuantiles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gQuantiles</span>

<div class="viewcode-block" id="PerformanceTableau.computeQuantiles">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeQuantiles">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders a quantiles matrix action x criterion with the performance quantile of action on criterion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#actionsList = [x for x in self.actions]</span>
        <span class="c1">#criteriaList = list(self.criteria.keys())</span>
<span class="c1">##        </span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(actionsList,criteriaList)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">quantiles</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
            <span class="n">quantiles</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionQuantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantiles</span> <span class="o">=</span> <span class="n">quantiles</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">quantiles</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeActionQuantile">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeActionQuantile">[docs]</a>
    <span class="k">def</span> <span class="nf">computeActionQuantile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the overall performance quantile of action</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#criteriaList = [x for x in self.criteria]</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">criteriaQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
            <span class="n">agq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionQuantile</span><span class="p">(</span><span class="n">action</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">agq</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                <span class="n">sumWeights</span> <span class="o">+=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="n">criteriaQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">agq</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])))</span>
        <span class="n">criteriaQuantiles</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">currentQuantile</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">currentWeight</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">minQuantile</span> <span class="o">=</span> <span class="n">criteriaQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">minWeight</span> <span class="o">=</span> <span class="n">criteriaQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">majority</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sumWeights</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">majority</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">currentWeight</span><span class="p">,</span><span class="n">minWeight</span><span class="p">,</span> <span class="n">currentQuantile</span><span class="p">,</span> <span class="n">minQuantile</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">minWeight</span> <span class="o">&lt;</span> <span class="n">majority</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">currentQuantile</span> <span class="o">=</span> <span class="n">minQuantile</span>
            <span class="n">currentWeight</span> <span class="o">=</span> <span class="n">minWeight</span>
            <span class="n">minQuantile</span> <span class="o">=</span> <span class="n">criteriaQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
            <span class="n">minWeight</span> <span class="o">+=</span> <span class="n">criteriaQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">currentWeight</span><span class="p">,</span><span class="n">minWeight</span><span class="p">,</span> <span class="n">currentQuantile</span><span class="p">,</span> <span class="n">minQuantile</span><span class="p">)</span>
        <span class="n">actionQuantile</span> <span class="o">=</span> <span class="n">currentQuantile</span> <span class="o">+</span> <span class="p">(</span><span class="n">majority</span><span class="o">-</span><span class="n">currentWeight</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">minWeight</span><span class="o">-</span><span class="n">currentWeight</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">minQuantile</span><span class="o">-</span><span class="n">currentQuantile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile for </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">action</span><span class="p">,</span><span class="n">actionQuantile</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">actionQuantile</span></div>


            
<div class="viewcode-block" id="PerformanceTableau.csvAllQuantiles">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.csvAllQuantiles">[docs]</a>
    <span class="k">def</span> <span class="nf">csvAllQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;quantiles&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save quantiles matrix criterionxaction in CSV format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="c1">##        criteriaList = [x for x in self.criteria]</span>
<span class="c1">##        criteriaList.sort()</span>
<span class="c1">##        actionsList = [x for x in self.actions]</span>
<span class="c1">##        actionsList.sort()</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# saved quantiles matrix from performance tableau </span><span class="si">%s</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;quantiles&quot;,&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
            <span class="c1">#x = actionsList[i]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">weights  | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="n">g</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
                <span class="n">qval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionQuantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">qval</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="n">qval</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA,&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">qval</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">qval</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<div class="viewcode-block" id="PerformanceTableau.showAllQuantiles">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showAllQuantiles">[docs]</a>
    <span class="k">def</span> <span class="nf">showAllQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        prints the performance quantiles tableau in the session console.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeAllQuantiles</span><span class="p">(</span><span class="n">Sorted</span><span class="o">=</span><span class="n">Sorted</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceTableau.showHTMLPerformanceQuantiles">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showHTMLPerformanceQuantiles">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLPerformanceQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the performance quantiles tableau in a browser window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeAllQuantiles</span><span class="p">(</span><span class="n">Sorted</span><span class="o">=</span><span class="n">Sorted</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.computeAllQuantiles">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeAllQuantiles">[docs]</a>
    <span class="k">def</span> <span class="nf">computeAllQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders a html string showing the table of</span>
<span class="sd">        the quantiles matrix action x criterion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criteria | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criteria&lt;/th&gt;&#39;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">weights  | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr style=&quot;text-align: center;&quot; bgcolor=&quot;#FFF79B&quot;&gt;&lt;td&gt;weights&lt;/td&gt;&#39;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td &gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;   | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th  bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">qval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionQuantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">qval</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">qval</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qval</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NA</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;NA&lt;/td&gt;&#39;</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                                          
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">html</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeQuantileOrder">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeQuantileOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantileOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">q0</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">q1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a linear ordering of the decision actions from a simulation of pre-ranked outranking digraphs.</span>

<span class="sd">        The pre-ranking simulations range by default from</span>
<span class="sd">        quantiles=q0 to quantiles=min( 100, max(10,len(self.actions)/10]) ).</span>

<span class="sd">        The actions are ordered along a decreasing Borda score of their ranking results.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sparseOutrankingDigraphs</span> <span class="kn">import</span> <span class="n">PreRankedOutrankingDigraph</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">kBestFrequency</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">x</span><span class="p">,[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">])</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">q1</span> <span class="o">&lt;=</span> <span class="n">q0</span><span class="p">:</span>
            <span class="n">q1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">n</span><span class="o">//</span><span class="mi">10</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">):</span>
            <span class="n">pr</span> <span class="o">=</span> <span class="n">PreRankedOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">quantiles</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                    <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span><span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">rbest</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">boostedOrder</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                <span class="n">kBestFrequency</span><span class="p">[</span><span class="n">rbest</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">stats</span> <span class="o">=</span> <span class="n">kBestFrequency</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">stats</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">Stats</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">kBestFrequency</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">n</span><span class="p">],</span><span class="n">kBestFrequency</span><span class="p">[</span><span class="n">x</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">bestStatistics</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Stats</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">quantileOrder</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bestStatistics</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">bestStatistics</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">quantileOrder</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">quantileOrder</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeQuantileRanking">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeQuantileRanking">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantileRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">q0</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">q1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a linear ranking of the decision actions from a simulation of pre-ranked outranking digraphs.</span>

<span class="sd">        The pre-ranking simulations range by default from</span>
<span class="sd">        quantiles=q0 to qantiles=min( 100, max(10,len(self.actions)/10) ).</span>

<span class="sd">        The actions are ordered along an increasing Borda score of their ranking results.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileOrder</span><span class="p">(</span><span class="n">q0</span><span class="o">=</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="o">=</span><span class="n">q1</span><span class="p">,</span>
                         <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                            <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                         <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="n">ranking</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ranking</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.computeQuantileSort">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeQuantileSort">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantileSort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows a sorting of the actions from decreasing majority quantiles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantiles</span><span class="p">()</span>
        <span class="n">actionsSorting</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">actionsSorting</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">quantiles</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">x</span><span class="p">))</span>
        <span class="n">actionsSorting</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">actionsSorting</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeQuantilePreorder">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeQuantilePreorder">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantilePreorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        computes the preorder of the actions obtained from decreasing majority quantiles. The quantiles are recomputed with a call to the self.computeQuantileSort() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">quantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileSort</span><span class="p">()</span>
        <span class="n">quantiles</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span>
        <span class="n">actionsPreorder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">currLevel</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">currEquivalenceClass</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">currLevel</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">currLevel</span><span class="p">:</span>
                <span class="n">currEquivalenceClass</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">currEquivalenceClass</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">currEquivalenceClass</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">actionsPreorder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currEquivalenceClass</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">actionsPreorder</span><span class="p">)</span>
                <span class="n">currEquivalenceClass</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">currLevel</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">currEquivalenceClass</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">actionsPreorder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currEquivalenceClass</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">actionsPreorder</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">actionsPreorder</span></div>


<div class="viewcode-block" id="PerformanceTableau.showQuantileSort">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showQuantileSort">[docs]</a>
    <span class="k">def</span> <span class="nf">showQuantileSort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper of computeQuantilePreorder() for the obsolete showQuantileSort() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantilePreorder</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

 
<div class="viewcode-block" id="PerformanceTableau.computeDefaultDiscriminationThresholds">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeDefaultDiscriminationThresholds">[docs]</a>
    <span class="k">def</span> <span class="nf">computeDefaultDiscriminationThresholds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                               <span class="n">quantile</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ind&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;pref&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span><span class="s1">&#39;veto&#39;</span><span class="p">:</span><span class="mi">80</span><span class="p">},</span>
                                               <span class="n">Debug</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                               <span class="n">Comments</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        updates the discrimination thresholds with the percentiles</span>
<span class="sd">        from the performance differences.</span>
<span class="sd">        Parameters: quantile = {&#39;ind&#39;: 10, &#39;pref&#39;: 20, &#39;weakVeto&#39;: 60, &#39;veto: 80}.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">math</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span> <span class="o">=</span> <span class="kc">True</span>
            
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Installs default discrimination thresholds on each criterion&#39;</span><span class="p">)</span>

<span class="c1">#        performanceDifferences = self.computePerformanceDifferences(Debug=Debug,Comments=Comments)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">if</span> <span class="n">criteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">)]</span>
            <span class="c1">#criteriaList.sort()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">performanceDifferences</span><span class="p">,</span><span class="n">minDiff</span><span class="p">,</span><span class="n">maxDiff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCriterionPerformanceDifferences</span><span class="p">(</span><span class="n">c</span><span class="p">,</span>
                                                            <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="c1">#vx = self.criteria[c][&#39;performanceDifferences&#39;]</span>
            <span class="n">vx</span> <span class="o">=</span> <span class="n">performanceDifferences</span>
            <span class="n">nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=====&gt;&#39;</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">vx</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">quantile</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">quantile</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">quantile</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">quantile</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">threshold</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">vx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">quantile</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                        <span class="n">threshold</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">vx</span><span class="p">[</span><span class="n">nv</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">kq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">quantile</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">nv</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">100.0</span><span class="p">))</span>
                        <span class="n">r</span> <span class="o">=</span> <span class="p">((</span><span class="n">nv</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">quantile</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">%</span> <span class="mi">100</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">kq</span><span class="p">,</span><span class="n">r</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

                        <span class="c1">## if kq == nv-1:</span>
                        <span class="c1">##     kqplus = nv-1</span>
                        <span class="c1">## else:</span>
                        <span class="c1">##     kq_1 = kq - 1</span>
                        <span class="n">threshold</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">vx</span><span class="p">[</span><span class="n">kq</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">))</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">vx</span><span class="p">[</span><span class="n">kq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">vx</span><span class="p">[</span><span class="n">kq</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">threshold</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

            
            <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">threshold</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="s1">&#39; default thresholds:&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span></div>



<div class="viewcode-block" id="PerformanceTableau.computeThresholdPercentile">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeThresholdPercentile">[docs]</a>
    <span class="k">def</span> <span class="nf">computeThresholdPercentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criterion</span><span class="p">,</span><span class="n">threshold</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        computes for a given criterion the quantile</span>
<span class="sd">        of the performance differences of a given constant threshold.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">performanceDifferences</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="s1">&#39;performanceDifferences&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1">#self.computePerformanceDifferences(Debug=Debug)</span>
            <span class="c1">#performanceDifferences = self.criteria[criterion][&#39;performanceDifferences&#39;]</span>
            <span class="n">performanceDifferences</span><span class="p">,</span><span class="n">minDiff</span><span class="p">,</span><span class="n">maxDiff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCriterionPerformanceDifferences</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;performanceDifferences = &quot;</span><span class="p">,</span><span class="n">performanceDifferences</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">quantile</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">threshold</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>     
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span> <span class="n">quantile</span><span class="p">)</span>
        <span class="n">nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">performanceDifferences</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nv</span> <span class="ow">and</span> <span class="n">performanceDifferences</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">quantile</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">quantile</span><span class="p">,</span> <span class="n">performanceDifferences</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">percentile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;nv = &#39;</span><span class="p">,</span> <span class="n">nv</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;percentile =&#39;</span><span class="p">,</span> <span class="n">percentile</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">percentile</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeVariableThresholdPercentile">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeVariableThresholdPercentile">[docs]</a>
    <span class="k">def</span> <span class="nf">computeVariableThresholdPercentile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criterion</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        computes for a given criterion the quantile</span>
<span class="sd">        of the performance differences of a given threshold.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">th</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">threshold</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<span class="c1">##        actionsList = [x for x in self.actions]</span>
<span class="c1">##        actionsList.sort()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">):</span>
            <span class="n">performanceDifferences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionPerformanceDifferences</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">criterion</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;performanceDifferences:&#39;</span><span class="p">,</span> <span class="n">performanceDifferences</span><span class="p">)</span>
            <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">performanceDifferences</span><span class="p">)</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">na</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">th</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="n">a</span><span class="p">])</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">th</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a,na,self.evaluation[criterion][a],th[0],th[1],quantile&#39;</span><span class="p">,</span>
                      <span class="n">a</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">evaluation</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="n">a</span><span class="p">],</span><span class="n">th</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">th</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">quantile</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">na</span> <span class="ow">and</span> <span class="n">performanceDifferences</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">quantile</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i, quantile, performanceDifferences[i]&#39;</span><span class="p">,</span>
                          <span class="n">i</span><span class="p">,</span> <span class="n">quantile</span><span class="p">,</span> <span class="n">performanceDifferences</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a,na,final i&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">na</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="n">percentile</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;count = &#39;</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="s1">&#39;total = &#39;</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;percentile =&#39;</span><span class="p">,</span> <span class="n">percentile</span><span class="p">)</span>   
        <span class="k">return</span> <span class="n">percentile</span></div>


<div class="viewcode-block" id="PerformanceTableau.showPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showPerformanceTableau">[docs]</a>
    <span class="k">def</span> <span class="nf">showPerformanceTableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the performance Tableau.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----  performance tableau -----*&#39;</span><span class="p">)</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
                <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">actionsSubset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toIndex</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="c1"># view criteria x actions</span>
        <span class="k">if</span> <span class="n">Transposed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criteria | weights |&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">  &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">---------|-----------------------------------------&#39;</span><span class="p">)</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f &#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">  |   &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>\
                            <span class="o">+</span> <span class="s1">&#39;   | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">evalgx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">evalgx</span> <span class="o">==</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; NA &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>                    
                        <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evalgx</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>
        <span class="c1"># view actions x criteria</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Criteria | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">  &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Actions  | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1">   &#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>          
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">---------|-----------------------------------------&#39;</span><span class="p">)</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f &#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">   |&#39;</span> <span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">   |&#39;</span> <span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>        
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                    <span class="n">evalgx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">evalgx</span> <span class="o">==</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  NA  &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>                    
                        <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evalgx</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span></div>

            

<div class="viewcode-block" id="PerformanceTableau.saveCSV">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.saveCSV">[docs]</a>
    <span class="k">def</span> <span class="nf">saveCSV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempPerfTab&#39;</span><span class="p">,</span>
                <span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;1</span>
<span class="sd">        Store the performance Tableau self Actions x Criteria in CSV format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">IT</span>
        <span class="kn">import</span> <span class="nn">collections</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span>        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*Storing performance tableau in CSV format in file </span><span class="si">%s</span><span class="s1">&#39;</span>\
              <span class="o">%</span> <span class="n">fileNameExt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">criteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">sorted</span><span class="p">:</span>
                <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">ng</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteriaList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">criteriaList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">sorted</span><span class="p">:</span>
                <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">formatStr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">.%.df&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;formatString:&#39;</span><span class="p">,</span><span class="n">formatStr</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1">## header row</span>
        <span class="n">writeStr</span> <span class="o">=</span> <span class="s1">&#39;&quot;criteria&quot;,&quot;name&quot;,&quot;weight&quot;,&quot;scale&quot;,&quot;prefDir&quot;,&quot;thresholds&quot;,&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">na</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">writeStr</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writeStr</span><span class="p">)</span>
        <span class="c1">## writing performance data</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">writeStr</span> <span class="o">=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="n">g</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">])</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">])</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">writeStr</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span>
            <span class="n">writeStr</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">na</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">writeStr</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">writeStr</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.computeMissingDataProportion">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeMissingDataProportion">[docs]</a>
    <span class="k">def</span> <span class="nf">computeMissingDataProportion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">InPercents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the proportion of missing data, </span>
<span class="sd">        i.e. NA == Decimal(&#39;-999&#39;) entries in self.evaluation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">naCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">entryCount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>

        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">entryCount</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">naCount</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">naCount</span><span class="o">/</span><span class="n">entryCount</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Empty performance tableau !!!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">InPercents</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">*=</span> <span class="mf">100.0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Missing data proportion: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">res</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span></div>

   
<div class="viewcode-block" id="PerformanceTableau.computeMinMaxEvaluations">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeMinMaxEvaluations">[docs]</a>
    <span class="k">def</span> <span class="nf">computeMinMaxEvaluations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders minimum and maximum performances on each criterion</span>
<span class="sd">        in dictionary form: {&#39;g&#39;: {&#39;minimum&#39;: x, &#39;maximum&#39;: x}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">if</span> <span class="n">criteria</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
            <span class="n">criteriaKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaKeys</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="k">if</span> <span class="n">actions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">actions</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">evaluations</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evaluations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluations</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">evaluations</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>
                <span class="n">result</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="PerformanceTableau.showHTMLCriteria">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showHTMLCriteria">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteriaSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the criteria in the system browser view.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_htmlCriteriaView</span><span class="p">(</span><span class="n">criteria</span><span class="o">=</span><span class="n">criteriaSubset</span><span class="p">,</span>
                                        <span class="n">Sorted</span><span class="o">=</span><span class="n">Sorted</span><span class="p">,</span>
                                        <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span>
                                        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_htmlCriteriaView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Family of Criteria&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a html view of the in the XMCDA2 format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">: Family of Criteria&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="n">title</span>            
        <span class="k">if</span> <span class="n">criteria</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        
        <span class="n">html</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;&lt;table border=&quot;1&quot;&gt;</span>
<span class="s2">        &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="s2">        &lt;th rowspan=&quot;2&quot;&gt;#&lt;/th&gt;</span>
<span class="s2">        &lt;th rowspan=&quot;2&quot;&gt;Identifyer&lt;/th&gt;</span>
<span class="s2">        &lt;th rowspan=&quot;2&quot;&gt;Name&lt;/th&gt;</span>
<span class="s2">        &lt;th rowspan=&quot;2&quot;&gt;Comment&lt;/th&gt;</span>
<span class="s2">        &lt;th rowspan=&quot;2&quot;&gt;Weight&lt;/th&gt;</span>
<span class="s2">        &lt;th colspan=&quot;3&quot;&gt;Scale&lt;/th&gt;</span>
<span class="s2">        &lt;th colspan=&quot;5&quot;&gt;Thresholds (ax + b)&lt;/th&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">        &lt;tr bgcolor=&quot;#9acd32&quot;&gt;</span>
<span class="s2">        &lt;th&gt;direction&lt;/th&gt;</span>
<span class="s2">        &lt;th&gt;min&lt;/th&gt;</span>
<span class="s2">        &lt;th&gt;max&lt;/th&gt;</span>
<span class="s2">        &lt;th&gt;indifference&lt;/th&gt;</span>
<span class="s2">        &lt;th&gt;preference&lt;/th&gt;</span>
<span class="s2">        &lt;th&gt;veto&lt;/th&gt;</span>
<span class="s2">        &lt;/tr&gt;&quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">critg</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="c1">#print(g,critg)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">i</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">g</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;No comment&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">fx + </span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ndigits</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span>\
                                <span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>                
            <span class="k">except</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt;&#39;</span>
                
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span>\
                                <span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>                
            <span class="k">except</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt;&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span>\
                                <span class="p">(</span><span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                 <span class="n">critg</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>                
            <span class="k">except</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;/td&gt;&#39;</span>

            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
        <span class="k">return</span> <span class="n">html</span>
        
        
<div class="viewcode-block" id="PerformanceTableau.showHTMLPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showHTMLPerformanceTableau">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLPerformanceTableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">isSorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">ContentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the html version of the performance tableau in a browser window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_htmlPerformanceTableau</span><span class="p">(</span><span class="n">actions</span><span class="o">=</span><span class="n">actionsSubset</span><span class="p">,</span>
                                             <span class="n">fromIndex</span><span class="o">=</span><span class="n">fromIndex</span><span class="p">,</span>
                                             <span class="n">toIndex</span><span class="o">=</span><span class="n">toIndex</span><span class="p">,</span>
                                             <span class="n">isSorted</span><span class="o">=</span><span class="n">isSorted</span><span class="p">,</span>
                                             <span class="n">Transposed</span><span class="o">=</span><span class="n">Transposed</span><span class="p">,</span>
                                             <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span>
                                             <span class="n">ContentCentered</span><span class="o">=</span><span class="n">ContentCentered</span><span class="p">,</span>
                                             <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

            
    <span class="k">def</span> <span class="nf">_htmlPerformanceTableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">isSorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">ContentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the performance tableau citerion x actions in html format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">minMaxEvaluations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeMinMaxEvaluations</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;Performance table </span><span class="si">%s</span><span class="s1">&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="n">title</span>            
        <span class="n">criteriaKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">isSorted</span><span class="p">:</span>
            <span class="n">criteriaKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">actions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">isSorted</span><span class="p">:</span>
            <span class="n">actionsKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="k">if</span> <span class="n">ContentCentered</span><span class="p">:</span>
            <span class="n">alignFormat</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alignFormat</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
        <span class="k">if</span> <span class="n">Transposed</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criterion&lt;/th&gt;&#39;</span>
            <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsKeys</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionsKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xName</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gName</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]:</span>
                            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]:</span>
                            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]:</span>
                            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;&lt;span style=&quot;color: LightGrey;font-size:75%; &quot;&gt;NA&lt;/span&gt;&lt;/td&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;criteria&lt;/th&gt;&#39;</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gName</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;weight&lt;/th&gt;&#39;</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
                <span class="n">gWeight</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gWeight</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsKeys</span><span class="p">)</span>
            <span class="c1">#for x in actionsKeys:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionsKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xName</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot;  align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffddff&quot; align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;&lt;span style=&quot;color: LightGrey;font-size:75%;&quot;&gt;NA&lt;/span&gt;&lt;/td&gt;&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minMaxEvaluations</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">alignFormat</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
                                <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;&lt;span style=&quot;color: LightGrey;font-size:75%;&quot;&gt;NA&lt;/span&gt;&lt;/td&gt;&#39;</span>
                        
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            
        <span class="k">return</span> <span class="n">html</span>

<div class="viewcode-block" id="PerformanceTableau.showHTMLPerformanceHeatmap">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showHTMLPerformanceHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">WithActionNames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">colorLevels</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                                   <span class="n">pageTitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">SparseModel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">outrankingModel</span> <span class="o">=</span> <span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                                   <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                   <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span>
                                   <span class="n">StoreRanking</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                   <span class="n">Correlations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the html heatmap version of the performance tableau in a browser window</span>
<span class="sd">        (see perfTabs.htmlPerformanceHeatMap() method ).</span>

<span class="sd">        **Parameters**:</span>
<span class="sd">        </span>
<span class="sd">        * *actionsList* and *criteriaList*, if provided,  give the possibility to show</span>
<span class="sd">          the decision alternatives, resp. criteria, in a given ordering.</span>
<span class="sd">        * *WithActionNames* = True (default False) will show the action names instead of the short names or the identifyers.</span>
<span class="sd">        * *ndigits* = 0 may be used to show integer evaluation values.</span>
<span class="sd">        * *colorLevels* may be 3, 5, 7, or 9. </span>
<span class="sd">        * When no *actionsList* is provided, the decision actions are ordered from the best to the worst. This</span>
<span class="sd">          ranking is obtained by default with the Copeland rule applied on a standard *BipolarOutrankingDigraph*.</span>
<span class="sd">        * When the *SparseModel* flag is put to *True*, a sparse *PreRankedOutrankingDigraph* construction is used instead.</span>
<span class="sd">        * the *outrankingModel* parameter (default = &#39;standard&#39;) allows to switch to alternative BipolarOutrankingDigraph constructors, like &#39;confident&#39; or &#39;robust&#39; models. When called from a bipolar-valued outrankingDigraph instance, *outrankingModel* = &#39;this&#39; keeps the current outranking model without recomputing by default the standard outranking model.            </span>
<span class="sd">        * The *minimalComponentSize* allows to control the fill rate of the pre-ranked model.</span>
<span class="sd">          When *minimalComponentSize* = *n* (the number of decision actions) both the pre-ranked model will be</span>
<span class="sd">          in fact equivalent to the standard model.</span>
<span class="sd">        * *rankingRule* = &#39;NetFlows&#39; (default) | &#39;Copeland&#39; | &#39;Kohler&#39; | &#39;RankedPairs&#39; | &#39;ArrowRaymond&#39;</span>
<span class="sd">          | &#39;IteratedNetFlows&#39; | &#39;IteraredCopeland&#39;. See tutorial on ranking mith multiple incommensurable criteria.</span>
<span class="sd">        * when the *StoreRanking* flag is set to *True*, the ranking result is storted in *self*.</span>
<span class="sd">        * Quantiles used for the pre-ranked decomposition are put by default to *n*</span>
<span class="sd">          (the number of decision alternatives) for *n* &lt; 50. For larger cardinalities up to 1000, quantiles = *n* /10.</span>
<span class="sd">          For bigger performance tableaux the *quantiles* parameter may be set to a much lower value</span>
<span class="sd">          not exceeding usually 10.</span>
<span class="sd">        * The pre-ranking may be obtained with three ordering strategies for the</span>
<span class="sd">          quantiles equivalence classes: &#39;average&#39; (default), &#39;optimistic&#39; or  &#39;pessimistic&#39;.</span>
<span class="sd">        * With *Correlations* = *True* and *criteriaList* = *None*, the criteria will be presented from left to right in decreasing</span>
<span class="sd">          order of the correlations between the marginal criterion based ranking and the global ranking used for</span>
<span class="sd">          presenting the decision alternatives.</span>
<span class="sd">        * For large performance Tableaux, *multiprocessing* techniques may be used by setting</span>
<span class="sd">          *Threading* = *True* in order to speed up the computations; especially when *Correlations* = *True*.</span>
<span class="sd">        * By default, the number of cores available, will be detected. It may be necessary in a HPC context to indicate the exact number of singled threaded cores in fact allocated to the multiprocessing job.</span>


<span class="sd">        &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceTableau</span>
<span class="sd">        &gt;&gt;&gt; rt = RandomPerformanceTableau(seed=100)</span>
<span class="sd">        &gt;&gt;&gt; rt.showHTMLPerformanceHeatmap(colorLevels=5,Correlations=True)</span>

<span class="sd">        .. image:: perfTabsExample.png</span>
<span class="sd">           :alt: HTML heat map of the performance tableau</span>
<span class="sd">           :width: 600 px</span>
<span class="sd">           :align: center</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pageTitle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pageTitle</span> <span class="o">=</span> <span class="s1">&#39;Heatmap of Performance Tableau </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_htmlPerformanceHeatmap</span><span class="p">(</span><span class="n">argCriteriaList</span><span class="o">=</span><span class="n">criteriaList</span><span class="p">,</span>
                                             <span class="n">argActionsList</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                                            <span class="n">WithActionNames</span><span class="o">=</span><span class="n">WithActionNames</span><span class="p">,</span>
                                             <span class="n">fromIndex</span><span class="o">=</span><span class="n">fromIndex</span><span class="p">,</span>
                                             <span class="n">Transposed</span><span class="o">=</span><span class="n">Transposed</span><span class="p">,</span>
                                             <span class="n">toIndex</span><span class="o">=</span><span class="n">toIndex</span><span class="p">,</span>
                                             <span class="n">SparseModel</span><span class="o">=</span><span class="n">SparseModel</span><span class="p">,</span>
                                              <span class="n">outrankingModel</span><span class="o">=</span><span class="n">outrankingModel</span><span class="p">,</span>
                                             <span class="n">minimalComponentSize</span><span class="o">=</span><span class="n">minimalComponentSize</span><span class="p">,</span>
                                             <span class="n">rankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span>
                                             <span class="n">StoreRanking</span><span class="o">=</span><span class="n">StoreRanking</span><span class="p">,</span>
                                             <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span>
                                             <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
                                             <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span>
                                             <span class="n">colorLevels</span><span class="o">=</span><span class="n">colorLevels</span><span class="p">,</span>
                                             <span class="n">pageTitle</span><span class="o">=</span><span class="n">pageTitle</span><span class="p">,</span>
                                             <span class="n">Correlations</span><span class="o">=</span><span class="n">Correlations</span><span class="p">,</span>
                                             <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span> 
                                             <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                             <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_htmlPerformanceHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argCriteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">argActionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">WithActionNames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">SparseModel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">outrankingModel</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                                <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">rankingRule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">StoreRanking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">ContentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">colorLevels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">pageTitle</span><span class="o">=</span><span class="s1">&#39;Performance Heatmap&#39;</span><span class="p">,</span>
                                <span class="n">Correlations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;       </span>
<span class="sd">        Renders the Brewer RdYlGn 3, 5, 7, or 9 levels colored heatmap of the performance table</span>
<span class="sd">        actions x criteria in html format.</span>

<span class="sd">        See the corresponding perfTabs.showHTMLPerformanceHeatMap() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>            
        <span class="n">brewerRdYlGn9Colors</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1111&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D53E4F&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2222&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#F46D43&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.3333&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4444&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5555&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6666&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.7777&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8888&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#65BD63&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.000&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#1A9850&quot;&#39;</span><span class="p">)]</span>
        <span class="n">brewerRdYlGn7Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1429&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#F46D43&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2857&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4286&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5714&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.7143&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8571&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0000&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#65BD63&quot;&#39;</span><span class="p">)</span>
                               <span class="p">]</span>
        <span class="n">brewerRdYlGn5Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">)</span>
                               <span class="p">]</span>
        <span class="n">brewerRdYlGn3Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.3333&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6666&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">]</span>
        <span class="k">if</span> <span class="n">colorLevels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colorLevels</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">if</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn7Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn9Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn5Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn3Colors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn7Colors</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorPalette</span><span class="p">)</span>
        <span class="n">backGroundColor</span>   <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">naColor</span>           <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">columnHeaderColor</span> <span class="o">=</span> <span class="s1">&#39;&quot;#CCFFFF&quot;&#39;</span>
        <span class="n">rowHeaderColor</span>    <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>

        <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;Digraph3 performance heat map&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1">#html += &#39;table {border-collapse: collapse;}&#39;</span>
        <span class="k">if</span> <span class="n">ContentCentered</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;td {text-align: center;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;td.na {color: rgb(192,192,192);}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/style&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/head&gt;</span><span class="se">\n</span><span class="s1">&lt;body&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h2&gt;</span><span class="si">%s</span><span class="s1">&lt;/h2&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pageTitle</span>
        
        <span class="k">if</span> <span class="n">argCriteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argCriteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="n">argCriteriaList</span>

<span class="c1">##        if rankingRule is None:</span>
<span class="c1">##            rankingRule = &#39;NetFlows&#39;</span>

        <span class="k">if</span> <span class="n">argActionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># actions ranking is needed</span>
            
            <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">SparseModel</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">sparseOutrankingDigraphs</span> <span class="kn">import</span> <span class="n">PreRankedOutrankingDigraph</span>
                <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">na</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
                        <span class="n">q</span> <span class="o">=</span> <span class="mi">5</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">q</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">q</span> <span class="o">=</span> <span class="n">quantiles</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">PreRankedOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">quantiles</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                               <span class="n">minimalComponentSize</span><span class="o">=</span><span class="n">minimalComponentSize</span><span class="p">,</span>
                                           <span class="n">componentRankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                           <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">boostedRanking</span>
                <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
                
            <span class="k">else</span><span class="p">:</span> <span class="c1"># standard outranking model</span>
                <span class="k">if</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">argActionsList</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;confident&#39;</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">ConfidentBipolarOutrankingDigraph</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;robust&#39;</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">RobustOutrankingDigraph</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">RobustOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">outrankingModel</span> <span class="o">==</span> <span class="s1">&#39;this&#39;</span><span class="p">:</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span>                 
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Error: outrankingModel &quot;</span><span class="si">%s</span><span class="s1">&quot; is not implemented !!!&#39;</span> <span class="o">%</span> <span class="n">outrankingModel</span> <span class="p">)</span>
                    
                <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeNetFlowsRanking</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">netFlowsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">copelandRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Kohler&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">g</span><span class="p">))</span><span class="o">.</span><span class="n">computeKohlerRanking</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">kohlerRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;RankedPairs&#39;</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">RankedPairsOrder</span>
                    <span class="n">rp</span> <span class="o">=</span> <span class="n">RankedPairsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">computeRanking</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rankedPairsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;ArrowRaynaud&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeArrowRaynaudRanking</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">arrowRaynaudRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedNetFlows&#39;</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedNetFlowsRanking</span>
                    <span class="n">inf</span> <span class="o">=</span> <span class="n">IteratedNetFlowsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">inf</span><span class="o">.</span><span class="n">iteratedNetFlowsRanking</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">iteratedNetFlowsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedCopeland&#39;</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedCopelandRanking</span>
                    <span class="n">icop</span> <span class="o">=</span> <span class="n">IteratedCopelandRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">icop</span><span class="o">.</span><span class="n">iteratedCopelandRanking</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">iteratedCopelandRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># default ranking rule</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeNetFlowsRanking</span><span class="p">()</span>
                    <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span>
                    <span class="k">if</span> <span class="n">StoreRanking</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">netFlowsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
                <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)))</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># actions list given</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">argActionsList</span>
            <span class="n">rankingRule</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1">#Correlations = False</span>
            <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">SparseModel</span><span class="p">:</span>
                <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">argActionsList</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="n">actionsList</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="n">rankCorrelation</span><span class="p">)</span>
            
        <span class="c1">##########</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">if</span> <span class="n">criteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">marginalCorrelations</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeRankingConsensusQuality</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="n">marginalCorrelations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">meanMarginalCriteriaCorrelation</span> <span class="o">=</span> <span class="n">marginalCorrelations</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">sdMarginalCriteriaCorrelation</span> <span class="o">=</span> <span class="n">marginalCorrelations</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>             
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">criteriaWeightsList</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">]</span>
                <span class="n">criteriaWeightsList</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaWeightsList</span><span class="p">]</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">marginalCorrelations</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeRankingConsensusQuality</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="n">marginalCorrelations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">meanMarginalCriteriaCorrelation</span> <span class="o">=</span> <span class="n">marginalCorrelations</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">sdMarginalCriteriaCorrelation</span> <span class="o">=</span> <span class="n">marginalCorrelations</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>             
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">quantileColor</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">quantilexg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionQuantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">quantilexg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                            <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">&lt;=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span> <span class="c1"># negative weight and reversed quatile coloring</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                            <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">&lt;=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">break</span>        
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">naColor</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Transposed</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                 <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;criteria&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;weight&lt;/th&gt;&#39;</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;tau*&lt;/th&gt;&#39;</span>
            <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xName</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">gn</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteriaList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">gn</span><span class="p">):</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">criteriaList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gName</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cg</span> <span class="o">=</span> <span class="n">criteriaCorrelation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> align=&quot;right&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> \
                                                <span class="o">%</span> <span class="p">(</span><span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">],</span><span class="n">ndigits</span><span class="p">)</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> class=&quot;na&quot;&gt;NA&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">naColor</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># standard actions x criteria layout</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                         <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;criteria&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">gName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gName</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;weights&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> \
                            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;tau&lt;sup&gt;(*)&lt;/sup&gt;&lt;/th&gt;&#39;</span> \
                                    <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">:</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fromIndex</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">WithActionNames</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1"> align=&quot;left&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> \
                                      <span class="o">%</span> <span class="p">(</span><span class="n">rowHeaderColor</span><span class="p">,</span><span class="n">xName</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rowHeaderColor</span><span class="p">,</span><span class="n">xName</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> align=&quot;right&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> \
                                                      <span class="o">%</span> <span class="p">(</span><span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">],</span><span class="n">ndigits</span><span class="p">)</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> class=&quot;na&quot;&gt;NA&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">naColor</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># legend</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Color legend: &lt;/i&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;quantile&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&amp;nbsp;</span><span class="si">%.2f</span><span class="s1">&amp;#037;&lt;/td&gt;&#39;</span> \
                <span class="o">%</span> <span class="p">(</span><span class="n">colorPalette</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                   <span class="n">colorPalette</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">))</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;b&gt;(*) tau:&lt;/b&gt; &lt;i&gt;Ordinal (Kendall) correlation between&lt;/i&gt;&lt;br&gt;&lt;i&gt;marginal criterion and global ranking relation&lt;/i&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">rankCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Outranking model&lt;/i&gt;: &lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;, &lt;i&gt;Ranking rule&lt;/i&gt;: &lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">outrankingModel</span><span class="p">,</span><span class="n">rankingRule</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Ordinal (Kendall) correlation between&lt;/i&gt;&lt;br/&gt;&lt;i&gt;global ranking and global outranking relation:&lt;/i&gt; &lt;b&gt;</span><span class="si">%+.3f</span><span class="s1">&lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rankCorrelation</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">])</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Mean marginal correlation (a)               :&lt;/i&gt; &lt;b&gt;</span><span class="si">%+.3f</span><span class="s1">&lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">meanMarginalCriteriaCorrelation</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Standard marginal correlation deviation (b) :&lt;/i&gt; &lt;b&gt;</span><span class="si">%+.3f</span><span class="s1">&lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sdMarginalCriteriaCorrelation</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Ranking fairness (a) - (b)                  :&lt;/i&gt; &lt;b&gt;</span><span class="si">%+.3f</span><span class="s1">&lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">meanMarginalCriteriaCorrelation</span><span class="p">)</span> <span class="o">-</span> <span class="n">sdMarginalCriteriaCorrelation</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/body&gt;&lt;/html&gt;&#39;</span>
        <span class="k">return</span> <span class="n">html</span>

    <span class="k">def</span> <span class="nf">_computeRankingConsensusQuality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ranking</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the marginal criteria correlations with a given ranking with summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">marginalCorrelations</span> \
            <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span>
                                <span class="n">ranking</span><span class="p">,</span><span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
        <span class="n">ncrit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">marginalCorrelations</span><span class="p">)))</span>
        <span class="n">meanMarginalCorrelation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">varMarginalCorrelation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">moment4</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">sumWeights</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">cgw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span>
            <span class="n">meanMarginalCorrelation</span> <span class="o">+=</span> <span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">cgw</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">cgw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span>
            <span class="n">varMarginalCorrelation</span> <span class="o">+=</span> <span class="p">((</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">meanMarginalCorrelation</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cgw</span>
            <span class="n">moment4</span> <span class="o">+=</span> <span class="p">((</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">meanMarginalCorrelation</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">cgw</span>
            <span class="c1">#varMarginalCorrelation += (cg[0]**2)*cgw</span>
        <span class="c1">#meanMarginalCriteriaCorrelation /= ncrit</span>
        <span class="c1">#varMarginalCriteriaCorrelation /= ncrit</span>
        <span class="c1">#varMarginalCorrelation -= meanMarginalCorrelation*meanMarginalCriteriaCorrelation</span>
        <span class="n">sdMarginalCorrelation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">varMarginalCorrelation</span><span class="p">)</span>
        <span class="n">kurtosis</span> <span class="o">=</span> <span class="n">moment4</span> <span class="o">-</span><span class="mi">3</span>
        <span class="c1"># showing the results</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Consensus quality of ranking:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criterion (weight): correlation&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">): </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weighted mean marginal correlation (a): </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">meanMarginalCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard deviation (b)                : </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sdMarginalCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking fairness (Kurtosis a^4/b^4)   : </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kurtosis</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">marginalCorrelations</span><span class="p">,</span><span class="n">meanMarginalCorrelation</span><span class="p">,</span><span class="n">sdMarginalCorrelation</span><span class="p">)</span>



<div class="viewcode-block" id="PerformanceTableau.computeRankingConsensusQuality">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeRankingConsensusQuality">[docs]</a>
    <span class="k">def</span> <span class="nf">computeRankingConsensusQuality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ranking</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the marginal criteria correlations with a given ranking with summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">marginalCorrelations</span> \
                     <span class="o">=</span>  <span class="n">g</span><span class="o">.</span><span class="n">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span>
                                <span class="n">ranking</span><span class="p">,</span><span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
        <span class="n">ncrit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">marginalCorrelations</span><span class="p">)))</span>
        <span class="n">meanMarginalCorrelation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">varMarginalCorrelation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">sumWeights</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">cgw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span>
            <span class="n">meanMarginalCorrelation</span> <span class="o">+=</span> <span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">cgw</span>
        <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
            <span class="c1">#if cg[0] &lt; Decimal(&#39;0&#39;):</span>
            <span class="n">cgw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span>
            <span class="n">varMarginalCorrelation</span> <span class="o">+=</span> <span class="p">((</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">meanMarginalCorrelation</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cgw</span>
            <span class="c1">#varMarginalCorrelation += (cg[0]**2)*cgw</span>
        <span class="c1">#meanMarginalCriteriaCorrelation /= ncrit</span>
        <span class="c1">#varMarginalCriteriaCorrelation /= ncrit</span>
        <span class="c1">#varMarginalCorrelation -= meanMarginalCorrelation*meanMarginalCriteriaCorrelation</span>
        <span class="n">sdMarginalCorrelation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">varMarginalCorrelation</span><span class="p">)</span> 
        <span class="c1"># showing the results</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Consensus quality of ranking:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criterion (weight): correlation&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">marginalCorrelations</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">): </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">cg</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Summary:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weighted mean marginal correlation (a): </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">meanMarginalCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard deviation (b)                : </span><span class="si">%+.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sdMarginalCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking fairness (a)-(b)              : </span><span class="si">%+.3f</span><span class="s1">&#39;</span> \
                       <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">meanMarginalCorrelation</span><span class="p">)</span> <span class="o">-</span> <span class="n">sdMarginalCorrelation</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">marginalCorrelations</span><span class="p">,</span>
                <span class="n">meanMarginalCorrelation</span><span class="p">,</span>
                <span class="n">sdMarginalCorrelation</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="PerformanceTableau.showRankingConsensusQuality">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showRankingConsensusQuality">[docs]</a>
    <span class="k">def</span> <span class="nf">showRankingConsensusQuality</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ranking</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the marginal criteria correlations with a given ranking with summary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeRankingConsensusQuality</span><span class="p">(</span><span class="n">ranking</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceTableau.computeWeightPreorder">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeWeightPreorder">[docs]</a>
    <span class="k">def</span> <span class="nf">computeWeightPreorder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the weight preorder following from the given</span>
<span class="sd">        criteria weights in a list of increasing equivalence</span>
<span class="sd">        lists of criteria. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weightorder</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="c1"># generate weightslist</span>
        <span class="n">weightslist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">weightslist</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]),</span><span class="n">g</span><span class="p">))</span>
        <span class="n">weightslist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="c1"># generate weightPreorder</span>
        <span class="n">weightPreorder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">weightclass</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weightslist</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">weightslist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">weightslist</span><span class="p">[</span><span class="n">cur</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">weightclass</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weightslist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cur</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">weightPreorder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weightclass</span><span class="p">)</span>
                <span class="n">weightclass</span> <span class="o">=</span> <span class="p">[</span><span class="n">weightslist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>        
        <span class="n">weightPreorder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weightclass</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">weightPreorder</span></div>

   
<div class="viewcode-block" id="PerformanceTableau.showAll">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showAll">[docs]</a>
    <span class="k">def</span> <span class="nf">showAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show fonction for performance tableau</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- show performance tableau -------*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name         :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actions      :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Criteria     :&#39;</span><span class="p">)</span>       
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; criterion name        :&#39;</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   scale: &#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, weight: </span><span class="si">%.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   thresholds:&#39;</span><span class="p">,</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weights preorder :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Evaluations      :&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">evaluation</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">])</span></div>


<div class="viewcode-block" id="PerformanceTableau.showEvaluationStatistics">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showEvaluationStatistics">[docs]</a>
    <span class="k">def</span> <span class="nf">showEvaluationStatistics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the variance and standard deviation of</span>
<span class="sd">        the values observed in the performance Tableau.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">math</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- Evaluation statistics ----*&#39;</span><span class="p">)</span>
        <span class="n">average</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">average</span> <span class="o">+=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">average</span> <span class="o">=</span> <span class="n">average</span><span class="o">/</span><span class="n">n</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;average      : </span><span class="si">%2.2f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">average</span><span class="p">))</span>
        <span class="n">variance</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">variance</span> <span class="o">+=</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="n">average</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">-</span><span class="n">average</span><span class="p">)</span>
        <span class="n">variance</span> <span class="o">=</span> <span class="n">variance</span><span class="o">/</span><span class="n">n</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;variance     : </span><span class="si">%2.2f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variance</span><span class="p">))</span>
        <span class="n">stddev</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;std deviation: </span><span class="si">%2.2f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stddev</span><span class="p">))</span>      </div>


<div class="viewcode-block" id="PerformanceTableau.save">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempperftab&#39;</span><span class="p">,</span><span class="n">isDecimal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">valueDigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of Performance Tableaux.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving performance tableau in file: &lt;&#39;</span> \
              <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved performance Tableau: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># name</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;name = </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fileName</span><span class="p">)</span>
        <span class="c1"># actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;actions = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">it</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">##            try:</span>
<span class="c1">##                xnameString = actions[x][&#39;name&#39;]</span>
<span class="c1">##            except:</span>
<span class="c1">##                xnameString = str(x)</span>
<span class="c1">##            try:</span>
<span class="c1">##                xcommentString = actions[x][&#39;comment&#39;]</span>
<span class="c1">##            except:</span>
<span class="c1">##                xcommentString = &#39;&#39;</span>
<span class="c1">##            fo.write(&#39;(\&#39;%s\&#39;, {\&#39;name\&#39;: \&#39;%s\&#39;,\&#39;comment\&#39;:\&#39;%s\&#39;}),\n&#39; %(x,xnameString,xcommentString))</span>
<span class="c1">##            </span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># objectives</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;objectives = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectives</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">##            fo.write( &#39;(\&#39;%s\&#39;, {\&#39;name\&#39;: \&#39;%s\&#39;,\n&#39; % (obj,objectives[obj][&#39;name&#39;]) )</span>
<span class="c1">##            weightString = &#39;%%.%df&#39; % (valueDigits)</span>
<span class="c1">##            objString = &#39;\&#39;criteria\&#39;: %s, \&#39;weight\&#39;:&#39;+weightString+&#39;}),\n&#39;</span>
<span class="c1">##            fo.write(objString % (objectives[obj][&#39;criteria&#39;],\</span>
<span class="c1">##                                                                objectives[obj][&#39;weight&#39;]))  </span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>            
        <span class="c1"># criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;criteria = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="n">gKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">gKeys</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
            <span class="k">if</span> <span class="s1">&#39;preferenceDirection&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gKeys</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">preferenceDirection</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="s1">max</span><span class="se">\&#39;</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># missing data symbol</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;NA = Decimal(&#39;</span><span class="si">%s</span><span class="s2">&#39;)</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">))</span> <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;NA = Decimal(&#39;-999&#39;)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># evaluations</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;evaluation = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Decimal</span><span class="p">:</span>
                    <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;:Decimal(&quot;&#39; + str(evaluation[g][x]) + &#39;&quot;),\n&#39;)</span>
                    <span class="n">evaluationString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%%</span><span class="s1">s</span><span class="se">\&#39;</span><span class="s1">:Decimal(&quot;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&quot;),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valueDigits</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_saveXML</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                 <span class="n">subcategory</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span><span class="n">author</span><span class="o">=</span><span class="s1">&#39;digraphs Module (RB)&#39;</span><span class="p">,</span>
                 <span class="n">reference</span><span class="o">=</span><span class="s1">&#39;saved from Python&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save temporary performance tableau self in XML format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- saving performance tableau in XML format  -------------*&#39;</span><span class="p">)</span>        
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">nameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;performanceTableau.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;!DOCTYPE digraph SYSTEM &quot;digraphs.dtd&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performancetableau &#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;category=&quot;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">category</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot; subcategory=&quot;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subcategory</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;header&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nameExt</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;author&gt;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;reference&gt;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/reference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/header&gt;&#39;</span><span class="p">)</span>
        <span class="n">listActions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">listActions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">listActions</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;actions&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;action&gt;&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">listActions</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/action&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/actions&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;critname&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&lt;/critname&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;min&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/min&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;max&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/max&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;indifference&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">])</span>\
                                                     <span class="o">+</span><span class="s1">&#39;&lt;/indifference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preference&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/preference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;weakVeto&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/weakVeto&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;veto&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/veto&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1">#fo.write(&#39;&lt;weight&gt;&#39;+str(criteria[g][&#39;weight&#39;])+&#39;&lt;/weight&gt;\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;weight&gt;</span><span class="si">%.3f</span><span class="s1">&lt;/weight&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;evaluations&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;evaluation&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;critname&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&lt;/critname&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;evalactions&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;action&gt;&#39;</span><span class="p">)</span>       
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">listActions</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/action&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                    
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">listActions</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/evalactions&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/evaluation&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/evaluations&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performancetableau&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>         
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File: &#39;</span> <span class="o">+</span> <span class="n">nameExt</span> <span class="o">+</span> <span class="s1">&#39; saved !&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_saveXMLRubis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="n">subcategory</span><span class="o">=</span><span class="s1">&#39;new D2 version&#39;</span><span class="p">,</span><span class="n">author</span><span class="o">=</span><span class="s1">&#39;digraphs Module (RB)&#39;</span><span class="p">,</span><span class="n">reference</span><span class="o">=</span><span class="s1">&#39;saved from Python&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save temporary performance tableau self in XML Rubis format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">codecs</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- saving performance tableau in XML Rubis format  -------------*&#39;</span><span class="p">)</span>        
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">nameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;rubisPerformanceTableau.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#fo.write(&#39;&lt;!DOCTYPE rubisPerformaceTableau SYSTEM &quot;http://localhost/rubisServer/Schemas/rubisPerformanceTableau-1.0/rubisPerformanceTableau.dtd&quot;&gt;\n&#39;)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;rubisPerformanceTableau xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;rubisPerformanceTableau.xsd&quot; &#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;category=&quot;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">category</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot; subcategory=&quot;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subcategory</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;Performance Tableau in XML Rubis format.&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;header&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nameExt</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;author&gt;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">author</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;reference&gt;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/reference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/header&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;actions&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;Potential decision actions.&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;action id=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/action&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/actions&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;Rubis family of criteria.&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>   
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterion id=&quot;</span><span class="si">%s</span><span class="s1">&quot; category=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="s1">&#39;performance&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1">#fo.write(&#39;&lt;min&gt;&#39;+unicode(criteria[g][&#39;scale&#39;][0])+&#39;&lt;/min&gt;\n&#39;)</span>
            <span class="c1">#fo.write(&#39;&lt;max&gt;&#39;+unicode(criteria[g][&#39;scale&#39;][1])+&#39;&lt;/max&gt;\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;min&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/min&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;max&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/max&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;indifference&gt;(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.3f</span><span class="s1">)&lt;/indifference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;weakPreference&gt;(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.3f</span><span class="s1">)&lt;/weakPreference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preference&gt;(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.3f</span><span class="s1">)&lt;/preference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;weakVeto&gt;(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.3f</span><span class="s1">)&lt;/weakVeto&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;veto&gt;(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.3f</span><span class="s1">)&lt;/veto&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;weight&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/weight&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;evaluations&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;Rubis Performance Table.&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;evaluation&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionID&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&lt;/criterionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;actionID&gt;&#39;</span><span class="p">)</span>       
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/actionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                    
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/evaluation&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/evaluations&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/rubisPerformanceTableau&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>         
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File: &#39;</span> <span class="o">+</span> <span class="n">nameExt</span> <span class="o">+</span> <span class="s1">&#39; saved !&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_saveXMCDA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;New XMCDA Rubis format&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;digraphs Module (RB)&#39;</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;saved from Python session&#39;</span><span class="p">,</span><span class="n">variant</span><span class="o">=</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="n">valuationType</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span><span class="n">servingD3</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save performance tableau object self in XMCDA format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">codecs</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- saving performance tableau in XMCDA format  -------------*&#39;</span><span class="p">)</span>        
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.xmcda&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">nameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">servingD3</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;!-- ?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcdaDefault.xsl&quot;? --&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcdaDefault.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&lt;xmcda:XMCDA xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.decision-deck.org/2008/UMCDA-ML-1.0 umcda-ml-1.0.xsd&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2008/UMCDA-ML-1.0&quot; instanceID=&quot;void&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
       <span class="c1"># write description</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;caseReference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;title&gt;Performance Tableau in XMCDA format.&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>   
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;id&gt;</span><span class="si">%s</span><span class="s1">&lt;/id&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nameExt</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;root&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;author&gt;</span><span class="si">%s</span><span class="s1">&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/caseReference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># write methodData</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;methodData&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Method data&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>   
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;id&gt;</span><span class="si">%s</span><span class="s1">&lt;/id&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis best choice method&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;methodData&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;variant&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variant</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;valuationType&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valuationType</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;significanceThreshold&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/methodData&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#  save alternatives</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternatives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Potential decision actions.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;</span><span class="si">%s</span><span class="s1">&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;alternatives&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                  
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternative id=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                  
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternativeType&gt;potential&lt;/alternativeType&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;status&gt;active&lt;/status&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternatives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># save criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Family of criteria.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;</span><span class="si">%s</span><span class="s1">&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>   
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterion id=&quot;</span><span class="si">%s</span><span class="s1">&quot; &gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;name&gt;</span><span class="si">%s</span><span class="s1">&lt;/name&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="p">)</span>
                
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;</span><span class="si">%s</span><span class="s1">&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;criterion&#39;</span><span class="p">))</span>            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;performance&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;status&gt;active&lt;/status&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;IntegerWeights&#39;</span><span class="p">]:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;significance&gt;&lt;integer&gt;</span><span class="si">%d</span><span class="s1">&lt;/integer&gt;&lt;/significance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;significance&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/significance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;significance&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/significance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionFunction category=&quot;</span><span class="si">%s</span><span class="s1">&quot; subCategory=&quot;</span><span class="si">%s</span><span class="s1">&quot; &gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="s1">&#39;performance&#39;</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="c1">#pdir = -1</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
 
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;min&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/min&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;max&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/max&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>

            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold&gt;&lt;type&gt;ind&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold&gt;&lt;type&gt;weakPreference&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold&gt;&lt;type&gt;pref&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold&gt;&lt;type&gt;weakVeto&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold&gt;&lt;type&gt;veto&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;function&gt;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;&lt;/function&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterionFunction&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#fo.write(&#39;&lt;majorityThreshold&gt;&lt;value&gt;&lt;real&gt;0.5&lt;/real&gt;&lt;/value&gt;&lt;/majorityThreshold&gt;\n&#39;)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># save performance table</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performanceTable&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Rubis Performance Table.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;</span><span class="si">%s</span><span class="s1">&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;performanceTable&#39;</span><span class="p">))</span>            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionEvaluations&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionID&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&lt;/criterionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;evaluation&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternativeID&gt;&#39;</span><span class="p">)</span>       
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternativeID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                    
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&lt;real&gt;&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/real&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/evaluation&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterionEvaluations&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performanceTable&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/xmcda:XMCDA&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>         
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File: &#39;</span> <span class="o">+</span> <span class="n">nameExt</span> <span class="o">+</span> <span class="s1">&#39; saved !&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="PerformanceTableau.saveXMCDA2">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.saveXMCDA2">[docs]</a>
    <span class="k">def</span> <span class="nf">saveXMCDA2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span>
                   <span class="n">category</span><span class="o">=</span><span class="s1">&#39;XMCDA 2.0 Extended format&#39;</span><span class="p">,</span>
                   <span class="n">user</span><span class="o">=</span><span class="s1">&#39;digraphs Module (RB)&#39;</span><span class="p">,</span>
                   <span class="n">version</span><span class="o">=</span><span class="s1">&#39;saved from Python session&#39;</span><span class="p">,</span>
                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Performance Tableau in XMCDA-2.0 format.&#39;</span><span class="p">,</span>
                   <span class="n">variant</span><span class="o">=</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span>
                   <span class="n">valuationType</span><span class="o">=</span><span class="s1">&#39;bipolar&#39;</span><span class="p">,</span>
                   <span class="n">servingD3</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">isStringIO</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">stringNA</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span>
                   <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by saveXMCDA2()&#39;</span><span class="p">,</span>
                   <span class="n">hasVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save performance tableau object self in XMCDA 2.0 format including decision objectives, the case given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">codecs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- saving performance tableau in XMCDA 2.0 format  -------------*&#39;</span><span class="p">)</span>
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="k">if</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by stringIO()&#39;</span>
            <span class="kn">import</span> <span class="nn">io</span>
            <span class="c1">## ms = 100 * len(self.actions) + 500 * len(self.criteria) * 20 * len(self.evaluation)</span>
            <span class="c1">## print &#39;estimated mapped memory size = %d&#39; % (ms)</span>
            <span class="c1">##fo = mmap.mmap(-1,ms)</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#nameExt = fileName+&#39;.xmcda2&#39;</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">nameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">servingD3</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;!-- ?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;? --&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&lt;xmcda:XMCDA xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0 http://www.decision-deck.org/xmcda/_downloads/XMCDA-2.0.0.xsd&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot; instanceID=&quot;void&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="c1"># write description</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;projectReference id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="n">nameExt</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span> <span class="p">)</span>  
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;author&gt;</span><span class="si">%s</span><span class="s1">&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/projectReference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># write methodParameters</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;methodParameters id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="s1">&#39;Rubis best choice method&#39;</span><span class="p">,</span><span class="s1">&#39;methodData&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Method parameters&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>   
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;variant&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variant</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;valuationType&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valuationType</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/methodParameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1">#  save alternatives</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternatives mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;alternatives&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Potential decision actions.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                  
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">actionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">actionName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternative id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">actionName</span><span class="p">,</span><span class="s1">&#39;potentialDecisionAction&#39;</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                  
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;real&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternatives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># save objectives</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">objectivesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">]</span>
            <span class="n">objectivesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;objectives mcdaConcept=&quot;objectives&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Set of decision objectives&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectivesList</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">objectiveName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">objectiveName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;objective id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span><span class="n">objectiveName</span><span class="p">,</span><span class="s1">&#39;objective&#39;</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">objective</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span> <span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;weight&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/weight&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">objCriteria</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">obj</span><span class="p">]</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;objectiveCriteria&gt;</span><span class="si">%s</span><span class="s1">&lt;/objectiveCriteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">objCriteria</span><span class="p">))</span> <span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/objective&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/objectives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># save criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criteria mcdaConcept=&quot;criteria&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Family of criteria.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterion id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="n">criterionName</span><span class="p">,</span><span class="s1">&#39;criterion&#39;</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;performance&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionObjective&gt;</span><span class="si">%s</span><span class="s1">&lt;/criterionObjective&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;IntegerWeights&#39;</span><span class="p">]:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;integer&gt;</span><span class="si">%d</span><span class="s1">&lt;/integer&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="c1">#pdir = -1</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;minimum&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/minimum&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;maximum&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/maximum&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>

            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;ind&quot; name=&quot;indifference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;weakPreference&quot; name=&quot;weak Preference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;pref&quot; name=&quot;preference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="n">hasVeto</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;weakVeto&quot; name=&quot;weak veto&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;veto&quot; name=&quot;veto&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># save performance table</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performanceTable mcdaConcept=&quot;performanceTable&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Rubis Performance Table.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternativePerformances&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternativeID&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/alternativeID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                            <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionID&gt;&#39;</span><span class="p">)</span>       
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">pdir</span><span class="o">*</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&lt;NA&gt;&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stringNA</span> <span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/NA&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&lt;real&gt;&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">val</span> <span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/real&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternativePerformances&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performanceTable&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/xmcda:XMCDA&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="n">problemText</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">problemText</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File: &#39;</span> <span class="o">+</span> <span class="n">nameExt</span> <span class="o">+</span> <span class="s1">&#39; saved !&#39;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_saveXMCDA2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span>
                   <span class="n">category</span><span class="o">=</span><span class="s1">&#39;XMCDA 2.0 format&#39;</span><span class="p">,</span>
                   <span class="n">user</span><span class="o">=</span><span class="s1">&#39;digraphs Module (RB)&#39;</span><span class="p">,</span>
                   <span class="n">version</span><span class="o">=</span><span class="s1">&#39;saved from Python session&#39;</span><span class="p">,</span>
                   <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Performance Tableau in XMCDA-2.0 format.&#39;</span><span class="p">,</span>
                   <span class="n">variant</span><span class="o">=</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span>
                   <span class="n">valuationType</span><span class="o">=</span><span class="s1">&#39;bipolar&#39;</span><span class="p">,</span>
                   <span class="n">servingD3</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">isStringIO</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">stringNA</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span>
                   <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by saveXMCDA2()&#39;</span><span class="p">,</span>
                   <span class="n">hasVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save performance tableau object self in XMCDA 2.0 format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">codecs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- saving performance tableau in XMCDA 2.0 format  -------------*&#39;</span><span class="p">)</span>
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="k">if</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by stringIO()&#39;</span>
            <span class="kn">import</span> <span class="nn">io</span>
            <span class="c1">## ms = 100 * len(self.actions) + 500 * len(self.criteria) * 20 * len(self.evaluation)</span>
            <span class="c1">## print &#39;estimated mapped memory size = %d&#39; % (ms)</span>
            <span class="c1">##fo = mmap.mmap(-1,ms)</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#nameExt = fileName+&#39;.xmcda2&#39;</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">nameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">servingD3</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;!-- ?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;? --&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&lt;xmcda:XMCDA xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0 http://www.decision-deck.org/xmcda/_downloads/XMCDA-2.0.0.xsd&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot; instanceID=&quot;void&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="c1"># write description</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;projectReference id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="n">nameExt</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span> <span class="p">)</span>  
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;author&gt;</span><span class="si">%s</span><span class="s1">&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/projectReference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># write methodParameters</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;methodParameters id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="s1">&#39;Rubis best choice method&#39;</span><span class="p">,</span><span class="s1">&#39;methodData&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Method parameters&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>   
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;variant&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variant</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;parameter name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;valuationType&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valuationType</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/methodParameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1">#  save alternatives</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternatives mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;alternatives&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Potential decision actions.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                  
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">actionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">actionName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternative id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">actionName</span><span class="p">,</span><span class="s1">&#39;potentialDecisionAction&#39;</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                  
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;real&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternatives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># save criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criteria mcdaConcept=&quot;criteria&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Family of criteria.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterion id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="n">criterionName</span><span class="p">,</span><span class="s1">&#39;criterion&#39;</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;performance&#39;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;IntegerWeights&#39;</span><span class="p">]:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;integer&gt;</span><span class="si">%d</span><span class="s1">&lt;/integer&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="c1">#pdir = -1</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;minimum&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/minimum&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;maximum&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/maximum&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>

            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;ind&quot; name=&quot;indifference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;weakPreference&quot; name=&quot;weak Preference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;pref&quot; name=&quot;preference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="n">hasVeto</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;weakVeto&quot; name=&quot;weak veto&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;threshold id=&quot;veto&quot; name=&quot;veto&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                       
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># save performance table</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performanceTable mcdaConcept=&quot;performanceTable&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Rubis Performance Table.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)):</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternativePerformances&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;alternativeID&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/alternativeID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionID&gt;&#39;</span><span class="p">)</span>       
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">pdir</span><span class="o">*</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&lt;NA&gt;&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stringNA</span> <span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/NA&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;value&gt;&lt;real&gt;&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">val</span> <span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/real&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>                    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/alternativePerformances&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/performanceTable&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>        
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/xmcda:XMCDA&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="n">problemText</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span>            
            <span class="k">return</span> <span class="n">problemText</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File: &#39;</span> <span class="o">+</span> <span class="n">nameExt</span> <span class="o">+</span> <span class="s1">&#39; saved !&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="PerformanceTableau.saveXMCDA2String">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.saveXMCDA2String">[docs]</a>
    <span class="k">def</span> <span class="nf">saveXMCDA2String</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;XMCDA 2.0 format&#39;</span><span class="p">,</span>
                         <span class="n">user</span><span class="o">=</span><span class="s1">&#39;digraphs Module (RB)&#39;</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;saved from Python session&#39;</span><span class="p">,</span>
                         <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Performance Tableau in XMCDA-2.0 format.&#39;</span><span class="p">,</span><span class="n">variant</span><span class="o">=</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span>
                         <span class="n">valuationType</span><span class="o">=</span><span class="s1">&#39;bipolar&#39;</span><span class="p">,</span><span class="n">servingD3</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by stringIO()&#39;</span><span class="p">,</span>
                         <span class="n">stringNA</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save performance tableau object self in XMCDA 2.0 format.</span>
<span class="sd">        !!! obsolete: replaced by the isStringIO in the saveXMCDA2 method !!!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">codecs</span>
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">servingD3</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;!-- ?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;? --&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&lt;xmcda:XMCDA xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0 http://www.decision-deck.org/xmcda/_downloads/XMCDA-2.0.0.xsd&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2009/XMCDA-2.0.0&quot; instanceID=&quot;void&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># write description</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;projectReference id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="n">nameExt</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>  
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;author&gt;</span><span class="si">%s</span><span class="s1">&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">user</span><span class="p">))</span> 
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">version</span><span class="p">))</span> 
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span> 
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/projectReference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># write methodParameters</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;methodParameters id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="s1">&#39;Rubis best choice method&#39;</span><span class="p">,</span><span class="s1">&#39;methodData&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;subTitle&gt;Method parameters&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>   
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;parameter name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;variant&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variant</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;parameter name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;valuationType&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;label&gt;</span><span class="si">%s</span><span class="s1">&lt;/label&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">valuationType</span><span class="p">)</span> 
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/parameter&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/parameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/methodParameters&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1">#  save alternatives</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;alternatives mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;alternatives&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;subTitle&gt;Potential decision actions.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                  
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">actionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">actionName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;alternative id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">actionName</span><span class="p">,</span><span class="s1">&#39;potentialDecisionAction&#39;</span><span class="p">)</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;comment&gt;&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;comment&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                  
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;type&gt;real&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>  
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/alternative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/alternatives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># save objectives</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">objectivesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span><span class="p">]</span>
            <span class="n">objectivesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;objectives mcdaConcept=&quot;objectives&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;subTitle&gt;Set of decision objectives&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectivesList</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">objectiveName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">objectiveName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;objective id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span><span class="n">objectiveName</span><span class="p">,</span><span class="s1">&#39;objective&#39;</span> <span class="p">)</span> 
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">objective</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span> 
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis&#39;</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;weight&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/weight&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">objCriteria</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">obj</span><span class="p">]</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;objectiveCriteria&gt;</span><span class="si">%s</span><span class="s1">&lt;/objectiveCriteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">objCriteria</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/objective&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/objectives&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># save criteria</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criteria mcdaConcept=&quot;criteria&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;subTitle&gt;Family of criteria.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>       
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criterion id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="n">criterionName</span><span class="p">,</span><span class="s1">&#39;criterion&#39;</span> <span class="p">)</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span> 
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;performance&#39;</span><span class="p">)</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criterionObjective&gt;</span><span class="si">%s</span><span class="s1">&lt;/criterionObjective&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;IntegerWeights&#39;</span><span class="p">]:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;integer&gt;</span><span class="si">%d</span><span class="s1">&lt;/integer&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criterionValue&gt;&lt;value&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/value&gt;&lt;/criterionValue&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="c1">#pdir = -1</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;preferenceDirection&gt;</span><span class="si">%s</span><span class="s1">&lt;/preferenceDirection&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
                <span class="n">pdir</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;minimum&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/minimum&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;maximum&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/maximum&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/quantitative&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/scale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;threshold id=&quot;ind&quot; name=&quot;indifference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                       
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;threshold id=&quot;weakPreference&quot; name=&quot;weak Preference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakPreference&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                       
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;threshold id=&quot;pref&quot; name=&quot;preference&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                       
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;threshold id=&quot;weakVeto&quot; name=&quot;weak veto&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;weakVeto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                       
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;threshold id=&quot;veto&quot; name=&quot;veto&quot; mcdaConcept=&quot;performanceDiscriminationThreshold&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;slope&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/slope&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;intercept&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/intercept&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/linear&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;veto&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/constant&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>                       
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/threshold&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/thresholds&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/criterion&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/criteria&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="c1"># save performance table</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;performanceTable mcdaConcept=&quot;performanceTable&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;subTitle&gt;Rubis Performance Table.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)):</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;alternativePerformances&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;alternativeID&gt;&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;&lt;/alternativeID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;criterionID&gt;&#39;</span>       
                <span class="n">fo</span> <span class="o">+=</span> <span class="n">g</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/criterionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">pdir</span><span class="o">*</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;value&gt;&lt;NA&gt;&#39;</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stringNA</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/NA&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span> 
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                            <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;value&gt;&lt;real&gt;&#39;</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pdir</span><span class="o">*</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">actionsList</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                    <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/real&gt;&lt;/value&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/performance&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/alternativePerformances&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/performanceTable&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>        
        <span class="n">fo</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/xmcda:XMCDA&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">fo</span></div>

     


    <span class="c1">## def showStatistics(self,withOutput=False,Comments=True):</span>
    <span class="c1">##     &quot;&quot;&quot;</span>
    <span class="c1">##     show version of the computeStatistics method for PerformanceTableau instances</span>
    <span class="c1">##     &quot;&quot;&quot;</span>
    <span class="c1">##     self.computeStatistics(withOutput=withOutput,Comments=Comments)</span>

<div class="viewcode-block" id="PerformanceTableau.computeNormalizedDiffEvaluations">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.computeNormalizedDiffEvaluations">[docs]</a>
    <span class="k">def</span> <span class="nf">computeNormalizedDiffEvaluations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lowValue</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">highValue</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span><span class="n">withOutput</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders and csv stores (withOutput=True) the</span>
<span class="sd">        list of normalized evaluation differences observed on the family of criteria</span>
<span class="sd">        Is only adequate if all criteria have the same</span>
<span class="sd">        evaluation scale. Therefore the performance tableau is normalized to 0.0-100.0 scales.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalizeEvaluations</span><span class="p">(</span><span class="n">lowValue</span><span class="o">=</span><span class="n">lowValue</span><span class="p">,</span><span class="n">highValue</span><span class="o">=</span><span class="n">highValue</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showPerformanceTableau</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">diffEvaluations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">withOutput</span><span class="p">:</span>
            <span class="n">fileoutName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_diff.csv&#39;</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileoutName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Evaluation differences statistics </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;diffperf&quot;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span> <span class="ow">and</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                            <span class="n">diffxy</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
                            <span class="n">diffEvaluations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diffxy</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diffxy = evaluation[g][x] = evaluation[g][y]&#39;</span><span class="p">,</span> <span class="n">diffxy</span><span class="p">,</span> <span class="s1">&#39; = &#39;</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> <span class="s1">&#39; - &#39;</span><span class="p">,</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">withOutput</span><span class="p">:</span>
                                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">diffxy</span><span class="p">)</span>                
        <span class="k">if</span> <span class="n">withOutput</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diffEvaluations</span> <span class="o">=</span> <span class="n">diffEvaluations</span>
        <span class="k">return</span> <span class="n">diffEvaluations</span></div>


    
<div class="viewcode-block" id="PerformanceTableau.showStatistics">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.showStatistics">[docs]</a>
    <span class="k">def</span> <span class="nf">showStatistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show statistics concerning the evaluation distributions</span>
<span class="sd">        on each criteria.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">math</span>
        <span class="n">criteriaKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Performance tableau summary statistics -------*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Instance name      :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#Actions           :&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#Criteria          :&#39;</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*Statistics per Criterion*&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Criterion name       :&#39;</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Criterion weight     :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="n">averageEvaluation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
            <span class="n">varianceEvaluation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">minEvaluation</span> <span class="o">=</span> <span class="n">Max</span>
            <span class="n">maxEvaluation</span> <span class="o">=</span> <span class="n">Min</span>
            <span class="n">evaluationList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evaluationList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                    <span class="n">averageEvaluation</span> <span class="o">+=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="n">varianceEvaluation</span> <span class="o">+=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span><span class="o">**</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minEvaluation</span><span class="p">:</span>
                        <span class="n">minEvaluation</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxEvaluation</span><span class="p">:</span>
                        <span class="n">maxEvaluation</span> <span class="o">=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
            <span class="n">evaluationList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluationList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">evaluationList</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  criterion scale      : </span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Min</span><span class="p">,</span> <span class="n">Max</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  criterion scale      : </span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">Max</span><span class="p">,</span> <span class="n">Min</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  criterion scale    : </span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Min</span><span class="p">,</span> <span class="n">Max</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  # missing evaluations : </span><span class="si">%d</span><span class="s1">&#39;</span>   <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">na</span><span class="p">))</span>
            <span class="c1"># !! index on evaluation List goes from 0 to na -1 !!</span>
            <span class="k">if</span> <span class="n">na</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">rankQ1</span> <span class="o">=</span> <span class="n">na</span> <span class="o">/</span> <span class="mf">4.0</span>
                <span class="n">lowRankQ1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rankQ1</span><span class="p">))</span>
                <span class="n">proportQ1</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rankQ1</span> <span class="o">-</span> <span class="n">lowRankQ1</span><span class="p">))</span>
                <span class="n">quantileQ1</span> <span class="o">=</span> <span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">proportQ1</span> <span class="o">*</span> <span class="p">(</span><span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ1</span><span class="p">])</span> <span class="p">)</span>
                <span class="c1">#print rankQ1, lowRankQ1, proportQ1</span>

                <span class="n">rankQ2</span> <span class="o">=</span> <span class="n">na</span> <span class="o">/</span> <span class="mf">2.0</span>
                <span class="n">lowRankQ2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rankQ2</span><span class="p">))</span>
                <span class="n">proportQ2</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rankQ2</span> <span class="o">-</span> <span class="n">lowRankQ2</span><span class="p">))</span>
                
                <span class="n">quantileQ2</span> <span class="o">=</span> <span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">proportQ2</span> <span class="o">*</span> <span class="p">(</span> <span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ2</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ2</span><span class="p">])</span> <span class="p">)</span>

                <span class="n">rankQ3</span> <span class="o">=</span> <span class="p">(</span><span class="n">na</span> <span class="o">*</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span>
                <span class="n">lowRankQ3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">rankQ3</span><span class="p">))</span>
                <span class="n">proportQ3</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rankQ3</span> <span class="o">-</span> <span class="n">lowRankQ3</span><span class="p">))</span>
                              
                <span class="n">quantileQ3</span> <span class="o">=</span> <span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ3</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span> <span class="n">proportQ3</span> <span class="o">*</span> <span class="p">(</span><span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ3</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">evaluationList</span><span class="p">[</span><span class="n">lowRankQ3</span><span class="p">])</span> <span class="p">)</span>
                    
                <span class="n">averageEvaluation</span> <span class="o">/=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">na</span><span class="p">))</span>
                <span class="n">varianceEvaluation</span> <span class="o">=</span> <span class="n">varianceEvaluation</span><span class="o">/</span><span class="n">na</span> <span class="o">-</span> <span class="n">averageEvaluation</span><span class="o">**</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
                <span class="n">stdDevEvaluation</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">varianceEvaluation</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  mean evaluation       : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">averageEvaluation</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  standard deviation    : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stdDevEvaluation</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  maximal evaluation    : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxEvaluation</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  quantile Q3 (x_75)    : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantileQ3</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  median evaluation     : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantileQ2</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  quantile Q1 (x_25)    : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantileQ1</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  minimal evaluation    : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">minEvaluation</span><span class="p">))</span>
                <span class="n">averageAbsDiffEvaluation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
                <span class="n">varianceDiffEvaluation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
                <span class="n">nd</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span> <span class="ow">and</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                            <span class="n">diffxy</span> <span class="o">=</span> <span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
                            <span class="n">averageAbsDiffEvaluation</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diffxy</span><span class="p">)</span>
                            <span class="n">varianceDiffEvaluation</span> <span class="o">+=</span> <span class="n">diffxy</span><span class="o">**</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
                            <span class="n">nd</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#            print &#39;  Sum of evaluation differences = &#39;, averageAbsDiffEvaluation</span>
                <span class="n">averageAbsDiffEvaluation</span> <span class="o">/=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span>
                <span class="c1">## averageDiffEvaluation == 0 per construction  </span>
                <span class="n">varianceDiffEvaluation</span> <span class="o">=</span> <span class="n">varianceDiffEvaluation</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span>
                <span class="n">stdDevDiffEvaluation</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">varianceDiffEvaluation</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  mean absolute difference      : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">averageAbsDiffEvaluation</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  standard difference deviation : </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stdDevDiffEvaluation</span><span class="p">))</span></div>


<div class="viewcode-block" id="PerformanceTableau.normalizeEvaluations">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.normalizeEvaluations">[docs]</a>
    <span class="k">def</span> <span class="nf">normalizeEvaluations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lowValue</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">highValue</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        recode the evaluations between lowValue and highValue on all criteria</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">##from math import copysign</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">lowValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lowValue</span><span class="p">))</span>
        <span class="n">highValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">highValue</span><span class="p">))</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">highValue</span><span class="o">-</span><span class="n">lowValue</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lowValue&#39;</span><span class="p">,</span> <span class="n">lowValue</span><span class="p">,</span> <span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>
        <span class="n">criterionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">]</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">]</span>
        <span class="n">normEvaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criterionKeys</span><span class="p">:</span>
            <span class="c1">#print(g, criteria[g][&#39;weight&#39;], criteria[g][&#39;preferenceDirection&#39;])</span>
            <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">glow</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">ghigh</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">gamp</span> <span class="o">=</span> <span class="n">ghigh</span> <span class="o">-</span> <span class="n">glow</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt; g, glow, ghigh, gamp&#39;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="n">ghigh</span><span class="p">,</span> <span class="n">gamp</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evalx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">evalx</span><span class="p">)</span>
                    <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowValue</span> <span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">glow</span><span class="p">)</span><span class="o">/</span><span class="n">gamp</span><span class="p">)</span><span class="o">*</span><span class="n">amplitude</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
                            <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">lowValue</span> <span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">glow</span><span class="p">)</span><span class="o">/</span><span class="n">gamp</span><span class="p">)</span><span class="o">*</span><span class="n">amplitude</span><span class="p">)</span>
                            <span class="c1">#print(&#39;passing here&#39;,normEvaluation[g][x])</span>
                            
                        <span class="k">elif</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="c1">#else:</span>
                            <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">lowValue</span> <span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">glow</span><span class="p">)</span><span class="o">/</span><span class="n">gamp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">amplitude</span><span class="p">))</span>
                            <span class="c1">#print(&#39;passing here&#39;,normEvaluation[g][x])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
                            <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowValue</span> <span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">glow</span><span class="p">)</span><span class="o">/</span><span class="n">gamp</span><span class="p">)</span><span class="o">*</span><span class="n">amplitude</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
                            <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">lowValue</span> <span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">glow</span><span class="p">)</span><span class="o">/</span><span class="n">gamp</span><span class="p">)</span><span class="o">*</span><span class="n">amplitude</span><span class="p">)</span>
                        
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">],</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">normEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>
                    
        <span class="k">return</span> <span class="n">normEvaluation</span></div>


<div class="viewcode-block" id="PerformanceTableau.quantizeCriterionEvaluations">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.quantizeCriterionEvaluations">[docs]</a>
    <span class="k">def</span> <span class="nf">quantizeCriterionEvaluations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        q-tile evaluation of criterion q</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">]</span>
        <span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">quantilesFrequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">criterionActionsQuantiles</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
        <span class="n">criterionValues</span> <span class="o">=</span> <span class="p">[</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span> <span class="k">if</span>
                               <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">]</span>
        <span class="n">criterionValues</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">ng</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">criterionValues</span><span class="p">)</span>
        <span class="n">criterionActionsQuantiles</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
            <span class="n">indxinf</span> <span class="o">=</span> <span class="n">criterionValues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
            <span class="n">lx</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">criterionValues</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]]</span>
            <span class="n">indxsup</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lx</span><span class="p">)</span>
            <span class="n">indx</span> <span class="o">=</span> <span class="p">((</span><span class="n">indxinf</span><span class="o">+</span><span class="n">indxsup</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">ng</span>
            <span class="n">actionQuantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="n">indx</span><span class="p">)</span>
            <span class="n">aq</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">qfreq</span> <span class="ow">in</span> <span class="n">quantilesFrequencies</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">actionQuantile</span> <span class="o">&lt;</span> <span class="n">qfreq</span><span class="p">:</span>
                    <span class="n">criterionActionsQuantiles</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">aq</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">aq</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">criterionActionsQuantiles</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-tiled evaluations&#39;</span> <span class="o">%</span> <span class="n">q</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ind&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)),</span>
                                          <span class="s1">&#39;pref&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">),</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">))}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">criterionActionsQuantiles</span></div>

   
<div class="viewcode-block" id="PerformanceTableau.restoreOriginalEvaluations">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PerformanceTableau.restoreOriginalEvaluations">[docs]</a>
    <span class="k">def</span> <span class="nf">restoreOriginalEvaluations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lowValue</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">highValue</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        recode the evaluations to their original values on all criteria</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">lowValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lowValue</span><span class="p">))</span>
        <span class="n">highValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">highValue</span><span class="p">))</span>
        <span class="n">amplitude</span> <span class="o">=</span> <span class="n">highValue</span><span class="o">-</span><span class="n">lowValue</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lowValue&#39;</span><span class="p">,</span> <span class="n">lowValue</span><span class="p">,</span> <span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">)</span>
        <span class="n">criterionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evaluation</span><span class="p">]</span>
        <span class="n">restoredEvaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criterionKeys</span><span class="p">:</span>
            <span class="n">restoredEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">glow</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">ghigh</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">gamp</span> <span class="o">=</span> <span class="n">ghigh</span> <span class="o">-</span> <span class="n">glow</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt; g, glow, ghigh, gamp&#39;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">glow</span><span class="p">,</span> <span class="n">ghigh</span><span class="p">,</span> <span class="n">gamp</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evalx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">evalx</span><span class="p">)</span>
                    <span class="c1">## normEvaluation[g][x] = lowValue + ((evalx-glow)/gamp)*amplitude</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                            <span class="n">sign</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sign</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                        <span class="c1">#normEvaluation[g][x] = (lowValue + ((evalx-glow)/gamp)*amplitude)*sign</span>
                        <span class="n">restoredEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">glow</span> <span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">lowValue</span><span class="p">)</span><span class="o">/</span><span class="n">amplitude</span><span class="p">)</span><span class="o">*</span><span class="n">gamp</span><span class="p">)</span><span class="o">*</span><span class="n">sign</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
                        <span class="n">restoredEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">glow</span><span class="o">+</span> <span class="p">((</span><span class="n">evalx</span><span class="o">-</span><span class="n">lowValue</span><span class="p">)</span><span class="o">/</span><span class="n">amplitude</span><span class="p">)</span><span class="o">*</span><span class="n">gamp</span>
                        
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">],</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> <span class="n">restoredEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">restoredEvaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>
                    
        <span class="k">return</span> <span class="n">restoredEvaluation</span></div>
</div>


<span class="c1">#-----------------------</span>
<div class="viewcode-block" id="EmptyPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.EmptyPerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">EmptyPerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Template for PerformanceTableau objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;PerfTab-template&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="kc">None</span></div>


<span class="c1">#-----------------------</span>
<div class="viewcode-block" id="PartialPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.PartialPerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">PartialPerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for partial performance tableaux concerning a subset of actions and/or criteria and/or objectives</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inPerfTab</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">criteriaSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">objectivesSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="n">RandomCBPerformanceTableau</span><span class="p">,</span>\
                                   <span class="n">Random3ObjectivesPerformanceTableau</span><span class="p">,</span>\
                                   <span class="n">RandomPerformanceTableau</span>
        <span class="k">if</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="p">[</span><span class="n">RandomCBPerformanceTableau</span><span class="p">,</span>
                                   <span class="n">Random3ObjectivesPerformanceTableau</span><span class="p">,</span>
                                   <span class="n">RandomPerformanceTableau</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="c1"># name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;partial-&#39;</span><span class="o">+</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># actions</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsSubset</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="n">actionsTypeStatistics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inPerfTab</span><span class="p">)</span> <span class="o">==</span> <span class="n">RandomCBPerformanceTableau</span><span class="p">:</span>
                <span class="n">xType</span> <span class="o">=</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">inPerfTab</span><span class="p">)</span> <span class="o">==</span> <span class="n">Random3ObjectivesPerformanceTableau</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objectiveSupportingTypes</span> <span class="o">=</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">objectiveSupportingTypes</span>
                <span class="n">xType</span> <span class="o">=</span> <span class="s1">&#39;Soc&#39;</span> <span class="o">+</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">][</span><span class="s1">&#39;Soc&#39;</span><span class="p">]</span>
                <span class="n">xType</span> <span class="o">+=</span> <span class="s1">&#39;Eco&#39;</span> <span class="o">+</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">][</span><span class="s1">&#39;Eco&#39;</span><span class="p">]</span>
                <span class="n">xType</span> <span class="o">+=</span> <span class="s1">&#39;Env&#39;</span> <span class="o">+</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">][</span><span class="s1">&#39;Env&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xType</span> <span class="o">=</span> <span class="s1">&#39;NA&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">actionsTypeStatistics</span><span class="p">[</span><span class="n">xType</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">actionsTypeStatistics</span><span class="p">[</span><span class="n">xType</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsTypeStatistics</span> <span class="o">=</span> <span class="n">actionsTypeStatistics</span>
        
        <span class="c1"># objectives &amp; criteria</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">HasObjectives</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">objectivesSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">objectives</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">objectives</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">HasObjectives</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">criteriaSubset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">criteria</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">HasObjectives</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectives</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaSubset</span><span class="p">:</span>
                    <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
<span class="c1">##                    if HasObjectives:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;objective&#39;</span><span class="p">]</span>
                        <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">criteriaSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">criteriaSubset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objectivesSubset</span><span class="p">:</span>
                <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">])</span>
                <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">inPerfTab</span><span class="o">.</span><span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaSubset</span><span class="p">:</span>
                        <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
                        <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">objectives</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">commonScale</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">commonScale</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OrdinalScales</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">OrdinalScales</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BigData</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">BigData</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">missingDataProbability</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">missingDataProbability</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>
        <span class="c1"># evaluations</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valueDigits</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">valueDigits</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valueDigits</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>
        
        <span class="n">evaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span></div>

        
<span class="c1">#-----------------------</span>
<div class="viewcode-block" id="ConstantPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.ConstantPerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">ConstantPerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for (partially) constant performance tableaux.</span>

<span class="sd">    *Parameter*:</span>
<span class="sd">    </span>
<span class="sd">        * *actionsSubset* selects the actions to be set at equal constant performances,</span>
<span class="sd">        * *criteriaSubset* select the concerned subset of criteria,</span>
<span class="sd">        * The *position* parameter (default = median performance) selects the constant performance in the respective scale of each performance criterion.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inPerfTab</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">criteriaSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">position</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;constant-&#39;</span><span class="o">+</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">name</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsSubset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">criteriaSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">criteriaSubset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">inPerfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>

        <span class="n">actionsKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsSubset</span><span class="p">]</span>
        <span class="n">criteriaKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaSubset</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaKeys</span><span class="p">:</span>
            <span class="n">constantPerformance</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">position</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">constantPerformance</span><span class="p">))</span></div>

                                    
<span class="c1">#-----------------------</span>
<div class="viewcode-block" id="CircularPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.CircularPerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">CircularPerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructor for circular performance tableaux.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">),</span><span class="n">NoPolarisation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="n">RandomPerformanceTableau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;circular-</span><span class="si">%s</span><span class="s1">-PT&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">RandomPerformanceTableau</span><span class="p">(</span><span class="n">numberOfActions</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
                                     <span class="n">numberOfCriteria</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">NoPolarisation</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="n">giThs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]</span>
                <span class="n">giThs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;veto&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">scale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">order</span>
        <span class="n">grades</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">step</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">)]</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
            <span class="n">gi</span> <span class="o">=</span> <span class="n">criteriaList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
                <span class="n">xj</span> <span class="o">=</span> <span class="n">actionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">gi</span><span class="p">][</span><span class="n">xj</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">grades</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
            <span class="n">lastGrade</span> <span class="o">=</span> <span class="n">grades</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">grades</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">lastGrade</span><span class="p">)</span>      </div>

                                    
<span class="c1"># ----------------------</span>
<div class="viewcode-block" id="NormalizedPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.NormalizedPerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">NormalizedPerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    specialsation of the PerformanceTableau class for</span>
<span class="sd">    constructing normalized, 0 - 100, valued PerformanceTableau</span>
<span class="sd">    instances from a given argPerfTab instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">lowValue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">highValue</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">coalition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argPerfTab</span><span class="p">,(</span><span class="nb">str</span><span class="p">)):</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">argPerfTab</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argPerfTab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a valid PerformanceTableau instance is required !&#39;</span><span class="p">)</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>      
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;norm_&#39;</span><span class="o">+</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalizeEvaluations</span><span class="p">(</span><span class="n">lowValue</span><span class="p">,</span><span class="n">highValue</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>        
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]:</span>
                    <span class="n">empan</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="n">intercept</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">empan</span>\
                                <span class="o">*</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">highValue</span><span class="o">-</span><span class="n">lowValue</span><span class="p">)))</span>
                    <span class="n">slope</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">slope</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lowValue</span><span class="p">,</span><span class="n">highValue</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>        </div>


<span class="c1"># ----------------------</span>
<span class="c1">##class QunantizedPerformanceTableau(PerformanceTableau):</span>
<span class="c1">##    &quot;&quot;&quot;</span>
<span class="c1">##    specialsation of the PerformanceTableau class for</span>
<span class="c1">##    constructing quantized valued PerformanceTableau</span>
<span class="c1">##    instances from a given argPerfTab instance.</span>
<span class="c1">##    &quot;&quot;&quot;</span>
<span class="c1">##    def __init__(self,argPerfTab=None,</span>
<span class="c1">##                 criteriaSubset=None,Debug=False):</span>
<span class="c1">##        from copy import deepcopy</span>
<span class="c1">##        from decimal import Decimal</span>
<span class="c1">##        if isinstance(argPerfTab,(str)):</span>
<span class="c1">##            perfTab = PerformanceTableau(argPerfTab)</span>
<span class="c1">##        elif argPerfTab is None:</span>
<span class="c1">##            print(&#39;Error: a valid PerformanceTableau instance is required !&#39;)</span>
<span class="c1">##            perfTab = None</span>
<span class="c1">##        else:</span>
<span class="c1">##            perfTab = argPerfTab      </span>
<span class="c1">##        self.name = &#39;norm_&#39;+ perfTab.name</span>
<span class="c1">##        try:</span>
<span class="c1">##            self.description = deepcopy(perfTab.description)</span>
<span class="c1">##        except:</span>
<span class="c1">##            pass</span>
<span class="c1">##        self.actions = deepcopy(perfTab.actions)</span>
<span class="c1">##        self.criteria = deepcopy(perfTab.criteria)</span>
<span class="c1">##        self.evaluation = deepcopy(perfTab.evaluation)</span>
<span class="c1">##        try:</span>
<span class="c1">##            self.NA = deepcopy(perfTab.NA)</span>
<span class="c1">##        except:</span>
<span class="c1">##            self.NA = Decimal(&#39;-999&#39;)</span>
<span class="c1">##        self.evaluation = self.normalizeEvaluations(lowValue,highValue,Debug)</span>
<span class="c1">##        criteria = self.criteria        </span>
<span class="c1">##        for g in criteria:</span>
<span class="c1">##            if criteria[g][&#39;weight&#39;] &lt; 0:</span>
<span class="c1">##                criteria[g][&#39;weight&#39;] = -criteria[g][&#39;weight&#39;]</span>
<span class="c1">##            try:</span>
<span class="c1">##                for th in criteria[g][&#39;thresholds&#39;]:</span>
<span class="c1">##                    empan = Decimal(str(criteria[g][&#39;scale&#39;][1]-criteria[g][&#39;scale&#39;][0]))</span>
<span class="c1">##                    intercept = criteria[g][&#39;thresholds&#39;][th][0]/empan\</span>
<span class="c1">##                                * (Decimal(str(highValue-lowValue)))</span>
<span class="c1">##                    slope = criteria[g][&#39;thresholds&#39;][th][1]</span>
<span class="c1">##                    criteria[g][&#39;thresholds&#39;][th] = (intercept,slope)</span>
<span class="c1">##            except:</span>
<span class="c1">##                pass</span>
<span class="c1">##            criteria[g][&#39;scale&#39;] = [lowValue,highValue]</span>
<span class="c1">##        self.criteria = criteria        </span>

<span class="c1">###################################</span>
<span class="c1"># Specialisations</span>
<span class="c1">###################################</span>

<div class="viewcode-block" id="XMCDA2PerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.XMCDA2PerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">XMCDA2PerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For reading stored XMCDA 2.0 formatted instances with exact decimal numbers.</span>
<span class="sd">    Using the inbuilt module xml.etree (for Python 2.5+).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        * fileName is given without the extension ``.xml`` or ``.xmcda``,</span>
<span class="sd">        * HasSeparatedWeights in XMCDA 2.0.0 encoding (default = False),</span>
<span class="sd">        * HasSeparatedThresholds in XMCDA 2.0.0 encoding (default = False),</span>
<span class="sd">        * stringInput: instantiates from an XMCDA 2.0 encoded string argument.</span>

<span class="sd">    !! *Obsolete by now* !!</span>
<span class="sd">           </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#from collections import OrderedDict</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">HasSeparatedWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">HasSeparatedThresholds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">stringInput</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="kn">from</span> <span class="nn">xml.etree</span> <span class="kn">import</span> <span class="n">ElementTree</span>
        <span class="k">if</span> <span class="n">stringInput</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.xmcda2&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.xml&#39;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: file </span><span class="si">%s</span><span class="s2">{.xmcda2|.xml} not found !&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="n">stringInput</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: stringInput </span><span class="si">%s</span><span class="s2"> !&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">stringInput</span><span class="p">)))</span>
            
        <span class="n">XMCDA</span> <span class="o">=</span> <span class="n">ElementTree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        <span class="c1"># get name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;projectReference&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;temp&#39;</span>
        <span class="c1"># get description</span>
        <span class="n">description</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#for elem in [x for x in XMCDA.find(&#39;projectReference&#39;).getchildren()]:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;projectReference&#39;</span><span class="p">)]:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;bibliography&#39;</span><span class="p">:</span>
                <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;subSubTitle&#39;</span><span class="p">:</span> <span class="s1">&#39;Bibliography&#39;</span><span class="p">}}</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">bibEntry</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;bibEntry&#39;</span><span class="p">)]:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bibEntry</span><span class="o">.</span><span class="n">text</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">description</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">description</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># get method Parameters</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="p">{}</span>
            
        <span class="k">if</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;methodParameters&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;methodParameters&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">):</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">parameter</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="c1">#print tag,value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># get alternatives&#39; description</span>
        <span class="n">description</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#for elem in [x for x in XMCDA.find(&#39;alternatives&#39;).find(&#39;description&#39;).getchildren()]:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;alternatives&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
            <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsDescription</span> <span class="o">=</span> <span class="n">description</span>
        <span class="c1"># get alternatives</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;alternatives&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;alternative&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">:</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">Active</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">Active</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1">#for elem in [y for y in x.find(&#39;description&#39;).getchildren()]:</span>
                    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
                        <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        
        <span class="k">if</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;objectives&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># objectives are defined</span>
            <span class="n">objectives</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="c1"># get objectives&#39; description</span>
            <span class="k">if</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;objectives&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">description</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="c1">#for elem in [x for x in XMCDA.find(&#39;criteria&#39;).find(&#39;description&#39;).getchildren()]:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
                    <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objectivesDescription</span> <span class="o">=</span> <span class="n">description</span>
            <span class="c1">## get objectives</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;objectives&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;objective&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converting objective </span><span class="si">%s</span><span class="s1"> data&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>             
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">:</span>
                        <span class="n">Active</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Active</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">Active</span><span class="p">:</span>
                    <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="c1">#name</span>
                    <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                    <span class="c1">#description</span>
                    <span class="c1">#for elem in [y for y in obj.find(&#39;description&#39;).getchildren()]:</span>
                    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
                        <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">criteria</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;objectiveCriteria&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">objectives</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;objectiveCriteria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">objectives</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no objectives are given</span>
            <span class="k">pass</span>
        
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># get criteria&#39; description</span>
        <span class="k">if</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1">#for elem in [x for x in XMCDA.find(&#39;criteria&#39;).find(&#39;description&#39;).getchildren()]:</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
                <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteriaDescription</span> <span class="o">=</span> <span class="n">description</span>
        <span class="c1">## get criteria</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;criterion&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converting criterion </span><span class="si">%s</span><span class="s1"> data&#39;</span> <span class="o">%</span> <span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>             
                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span><span class="p">:</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">Active</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">Active</span><span class="p">:</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="c1">#name</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="c1">#description</span>
                <span class="c1">#for elem in [y for y in g.find(&#39;description&#39;).getchildren()]:</span>
                <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
                    <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;objective&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionObjective&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="c1">#prefrenceDirection</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;quantitative&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                <span class="c1">#scale</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;quantitative&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;minimum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;quantitative&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;maximum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Min</span><span class="p">,</span><span class="n">Max</span><span class="p">)</span>
                <span class="c1">##criteria[g.attrib[&#39;id&#39;]][&#39;scale&#39;] = (Min*pdir,Max*pdir)</span>
                <span class="c1">#weights</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">HasSeparatedWeights</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">cv</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionValue&#39;</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">HasSeparatedWeights</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1">#thresholds</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">HasSeparatedThresholds</span><span class="p">:</span>                    
                    <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">):</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;intercept&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                                <span class="k">except</span><span class="p">:</span>
                                    <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;intercept&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                                <span class="n">slope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;slope&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                                <span class="k">except</span><span class="p">:</span>
                                    <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                                <span class="n">slope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
                            <span class="c1">## criteria[g.attrib[&#39;id&#39;]][&#39;thresholds&#39;][th.attrib[&#39;id&#39;]] = (intercept,pdir*slope)</span>
                            <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">slope</span><span class="p">)</span>


        <span class="c1"># get separated criteria weights</span>
        <span class="k">if</span> <span class="n">HasSeparatedWeights</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criteriaValues&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;criterionValue&#39;</span><span class="p">):</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">criteria</span><span class="p">[</span><span class="n">cv</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

        <span class="c1"># get separated criteria thresholds</span>
        <span class="k">if</span> <span class="n">HasSeparatedThresholds</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cth</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criteriaThresholds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;criterionThresholds&#39;</span><span class="p">):</span>
                    <span class="n">g</span> <span class="o">=</span> <span class="n">cth</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                    <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">cth</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;thresholds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;intercept&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;intercept&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                            <span class="n">slope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;slope&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="n">intercept</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">th</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                            <span class="n">slope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
                        <span class="c1">## criteria[g][&#39;thresholds&#39;][th.attrib[&#39;id&#39;]] = (intercept,pdir*slope)</span>
                        <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">slope</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># allocate final criteria dictionary        </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
                    
        <span class="c1"># get coalitions</span>
        

        
        <span class="c1"># get evaluations&#39; description</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">NA</span>
        <span class="n">description</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#for elem in [x for x in XMCDA.find(&#39;performanceTable&#39;).find(&#39;description&#39;).getchildren()]:</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;performanceTable&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">)]:</span>
            <span class="n">description</span><span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluationDescription</span> <span class="o">=</span> <span class="n">description</span>
        <span class="c1"># get evaluations</span>
        <span class="n">evaluationAP</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">XMCDA</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;performanceTable&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;alternativePerformances&#39;</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;alternativeID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
            <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;performance&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                    <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">]</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                        <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">]</span><span class="o">=</span><span class="n">Decimal</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;criterionID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">]</span><span class="o">=</span><span class="n">NA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluationAP</span> <span class="o">=</span> <span class="n">evaluationAP</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
                        <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">pdir</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">*</span> <span class="n">pdir</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluationAP</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">g</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># compute weigth preoder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span></div>


<span class="c1">###########</span>
<div class="viewcode-block" id="CSVPerformanceTableau">
<a class="viewcode-back" href="../techDoc.html#perfTabs.CSVPerformanceTableau">[docs]</a>
<span class="k">class</span> <span class="nc">CSVPerformanceTableau</span><span class="p">(</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reading stored CSV encoded actions x criteria PerformanceTableau instances, Using the inbuilt module csv.</span>

<span class="sd">    Param:</span>
<span class="sd">        fileName (without the extension .csv).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">csv</span> <span class="kn">import</span> <span class="n">reader</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">csvReader</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span>
            <span class="n">csvText</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">csvReader</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="n">csvText</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: File </span><span class="si">%s</span><span class="s2">.csv not found !!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="s1">&#39;CSV PerformanceTableau input method.&#39;</span>
        <span class="c1"># actions dictionary</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvText</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">csvText</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">csvText</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">csvText</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;comment&#39;</span><span class="p">:</span><span class="s1">&#39;potential decision action&#39;</span><span class="p">})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="c1"># objectives dictionary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># criteria dictionary</span>
        <span class="n">ng</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">csvText</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ng</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],{</span><span class="s1">&#39;comment&#39;</span><span class="p">:</span><span class="s1">&#39;performance criteria&#39;</span><span class="p">})</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ng</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>

        <span class="c1"># criteria attributes</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ng</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>          
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weightPreorder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeightPreorder</span><span class="p">()</span>
 
        <span class="c1"># evaluation tableau</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ng</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">na</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">evaluation</span><span class="p">[</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">csvText</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="n">csvText</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-999&#39;</span><span class="p">)</span>

        <span class="c1"># close input file</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<span class="c1">#----------test Digraph class ----------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    
    <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">perfTabs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">import</span> <span class="nn">sortingDigraphs</span>
    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
    <span class="kn">import</span> <span class="nn">random</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Digraph3 perfTabs module                         *</span>
<span class="s2">    * Copyright (C) 2011-2021 Raymond Bisdorff         *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Testing classes and methods -------&#39;</span><span class="p">)</span>
    
    <span class="n">randomSeed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1">##    t = CircularPerformanceTableau(order=7)</span>
<span class="c1">##    t.showPerformanceTableau()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">RandomCBPerformanceTableau</span><span class="p">(</span><span class="n">numberOfCriteria</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
                                   <span class="n">numberOfActions</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                   <span class="n">weightDistribution</span><span class="o">=</span><span class="s1">&#39;equiobjectives&#39;</span><span class="p">,</span>
                                   <span class="n">IntegerWeights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">NegativeWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">missingDataProbability</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                                   <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                   <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="n">Correlations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">colorLevels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">SparseModel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span><span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">outrankingModel</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span>
                                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># ##    t.showHTMLPerformanceHeatmap(outrankingModel=&#39;this&#39;,</span>
<span class="c1"># ##                                   Correlations=True,colorLevels=5,</span>
<span class="c1"># ##                                rankingRule=&#39;NetFlows&#39;,Transposed=False)</span>
<span class="c1">#     t.showHTMLPerformanceHeatmap(outrankingModel=&#39;confident&#39;,</span>
<span class="c1">#                                  Correlations=True,colorLevels=5,</span>
<span class="c1">#                                  rankingRule=&#39;NetFlows&#39;,Transposed=False)</span>
<span class="c1">#     t.showHTMLPerformanceHeatmap(outrankingModel=&#39;robust&#39;,</span>
<span class="c1">#                                  Correlations=True,colorLevels=5,</span>
<span class="c1">#                                  rankingRule=&#39;NetFlows&#39;,Transposed=False)</span>

<span class="c1">#     g = RobustOutrankingDigraph(t)</span>
<span class="c1">#     g.showHTMLPerformanceHeatmap(outrankingModel=&#39;this&#39;,</span>
<span class="c1">#                                    Correlations=True,colorLevels=5,</span>
<span class="c1">#                                  rankingRule=&#39;NetFlows&#39;,Transposed=False)    </span>
<span class="c1">#     t.save(&#39;testow&#39;)</span>
<span class="c1">#     t1 = PerformanceTableau(&#39;testow&#39;)</span>
<span class="c1">#     t1.showObjectives()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*************************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* R.B. August 2015                  *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* $Revision: Python3.9 $            *&#39;</span><span class="p">)</span>                   
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*************************************&#39;</span><span class="p">)</span>

<span class="c1">#############################</span>
<span class="c1"># Log record for changes:</span>
<span class="c1"># $Log: perfTabs.py,v $</span>
<span class="c1"># Revision 1.37  2012/12/24 15:18:21</span>
<span class="c1"># compatibility patch for old (-2008) python performance tableaux</span>
<span class="c1">#############################</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2025, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Mar 21, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>