<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sparseOutrankingDigraphs &mdash; Digraph3 3.12.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.custom.css?v=7bc2f056" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster.bundle.min.css?v=37217874" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-shadow.min.css?v=6227e517" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-punk.min.css?v=94669e23" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-noir.min.css?v=21a39f42" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-light.min.css?v=a18b2449" />
      <link rel="stylesheet" type="text/css" href="../_static/css/tooltipster-sideTip-borderless.min.css?v=dbff53e4" />
      <link rel="stylesheet" type="text/css" href="../_static/css/micromodal.css?v=d7bf34ee" />
      <link rel="stylesheet" type="text/css" href="../_static/css/sphinx_rtd_theme.css?v=3234e928" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=e70b10b9"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=15d7cbb8"></script>
        <script src="../_static/js/hoverxref.js?v=82c55261"></script>
        <script src="../_static/js/tooltipster.bundle.min.js?v=18bf091b"></script>
        <script src="../_static/js/micromodal.min.js?v=04d6302d"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                Python 3.12
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">sparseOutrankingDigraphs</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sparseOutrankingDigraphs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Digraph3 collection of python3 modules for Algorithmic Decision Theory applications</span>

<span class="sd">Module for sparse outranking digraph model implementations </span>

<span class="sd">Copyright (C) 2016-2023 Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR ANY PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along</span>
<span class="sd">    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="sd">    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#####################################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.10&quot;</span>

<span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sortingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span> <span class="nn">sparseOutrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="SparseOutrankingDigraph">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">SparseOutrankingDigraph</span><span class="p">(</span><span class="n">BipolarOutrankingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract root class for linearly decomposed sparse digraphs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Abstract root class&#39;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default presentation method for pre-ranked sparse digraphs instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="s1">&#39;*----- Object instance description ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class    : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name     : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Actions           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Criteria          : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Sorting by        : </span><span class="si">%d</span><span class="s1">-Tiling</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Ordering strategy : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Ranking rule      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Components        : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Minimal order     : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Maximal order     : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximalComponentSize</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Average order     : </span><span class="si">%.1f</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;fill rate         : </span><span class="si">%.3f%%</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fillRate</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes        : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;----  Constructor run times (in sec.) ----</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Threads           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Threads           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Start method      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Start method      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Total time        : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Data imput        : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;QuantilesSorting  : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Preordering       : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">]</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Decomposing       : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Ordering          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">reprString</span>

<div class="viewcode-block" id="SparseOutrankingDigraph.relation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.relation">[docs]</a>
    <span class="k">def</span> <span class="nf">relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dynamic construction of the global outranking characteristic function *r(x S y)*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Med</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span>
        <span class="n">cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span>
        <span class="c1">#print(x,cx,y,cy)</span>
        <span class="k">if</span> <span class="n">cx</span> <span class="o">==</span> <span class="n">cy</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cx</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cx</span><span class="p">][</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cy</span><span class="p">][</span><span class="s1">&#39;rank&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">Min</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Max</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.computeDeterminateness">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.computeDeterminateness">[docs]</a>
    <span class="k">def</span> <span class="nf">computeDeterminateness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Kendalll distance in % of self</span>
<span class="sd">        with the all median valued (indeterminate) digraph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">deter</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">deter</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">Med</span><span class="p">)</span>
        <span class="n">deter</span> <span class="o">=</span> <span class="p">(</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">deter</span><span class="p">))</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">order</span> <span class="o">*</span> <span class="p">(</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">deter</span><span class="o">/</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Max</span><span class="o">-</span><span class="n">Med</span><span class="p">)))</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.computeOrderCorrelation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.computeOrderCorrelation">[docs]</a>
    <span class="k">def</span> <span class="nf">computeOrderCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the ordinal correlation K of a sparse digraph instance</span>
<span class="sd">        when compared with a given linear order (from worst to best) of its actions</span>

<span class="sd">        K = sum_{x != y} [ min( max(-self.relation(x,y)),other.relation(x,y), max(self.relation(x,y),-other.relation(x,y)) ]</span>

<span class="sd">        K /= sum_{x!=y} [ min(abs(self.relation(x,y),abs(other.relation(x,y)) ]</span>

<span class="sd">        .. note::</span>

<span class="sd">             Renders a dictionary with the key &#39;correlation&#39; containing the actual bipolar correlation index and the key &#39;determination&#39; containing the minimal determination level D of self and the other relation.</span>

<span class="sd">             D = sum_{x != y} min(abs(self.relation(x,y)),abs(other.relation(x,y)) / n(n-1)</span>

<span class="sd">             where n is the number of actions considered.</span>

<span class="sd">             The correlation index with a completely indeterminate relation</span>
<span class="sd">             is by convention 0.0 at determination level 0.0 .</span>

<span class="sd">        .. warning::</span>

<span class="sd">             self must be a normalized outranking digraph instance !</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">selfMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">selfMax</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: self&#39;s valuationdomain  must be normalized !&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="n">corrSum</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">determSum</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># x &lt; y</span>
                <span class="n">selfRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="n">otherRelation</span> <span class="o">=</span> <span class="o">-</span><span class="n">selfMax</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">selfRelation</span><span class="p">,</span><span class="n">otherRelation</span><span class="p">),</span>
                            <span class="nb">max</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">,</span><span class="o">-</span><span class="n">otherRelation</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">corrSum</span> <span class="o">+=</span> <span class="n">corr</span>
                <span class="n">determ</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">otherRelation</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">determSum</span> <span class="o">+=</span> <span class="n">determ</span>
                <span class="c1"># y &gt; x</span>
                <span class="n">selfRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
                <span class="n">otherRelation</span> <span class="o">=</span> <span class="n">selfMax</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">selfRelation</span><span class="p">,</span><span class="n">otherRelation</span><span class="p">),</span>
                            <span class="nb">max</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">,</span><span class="o">-</span><span class="n">otherRelation</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">corrSum</span> <span class="o">+=</span> <span class="n">corr</span>
                <span class="n">determ</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">otherRelation</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">determSum</span> <span class="o">+=</span> <span class="n">determ</span>

        <span class="k">if</span> <span class="n">determSum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">correlation</span> <span class="o">=</span> <span class="n">corrSum</span> <span class="o">/</span> <span class="n">determSum</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
            <span class="n">determination</span> <span class="o">=</span> <span class="n">determSum</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span>
            <span class="n">determination</span> <span class="o">/=</span> <span class="n">selfMax</span>

            <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;correlation&#39;</span><span class="p">:</span> <span class="n">correlation</span><span class="p">,</span>\
                     <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="n">determination</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;correlation&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>\
                     <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="mf">0.0</span> <span class="p">}</span></div>


    <span class="k">def</span> <span class="nf">estimateRankingCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sampleSize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">,</span><span class="n">sampleSize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
        <span class="n">preRankedSample</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sample</span><span class="p">:</span>
                <span class="n">preRankedSample</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">preRankedSample</span><span class="p">)</span>
        <span class="n">ptp</span> <span class="o">=</span> <span class="n">PartialPerformanceTableau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
        <span class="n">pg</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">ptp</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">preRankedSample</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corr</span>

<div class="viewcode-block" id="SparseOutrankingDigraph.sortingRelation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.sortingRelation">[docs]</a>
    <span class="k">def</span> <span class="nf">sortingRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dynamic construction of the quantiles sorting characteristic function *r(x QS y)*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Med</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span>
        <span class="n">cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span>
        <span class="c1">#print(x,cx,y,cy)</span>
        <span class="k">if</span> <span class="n">cx</span> <span class="o">==</span> <span class="n">cy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Med</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cx</span><span class="p">][</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cy</span><span class="p">][</span><span class="s1">&#39;rank&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">Min</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Max</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.showRelationMap">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showRelationMap">[docs]</a>
    <span class="k">def</span> <span class="nf">showRelationMap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints on the console, in text map format, the location of</span>
<span class="sd">        the diagonal outranking components of the sparse outranking digraph.</span>

<span class="sd">        By default, symbols = {&#39;max&#39;:&#39;┬&#39;,&#39;positive&#39;: &#39;+&#39;, &#39;median&#39;: &#39; &#39;,</span>
<span class="sd">                               &#39;negative&#39;: &#39;-&#39;, &#39;min&#39;: &#39;┴&#39;}</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; from sparseOutrankingDigraphs import *</span>
<span class="sd">            &gt;&gt;&gt; t = RandomCBPerformanceTableau(numberOfActions=50,seed=1)</span>
<span class="sd">            &gt;&gt;&gt; bg = PreRankedOutrankingDigraph(t,quantiles=10,minimalComponentSize=5)</span>
<span class="sd">            &gt;&gt;&gt; print(bg)</span>
<span class="sd">            *----- show short --------------*</span>
<span class="sd">            Instance name     : randomCBperftab_mp</span>
<span class="sd">            # Actions         : 50</span>
<span class="sd">            # Criteria        : 7</span>
<span class="sd">            Sorting by        : 10-Tiling</span>
<span class="sd">            Ordering strategy : average</span>
<span class="sd">            Ranking Rule      : Copeland</span>
<span class="sd">            # Components      : 7</span>
<span class="sd">            Minimal size      : 5</span>
<span class="sd">            Maximal size      : 13</span>
<span class="sd">            Median size       : 6</span>
<span class="sd">            fill rate         : 16.898%</span>
<span class="sd">            ----  Constructor run times (in sec.) ----</span>
<span class="sd">            Total time        : 0.08494</span>
<span class="sd">            QuantilesSorting  : 0.04339</span>
<span class="sd">            Preordering       : 0.00034</span>
<span class="sd">            Decomposing       : 0.03989</span>
<span class="sd">            Ordering          : 0.00024</span>
<span class="sd">            &gt;&gt;&gt; bg.showRelationMap()</span>
<span class="sd">             ┬+++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴ ++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">             + ++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            --- -┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            -┴-+ ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴ ┬-+┬+┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴   +┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴+  +  ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴-+- ++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴  + ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴   -  ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴ +++-+++++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴+ +++++++++-+┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴+- +--+++++++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴--+ -++++++-+┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴++++ +-   ++ ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴--+-+ +++++++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴-+-++- ++++--┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴-++-++- + -+-┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴---- ++- + ++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴-+--++++- -++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴--- --+++ ++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴+-+-++-+-+ +┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴-+- -+++-++ ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴  -  + + ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴  -+ + ++┬++┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴++ +++++++++┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴ -- -+-++  ┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴++++ ++++++-┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴----- ++-┬+┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴  +++- -++-+┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴-----++ -++┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴ +-+-+-+ -++┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴+   +++ ┬+┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴-- --+++  -┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴--┴+ -┴--+ ┬┬┬┬┬┬┬┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴ +++++++┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴+ +++-+┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴--  +++┬┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴--    ++┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴+-+  +++┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴ +- + --┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴---+++ +┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴- ┴-+++ ┬┬┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴  ┬┬┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴  ++ ┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴ - -┬┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴ -+  ┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴  ┴  ┬</span>
<span class="sd">            ┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴┴</span>
<span class="sd">            Component ranking rule: Copeland</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">symbols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">symbols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="s1">&#39;┬&#39;</span><span class="p">,</span><span class="s1">&#39;positive&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
                       <span class="s1">&#39;negative&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="s1">&#39;┴&#39;</span><span class="p">}</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">actionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="n">actionsList</span>
        <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">[</span><span class="n">fromIndex</span><span class="p">:</span><span class="n">toIndex</span><span class="p">]:</span>
            <span class="n">pictStr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ranking</span><span class="p">[</span><span class="n">fromIndex</span><span class="p">:</span><span class="n">toIndex</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">Max</span><span class="p">:</span>
                    <span class="n">pictStr</span> <span class="o">+=</span> <span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">Min</span><span class="p">:</span>
                    <span class="n">pictStr</span> <span class="o">+=</span> <span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">pictStr</span> <span class="o">+=</span> <span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span><span class="n">Med</span><span class="p">:</span>
                    <span class="n">pictStr</span> <span class="o">+=</span> <span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">pictStr</span> <span class="o">+=</span> <span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pictStr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Component ranking rule: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;List of actions provided.&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.showHTMLMarginalQuantileLimits">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showHTMLMarginalQuantileLimits">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLMarginalQuantileLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the marginal quantiles limits.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="n">catKey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span><span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> \
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">catKey</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showHTMLPerformanceTableau</span><span class="p">(</span><span class="n">actionsSubset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">,</span>
                                        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Marginal performance quantiles&#39;</span><span class="p">,</span>
                                        <span class="n">htmlFileName</span><span class="o">=</span><span class="n">htmlFileName</span><span class="p">)</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.showHTMLRelationMap">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showHTMLRelationMap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLRelationMap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">Colored</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">tableTitle</span><span class="o">=</span><span class="s1">&#39;Relation Map&#39;</span><span class="p">,</span>
                            <span class="n">relationName</span><span class="o">=</span><span class="s1">&#39;r(x S y)&#39;</span><span class="p">,</span>
                            <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;middot;&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;nbsp;&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;#150;&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;#151;&#39;</span><span class="p">],</span>
                            <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launches a browser window with the colored relation map of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">htmlRelationMap</span><span class="p">(</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                        <span class="n">Colored</span><span class="o">=</span><span class="n">Colored</span><span class="p">,</span>
                                        <span class="n">tableTitle</span><span class="o">=</span><span class="n">tableTitle</span><span class="p">,</span>
                                        <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">,</span>
                                        <span class="n">ContentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">relationName</span><span class="o">=</span><span class="n">relationName</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_showHTMLRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not yet availbale !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Method not yet implemented for This class of digraphs!&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Try instead: self.showRelationTable()&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="SparseOutrankingDigraph.showHTMLRelationTable">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showHTMLRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="c1">#relation=None,</span>
                              <span class="n">IntegerValues</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">Colored</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">tableTitle</span><span class="o">=</span><span class="s1">&#39;Valued Sparse Relation Table&#39;</span><span class="p">,</span>
                              <span class="n">relationName</span><span class="o">=</span><span class="s1">&#39;r(x,y)&#39;</span><span class="p">,</span>
                              <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launches a browser window with the colored relation table of self.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_htmlRelationTable</span><span class="p">(</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                                         <span class="c1">#relation=relation,</span>
                                         <span class="n">isColored</span><span class="o">=</span><span class="n">Colored</span><span class="p">,</span>
                                         <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span>
                                         <span class="n">hasIntegerValues</span><span class="o">=</span><span class="n">IntegerValues</span><span class="p">,</span>
                                         <span class="n">tableTitle</span><span class="o">=</span><span class="n">tableTitle</span><span class="p">,</span>
                                         <span class="n">relationName</span><span class="o">=</span><span class="n">relationName</span><span class="p">,</span>
                                         <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="n">ReflexiveTerms</span><span class="p">,</span>
                                         <span class="n">fromIndex</span><span class="o">=</span><span class="n">fromIndex</span><span class="p">,</span>
                                         <span class="n">toIndex</span><span class="o">=</span><span class="n">toIndex</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>     </div>

        
    <span class="k">def</span> <span class="nf">_htmlRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tableTitle</span><span class="o">=</span><span class="s1">&#39;Valued Sparse Relation Table&#39;</span><span class="p">,</span>
                           <span class="c1">#relation=None,</span>
                           <span class="n">relationName</span><span class="o">=</span><span class="s1">&#39;r(x,y)&#39;</span><span class="p">,</span>
                           <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">hasIntegerValues</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">actionsSubset</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">isColored</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the relation valuation in actions X actions html table format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">actionsSubset</span>
        <span class="c1">#if relation is None:</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>   <span class="c1"># dynamic function</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="n">tableTitle</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table border=&quot;1&quot;&gt;&#39;</span>
        <span class="k">if</span> <span class="n">isColored</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">relationName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">relationName</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fromIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fromIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">toIndex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">)</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">[</span><span class="n">fromIndex</span><span class="p">:</span><span class="n">toIndex</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">frozenset</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">)]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)]</span>
<span class="c1">##        if actionsSubset is None:</span>
<span class="c1">##            actionsList.sort()</span>
        <span class="c1">#print actionsList</span>
        <span class="c1">#actionsList.sort()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hasIntegerValues</span><span class="p">:</span> 
            <span class="k">try</span><span class="p">:</span>
                <span class="n">hasIntegerValuation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">hasIntegerValuation</span> <span class="o">=</span> <span class="n">hasIntegerValues</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hasIntegerValuation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hasIntegerValuation</span> <span class="o">=</span> <span class="n">hasIntegerValues</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hasIntegerValuation</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">isColored</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span>
            <span class="k">if</span> <span class="n">isColored</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ReflexiveTerms</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">isColored</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                                    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                        <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                                    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                        <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                        <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ndigitsFormat</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">2.</span><span class="si">%d</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                            <span class="k">if</span> <span class="n">isColored</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                                    <span class="n">formatStr</span> \
                                    <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                        <span class="o">%</span> <span class="n">ndigitsFormat</span> 
                                    <span class="n">s</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                                    <span class="n">formatStr</span> \
                                    <span class="o">=</span> <span class="s1">&#39;&lt;td  bgcolor=&quot;#ffddff&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                        <span class="o">%</span> <span class="n">ndigitsFormat</span>
                                    <span class="n">s</span> <span class="o">+=</span>  <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">formatStr</span> \
                                    <span class="o">=</span> <span class="s1">&#39;&lt;td  bgcolor=&quot;#dddddd&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                    <span class="o">%</span> <span class="n">ndigitsFormat</span>
                                    <span class="n">s</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">formatStr</span> <span class="o">=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">ndigitsFormat</span>
                                <span class="n">s</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#eeeeee&quot; align=&quot;center&quot;&gt; &amp;ndash; &lt;/td&gt;&#39;</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span>
                    <span class="n">cy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">cx</span> <span class="o">==</span> <span class="n">cy</span> <span class="ow">and</span> <span class="n">isColored</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                    <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffddff&quot;  align=&quot;right&quot;&gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                    <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#dddddd&quot; align=&quot;right&quot; &gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                    <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                        <span class="k">elif</span> <span class="n">isColored</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#edf5c4&quot; align=&quot;right&quot; &gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%d</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ndigitsFormat</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1">2.</span><span class="si">%d</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                        <span class="k">if</span> <span class="n">cx</span> <span class="o">==</span> <span class="n">cy</span> <span class="ow">and</span> <span class="n">isColored</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                                <span class="n">formatStr</span> \
                                    <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                         <span class="o">%</span> <span class="n">ndigitsFormat</span> 
                                <span class="n">s</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">elif</span> <span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                                <span class="n">formatStr</span> \
                                    <span class="o">=</span> <span class="s1">&#39;&lt;td  bgcolor=&quot;#ffddff&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                         <span class="o">%</span> <span class="n">ndigitsFormat</span>
                                <span class="n">s</span> <span class="o">+=</span>  <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">formatStr</span> \
                                    <span class="o">=</span> <span class="s1">&#39;&lt;td  bgcolor=&quot;#dddddd&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                         <span class="o">%</span> <span class="n">ndigitsFormat</span>
                                <span class="n">s</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="k">elif</span> <span class="n">isColored</span><span class="p">:</span>
                            <span class="n">formatStr</span> <span class="o">=</span> <span class="s1">&#39;&lt;td  bgcolor=&quot;#fffbde&quot; align=&quot;right&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> \
                                <span class="o">%</span> <span class="n">ndigitsFormat</span>
                            <span class="n">s</span> <span class="o">+=</span>  <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">formatStr</span> <span class="o">=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">ndigitsFormat</span>
                            <span class="n">s</span> <span class="o">+=</span> <span class="n">formatStr</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
        <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;p&gt;Valuation domain: [</span><span class="si">%d</span><span class="s1">; </span><span class="si">%+d</span><span class="s1">]&lt;/p&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Min</span><span class="p">,</span><span class="n">Max</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;p&gt;Valuation domain: [</span><span class="si">%.2f</span><span class="s1">; </span><span class="si">%+.2f</span><span class="s1">]&lt;/p&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Min</span><span class="p">,</span><span class="n">Max</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">s</span>

        
<div class="viewcode-block" id="SparseOutrankingDigraph.htmlRelationMap">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.htmlRelationMap">[docs]</a>
    <span class="k">def</span> <span class="nf">htmlRelationMap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">tableTitle</span><span class="o">=</span><span class="s1">&#39;Relation Map&#39;</span><span class="p">,</span>
                          <span class="n">relationName</span><span class="o">=</span><span class="s1">&#39;r(x R y)&#39;</span><span class="p">,</span>
                          <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;middot;&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;nbsp;&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">],</span>
                          <span class="n">Colored</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">ContentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the relation map in actions X actions html table format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">actionsSubset</span>

        <span class="n">s</span>  <span class="o">=</span> <span class="s1">&#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;Digraph3 relation map&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">ContentCentered</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;td {text-align: center;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;td.na {color: rgb(192,192,192);}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/style&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/head&gt;</span><span class="se">\n</span><span class="s1">&lt;body&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="n">tableTitle</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table border=&quot;0&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">Colored</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">relationName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">relationName</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Colored</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th</span><span class="se">\n</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span>
            <span class="k">if</span> <span class="n">Colored</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Colored</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">Max</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#66ff66&quot;&gt;&lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">Min</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ff6666&quot;&gt;&lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;&lt;/td</span><span class="se">\n</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffdddd&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffffff&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">Max</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">Min</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;&lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># legend</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;span style=&quot;font-size: 100%&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th align=&quot;left&quot; colspan=&quot;5&quot;&gt;Ranking rules:&lt;/th&gt;&lt;td align=&quot;left&quot; colspan=&quot;5&quot;&gt;</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1"> quantile ordering&lt;/td&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>\
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th align=&quot;left&quot; colspan=&quot;10&quot;&gt;&lt;i&gt;Symbol legend&lt;/i&gt;&lt;/th&gt;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span>
        <span class="k">if</span> <span class="n">Colored</span><span class="p">:</span>
            <span class="n">s</span> \
            <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#66ff66&quot; align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;certainly valid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ddffdd&quot; align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;valid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;indeterminate&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ffdddd&quot; align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;invalid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">s</span> \
        <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=&quot;#ff6666&quot; align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;certainly invalid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> \
            <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;certainly valid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;valid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;indeterminate&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;invalid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;td&gt;certainly invalid&lt;/td&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/span&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># html footer</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/body&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/html&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.computeOrdinalCorrelation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.computeOrdinalCorrelation">[docs]</a>
    <span class="k">def</span> <span class="nf">computeOrdinalCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the ordinal correlation K of a SpareOutrakingDigraph instance</span>
<span class="sd">        when compared with a given compatible (same actions set) other Digraph instance.</span>

<span class="sd">        K = sum_{x != y} [ min( max(-self.relation(x,y)),other.relation(x,y), max(self.relation(x,y),-other.relation(x,y)) ]</span>

<span class="sd">        K /= sum_{x!=y} [ min(abs(self.relation(x,y),abs(other.relation(x,y)) ]</span>

<span class="sd">        .. note::</span>

<span class="sd">             The global outranking relation of SparesOutrankingDigraph instances is contructed on the fly</span>
<span class="sd">             from the ordered dictionary of the components.</span>

<span class="sd">             Renders a dictionary with a &#39;correlation&#39; key containing the actual bipolar correlation index K and a &#39;determination&#39; key containing the minimal determination level D of self and the other relation, where</span>

<span class="sd">             D = sum_{x != y} min(abs(self.relation(x,y)),abs(other.relation(x,y)) / n(n-1)</span>

<span class="sd">             and where n is the number of actions considered.</span>

<span class="sd">             The correlation index K with a completely indeterminate relation</span>
<span class="sd">             is by convention 0.0 at determination level 0.0 .</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the BigDigraph instance must be normalized !!&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,(</span><span class="n">Digraph</span><span class="p">)):</span>
            <span class="c1"># if Debug:</span>
            <span class="c1">#     print(&#39;other is a Digraph instance&#39;)</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the other digraph must be normalized !!&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,(</span><span class="n">BigDigraph</span><span class="p">)):</span>
            <span class="c1"># if Debug:</span>
            <span class="c1">#     print(&#39;other is a BigDigraph instance&#39;)</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the other bigDigraph instance must be normalized !!&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="n">correlation</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">determination</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">selfRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">otherRelation</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">relation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">otherRelation</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
                        <span class="c1">#if Debug:</span>
                        <span class="c1">#    print(x,y,&#39;self&#39;, selfRelation)</span>
                        <span class="c1">#    print(x,y,&#39;other&#39;, otherRelation)</span>
                    <span class="n">corr</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">selfRelation</span><span class="p">,</span><span class="n">otherRelation</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">,</span><span class="o">-</span><span class="n">otherRelation</span><span class="p">)</span> <span class="p">)</span>
                    <span class="n">correlation</span> <span class="o">+=</span> <span class="n">corr</span>
                    <span class="n">determination</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span> <span class="nb">abs</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">otherRelation</span><span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span> <span class="n">determination</span> <span class="o">&gt;</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">):</span>
            <span class="n">correlation</span> <span class="o">/=</span> <span class="n">determination</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;correlation&#39;</span><span class="p">:</span> <span class="n">correlation</span><span class="p">,</span>\
                     <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="n">determination</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;correlation&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">),</span>\
                    <span class="s1">&#39;determination&#39;</span><span class="p">:</span> <span class="n">determination</span><span class="p">}</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.showDecomposition">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showDecomposition">[docs]</a>
    <span class="k">def</span> <span class="nf">showDecomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;decreasing&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints on the console the decomposition structure of the sparse outranking digraph instance</span>
<span class="sd">        in *decreasing* (default) or *increasing* preference direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Relation decomposition in </span><span class="si">%s</span><span class="s1"> order---*&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">compKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">compKey</span> <span class="k">for</span> <span class="n">compKey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">!=</span> <span class="s1">&#39;increasing&#39;</span><span class="p">:</span>
            <span class="n">compKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">compKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">compKey</span> <span class="ow">in</span> <span class="n">compKeys</span><span class="p">:</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">]</span>
            <span class="n">sg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sg</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">compKey</span><span class="p">,</span><span class="n">actions</span><span class="p">))</span></div>



<div class="viewcode-block" id="SparseOutrankingDigraph.computeDecompositionSummaryStatistics">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.computeDecompositionSummaryStatistics">[docs]</a>
    <span class="k">def</span> <span class="nf">computeDecompositionSummaryStatistics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the summary of the distribution of the length of</span>
<span class="sd">        the components as follows::</span>

<span class="sd">            summary = {&#39;max&#39;: maxLength,</span>
<span class="sd">                       &#39;median&#39;:medianLength,</span>
<span class="sd">                       &#39;mean&#39;:meanLength,</span>
<span class="sd">                       &#39;stdev&#39;: stdLength,</span>
<span class="sd">                       &#39;fillrate&#39;: fillrate,</span>
<span class="sd">                                  (see computeFillRate()}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">statistics</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error importing the statistics module.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You need to upgrade your Python to version 3.4+ !&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span>
        <span class="n">compLengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">order</span>\
                       <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        <span class="n">medianLength</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">compLengths</span><span class="p">)</span>
        <span class="n">stdLength</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">pstdev</span><span class="p">(</span><span class="n">compLengths</span><span class="p">)</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
                   <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span><span class="p">,</span>
                   <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximalComponentSize</span><span class="p">,</span>
                   <span class="s1">&#39;median&#39;</span><span class="p">:</span><span class="n">medianLength</span><span class="p">,</span>
                   <span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">/</span><span class="n">nc</span><span class="p">,</span>
                   <span class="s1">&#39;stdev&#39;</span><span class="p">:</span> <span class="n">stdLength</span><span class="p">,</span>
                   <span class="s1">&#39;fillrate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillRate</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">summary</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.recodeValuation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.recodeValuation">[docs]</a>
    <span class="k">def</span> <span class="nf">recodeValuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">newMin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">newMax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialization for recoding the valuation of all the partial digraphs and the component relation.</span>
<span class="sd">        By default the valuation domain is normalized to [-1;1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># saving old and new valuation domain</span>
        <span class="n">oldMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">oldMin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">oldMed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">oldAmplitude</span> <span class="o">=</span> <span class="n">oldMax</span> <span class="o">-</span> <span class="n">oldMin</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">oldMin</span><span class="p">,</span> <span class="n">oldMed</span><span class="p">,</span> <span class="n">oldMax</span><span class="p">,</span> <span class="n">oldAmplitude</span><span class="p">)</span>
        <span class="n">newMin</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">newMin</span><span class="p">))</span>
        <span class="n">newMax</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">newMax</span><span class="p">))</span>
        <span class="n">newMed</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">newMax</span> <span class="o">+</span> <span class="n">newMin</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)))</span>
        <span class="n">newAmplitude</span> <span class="o">=</span> <span class="n">newMax</span> <span class="o">-</span> <span class="n">newMin</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">newMin</span><span class="p">,</span> <span class="n">newMed</span><span class="p">,</span> <span class="n">newMax</span><span class="p">,</span> <span class="n">newAmplitude</span><span class="p">)</span>
        <span class="c1"># loop over all components</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recoding the valuation of a BigDigraph instance&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cki</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cki</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="n">newMin</span><span class="o">=</span><span class="n">newMin</span><span class="p">,</span><span class="n">newMax</span><span class="o">=</span><span class="n">newMax</span><span class="p">)</span>
       <span class="c1"># update valuation domain</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">newMin</span><span class="p">))</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">newMax</span><span class="p">))</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="p">(</span><span class="n">Min</span><span class="o">+</span><span class="n">Max</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Med</span> <span class="p">}</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.ranking2Preorder">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.ranking2Preorder">[docs]</a>
    <span class="k">def</span> <span class="nf">ranking2Preorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ranking</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a preordering (a list of list) of a ranking (best to worst) of decision actions in increasing preference direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#ordering = list(ranking)</span>
        <span class="c1">#ordering.reverse()</span>
        <span class="n">preordering</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">ranking</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">preordering</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.ordering2Preorder">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.ordering2Preorder">[docs]</a>
    <span class="k">def</span> <span class="nf">ordering2Preorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ordering</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a preordering (a list of list) of a linar order (worst to best) of decision actions in increasing preference direction.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">preordering</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ordering</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">preordering</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.computeFillRate">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.computeFillRate">[docs]</a>
    <span class="k">def</span> <span class="nf">computeFillRate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the sum of the squares (without diagonal) of the orders of the component&#39;s subgraphs</span>
<span class="sd">        over the square (without diagonal) of the big digraph order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fillRate</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">order</span><span class="o">*</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>\
                        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">fillRate</span><span class="o">/</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;decreasing&#39;</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for exportSortingDigraph.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportSortingGraphViz</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                                   <span class="n">actionsSubset</span><span class="o">=</span><span class="n">actionsSubset</span><span class="p">,</span>
                                   <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
                                   <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                   <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                                   <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                                   <span class="n">fontSize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">,</span>
                                   <span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">,</span>
                                   <span class="n">relation</span><span class="o">=</span><span class="n">relation</span><span class="p">,</span>
                                   <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>



<div class="viewcode-block" id="SparseOutrankingDigraph.exportSortingGraphViz">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.exportSortingGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportSortingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;decreasing&#39;</span><span class="p">,</span>
                              <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                              <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                              <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                              <span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for weak order (Hasse diagram) drawing</span>
<span class="sd">        filtering from SortingDigraph instances.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; # Testing graph viz export of sorting Hasse diagram</span>
<span class="sd">            &gt;&gt;&gt; MP  = True</span>
<span class="sd">            &gt;&gt;&gt; nbrActions=100</span>
<span class="sd">            &gt;&gt;&gt; tp = RandomCBPerformanceTableau(numberOfActions=nbrActions,</span>
<span class="sd">            ...                         Threading=MP,</span>
<span class="sd">            ...                         seed=100)</span>
<span class="sd">            &gt;&gt;&gt; bg = PreRankedOutrankingDigraph(tp,CopyPerfTab=True,quantiles=20,</span>
<span class="sd">            ...                             quantilesOrderingStrategy=&#39;average&#39;,</span>
<span class="sd">            ...                             componentRankingRule=&#39;Copeland&#39;,</span>
<span class="sd">            ...                             LowerClosed=False,</span>
<span class="sd">            ...                             minimalComponentSize=1,</span>
<span class="sd">            ...                            Threading=MP,nbrOfCPUs=8,</span>
<span class="sd">            ...                            #tempDir=&#39;.&#39;,</span>
<span class="sd">            ...                             nbrOfThreads=8,</span>
<span class="sd">            ...                             Comments=False,Debug=False)</span>
<span class="sd">            &gt;&gt;&gt; print(bg)</span>
<span class="sd">            *----- show short --------------*</span>
<span class="sd">            Instance name     : randomCBperftab_mp</span>
<span class="sd">            # Actions         : 100</span>
<span class="sd">            # Criteria        : 7</span>
<span class="sd">            Sorting by        : 20-Tiling</span>
<span class="sd">            Ordering strategy : average</span>
<span class="sd">            Ranking rule      : Copeland</span>
<span class="sd">            # Components      : 36</span>
<span class="sd">            Minimal order     : 1</span>
<span class="sd">            Maximal order     : 11</span>
<span class="sd">            Average order     : 2.8</span>
<span class="sd">            fill rate         : 4.121%</span>
<span class="sd">            ----  Constructor run times (in sec.) ----</span>
<span class="sd">            Total time        : 0.15991</span>
<span class="sd">            QuantilesSorting  : 0.11717</span>
<span class="sd">            Preordering       : 0.00066</span>
<span class="sd">            Decomposing       : 0.04009</span>
<span class="sd">            Ordering          : 0.00000</span>
<span class="sd">            &gt;&gt;&gt; bg.showComponents()</span>
<span class="sd">            *--- Relation decomposition in increasing order---*</span>
<span class="sd">            35: [&#39;a010&#39;]</span>
<span class="sd">            34: [&#39;a024&#39;, &#39;a060&#39;]</span>
<span class="sd">            33: [&#39;a012&#39;]</span>
<span class="sd">            32: [&#39;a018&#39;]</span>
<span class="sd">            31: [&#39;a004&#39;, &#39;a054&#39;, &#39;a075&#39;, &#39;a082&#39;]</span>
<span class="sd">            30: [&#39;a099&#39;]</span>
<span class="sd">            29: [&#39;a065&#39;]</span>
<span class="sd">            28: [&#39;a025&#39;, &#39;a027&#39;, &#39;a029&#39;, &#39;a041&#39;, &#39;a059&#39;]</span>
<span class="sd">            27: [&#39;a063&#39;]</span>
<span class="sd">            26: [&#39;a047&#39;, &#39;a066&#39;]</span>
<span class="sd">            25: [&#39;a021&#39;]</span>
<span class="sd">            24: [&#39;a007&#39;]</span>
<span class="sd">            23: [&#39;a044&#39;]</span>
<span class="sd">            22: [&#39;a037&#39;, &#39;a062&#39;, &#39;a090&#39;, &#39;a094&#39;, &#39;a098&#39;, &#39;a100&#39;]</span>
<span class="sd">            21: [&#39;a005&#39;, &#39;a040&#39;, &#39;a051&#39;, &#39;a093&#39;]</span>
<span class="sd">            20: [&#39;a015&#39;, &#39;a030&#39;, &#39;a052&#39;, &#39;a055&#39;, &#39;a064&#39;, &#39;a077&#39;]</span>
<span class="sd">            19: [&#39;a006&#39;, &#39;a061&#39;]</span>
<span class="sd">            18: [&#39;a049&#39;]</span>
<span class="sd">            17: [&#39;a001&#39;, &#39;a033&#39;]</span>
<span class="sd">            16: [&#39;a016&#39;, &#39;a028&#39;, &#39;a032&#39;, &#39;a035&#39;, &#39;a057&#39;, &#39;a079&#39;, &#39;a084&#39;, &#39;a095&#39;]</span>
<span class="sd">            15: [&#39;a043&#39;]</span>
<span class="sd">            14: [&#39;a002&#39;, &#39;a017&#39;, &#39;a023&#39;, &#39;a034&#39;, &#39;a067&#39;, &#39;a072&#39;, &#39;a073&#39;, &#39;a074&#39;, &#39;a088&#39;, &#39;a089&#39;, &#39;a097&#39;]</span>
<span class="sd">            13: [&#39;a048&#39;]</span>
<span class="sd">            12: [&#39;a078&#39;, &#39;a092&#39;]</span>
<span class="sd">            11: [&#39;a070&#39;]</span>
<span class="sd">            10: [&#39;a014&#39;, &#39;a026&#39;, &#39;a039&#39;, &#39;a058&#39;, &#39;a068&#39;, &#39;a083&#39;, &#39;a086&#39;]</span>
<span class="sd">            9: [&#39;a008&#39;, &#39;a022&#39;, &#39;a038&#39;, &#39;a081&#39;, &#39;a091&#39;, &#39;a096&#39;]</span>
<span class="sd">            8: [&#39;a020&#39;]</span>
<span class="sd">            7: [&#39;a069&#39;]</span>
<span class="sd">            6: [&#39;a045&#39;]</span>
<span class="sd">            5: [&#39;a003&#39;, &#39;a009&#39;, &#39;a013&#39;, &#39;a031&#39;, &#39;a036&#39;, &#39;a056&#39;, &#39;a076&#39;]</span>
<span class="sd">            4: [&#39;a042&#39;, &#39;a071&#39;]</span>
<span class="sd">            3: [&#39;a085&#39;]</span>
<span class="sd">            2: [&#39;a019&#39;, &#39;a080&#39;, &#39;a087&#39;]</span>
<span class="sd">            1: [&#39;a046&#39;]</span>
<span class="sd">            0: [&#39;a011&#39;, &#39;a050&#39;, &#39;a053&#39;]</span>
<span class="sd">            &gt;&gt;&gt; bg.exportSortingGraphViz(actionsSubset=bg.boostedRanking[:100])</span>

<span class="sd">        .. image:: preRankedDigraph.png</span>
<span class="sd">           :alt: pre-ranked digraph</span>
<span class="sd">           :width: 400 px</span>
<span class="sd">           :align: center</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

        <span class="k">def</span> <span class="nf">_safeName</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">t1</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">t1</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in nodeName: </span><span class="si">%s</span><span class="s1"> !!&#39;</span> <span class="o">%</span> <span class="n">t0</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">t0</span>

        <span class="n">compKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">!=</span> <span class="s1">&#39;decreasing&#39;</span><span class="p">:</span>
            <span class="n">compKeys</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">compKeys</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsKeys</span> <span class="o">=</span> <span class="n">actionsSubset</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsKeys</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
<span class="c1">##        if bestChoice != set():</span>
<span class="c1">##            rankBestString = &#39;{rank=max; &#39;</span>
<span class="c1">##        if worstChoice != set():</span>
<span class="c1">##            rankWorstString = &#39;{rank=min; &#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="n">bgcolor</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Digraph3 (graphviz)</span><span class="se">\\</span><span class="s1">n R. Bisdorff, 2020&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;,fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fontSize</span><span class="p">)</span>
        <span class="c1"># nodes</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                   <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># same ranks for Hasses equivalence classes</span>
        <span class="n">prtComp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">compKeys</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">compKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> \
                    <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsKeys</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ich</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">prtComp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ich</span><span class="p">)</span>
                <span class="n">sameRank</span> <span class="o">=</span> <span class="s1">&#39;{ rank = same; &#39;</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                    <span class="n">sameRank</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;; &#39;</span>
                <span class="n">sameRank</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sameRank</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sameRank</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prtComp</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">prtComp</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">prtComp</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">prtComp</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="c1">#edge = &#39;n&#39;+str(i+1)+&#39;-&gt; n&#39;+str(i+2)+&#39; [dir=forward,style=&quot;setlinewidth(1)&quot;,color=black, arrowhead=normal] ;\n&#39;</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                        <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                        <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                            <span class="o">%</span> <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                        <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                        <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> \
                            <span class="o">%</span> <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># restore original relation</span>
        <span class="c1">#self.relation = copy(originalRelation)</span>

        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;dot -Grankdir=TB -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> \
                          <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="c1">#commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="SparseOutrankingDigraph.showRubisBestChoiceRecommendation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showRubisBestChoiceRecommendation">[docs]</a>
    <span class="k">def</span> <span class="nf">showRubisBestChoiceRecommendation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">ChoiceVector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for self.showBestChoiceRecommendation() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showBestChoiceRecommendation</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                     <span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>


<div class="viewcode-block" id="SparseOutrankingDigraph.showBestChoiceRecommendation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.SparseOutrankingDigraph.showBestChoiceRecommendation">[docs]</a>
    <span class="k">def</span> <span class="nf">showBestChoiceRecommendation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">ChoiceVector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Parameters*:</span>
<span class="sd">            * Comments=False,</span>
<span class="sd">            * ChoiceVector=False,</span>
<span class="sd">            * Debug=False.</span>

<span class="sd">        Update of rubisBestChoice Recommendation for big digraphs.</span>
<span class="sd">        To do: limit to best choice; worst choice should be a separate method()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="n">Digraph</span> <span class="k">as</span> <span class="n">DG</span>
        <span class="c1"># best choices</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">keys</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">c1</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_showRubisBestChoiceRecommendation</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span>
                                                    <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span>
                                                    <span class="n">ChoiceVector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                    <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;***********************&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best choice recommendation:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &quot; Choice: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span>
        <span class="c1"># worst choices</span>
        <span class="n">cn</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">keys</span><span class="p">()))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">gn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">cn</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_showRubisWorstChoiceRecommendation</span><span class="p">(</span><span class="n">gn</span><span class="p">,</span>
                                                     <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span>
                                                     <span class="n">ChoiceVector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                     <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actionsNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;***********************&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Worst choice recommendation:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; * Choice:  </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">actionsNames</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span></div>



    <span class="k">def</span> <span class="nf">_showRubisBestChoiceRecommendation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                          <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">ChoiceVector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">_OldCoca</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Parameters*:</span>
<span class="sd">            * g0=None (first component of self by default),</span>
<span class="sd">            * Comments=False,</span>
<span class="sd">            * ChoiceVector=True,</span>
<span class="sd">            * Debug=False,</span>
<span class="sd">            * _OldCoca=False</span>

<span class="sd">        Renders the Rubis Best choice recommendation of the first component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">copy</span><span class="o">,</span><span class="nn">time</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;***********************&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best Choice Recommendation&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All comments !!!&#39;</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">g0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">keys</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">g0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">c1</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">g0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span>
        <span class="n">n0</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">order</span>
        <span class="k">if</span> <span class="n">_OldCoca</span><span class="p">:</span>
            <span class="n">_selfwcoc</span> <span class="o">=</span> <span class="n">CocaDigraph</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_selfwcoc</span> <span class="o">=</span> <span class="n">BrokenCocsDigraph</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="n">_selfwcoc</span><span class="o">.</span><span class="n">breakings</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">_selfwcoc</span><span class="o">.</span><span class="n">order</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">n0</span>
        
        <span class="n">g1</span><span class="o">.</span><span class="n">relation_orig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">actions_orig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_selfwcoc</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_selfwcoc</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;List of pseudo-independent choices&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">g1</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="n">g1</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">()</span>
        <span class="c1">#self.showPreKernels()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">])</span>
        <span class="n">g1</span><span class="o">.</span><span class="n">computePreKernels</span><span class="p">()</span>
        <span class="c1">#if Debug:</span>
        <span class="c1">#    print(self.dompreKernels,self.abspreKernels)</span>
        <span class="n">g1</span><span class="o">.</span><span class="n">computeGoodChoices</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="n">g1</span><span class="o">.</span><span class="n">computeBadChoices</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;good and bad choices: &#39;</span><span class="p">,</span><span class="n">g1</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">,</span><span class="n">g1</span><span class="o">.</span><span class="n">badChoices</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* --- Best choice recommendation(s) ---*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; (in decreasing order of determinateness)   &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Valuation domain: [</span><span class="si">%.2f</span><span class="s1">;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span>\
              <span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="n">g1</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">bestChoice</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">worstChoice</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">gch</span> <span class="ow">in</span> <span class="n">g1</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="n">goodChoice</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">for</span> <span class="n">bch</span> <span class="ow">in</span> <span class="n">g1</span><span class="o">.</span><span class="n">badChoices</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gch</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="n">bch</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
                        <span class="c1">#if gch[0] == bch[0]:</span>
                        <span class="k">if</span> <span class="n">gch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">gch</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;null choice &#39;</span><span class="p">)</span>
                                <span class="n">g1</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">gch</span><span class="p">,</span>
                                                    <span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                                <span class="n">g1</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span>
                                                    <span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                            <span class="n">goodChoice</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">elif</span> <span class="n">gch</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">gch</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;outranked choice &#39;</span><span class="p">)</span>
                                <span class="n">g1</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">gch</span><span class="p">,</span>
                                                    <span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                                <span class="n">g1</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span>
                                                    <span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                            <span class="n">goodChoice</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">goodChoice</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">goodChoice</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; === &gt;&gt; potential BCR &#39;</span><span class="p">)</span>
                    <span class="n">g1</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">gch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">bestChoice</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
                        <span class="n">bestChoice</span> <span class="o">=</span> <span class="n">gch</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;non robust best choice &#39;</span><span class="p">)</span>
                <span class="n">g1</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">gch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Execution time: </span><span class="si">%.3f</span><span class="s1"> seconds&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*****************************&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestChoice</span> <span class="o">=</span> <span class="n">bestChoice</span>
        <span class="c1">#self.worstChoice = worstChoice</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">actions_orig</span><span class="p">)</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">relation_orig</span><span class="p">)</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
            <span class="n">g1</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">g1</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_showRubisWorstChoiceRecommendation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                          <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">ChoiceVector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">_OldCoca</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Parameters*:</span>
<span class="sd">            * g0=None (last component of self by default),</span>
<span class="sd">            * Comments=False,</span>
<span class="sd">            * ChoiceVector=True,</span>
<span class="sd">            * Debug=False,</span>
<span class="sd">            * _OldCoca=False,</span>

<span class="sd">        Renders the Rubis Worst choice recommendation of the first component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">copy</span><span class="o">,</span><span class="nn">time</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">Comments</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;***********************&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Worst Choice Recommendation&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All comments !!!&#39;</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">g0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cn</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">keys</span><span class="p">()))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">g0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">c1</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
        <span class="n">gn</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="o">-</span><span class="n">g0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">gn</span><span class="p">)</span>
        <span class="n">n0</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">order</span>
        <span class="k">if</span> <span class="n">_OldCoca</span><span class="p">:</span>
            <span class="n">_selfwcoc</span> <span class="o">=</span> <span class="n">CocaDigraph</span><span class="p">(</span><span class="n">gn</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_selfwcoc</span> <span class="o">=</span> <span class="n">BrokenCocsDigraph</span><span class="p">(</span><span class="n">gn</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
            <span class="n">b1</span> <span class="o">=</span> <span class="n">_selfwcoc</span><span class="o">.</span><span class="n">breakings</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="n">_selfwcoc</span><span class="o">.</span><span class="n">order</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">n0</span>
        
        <span class="n">gn</span><span class="o">.</span><span class="n">relation_orig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">actions_orig</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_selfwcoc</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_selfwcoc</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;List of pseudo-independent choices&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">gn</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="n">gn</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">()</span>
        <span class="c1">#self.showPreKernels()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">])</span>
        <span class="n">gn</span><span class="o">.</span><span class="n">computePreKernels</span><span class="p">()</span>
        <span class="c1">#if Debug:</span>
        <span class="c1">#    print(self.dompreKernels,self.abspreKernels)</span>
        <span class="n">gn</span><span class="o">.</span><span class="n">computeGoodChoices</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="n">gn</span><span class="o">.</span><span class="n">computeBadChoices</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;good and bad choices: &#39;</span><span class="p">,</span><span class="n">gn</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">,</span><span class="n">gn</span><span class="o">.</span><span class="n">badChoices</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* --- Worst choice recommendation(s) ---*&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; (in decreasing order of determinateness)   &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Valuation domain: [</span><span class="si">%.2f</span><span class="s1">;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span>\
              <span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="n">gn</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]))</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">bestChoice</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">worstChoice</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">bch</span> <span class="ow">in</span> <span class="n">gn</span><span class="o">.</span><span class="n">badChoices</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="n">badChoice</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">nullChoice</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">gch</span> <span class="ow">in</span> <span class="n">gn</span><span class="o">.</span><span class="n">goodChoices</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bch</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="n">gch</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
                        <span class="c1">#if gch[0] == bch[0]:</span>
                        <span class="k">if</span> <span class="n">bch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">bch</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;null choice &#39;</span><span class="p">)</span>
                                <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">gch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                                <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                            <span class="n">badChoice</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">nullChoice</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="n">bch</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bch</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;outranking choice &#39;</span><span class="p">)</span>
                                <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">gch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                                <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                            <span class="n">badChoice</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">badChoice</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">badChoice</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; === &gt;&gt; potential worst choice &#39;</span><span class="p">)</span>
                    <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">worstChoice</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
                        <span class="n">worstChoice</span> <span class="o">=</span> <span class="n">bch</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">nullChoice</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; === &gt;&gt; ambiguous choice &#39;</span><span class="p">)</span>
                    <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">worstChoice</span> <span class="o">==</span> <span class="nb">set</span><span class="p">():</span>
                        <span class="n">worstChoice</span> <span class="o">=</span> <span class="n">bch</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;non robust worst choice &#39;</span><span class="p">)</span>
                <span class="n">gn</span><span class="o">.</span><span class="n">showChoiceVector</span><span class="p">(</span><span class="n">bch</span><span class="p">,</span><span class="n">ChoiceVector</span><span class="o">=</span><span class="n">ChoiceVector</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Execution time: </span><span class="si">%.3f</span><span class="s1"> seconds&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*****************************&#39;</span><span class="p">)</span>
        <span class="c1">#self.bestChoice = bestChoice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worstChoice</span> <span class="o">=</span> <span class="n">worstChoice</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b1</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">actions_orig</span><span class="p">)</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">relation_orig</span><span class="p">)</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gn</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
            <span class="n">gn</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span></div>



<span class="c1">########################</span>
<span class="c1"># multiprocessing workers</span>
<span class="k">def</span> <span class="nf">_worker</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">_decomposition</span>
    <span class="k">for</span> <span class="n">Comments</span><span class="p">,</span><span class="n">args</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">input</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="s1">&#39;STOP&#39;</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_decompose</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            
<span class="k">def</span> <span class="nf">_decompose</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">perfTab</span><span class="p">,</span><span class="n">_decomposition</span><span class="p">,</span><span class="n">componentRankingRule</span><span class="p">):</span>
    <span class="c1">#global perfTab</span>
    <span class="c1">#global _decomposition</span>
    <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
    <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">CopelandOrder</span><span class="p">,</span><span class="n">NetFlowsOrder</span>

    <span class="n">comp</span> <span class="o">=</span> <span class="n">_decomposition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">))</span>
    <span class="n">compKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;c</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">compDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">}</span>
    <span class="n">compDict</span><span class="p">[</span><span class="s1">&#39;lowQtileLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">compDict</span><span class="p">[</span><span class="s1">&#39;highQtileLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">compDict</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">comp</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">comp</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">pg</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">perfTab</span><span class="p">,</span>
                    <span class="n">actionsSubset</span><span class="o">=</span><span class="n">comp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">componentRankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">pg</span><span class="p">)</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">ranking</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">pg</span><span class="p">)</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">ranking</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
    <span class="n">pg</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span>
    <span class="n">pg</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;evaluation&#39;</span><span class="p">)</span>
    <span class="n">pg</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">Digraph</span>
    <span class="n">compDict</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pg</span>
    <span class="n">splitComponent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;compKey&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;compDict&#39;</span><span class="p">:</span><span class="n">compDict</span><span class="p">}</span>
    <span class="n">foName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/splitComponent-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">splitComponent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1"> (</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">nc</span><span class="p">,</span><span class="n">pg</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>



<div class="viewcode-block" id="PreRankedOutrankingDigraph">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">PreRankedOutrankingDigraph</span><span class="p">(</span><span class="n">SparseOutrankingDigraph</span><span class="p">,</span><span class="n">PerformanceTableau</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main class for the multiprocessing implementation of sparse outranking digraphs.</span>

<span class="sd">    The associated performance tableau instance is decomposed with a q-tiling sort into a partition of quantile equivalence classes which are linearly ordered by average quantile limits (default).</span>

<span class="sd">    With each quantile equivalence class is associated a BipolarOutrankingDigraph object which is restricted to the decision actions gathered in this quantile equivalence class.</span>

<span class="sd">    See https://rbisdorff.github.io/documents/DA2PL-RB-2016.pdf</span>

<span class="sd">    By default, the number of quantiles is set to 5 when the numer of actions is less than 100, to 10 when the number of actions is less than 1000, or otherwise to 0.5% of the numer of decision actions. The number of quantiles can be set much lower for bigger orders. Mind the effective availability of CPU memory when tackling big digraph orders.</span>

<span class="sd">    For other parameters settings, see the corresponding :py:class:`sortingDigraphs.QuantilesSortingDigraph` class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="p">,</span>
                 <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">quantilesOrderingStrategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">componentRankingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">,</span>
                 <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tempDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="c1">#componentThreadingThreshold=50,</span>
                 <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrOfThreads</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">save2File</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#global perfTab</span>
        <span class="c1">#global _decomposition</span>

        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="c1">#from os import cpu_count</span>
        <span class="c1">#from multiprocessing import Pool</span>
        <span class="c1"># import multiprocessing as mp</span>
        <span class="c1"># if startMethod is None:</span>
        <span class="c1">#     startMethod = &#39;spawn&#39;</span>
        <span class="c1"># mpctx = mp.get_context(startMethod)</span>
        <span class="c1"># Pool = mpctx.Pool</span>
        <span class="c1"># cpu_count = mpctx.cpu_count</span>

        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

        <span class="n">ttot</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

        <span class="c1"># data input</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data input&#39;</span><span class="p">)</span>
        
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>
        <span class="c1"># setting quantiles sorting parameters</span>
        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
            <span class="c1"># self.actions = perfTab.actions</span>
            <span class="c1"># self.criteria = perfTab.criteria</span>
            <span class="c1"># self.evaluation = perfTab.evaluation</span>
            <span class="c1"># self.NA = perfTab.NA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_pr&#39;</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">na</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dataInput&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="c1">#print(self.runTimes)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;data input time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]))</span>

        <span class="c1">#######</span>
        <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">na</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">quantiles</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="k">elif</span> <span class="n">na</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">quantiles</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quantiles</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">na</span><span class="o">*</span><span class="mf">0.005</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantilesOrderingStrategy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;Threading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Threading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;PrefThresholds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;hasNoVeto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span>
        <span class="c1"># self.startMethod = startMethod</span>
        <span class="c1"># quantiles sorting</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing the </span><span class="si">%d</span><span class="s1">-quantiles sorting digraph of order </span><span class="si">%d</span><span class="s1"> ...&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantiles</span><span class="p">,</span><span class="n">na</span><span class="p">))</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">QuantilesSortingDigraph</span><span class="p">(</span><span class="n">argPerfTab</span><span class="o">=</span><span class="n">perfTab</span><span class="p">,</span>
                                     <span class="n">limitingQuantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span>
                                     <span class="n">LowerClosed</span><span class="o">=</span><span class="n">LowerClosed</span><span class="p">,</span>
                                     <span class="n">CompleteOutranking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">WithSortingRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">CopyPerfTab</span><span class="o">=</span><span class="n">CopyPerfTab</span><span class="p">,</span>
                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                     <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                     <span class="n">tempDir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">,</span>
                                     <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                     <span class="n">nbrOfProcesses</span><span class="o">=</span><span class="n">nbrOfThreads</span><span class="p">,</span>
                                     <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">valuationdomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">profiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">categories</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">sorting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">NA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sorting time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">]))</span>
        
        <span class="c1"># preordering</span>
        <span class="k">if</span> <span class="n">minimalComponentSize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimalComponentSize</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span> <span class="o">=</span> <span class="n">minimalComponentSize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span> <span class="o">=</span> <span class="n">componentRankingRule</span>
        <span class="n">tw</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">quantilesOrderingStrategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span>
        <span class="c1">##if quantilesOrderingStrategy == &#39;average&#39;:</span>
        <span class="n">_decomposition</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>\
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantileOrdering</span><span class="p">(</span>
                    <span class="n">strategy</span><span class="o">=</span><span class="n">quantilesOrderingStrategy</span><span class="p">,</span>
                        <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                        <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">_decomposition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decomposition</span> <span class="o">=</span> <span class="n">_decomposition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tw</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;weak ordering execution time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">]</span>  <span class="p">)</span>
        <span class="c1"># setting components</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_decomposition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span> <span class="o">=</span> <span class="n">nc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Threading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">comp</span> <span class="o">=</span> <span class="n">_decomposition</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1">#print(&#39;==&gt;&gt;&#39;,comp)</span>
                <span class="n">compKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;c</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">}</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="n">PartialPerformanceTableau</span><span class="p">(</span><span class="n">perfTab</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">comp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;lowQtileLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;highQtileLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">pg</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span>
                                          <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;evaluation&#39;</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">Digraph</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pg</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">comp</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">comp</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c1"># if self.sortingParameters[&#39;Threading&#39;] == True:</span>
            <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
            <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span><span class="p">,</span> <span class="n">dump</span>
            <span class="c1">#from multiprocessing import Process, Queue,active_children, cpu_count</span>
            <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
            <span class="k">if</span> <span class="n">startMethod</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">startMethod</span> <span class="o">=</span> <span class="s1">&#39;spawn&#39;</span>
            <span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">get_start_method</span><span class="p">()</span>
            <span class="n">Process</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Process</span>
            <span class="n">Queue</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Queue</span>
            <span class="n">active_children</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">active_children</span>
            <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>

            <span class="k">if</span> <span class="n">nbrOfCPUs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Processing the </span><span class="si">%d</span><span class="s1"> components&#39;</span> <span class="o">%</span> <span class="n">nc</span> <span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;with </span><span class="si">%d</span><span class="s1"> cores&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span><span class="p">)</span>
            <span class="c1">#tdump = time()</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span><span class="p">,</span><span class="n">mkdtemp</span>
            <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">)</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
                <span class="c1">## tasks queue and workers launching</span>
                <span class="n">NUMBER_OF_WORKERS</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span>
                <span class="n">tasksIndex</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">_decomposition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">)]</span>
                <span class="n">tasksIndex</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pos</span><span class="p">:</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">TASKS</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Comments</span><span class="p">,(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nc</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span>
                          <span class="n">perfTab</span><span class="p">,</span><span class="n">_decomposition</span><span class="p">,</span><span class="n">componentRankingRule</span><span class="p">))</span>\
                                                       <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">tasksIndex</span><span class="p">]</span>
                <span class="n">task_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">TASKS</span><span class="p">:</span>
                    <span class="n">task_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUMBER_OF_WORKERS</span><span class="p">):</span>
                    <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_worker</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">task_queue</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="c1">#print(&#39;started&#39;)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUMBER_OF_WORKERS</span><span class="p">):</span>
                    <span class="n">task_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;STOP&#39;</span><span class="p">)</span>

                <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="k">pass</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exit </span><span class="si">%d</span><span class="s1"> threads&#39;</span> <span class="o">%</span> <span class="n">NUMBER_OF_WORKERS</span><span class="p">)</span>

                <span class="n">components</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="c1">#componentsList = []</span>
                <span class="n">boostedRanking</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;job&#39;</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/splitComponent-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                    <span class="n">splitComponent</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;splitComponent&#39;</span><span class="p">,</span><span class="n">splitComponent</span><span class="p">)</span>
                    <span class="n">components</span><span class="p">[</span><span class="n">splitComponent</span><span class="p">[</span><span class="s1">&#39;compKey&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">splitComponent</span><span class="p">[</span><span class="s1">&#39;compDict&#39;</span><span class="p">]</span>
                    <span class="n">boostedRanking</span> <span class="o">+=</span> <span class="n">splitComponent</span><span class="p">[</span><span class="s1">&#39;compDict&#39;</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ranking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span> <span class="o">=</span> <span class="n">boostedRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boostedOrder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span><span class="p">))</span>

        <span class="c1"># storing components, fillRate and maximalComponentSize</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="n">components</span>
        <span class="n">fillRate</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">maximalComponentSize</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">compKey</span><span class="p">,</span><span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">pg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
            <span class="n">npg</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">order</span>
            <span class="k">if</span> <span class="n">npg</span> <span class="o">&gt;</span> <span class="n">maximalComponentSize</span><span class="p">:</span>
                <span class="n">maximalComponentSize</span> <span class="o">=</span> <span class="n">npg</span>
            <span class="n">fillRate</span> <span class="o">+=</span> <span class="n">npg</span><span class="o">*</span><span class="p">(</span><span class="n">npg</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compKey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fillRate</span> <span class="o">=</span> <span class="n">fillRate</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximalComponentSize</span> <span class="o">=</span> <span class="n">maximalComponentSize</span>

        <span class="c1"># setting the component relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;decomposing time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">]</span>  <span class="p">)</span>

        <span class="c1">#  compute boosted ranking in not threaded exceution</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;Threading&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span> <span class="o">=</span> <span class="n">componentRankingRule</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBoostedRanking</span><span class="p">(</span>
                                       <span class="n">rankingRule</span><span class="o">=</span><span class="n">componentRankingRule</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boostedOrder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ordering time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span>  <span class="p">)</span>
        <span class="c1">########</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">ttot</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save2File</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showShort</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">save2File</span><span class="p">)</span>


    <span class="c1"># ----- PreRankedOutrankingDigraph class methods ------------</span>

    <span class="k">def</span> <span class="nf">_computeQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the quantile interval of the decision actions.</span>

<span class="sd">        *Parameters*:</span>
<span class="sd">            * QuantilesdSortingDigraph instance</span>
<span class="sd">            * Descending: listing in *decreasing* (default) or *increasing* quantile order.</span>
<span class="sd">            * strategy: ordering in an {&#39;optimistic&#39; | &#39;pessimistic&#39; | &#39;average&#39; (default)}</span>
<span class="sd">              in the uppest, the lowest or the average potential quantile.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span>
        <span class="n">actionsCategories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span> \
                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                               <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span>
                                               <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                               <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                               <span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span><span class="p">)</span>
            <span class="n">lowQtileLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
            <span class="n">highQtileLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
            <span class="n">lowQtileValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">]</span>
            <span class="n">highQtileValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">score1</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span> <span class="o">+</span> <span class="n">hc</span><span class="p">)</span>
                <span class="n">score2</span> <span class="o">=</span> <span class="n">hc</span>
                <span class="n">score3</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span> <span class="o">+</span> <span class="n">hc</span><span class="p">)</span>
                <span class="n">score4</span> <span class="o">=</span> <span class="n">hc</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                <span class="n">score1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">score2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">score3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">score4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                <span class="n">score1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">score2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">score3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">score4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1">#strategy == &quot;optimal&quot;:</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">score1</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">+</span><span class="n">hc</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="n">score2</span> <span class="o">=</span> <span class="n">hc</span>
                <span class="n">score3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">)</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">score4</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">notHighLimit</span><span class="p">)</span>
            <span class="c1">#print(score1,highQtileLimit,lowQtileLimit,lowCateg,highCateg,score2,score3,score4)</span>
            <span class="c1">#if Optimal:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">score1</span><span class="p">,</span><span class="n">score2</span><span class="p">,</span><span class="n">score3</span><span class="p">,</span><span class="n">score4</span><span class="p">,</span>
                                   <span class="n">highQtileValue</span><span class="p">,</span>
                                   <span class="n">lowQtileValue</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span>
                                   <span class="n">highQtileLimit</span><span class="p">,</span><span class="n">lowQtileLimit</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">score1</span><span class="p">,</span><span class="n">score2</span><span class="p">,</span><span class="n">score3</span><span class="p">,</span><span class="n">score4</span><span class="p">,</span>
                                   <span class="n">highQtileValue</span><span class="p">,</span>
                                   <span class="n">lowQtileValue</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span>
                                   <span class="n">highCateg</span><span class="p">,</span><span class="n">highQtileLimit</span><span class="p">,</span><span class="n">lowQtileLimit</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>        

        <span class="n">actionsCategIntervals</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">actionsCategories</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">actionsCategIntervals</span><span class="p">)</span>
        <span class="n">compSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span>

        <span class="k">if</span> <span class="n">compSize</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                <span class="n">componentsIntervals</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">item</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">9</span><span class="p">]),</span>
                                        <span class="n">actionsCategories</span><span class="p">[</span><span class="n">item</span><span class="p">],</span>
                                        <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span>\
                                           <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">actionsCategIntervals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">componentsIntervals</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">item</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span>
                                        <span class="n">actionsCategories</span><span class="p">[</span><span class="n">item</span><span class="p">],</span>
                                        <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">7</span><span class="p">]]</span>\
                                           <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">actionsCategIntervals</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">componentsIntervals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsCategIntervals</span><span class="p">)</span>
            <span class="n">compContent</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="n">currContLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">compContent</span><span class="p">)</span>
                <span class="n">comp</span> <span class="o">=</span> <span class="n">actionsCategIntervals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">currContLength</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">lowQtileLimit</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
                <span class="n">highQtileLimit</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
                <span class="n">compContent</span> <span class="o">+=</span> <span class="n">actionsCategories</span><span class="p">[</span><span class="n">comp</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">compContent</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">compSize</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">lowCateg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
                    <span class="n">highCateg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                        <span class="n">highQtileLimit</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
                        <span class="n">lowQtileLimit</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
                        <span class="n">componentsIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">highQtileLimit</span><span class="p">,</span><span class="n">lowQtileLimit</span><span class="p">),</span>
                                                    <span class="n">compContent</span><span class="p">,</span>
                                                    <span class="n">score</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">highQtileLimit</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
                        <span class="n">lowQtileLimit</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
                        <span class="n">componentsIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">lowQtileLimit</span><span class="p">,</span><span class="n">highQtileLimit</span><span class="p">),</span>
                                                    <span class="n">compContent</span><span class="p">,</span>
                                                    <span class="n">score</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">])</span>
                    <span class="n">compContent</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">componentsIntervals</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">componentsIntervals</span>

<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeActionCategories">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeActionCategories">[docs]</a>
    <span class="k">def</span> <span class="nf">computeActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">Show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        Returns a tuple : action, lowest category key, highest category key, membership credibility !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#qs = self.qs</span>
        <span class="c1">#qs = self</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sortinga</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span>
                <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
                <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
            <span class="n">sortinga</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">]</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1">#for c in self.orderedCategoryKeys():</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="n">Above</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="n">Above</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
                <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sortinga</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">Above</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">credibility</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">credibility</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Show</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                     <span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                     <span class="n">action</span><span class="p">,</span>
                                     <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                    <span class="n">credibility</span><span class="p">,</span>\
                    <span class="n">lowLimit</span><span class="p">,</span>\
                    <span class="n">notHighLimit</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Show</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>\
                                     <span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>\
                                     <span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                     <span class="n">action</span><span class="p">,</span>\
                                     <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>\
                    <span class="n">credibility</span><span class="p">,</span>\
                    <span class="n">lowLimit</span><span class="p">,</span>\
                    <span class="n">notHighLimit</span></div>




<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeCriterion2RankingCorrelation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeCriterion2RankingCorrelation">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCriterion2RankingCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                            <span class="n">criterion</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                            <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                            <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                            <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the ordinal correlation coefficient between</span>
<span class="sd">        the global linar ranking and the marginal criterion relation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print(criterion)</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">coalition</span><span class="o">=</span><span class="p">[</span><span class="n">criterion</span><span class="p">],</span>
                                      <span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                      <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                      <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="n">globalOrdering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranking2Preorder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span><span class="p">)</span>
        <span class="n">globalRelation</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">computePreorderRelation</span><span class="p">(</span><span class="n">globalOrdering</span><span class="p">)</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">computeOrdinalCorrelation</span><span class="p">(</span><span class="n">globalRelation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corr</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeMarginalVersusGlobalRankingCorrelations">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeMarginalVersusGlobalRankingCorrelations">[docs]</a>
    <span class="k">def</span> <span class="nf">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                       <span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                       <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                       <span class="n">nbrCores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                       <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                       <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for computing correlations between each individual criterion relation with the corresponding global ranking relation.</span>

<span class="sd">        Returns a list of tuples (correlation,criterionKey) sorted by default in decreasing order of the correlation.</span>

<span class="sd">        If Threading is True, a multiprocessing Pool class is used with a parallel equivalent of the built-in map function.</span>

<span class="sd">        If nbrCores is not set, the os.cpu_count() function is used to determine the number of available cores.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">if</span> <span class="n">Threading</span><span class="p">:</span>
            <span class="c1">#from multiprocessing import set_start_method</span>
            <span class="c1">#set_start_method(&quot;spawn&quot;)</span>
            <span class="c1">#from multiprocessing import Pool</span>
            <span class="c1">#from os import cpu_count</span>
            <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
            <span class="k">if</span> <span class="n">startMethod</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">startMethod</span> <span class="o">=</span> <span class="s1">&#39;spawn&#39;</span>
            <span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_start_method</span><span class="p">()</span>
            <span class="n">Pool</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Pool</span>
            <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>

            <span class="k">if</span> <span class="n">nbrCores</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbrCores</span><span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThread</span> <span class="o">=</span> <span class="n">nbrCores</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
            <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">nbrCores</span><span class="p">)</span> <span class="k">as</span> <span class="n">proc</span><span class="p">:</span>
                <span class="n">correlations</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeCriterion2RankingCorrelation</span><span class="p">,</span>
                                        <span class="n">criteriaList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ValuedCorrelation</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="p">[(</span><span class="n">correlations</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span><span class="o">*</span>\
                                        <span class="n">correlations</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span>
                                        <span class="n">criteriaList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> \
                                             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">criteriaList</span><span class="p">))]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="p">[(</span><span class="n">correlations</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span>
                                        <span class="n">criteriaList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> \
                                             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">criteriaList</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#criteriaList = [x for x in self.criteria]</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
            <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
                <span class="n">corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCriterion2RankingCorrelation</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ValuedCorrelation</span><span class="p">:</span>
                    <span class="n">criteriaCorrelation</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">corr</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span>\
                                                  <span class="o">*</span> <span class="n">corr</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span><span class="n">c</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">criteriaCorrelation</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">corr</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span><span class="n">c</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">criteriaCorrelation</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">criteriaCorrelation</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showMarginalVersusGlobalRankingCorrelation">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showMarginalVersusGlobalRankingCorrelation">[docs]</a>
    <span class="k">def</span> <span class="nf">showMarginalVersusGlobalRankingCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                      <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                      <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                   <span class="n">startMehod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for computeCriterionCorrelation results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCriterion2RankingCorrelation</span><span class="p">(</span><span class="n">c</span><span class="p">,</span>
                                                            <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                                            <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                                            <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="n">criteriaCorrelation</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">corr</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">],</span><span class="n">corr</span><span class="p">[</span><span class="s1">&#39;determination&#39;</span><span class="p">],</span><span class="n">c</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">criteriaCorrelation</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Marginal versus global linear ranking correlation&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;criterion | weight</span><span class="se">\t</span><span class="s1"> corr</span><span class="se">\t</span><span class="s1"> deter</span><span class="se">\t</span><span class="s1"> corr*deter&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------|------------------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%9s</span><span class="s1"> |  </span><span class="si">%.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1">&#39;</span> \
                      <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showActionSortingResult">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showActionSortingResult">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionSortingResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the quantiles sorting result all (default) of a subset of the decision actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantiles sorting result per decision action&#39;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">categ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">categ</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%.2f</span><span class="s1"> (</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">categ</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                                <span class="n">res</span><span class="p">[</span><span class="n">categ</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">],</span>
                                                <span class="n">res</span><span class="p">[</span><span class="n">categ</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                                <span class="n">res</span><span class="p">[</span><span class="n">categ</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span></div>


<span class="c1">##    def showActionsSortingResult(self,actionsSubset=None):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        shows the quantiles sorting result all (default) of a subset of the decision actions.</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        print(&#39;Quantiles sorting result per decision action&#39;)</span>
<span class="c1">##        if actionsSubset==None:</span>
<span class="c1">##            for x in self.actions.keys():</span>
<span class="c1">##                self.computeActionCategories(x,Show=True)</span>
<span class="c1">##        else:</span>
<span class="c1">##            for x in actionsSubset:</span>
<span class="c1">##                self.computeActionCategories(x,Show=True)</span>

<div class="viewcode-block" id="PreRankedOutrankingDigraph.showShort">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showShort">[docs]</a>
    <span class="k">def</span> <span class="nf">showShort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">WithFileSize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default (__repr__) presentation method for big outranking digraphs instances:</span>

<span class="sd">        &gt;&gt;&gt; from sparseOutrankingDigraphs import *</span>
<span class="sd">        &gt;&gt;&gt; t = RandomCBPerformanceTableau(numberOfActions=100,seed=1)</span>
<span class="sd">        &gt;&gt;&gt; g = PreRankedOutrankingDigraph(t,quantiles=10)</span>
<span class="sd">        &gt;&gt;&gt; print(g)</span>
<span class="sd">        *----- show short --------------*</span>
<span class="sd">        Instance name     : randomCBperftab_mp</span>
<span class="sd">        Actions           : 100</span>
<span class="sd">        Criteria          : 7</span>
<span class="sd">        Sorting by        : 10-Tiling</span>
<span class="sd">        Ordering strategy : average</span>
<span class="sd">        Ranking rule      : Copeland</span>
<span class="sd">        Components        : 19</span>
<span class="sd">        Minimal size      : 1</span>
<span class="sd">        Maximal size      : 22</span>
<span class="sd">        Median size       : 2</span>
<span class="sd">        fill rate         : 0.116</span>
<span class="sd">        ----  Constructor run times (in sec.) ----</span>
<span class="sd">        Total time        : 0.14958</span>
<span class="sd">        QuantilesSorting  : 0.06847</span>
<span class="sd">        Preordering       : 0.00071</span>
<span class="sd">        Decomposing       : 0.07366</span>
<span class="sd">        Ordering          : 0.00130</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#summaryStats = self.computeDecompositionSummaryStatistics()</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- show short --------------*&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Instance name     : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actions           : </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Criteria          : </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sorting by        : </span><span class="si">%d</span><span class="s1">-Tiling&#39;</span> \
                     <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ordering strategy : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking rule      : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Components        : </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minimal order     : </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximal order     : </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximalComponentSize</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average order     : </span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fill rate         : </span><span class="si">%.3f%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fillRate</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----  Constructor run times (in sec.) ----&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total time        : </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;QuantilesSorting  : </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Preordering       : </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decomposing       : </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ordering          : </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;*----- show short --------------*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Instance name      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">WithFileSize</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Size (in bytes)    : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">total_size</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Actions          : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Criteria         : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Sorting by         : </span><span class="si">%d</span><span class="s1">-Tiling</span><span class="se">\n</span><span class="s1">&#39;</span> \
                     <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">])</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Ordering strategy  : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">])</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Local ranking rule : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Components       : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Minimal size       : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Maximal order      : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximalComponentSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Average order      : </span><span class="si">%.1f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Fill rate          : </span><span class="si">%.3f%%</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fillRate</span><span class="o">*</span><span class="mf">100.0</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;*-- Constructor run times (in sec.) --*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Total time         : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">])</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;QuantilesSorting   : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">])</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Preordering        : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">])</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Decomposing        : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Ordering           : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showActions">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showActions">[docs]</a>
    <span class="k">def</span> <span class="nf">showActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints out the actions disctionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="c1">#comp = self.components[ck]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;comment&#39;</span><span class="p">],)</span> \
                                              <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> \
                                           <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;List of decision actions&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">ax</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showCriteria">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showCriteria">[docs]</a>
    <span class="k">def</span> <span class="nf">showCriteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        print Criteria with thresholds and weights.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----  criteria -----*&#39;</span><span class="p">)</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
            <span class="n">sumWeights</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">critc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="n">critc</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">criterionName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">criterionName</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Scale =&#39;</span><span class="p">,</span> <span class="n">critc</span><span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">IntegerWeights</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Weight = </span><span class="si">%d</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">critc</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">weightg</span> <span class="o">=</span> <span class="n">critc</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">sumWeights</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Weight = </span><span class="si">%.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">weightg</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">critc</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt;&gt;&gt;&#39;</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span><span class="n">critc</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                              <span class="n">critc</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Threshold </span><span class="si">%s</span><span class="s1"> : </span><span class="si">%.2f</span><span class="s1"> + </span><span class="si">%.2f</span><span class="s1">x&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="n">critc</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">critc</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="n">th</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="nb">print</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">showCriteriaQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showPerformanceTableau</span><span class="p">(</span><span class="n">actionsSubset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span>

<div class="viewcode-block" id="PreRankedOutrankingDigraph.showComponents">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showComponents">[docs]</a>
    <span class="k">def</span> <span class="nf">showComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;increasing&#39;</span><span class="p">):</span>
        <span class="n">SparseOutrankingDigraph</span><span class="o">.</span><span class="n">showDecomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">)</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showDecomposition">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showDecomposition">[docs]</a>
    <span class="k">def</span> <span class="nf">showDecomposition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;decreasing&#39;</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- quantiles decomposition in </span><span class="si">%s</span><span class="s1"> order---*&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="p">)</span>
        <span class="c1">#compKeys = [compKey for compKey in self.components.keys()]</span>
        <span class="c1"># the components are ordered from best (1) to worst (n)</span>
        <span class="n">compKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">!=</span> <span class="s1">&#39;decreasing&#39;</span><span class="p">:</span>
            <span class="n">compKeys</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">compKey</span> <span class="ow">in</span> <span class="n">compKeys</span><span class="p">:</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">]</span>
            <span class="n">sg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sg</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">. </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> \
                  <span class="o">%</span> <span class="p">(</span><span class="n">compKey</span><span class="p">,</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;lowQtileLimit&#39;</span><span class="p">],</span>
                     <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;highQtileLimit&#39;</span><span class="p">],</span><span class="n">actions</span><span class="p">))</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeCategoryContents">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeCategoryContents">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCategoryContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the sorting results per category.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                                     <span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">,</span>
                                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                                         <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                                         <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">)</span>

        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> \
                   <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">categoryContent</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showSorting">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows sorting results in decreasing or increasing (Reverse=False)</span>
<span class="sd">        order of the categories. If isReturningHTML is True (default = False)</span>
<span class="sd">        the method returns a htlm table with the sorting result.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#from string import replace</span>
        <span class="c1">#from copy import copy, deepcopy</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">categoryKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
            <span class="n">categoryKeys</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in descending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in descending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Categories&lt;/th&gt;&lt;th&gt;Assorting&lt;/th&gt;&lt;/tr&gt;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in ascending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in ascending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Categories&lt;/th&gt;&lt;th&gt;Assorting&lt;/th&gt;&lt;/tr&gt;&#39;</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categoryKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="c1">#html += &#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;[%s - %s[&lt;/td&gt;&#39; % (limprevc,limc)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span></div>


<span class="c1">##    def showHTMLRelationTable(self):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Not yet availbale !</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        print(&#39;Method not yet implemented for This class of digraphs!&#39;)</span>
<span class="c1">##        print(&#39;Try instead: self.showRelationTable()&#39;)</span>

<div class="viewcode-block" id="PreRankedOutrankingDigraph.showRelationTable">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">compKeys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialized for showing the quantiles decomposed relation table.</span>
<span class="sd">        Components are stored in an ordered dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span>
        <span class="k">if</span> <span class="n">compKeys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> quantiles decomposed relation table in decreasing order&#39;</span> <span class="o">%</span> <span class="n">nc</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">compKey</span><span class="p">,</span><span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1">#comp = components[compKey]</span>
                <span class="n">pg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Component : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">compKey</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">actions</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pg</span><span class="o">.</span><span class="n">order</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">pg</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">compKey</span> <span class="ow">in</span> <span class="n">compKeys</span><span class="p">:</span>
                <span class="n">comp</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="n">compkey</span><span class="p">]</span>
                <span class="n">pg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Relation table of component </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">compKey</span><span class="p">))</span>
                <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">actions</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pg</span><span class="o">.</span><span class="n">order</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">pg</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">()</span></div>



<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeBoostedRanking">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeBoostedRanking">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBoostedRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders an ordred list of decision actions ranked in</span>
<span class="sd">        decreasing preference direction following the rankingRule</span>
<span class="sd">        on each component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span><span class="p">,</span><span class="n">KohlerOrder</span><span class="p">,</span><span class="n">CopelandOrder</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span>
        <span class="c1"># self.components is an ordered dictionary in decreasing preference</span>
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="c1">#comp = self.components[cki]</span>
            <span class="n">pg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
                <span class="n">opg</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">pg</span><span class="p">)</span>
                <span class="n">ranking</span> <span class="o">+=</span> <span class="n">opg</span><span class="o">.</span><span class="n">copelandRanking</span>
            <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
                <span class="n">opg</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">pg</span><span class="p">)</span>
                <span class="n">ranking</span> <span class="o">+=</span> <span class="n">opg</span><span class="o">.</span><span class="n">netFlowsRanking</span>
            <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Kohler&#39;</span><span class="p">:</span>
                <span class="n">opg</span> <span class="o">=</span> <span class="n">KohlerOrder</span><span class="p">(</span><span class="n">pg</span><span class="p">)</span>
                <span class="n">ranking</span> <span class="o">+=</span> <span class="n">opg</span><span class="o">.</span><span class="n">kohlerRanking</span>
        <span class="k">return</span> <span class="n">ranking</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeBoostedOrdering">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeBoostedOrdering">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBoostedOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">orderingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders an ordred list of decision actions ranked in</span>
<span class="sd">        increasing preference direction following the orderingRule</span>
<span class="sd">        on each component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBoostedRanking</span><span class="p">(</span><span class="n">rankingRule</span><span class="o">=</span><span class="n">orderingRule</span><span class="p">)</span>
        <span class="n">ranking</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ranking</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.actionRank">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.actionRank">[docs]</a>
    <span class="k">def</span> <span class="nf">actionRank</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">ranking</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the rank of a decision action in a given ranking</span>

<span class="sd">        If ranking is None, the self.boostedRanking attribute is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ranking</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ranking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span>
        <span class="k">return</span> <span class="n">ranking</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.actionOrder">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.actionOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">actionOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">ordering</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the order of a decision action in a given ordering</span>

<span class="sd">        If ordering is None, the self.boostedOrder attribute is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ordering</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boostedOrder</span>
        <span class="k">return</span> <span class="n">ordering</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeNewSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeNewSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">computeNewSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">relation</span><span class="p">,</span> <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;actions x in A belongs to category c in C&quot;,</span>
<span class="sd">        i.e. x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit (if LowerClosed).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>

        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>

        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                        <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="c1">#if Comments:</span>
                <span class="c1">#    print(&#39;%s in %s: low = %.2f, high = %.2f&#39; % \</span>
                <span class="c1">#          (x, c,lowLimit,notHighLimit), end=&#39; &#39;)</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="se">\t</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                             <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="c1">#print(&#39;\t %.2f \t %.2f \t %.2f&#39; % (sorting[x][c][&#39;lowLimit&#39;], sorting[x][c][&#39;notHighLimit&#39;], sorting[x][c][&#39;categoryMembership&#39;]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                             <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>
                             <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">sorting</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.computeNewActionCategories">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.computeNewActionCategories">[docs]</a>
    <span class="k">def</span> <span class="nf">computeNewActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">sorting</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        Returns a tuple : action, lowest category key, highest category key, membership credibility !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
                <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">credibility</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">credibility</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                     <span class="n">action</span><span class="p">,</span>
                                     <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                    <span class="n">credibility</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                     <span class="n">action</span><span class="p">,</span>
                                     <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                    <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>\
                    <span class="n">credibility</span></div>


<div class="viewcode-block" id="PreRankedOutrankingDigraph.showNewActionCategories">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showNewActionCategories">[docs]</a>
    <span class="k">def</span> <span class="nf">showNewActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">sorting</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeNewActionCategories</span><span class="p">(</span><span class="n">action</span><span class="p">,</span><span class="n">sorting</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="PreRankedOutrankingDigraph.showNewActionsSortingResult">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedOutrankingDigraph.showNewActionsSortingResult">[docs]</a>
    <span class="k">def</span> <span class="nf">showNewActionsSortingResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actions</span><span class="p">,</span><span class="n">sorting</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the quantiles sorting result all (default) of a subset of the decision actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantiles sorting result per decision action&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showNewActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sorting</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>
</div>


<span class="c1">##############</span>
<div class="viewcode-block" id="PreRankedConfidentOutrankingDigraph">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedConfidentOutrankingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">PreRankedConfidentOutrankingDigraph</span><span class="p">(</span><span class="n">PreRankedOutrankingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main class for the implementation of sparse confident outranking digraphs.</span>

<span class="sd">    The sparse outranking digraph instance is decomposed with a confident q-tiling sort into a partition of quantile equivalence classes which are linearly ordered by average quantile limits (default).</span>

<span class="sd">    With each quantile equivalence class is associated a ConfidentBipolarOutrankingDigraph object which is restricted to the decision actions gathered in this quantile equivalence class.</span>

<span class="sd">    By default, the number of quantiles is set to 5 when the numer of actions is less than 100, to 10 when the number of actions is less than 1000, or otherwise to 0.5% of the numer of decision actions. The number of quantiles can be set much lower for bigger orders. Mind the effective availability of CPU memory when tackling big digraph orders.</span>

<span class="sd">    For other parameters settings, see the corresponding classes:</span>
<span class="sd">    :py:class:`sortingDigraphs.QuantilesSortingDigraph` and :py:class:`outrankingDigraphs.ConfidentBipolarOutrankingDigraph` .</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="p">,</span>
                 <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">quantilesOrderingStrategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">componentRankingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">,</span>
                 <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">distribution</span> <span class="o">=</span> <span class="s1">&#39;triangular&#39;</span><span class="p">,</span>
                 <span class="n">betaParameter</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="n">confidence</span> <span class="o">=</span> <span class="mf">90.0</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tempDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="c1">#componentThreadingThreshold=50,</span>
                 <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrOfThreads</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">save2File</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="k">global</span> <span class="n">perfTab</span>
        <span class="k">global</span> <span class="n">_decomposition</span>

        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="c1">#from os import cpu_count</span>
        <span class="c1">#from multiprocessing import Pool</span>
        <span class="c1">#import multiprocessing as mp</span>
        <span class="c1">#mpctx = mp.get_context(&#39;spawn&#39;)</span>
        <span class="c1">#Pool = mpctx.Pool</span>
        <span class="c1">#cpu_count = mpctx.cpu_count</span>

        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

        <span class="n">ttot</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

        <span class="c1"># setting name</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>
        <span class="c1"># setting quantiles sorting parameters</span>
        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<span class="c1">##            self.actions = deepcopy(perfTab.actions)</span>
<span class="c1">##            self.criteria = deepcopy(perfTab.criteria)</span>
<span class="c1">##            self.evaluation = deepcopy(perfTab.evaluation)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<span class="c1">##            self.actions = perfTab.actions</span>
<span class="c1">##            self.criteria = perfTab.criteria</span>
<span class="c1">##            self.evaluation = perfTab.evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_conf_pr&#39;</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">na</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span> <span class="o">=</span> <span class="n">componentRankingRule</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1">#######</span>
        <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">na</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">quantiles</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="k">elif</span> <span class="n">na</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">quantiles</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quantiles</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">na</span><span class="o">*</span><span class="mf">0.005</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantilesOrderingStrategy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;Threading&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Threading</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;PrefThresholds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;hasNoVeto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span>
        <span class="c1"># quantiles sorting</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing the </span><span class="si">%d</span><span class="s1">-quantiles sorting digraph of order </span><span class="si">%d</span><span class="s1"> ...&#39;</span> \
                       <span class="o">%</span> <span class="p">(</span><span class="n">quantiles</span><span class="p">,</span><span class="n">na</span><span class="p">))</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">QuantilesSortingDigraph</span><span class="p">(</span><span class="n">argPerfTab</span><span class="o">=</span><span class="n">perfTab</span><span class="p">,</span>
                                     <span class="n">limitingQuantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span>
                                     <span class="n">LowerClosed</span><span class="o">=</span><span class="n">LowerClosed</span><span class="p">,</span>
                                     <span class="n">CompleteOutranking</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">WithSortingRelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">CopyPerfTab</span><span class="o">=</span><span class="n">CopyPerfTab</span><span class="p">,</span>
                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                     <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                     <span class="n">tempDir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">,</span>
                                     <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                                     <span class="n">nbrOfProcesses</span><span class="o">=</span><span class="n">nbrOfThreads</span><span class="p">,</span>
                                     <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                     <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">valuationdomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">profiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">categories</span>
        <span class="c1"># compute sorting likelyhoods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span> <span class="o">=</span> <span class="p">(</span><span class="n">confidence</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span> <span class="o">=</span> <span class="n">betaParameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">relation</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCLTLikelihoods</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
                                                      <span class="n">betaParameter</span><span class="o">=</span><span class="n">betaParameter</span><span class="p">,</span>
                                                      <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">confidentRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeConfidentRelation</span><span class="p">(</span><span class="n">qs</span><span class="o">.</span><span class="n">relation</span><span class="p">,</span>
                                                                <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>

       <span class="c1"># compute quantiles sorting result</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidentRelation</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                        <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span>

        <span class="c1"># compute category contents</span>
        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span> <span class="o">=</span> <span class="n">categoryContent</span>


        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span>

        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execution time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;sorting&#39;</span><span class="p">]))</span>
        <span class="c1"># preordering</span>
        <span class="k">if</span> <span class="n">minimalComponentSize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimalComponentSize</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimalComponentSize</span> <span class="o">=</span> <span class="n">minimalComponentSize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">componentRankingRule</span> <span class="o">=</span> <span class="n">componentRankingRule</span>
        <span class="n">tw</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">quantilesOrderingStrategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span>
        <span class="c1">##if quantilesOrderingStrategy == &#39;average&#39;:</span>
        <span class="n">_decomposition</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">item</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>\
                          <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantileOrdering</span><span class="p">(</span>
                                  <span class="n">strategy</span><span class="o">=</span><span class="n">quantilesOrderingStrategy</span><span class="p">,</span>
                                  <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                  <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                  <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">_decomposition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decomposition</span> <span class="o">=</span> <span class="n">_decomposition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tw</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;weak ordering execution time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;preordering&#39;</span><span class="p">]</span>  <span class="p">)</span>
        <span class="c1"># setting components</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_decomposition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbrComponents</span> <span class="o">=</span> <span class="n">nc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nc</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;Threading&#39;</span><span class="p">]:</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">comp</span> <span class="o">=</span> <span class="n">_decomposition</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1">#print(&#39;==&gt;&gt;&#39;,comp)</span>
                <span class="n">compKey</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;c</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rank&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">}</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="n">PartialPerformanceTableau</span><span class="p">(</span><span class="n">perfTab</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">comp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;lowQtileLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;highQtileLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">pg</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span>
                                          <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;evaluation&#39;</span><span class="p">)</span>
                <span class="n">pg</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">Digraph</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pg</span>
                <span class="n">components</span><span class="p">[</span><span class="n">compKey</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">comp</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">comp</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c1"># if self.sortingParameters[&#39;Threading&#39;] == True:</span>
                <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
                <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span><span class="p">,</span> <span class="n">dump</span>
                <span class="c1">#from multiprocessing import Process, Queue,active_children, cpu_count</span>
                <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
                <span class="k">if</span> <span class="n">startMethod</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">startMethod</span> <span class="o">=</span> <span class="s1">&#39;spawn&#39;</span><span class="p">,</span>
                <span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">startMethod</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_start_method</span><span class="p">()</span>
                <span class="n">Process</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Process</span>
                <span class="n">Queue</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Queue</span>
                <span class="n">active_children</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">active_children</span>
                <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>

                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Processing the </span><span class="si">%d</span><span class="s1"> components&#39;</span> <span class="o">%</span> <span class="n">nc</span> <span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threading ...&#39;</span><span class="p">)</span>
                <span class="c1">#tdump = time()</span>
                <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span><span class="p">,</span><span class="n">mkdtemp</span>
                <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">)</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
                    <span class="c1">## tasks queue and workers launching</span>
                    <span class="k">if</span> <span class="n">nbrOfCPUs</span> <span class="ow">is</span> <span class="n">NOne</span><span class="p">:</span>
                        <span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span>
                    <span class="n">NUMBER_OF_WORKERS</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nbrThread</span><span class="o">=</span><span class="n">nbrCPUs</span>
                    <span class="n">tasksIndex</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">_decomposition</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">)]</span>
                    <span class="n">tasksIndex</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">pos</span><span class="p">:</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">TASKS</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Comments</span><span class="p">,(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nc</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">componentRankingRule</span><span class="p">))</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">tasksIndex</span><span class="p">]</span>
                    <span class="n">task_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">TASKS</span><span class="p">:</span>
                        <span class="n">task_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUMBER_OF_WORKERS</span><span class="p">):</span>
                        <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_worker</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">task_queue</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;started&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUMBER_OF_WORKERS</span><span class="p">):</span>
                        <span class="n">task_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;STOP&#39;</span><span class="p">)</span>

                    <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                        <span class="k">pass</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exit </span><span class="si">%d</span><span class="s1"> threads&#39;</span> <span class="o">%</span> <span class="n">NUMBER_OF_WORKERS</span><span class="p">)</span>

                    <span class="n">components</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                    <span class="c1">#componentsList = []</span>
                    <span class="n">boostedRanking</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;job&#39;</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                        <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/splitComponent-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                        <span class="n">splitComponent</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;splitComponent&#39;</span><span class="p">,</span><span class="n">splitComponent</span><span class="p">)</span>
                        <span class="n">components</span><span class="p">[</span><span class="n">splitComponent</span><span class="p">[</span><span class="s1">&#39;compKey&#39;</span><span class="p">]]</span> \
                                <span class="o">=</span> <span class="n">splitComponent</span><span class="p">[</span><span class="s1">&#39;compDict&#39;</span><span class="p">]</span>
                        <span class="n">boostedRanking</span> <span class="o">+=</span> <span class="n">splitComponent</span><span class="p">[</span><span class="s1">&#39;compDict&#39;</span><span class="p">][</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ranking</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span> <span class="o">=</span> <span class="n">boostedRanking</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">boostedOrder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span><span class="p">))</span>

        <span class="c1"># storing components, fillRate and maximalComponentSize</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">components</span> <span class="o">=</span> <span class="n">components</span>
        <span class="n">fillRate</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">maximalComponentSize</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">compKey</span><span class="p">,</span><span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">pg</span> <span class="o">=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;subGraph&#39;</span><span class="p">]</span>
            <span class="n">npg</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">order</span>
            <span class="k">if</span> <span class="n">npg</span> <span class="o">&gt;</span> <span class="n">maximalComponentSize</span><span class="p">:</span>
                <span class="n">maximalComponentSize</span> <span class="o">=</span> <span class="n">npg</span>
            <span class="n">fillRate</span> <span class="o">+=</span> <span class="n">npg</span><span class="o">*</span><span class="p">(</span><span class="n">npg</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;component&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compKey</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fillRate</span> <span class="o">=</span> <span class="n">fillRate</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximalComponentSize</span> <span class="o">=</span> <span class="n">maximalComponentSize</span>

        <span class="c1"># setting the component relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;decomposing time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;decomposing&#39;</span><span class="p">]</span>  <span class="p">)</span>

        <span class="c1">#  compute boosted ranking in not threaded exceution</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;Threading&#39;</span><span class="p">]:</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBoostedRanking</span><span class="p">(</span>
                           <span class="n">rankingRule</span><span class="o">=</span><span class="n">componentRankingRule</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boostedOrder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boostedRanking</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ordering time: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ordering&#39;</span><span class="p">]</span>  <span class="p">)</span>
        <span class="c1">########</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">ttot</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save2File</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showShort</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">save2File</span><span class="p">)</span>


    <span class="c1"># ----- class methods ------------</span>


<div class="viewcode-block" id="PreRankedConfidentOutrankingDigraph.computeCLTLikelihoods">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedConfidentOutrankingDigraph.computeCLTLikelihoods">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCLTLikelihoods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">distribution</span><span class="o">=</span><span class="s2">&quot;triangular&quot;</span><span class="p">,</span>
                              <span class="n">betaParameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the pairwise CLT likelihood of the at least as good as relation</span>
<span class="sd">        neglecting all considerable large performance differences polarisations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
        <span class="c1">#from random import gauss</span>
        <span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">criteriaList</span><span class="p">)</span>

        <span class="n">weightSquares</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">gWeight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
            <span class="n">weightSquares</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">gWeight</span><span class="o">*</span><span class="n">gWeight</span>
            <span class="n">sumWeights</span> <span class="o">+=</span> <span class="n">gWeight</span>
        <span class="n">concordanceRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recodeConcordanceValuation</span><span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">sortingRelation</span><span class="p">,</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>

        <span class="n">ccf</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">distribution</span> <span class="o">==</span> <span class="s1">&#39;uniform&#39;</span><span class="p">:</span>
            <span class="n">varFactor</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">distribution</span> <span class="o">==</span> <span class="s1">&#39;triangular&#39;</span><span class="p">:</span>
            <span class="n">varFactor</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">distribution</span> <span class="o">==</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">betaParameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">betaParameter</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span>
            <span class="n">varFactor</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
        <span class="c1">## elif distribution == &#39;beta(4,4)&#39;:</span>
        <span class="c1">##     varFactor = Decimal(&#39;1&#39;)/Decimal(&#39;9&#39;)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">concordanceRelation</span><span class="p">:</span>
            <span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">concordanceRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]:</span>
                <span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                    <span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterionCharacteristicFunction</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                    <span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">c</span><span class="p">])</span><span class="o">*</span><span class="n">weightSquares</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(c,x,y,ccf[x][y][c])</span>
                <span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">varFactor</span><span class="o">*</span><span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">])</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(x,y,ccf[x][y][&#39;std&#39;])</span>
        <span class="n">lh</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">concordanceRelation</span><span class="p">:</span>
            <span class="n">lh</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">concordanceRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]:</span>

                <span class="n">mean</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">concordanceRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
                <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ccf</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="s1">&#39;std&#39;</span><span class="p">])</span>
                <span class="n">lh</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_myGaussCDF</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">lh</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">lh</span></div>


    <span class="k">def</span> <span class="nf">_computeConfidentRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">sortingRelation</span><span class="p">,</span>
                               <span class="n">likelihoodLevel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the relation cut at likelihood level.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">likelihoodLevel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">likelihoodLevel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">likelihoodLevel</span><span class="p">)</span>
        <span class="n">confidenceCutLevel</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="n">confidentRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#actionsList = [x for x in self.actions]</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">:</span>
            <span class="n">lhx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">confidentRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">lhx</span><span class="p">:</span>
                <span class="n">lhxy</span> <span class="o">=</span> <span class="n">lhx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lhxy</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">likelihoodLevel</span><span class="p">:</span>
                    <span class="n">confidentRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">confidentRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="n">Max</span> <span class="ow">and</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">confidenceCutLevel</span><span class="p">:</span>
                        <span class="n">confidenceCutLevel</span> <span class="o">=</span> <span class="n">level</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span><span class="n">confidentRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidenceCutLevel</span> <span class="o">=</span> <span class="n">confidenceCutLevel</span>
        <span class="k">return</span> <span class="n">confidentRelation</span>

    <span class="k">def</span> <span class="nf">_recodeConcordanceValuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">oldRelation</span><span class="p">,</span><span class="n">sumWeights</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recodes the characteristic valuation according</span>
<span class="sd">        to the parameters given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">oldRelation</span><span class="p">,</span><span class="n">sumWeights</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>

<span class="c1">##        oldMax = Decimal(&#39;1&#39;)</span>
<span class="c1">##        oldMin = Decimal(&#39;-1&#39;)</span>
<span class="c1">##        oldMed = Decimal(&#39;0&#39;)</span>
        <span class="n">oldMax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">oldMin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">oldMed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">oldAmplitude</span> <span class="o">=</span> <span class="n">oldMax</span> <span class="o">-</span> <span class="n">oldMin</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;old: &#39;</span><span class="p">,</span><span class="n">oldMin</span><span class="p">,</span> <span class="n">oldMed</span><span class="p">,</span> <span class="n">oldMax</span><span class="p">,</span> <span class="n">oldAmplitude</span><span class="p">)</span>

        <span class="n">newMin</span> <span class="o">=</span> <span class="o">-</span><span class="n">sumWeights</span>
        <span class="n">newMax</span> <span class="o">=</span> <span class="n">sumWeights</span>
        <span class="n">newMed</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">newMax</span> <span class="o">+</span> <span class="n">newMin</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)))</span>
        <span class="n">newAmplitude</span> <span class="o">=</span> <span class="n">newMax</span> <span class="o">-</span> <span class="n">newMin</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;new: &#39;</span><span class="p">,</span> <span class="n">newMin</span><span class="p">,</span> <span class="n">newMed</span><span class="p">,</span> <span class="n">newMax</span><span class="p">,</span> <span class="n">newAmplitude</span><span class="p">)</span>

<span class="c1">##        actions = [x for x in self.actions]</span>
        <span class="n">newRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">oldRelation</span><span class="p">:</span>
            <span class="n">newRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">oldRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">oldRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldMax</span><span class="p">:</span>
                    <span class="n">newRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMax</span>
                <span class="k">elif</span> <span class="n">oldRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldMin</span><span class="p">:</span>
                    <span class="n">newRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMin</span>
                <span class="k">elif</span> <span class="n">oldRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldMed</span><span class="p">:</span>
                    <span class="n">newRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMed</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">newRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMin</span> <span class="o">+</span>\
                        <span class="p">((</span><span class="n">oldRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">oldMin</span><span class="p">)</span><span class="o">/</span><span class="n">oldAmplitude</span><span class="p">)</span><span class="o">*</span><span class="n">newAmplitude</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">oldRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">],</span><span class="n">newRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">newRelation</span>

    <span class="k">def</span> <span class="nf">_myGaussCDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">Bipolar</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bipolar error function of z = (x-mu)/sigma) divided by sqrt(2).</span>
<span class="sd">        If Bipolar = False,</span>
<span class="sd">        renders the Gauss cdf(z) = [erf( z ) + 1] / 2</span>
<span class="sd">        sqrt(2) = 1.4142135623731</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#print(mean,sigma,x)</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span><span class="n">erf</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma</span> <span class="o">*</span> <span class="mf">1.4142135623731</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="n">Bipolar</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">erf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<div class="viewcode-block" id="PreRankedConfidentOutrankingDigraph.showRelationTable">
<a class="viewcode-back" href="../techDoc.html#sparseOutrankingDigraphs.PreRankedConfidentOutrankingDigraph.showRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerValues</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">actionsSubset</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">LikelihoodDenotation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">hasLatexFormat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">hasIntegerValuation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        prints the relation valuation in actions X actions table format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">LikelihoodDenotation</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">likelihoods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">likelihoods</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">LikelihoodDenotation</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">LikelihoodDenotation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">actionsSubset</span>

        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidentRelation</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* ---- Outranking Relation Table -----&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LikelihoodDenotation</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r/(lh) | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; r()   | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="c1">#actions = [x for x in actions]</span>
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">frozenset</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">)]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">actionsList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">hasIntegerValuation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">hasIntegerValuation</span> <span class="o">=</span> <span class="n">IntegerValues</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&#39;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-------|------------------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hasLatexFormat</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;$ &amp; &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&#39; |&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">hasLatexFormat</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">%+d</span><span class="s1">$ &amp;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%+d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">hasLatexFormat</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">%+.2f</span><span class="s1">$ &amp; &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%+.2f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">hasLatexFormat</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1">cr&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">LikelihoodDenotation</span><span class="p">:</span>
                <span class="n">headString</span> <span class="o">=</span> <span class="s2">&quot;&#39; &quot;</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;&#39; &quot;</span>
                <span class="n">formatStr</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">headString</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">formatStr</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">%+.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">likelihoods</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ( - ) &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valuation domain : [</span><span class="si">%+.3f</span><span class="s1">; </span><span class="si">%+.3f</span><span class="s1">] &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Uncertainty model: </span><span class="si">%s</span><span class="s1">(a=</span><span class="si">%.1f</span><span class="s1">,b=</span><span class="si">%.1f</span><span class="s1">) &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">betaParameter</span><span class="p">)</span>
                                                         <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Likelihood domain: [-1.0;+1.0] &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Likelihood level : </span><span class="si">%.2f</span><span class="s1"> (</span><span class="si">%.2f%%</span><span class="s1">) &#39;</span> \
              <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span><span class="p">,</span>
                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bipolarConfidenceLevel</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Determinateness  : </span><span class="si">%.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeDeterminateness</span><span class="p">()</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
</div>


<span class="c1">#######################################################################</span>
<span class="c1">#######################################################################</span>
<span class="c1">#----------test classes and methods ----------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Digraph3 sparseOutrankingDigraphs module         *</span>
<span class="s2">    * Copyright (C) 2010-2021 Raymond Bisdorff         *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Testing classes and methods -------&#39;</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
    <span class="n">MP</span>  <span class="o">=</span> <span class="kc">True</span>
    <span class="n">nbrActions</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">tp</span> <span class="o">=</span> <span class="n">RandomCBPerformanceTableau</span><span class="p">(</span><span class="n">numberOfActions</span><span class="o">=</span><span class="n">nbrActions</span><span class="p">,</span>
                                    <span class="n">BigData</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">bg1</span> <span class="o">=</span> <span class="n">PreRankedOutrankingDigraph</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span><span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">quantiles</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                 <span class="n">quantilesOrderingStrategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                 <span class="n">componentRankingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">,</span>
                                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                 <span class="n">Threading</span><span class="o">=</span><span class="n">MP</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                 <span class="c1">#tempDir=&#39;.&#39;,</span>
                                 <span class="n">startMethod</span><span class="o">=</span><span class="s1">&#39;spawn&#39;</span><span class="p">,</span>
                                 <span class="n">nbrOfThreads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                 <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">save2File</span><span class="o">=</span><span class="s1">&#39;testbgMP&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bg1</span><span class="p">,</span><span class="n">bg1</span><span class="o">.</span><span class="n">startMethod</span><span class="p">)</span>
    <span class="n">bg1</span><span class="o">.</span><span class="n">showDecomposition</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;increasing&#39;</span><span class="p">)</span>
    <span class="n">bg1</span><span class="o">.</span><span class="n">showHTMLRelationTable</span><span class="p">()</span>

    <span class="n">seed</span><span class="o">=</span> <span class="mi">1</span>
    <span class="n">sampleSize</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bg1</span><span class="o">.</span><span class="n">estimateRankingCorrelation</span><span class="p">(</span><span class="n">sampleSize</span><span class="p">,</span><span class="n">seed</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>
<span class="c1">#####################################</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2024, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Sep 04, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>