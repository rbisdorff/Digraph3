

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sortingDigraphs &mdash; Digraph3 3.13.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=a126d08a"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=15d7cbb8"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">sortingDigraphs</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sortingDigraphs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Digraph3 collection of python3 modules for</span>
<span class="sd">Algorithmic Decision Theory applications.</span>

<span class="sd">Module for sorting and rating applications.</span>

<span class="sd">Copyright (C) 2016-2025  Raymond Bisdorff.</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR ANY PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along</span>
<span class="sd">    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="sd">    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#######################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.13.13&quot;</span>

<span class="c1">#from digraphsTools import *</span>
<span class="c1">#from digraphs import *</span>
<span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sortingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1">#from multiprocessing import Process, active_children</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="c1">#mpctx = mp.get_context(&#39;spawn&#39;)</span>
<span class="c1">#Process = mpctx.Process</span>
<span class="c1">#active_children = mpctx.active_children</span>
<span class="c1">#cpu_count = mpctx.cpu_count</span>

<span class="c1"># multiprocessing thread for SortingDigraph class</span>

<span class="k">class</span> <span class="nc">_myThread</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">catKeys</span><span class="p">,</span><span class="n">LowerClosed</span><span class="p">,</span><span class="n">Debug</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span> <span class="o">=</span> <span class="n">tempDirName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catKeys</span> <span class="o">=</span> <span class="n">catKeys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
        <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
        <span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting working in </span><span class="si">%s</span><span class="s2"> on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;actions,catKeys&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">catKeys</span><span class="p">)</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpSelfRelation.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="c1">#context = loads(fi.read())</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">catKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catKeys</span>
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="c1">#relation = context.relation</span>
        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">catKeys</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">cMinKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="n">cMaxKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">cMaxKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1">: low = </span><span class="si">%.2f</span><span class="s1">, high = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                                       <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>
                                                       <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;sorting-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threadID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">sorting</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="SortingDigraph">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">SortingDigraph</span><span class="p">(</span><span class="n">BipolarOutrankingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of the digraphs.BipolarOutrankingDigraph Class</span>
<span class="sd">    for Condorcet based multicriteria sorting of alternatives.</span>

<span class="sd">    Besides a valid PerformanceTableau instance we require a sorting profile,</span>
<span class="sd">    i.e.:</span>

<span class="sd">         * a dictionary &lt;categories&gt; of categories with &#39;name&#39;, &#39;order&#39; and &#39;comment&#39;</span>
<span class="sd">         * a dictionary &lt;criteriaCategoryLimits&gt; with double entry:</span>

<span class="sd">               [criteriakey][categoryKey] containing a [&#39;minimum&#39;] and</span>
<span class="sd">               a  [&#39;maximum&#39;] value in the scale of the criterion</span>
<span class="sd">               respecting the order of the categories.</span>

<span class="sd">    Template of required data for a 4-sorting::</span>
<span class="sd">        </span>
<span class="sd">        categories = {</span>
<span class="sd">                      &#39;c1&#39;: { &#39;name&#39;: &#39;week&#39;,&#39;order&#39;: 1,</span>
<span class="sd">                              &#39;lowLimit&#39;: 0,&#39;highLimit&#39;: 25,</span>
<span class="sd">                              &#39;comment&#39;: &#39;lowest category&#39;,},</span>
<span class="sd">                      &#39;c2&#39;: { &#39;name&#39;: &#39;ok&#39;,&#39;order&#39;: 2,</span>
<span class="sd">                              &#39;lowLimit&#39;: 25,&#39;highLimit&#39;: 50,</span>
<span class="sd">                              &#39;comment&#39;: &#39;medium category&#39;,},</span>
<span class="sd">                      &#39;c3&#39;: { &#39;name&#39;: &#39;good&#39;,&#39;order&#39;: 3,</span>
<span class="sd">                              &#39;lowLimit&#39;: 50,&#39;highLimit&#39;: 75,</span>
<span class="sd">                              &#39;comment&#39;: &#39;highest category&#39;,},</span>
<span class="sd">                      &#39;c4&#39;: { &#39;name&#39;: &#39;excellent&#39;,&#39;order&#39;: 4,</span>
<span class="sd">                              &#39;lowLimit&#39;: 75,&#39;highLimit&#39;: 100,</span>
<span class="sd">                              &#39;comment&#39;: &#39;highest category&#39;,},</span>
<span class="sd">         }</span>
<span class="sd">        criteriaCategoryLimits[&#39;LowerClosed&#39;] = True # default</span>
<span class="sd">        criteriaCategoryLimits[g] = {</span>
<span class="sd">                &#39;c1&#39;: {&#39;minimum&#39;:0, &#39;maximum&#39;:25},</span>
<span class="sd">                &#39;c2&#39;: {&#39;minimum&#39;:25, &#39;maximum&#39;:50},</span>
<span class="sd">                &#39;c3&#39;: {&#39;minimum&#39;:50, &#39;maximum&#39;:75},</span>
<span class="sd">                &#39;c4&#39;: {&#39;minimum&#39;:75, &#39;maximum&#39;:200},</span>
<span class="sd">         }</span>

<span class="sd">    A template named tempProfile.py is providied in the digraphs module distribution.</span>
<span class="sd">        </span>
<span class="sd">    .. note::</span>

<span class="sd">        We generally require a performanceTableau instance and a filename</span>
<span class="sd">        where categories and a profile my be read from. If no such filename is given,</span>
<span class="sd">        then a default profile with five, equally spaced, categories is used</span>
<span class="sd">        on each criteria. By default lower-closed limts of categories are</span>
<span class="sd">        supposed to be used in the sorting.</span>

<span class="sd">    Example Python3 session:</span>

<span class="sd">    &gt;&gt;&gt; from sortingDigraphs import SortingDigraph</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; t = RandomPerformanceTableau(seed=100)</span>
<span class="sd">    &gt;&gt;&gt; [x for x in t.actions]</span>
<span class="sd">    [&#39;a01&#39;, &#39;a02&#39;, &#39;a03&#39;, &#39;a04&#39;, &#39;a05&#39;, &#39;a06&#39;, &#39;a07&#39;, &#39;a08&#39;,</span>
<span class="sd">    &#39;a09&#39;, &#39;a10&#39;, &#39;a11&#39;, &#39;a12&#39;, &#39;a13&#39;]</span>
<span class="sd">    &gt;&gt;&gt; so = SortingDigraph(t,scaleSteps=5)</span>
<span class="sd">    &gt;&gt;&gt; # so gives a sorting result into five lower closed ordered</span>
<span class="sd">    &gt;&gt;&gt; # categories enumerated from 0 to 5.</span>
<span class="sd">    &gt;&gt;&gt; so.showSorting()</span>
<span class="sd">    *--- Quantiles Sorting results in descending order ---*</span>
<span class="sd">    ]&gt; - c5]: 	 []</span>
<span class="sd">    ]c5 - c4]: 	 [&#39;a02&#39;, &#39;a08&#39;]</span>
<span class="sd">    ]c4 - c3]: 	 [&#39;a01&#39;, &#39;a03&#39;, &#39;a05&#39;, &#39;a07&#39;, &#39;a08&#39;, &#39;a10&#39;, &#39;a11&#39;, &#39;a12&#39;]</span>
<span class="sd">    ]c3 - c2]: 	 [&#39;a04&#39;, &#39;a06&#39;, &#39;a07&#39;, &#39;a09&#39;, &#39;a11&#39;, &#39;a13&#39;]</span>
<span class="sd">    ]c2 - c1]: 	 []</span>
<span class="sd">    &gt;&gt;&gt; # Notice that some alternatives, like a07, a08, and a11 are sorted</span>
<span class="sd">    &gt;&gt;&gt; # into more than one adjacent category. Weak ordering the sorting result</span>
<span class="sd">    &gt;&gt;&gt; # into ordered adjacent categories gives following result:</span>
<span class="sd">    &gt;&gt;&gt; so.showWeakOrder(strategy=&#39;average&#39;,Descending=True)</span>
<span class="sd">    Weak ordering with average normalized 5-sorting limits</span>
<span class="sd">    [c4]   : [&#39;a02&#39;]</span>
<span class="sd">    [c4-c3] : [&#39;a08&#39;]</span>
<span class="sd">    [c3]   : [&#39;a01&#39;, &#39;a03&#39;, &#39;a05&#39;, &#39;a10&#39;, &#39;a12&#39;]</span>
<span class="sd">    [c3-c2] : [&#39;a07&#39;, &#39;a11&#39;]</span>
<span class="sd">    [c2]   : [&#39;a04&#39;, &#39;a06&#39;, &#39;a09&#39;, &#39;a13&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">argProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">scaleSteps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">minValuation</span><span class="o">=-</span><span class="mf">100.0</span><span class="p">,</span>
                 <span class="n">maxValuation</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
                 <span class="n">isRobust</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tempDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrCores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for SortingDigraph instances.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

        <span class="c1"># import or generate a performance tableau</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">argPerfTab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! No valid performance tableau given!!&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Random standard performance tableau generated!!&#39;</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="n">RandomPerformanceTableau</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">RandomPerformanceTableau</span><span class="p">(</span><span class="n">numberOfActions</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                               <span class="n">numberOfCriteria</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argPerfTab</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">perfTab</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">argPerfTab</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;file </span><span class="si">%s</span><span class="s1"> not in perfTabs.PerformanceTableauformat!&#39;</span> <span class="o">%</span> <span class="n">argPerfTab</span><span class="p">)</span>
                <span class="n">perfTab</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>

        <span class="c1"># normalize the actions as a dictionary construct</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>

        <span class="c1"># keep a copy of the original actions set before adding the profiles</span>
        <span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">actionsOrig</span>
        
        <span class="c1">#  input the profiles</span>
        <span class="k">if</span> <span class="n">argProfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">defaultProfiles</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># normalize the actions as a dictionary construct</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
                <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                    <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Decimal</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argProfile</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="c1"># input from stored instantiation</span>
                <span class="n">fileName</span> <span class="o">=</span> <span class="n">argProfile</span>
                <span class="n">fileNameExt</span> <span class="o">=</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
                <span class="n">profile</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
                <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">profile</span><span class="p">)</span>
                <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="c1">#print(profile)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">profile</span><span class="p">[</span><span class="s1">&#39;criteriaCategoryLimits&#39;</span><span class="p">]</span>
<span class="c1">#                self.profiles = profile[&#39;profiles&#39;]</span>
<span class="c1">#                self.profileLimits = set(self.profiles[&#39;min&#39;]) | \</span>
<span class="c1">#                                     set(self.profiles[&#39;max&#39;])</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># input from a profiles dictionary</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sorting_with_given_profile&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">argProfile</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">argProfile</span><span class="p">[</span><span class="s1">&#39;criteriaCategoryLimits&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#                self.profiles = {}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">defaultProfiles</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sorting_with_default_profiles&#39;</span>
            <span class="n">normPerfTab</span> <span class="o">=</span> <span class="n">NormalizedPerformanceTableau</span><span class="p">(</span><span class="n">perfTab</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">actions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">criteria</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Decimal</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">evaluation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>
            <span class="c1"># supposing all criteria scales between 0.0 and 100.0</span>
            <span class="n">lowValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
            <span class="n">highValue</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">)</span>
            <span class="c1"># with preference direction = max</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">highValue</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">scaleSteps</span><span class="p">))</span>
            <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">scaleSteps</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">scaleSteps</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:(</span><span class="s1">&#39;c</span><span class="si">%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                                     <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">,</span>
                                     <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">k</span><span class="p">)),</span>
                                     <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">))}</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
            <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> \
                     <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">scaleSteps</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">scaleSteps</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">gHighLimit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gHighLimit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">gLowLimit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gLowLimit</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">=</span><span class="p">{</span>
                        <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">gLowLimit</span><span class="p">),</span>
                        <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">gHighLimit</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
            
            <span class="c1"># set the category limits type (LowerClosed = True)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dataInput&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span><span class="p">}</span>
        

        <span class="c1"># add the catogory limits to the actions set</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:{},</span><span class="s1">&#39;max&#39;</span><span class="p">:{}}</span>
        <span class="n">profileLimits</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">cMinKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
            <span class="n">cMaxKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
            <span class="n">profileLimits</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cMinKey</span><span class="p">)</span>
            <span class="n">profileLimits</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cMaxKey</span><span class="p">)</span>
            <span class="n">actions</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="n">actions</span><span class="p">[</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>
                        <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]))</span>
                        <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">defaultProfiles</span><span class="p">:</span>
                            <span class="n">highValueg</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">highValueg</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">highValue</span><span class="p">)</span>
                        <span class="c1">#print &#39;highValue = &#39;, highValue</span>
                        <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">highValueg</span> <span class="o">-</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">])))</span>
                        <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">highValueg</span> <span class="o">-</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">])))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;===&gt;&gt;&gt;&gt;&gt; Error&#39;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>

                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">]))</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]))</span>
                <span class="c1">#print &#39;LowerClosed&#39;, LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span> <span class="o">=</span> <span class="n">profileLimits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">LowerClosed</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>

        
        <span class="c1"># construct outranking relation</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">isRobust</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">RobustOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">relation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">minValuation</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">maxValuation</span><span class="p">)</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="p">(</span><span class="n">Max</span> <span class="o">+</span> <span class="n">Min</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Med</span> <span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span> <span class="p">}</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">relation</span> <span class="o">=</span> \
                    <span class="n">BipolarOutrankingDigraph</span><span class="o">.</span><span class="n">_constructRelationWithThreading</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span><span class="n">criteria</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">,</span>
                        <span class="n">initial</span><span class="o">=</span><span class="n">actionsOrig</span><span class="p">,</span>
                        <span class="n">terminal</span><span class="o">=</span><span class="n">profileLimits</span><span class="p">,</span>
                        <span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span>
                        <span class="n">hasBipolarVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                        <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                        <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">,</span>
                        <span class="n">tempDir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">,</span>
                        <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">relation</span> <span class="o">=</span> \
                    <span class="n">BipolarOutrankingDigraph</span><span class="o">.</span><span class="n">_constructRelationWithThreading</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span><span class="n">criteria</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">,</span>
                        <span class="n">terminal</span><span class="o">=</span><span class="n">actionsOrig</span><span class="p">,</span>
                        <span class="n">initial</span><span class="o">=</span><span class="n">profileLimits</span><span class="p">,</span>
                        <span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span>
                        <span class="n">hasBipolarVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                        <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                        <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">,</span>
                        <span class="n">tempDir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">,</span>
                        <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profileLimits</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">profileLimits</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
        
        <span class="c1"># compute weak ordering</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">sortingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingRelation</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,)</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">srx</span> <span class="o">=</span> <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">srx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>

        <span class="c1"># reset original action set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actionsOrig</span>

        <span class="c1"># compute weak ordering by choosing</span>
        <span class="c1"># self.computeRankingByChoosing() !!! not scalable !!!</span>
        <span class="c1"># obsolete: replaced by self.computeWeakOrder()</span>

        <span class="c1"># init general digraph Data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;weakOrdering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span>

<span class="c1">#########</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default presentation method for BipolarOutrankingDigraph instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">String</span> <span class="o">=</span>  <span class="s1">&#39;*-----  Object instance description -----------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Instance class      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Instance name       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Actions             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Criteria            : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Categories          : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Lowerclosed         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Size                : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>   <span class="c1"># not for quantiles sorted digraphs</span>
            <span class="k">pass</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Valuation domain    : [</span><span class="si">%.2f</span><span class="s1">;</span><span class="si">%.2f</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span>\
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Determinateness (</span><span class="si">%%</span><span class="s1">): </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeDeterminateness</span><span class="p">(</span><span class="n">InPercents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># not for quantiles sorted digraphs</span>
            <span class="k">pass</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Attributes          : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;*------  Constructor run times (in sec.) ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Threads             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Threads             : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Start method        : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Total time          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Data input          : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute profiles    : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute relation    : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeRelation&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Weak Ordering       : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;weakOrdering&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">String</span> 

    <span class="k">def</span> <span class="nf">saveCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempCategories&#39;</span><span class="p">):</span>

        <span class="n">fileName</span> <span class="o">+=</span> <span class="s1">&#39;.py&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving sorting categories in file: &lt;</span><span class="si">%s</span><span class="s1">&gt; ---*&#39;</span> <span class="o">%</span> <span class="n">fileName</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# categories save method from the SortingDigraph class</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
           <span class="c1"># save categories</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;categories = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,</span><span class="si">%s</span><span class="s1">),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">])))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># save criteria category limits</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;criteriaCategoryLimits = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">LowerClosed</span><span class="se">\&#39;</span><span class="s1">,</span><span class="si">%s</span><span class="s1">),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                     <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]))</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,{</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> :</span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                             <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">]))</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># close</span>
        
        
<div class="viewcode-block" id="SortingDigraph.htmlCriteriaCategoryLimits">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.htmlCriteriaCategoryLimits">[docs]</a>
    <span class="k">def</span> <span class="nf">htmlCriteriaCategoryLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tableTitle</span><span class="o">=</span><span class="s1">&#39;Category limits&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders category minimum and maximum limits for each criterion</span>
<span class="sd">        as a html table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;&#39;</span> <span class="o">%</span> <span class="n">tableTitle</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table border=&quot;1&quot;&gt;&#39;</span>

        <span class="n">criterionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">categoryKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th&gt;Criteria&lt;/th&gt;&#39;</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criterionKeys</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">g</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>

        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criterionKeys</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th&gt;Lower limit&lt;/th&gt;&#39;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categoryKeys</span><span class="p">:</span>
                <span class="c1">#print &#39;\t&#39;, c, (self.criteriaCategoryLimits[g][c][&#39;minimum&#39;],self.criteriaCategoryLimits[g][c][&#39;maximum&#39;])</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;%2.f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">])</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th&gt;Upper limit&lt;/th&gt;&#39;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categoryKeys</span><span class="p">:</span>
                <span class="c1">#print &#39;\t&#39;, c, (self.criteriaCategoryLimits[g][c][&#39;minimum&#39;],self.criteriaCategoryLimits[g][c][&#39;maximum&#39;])</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;%2.f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>

        <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
        <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="SortingDigraph.computeWeakOrder">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.computeWeakOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">computeWeakOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                         <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        specialisation of the showWeakOrder method.</span>
<span class="sd">        The weak ordering strategy may be:</span>

<span class="sd">           &quot;optimistic&quot; (ranked by highest category limits),</span>
<span class="sd">           &quot;pessimistic&quot; (ranked by lowest category limits) or</span>
<span class="sd">           &quot;average&quot; (ranked by average category limits)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="n">actionsCategories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">actionsCategoryLimits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span> <span class="c1"># average by default</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
                <span class="n">ac</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">+</span><span class="n">hc</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                        <span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">])][</span><span class="s1">&#39;categoryContent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                       <span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">])]</span> <span class="o">=</span>\
                                        <span class="p">{</span><span class="s1">&#39;categoryContent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="s1">&#39;categoryInterval&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">)}</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># strategy == &quot;optimistic&quot; or &quot;pessimistic&quot;:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                       <span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">])][</span><span class="s1">&#39;categoryContent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">categories</span><span class="p">[</span><span class="n">highCateg</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                       <span class="n">categories</span><span class="p">[</span><span class="n">lowCateg</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">])]</span> <span class="o">=</span>\
                                        <span class="p">{</span><span class="s1">&#39;categoryContent&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="s1">&#39;categoryInterval&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">)}</span>                                                            
        <span class="c1">#print(actionsCategories)    </span>
        <span class="n">actionsCategIntervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">actionsCategories</span><span class="p">:</span>
            <span class="c1">#print(interval)</span>
            <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">interval</span><span class="p">,</span>\
                                          <span class="n">actionsCategories</span><span class="p">[</span><span class="n">interval</span><span class="p">]])</span>
        <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">catKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">]</span>
        <span class="c1">#print(catKeys)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Weak ordering with </span><span class="si">%s</span><span class="s1"> normalized </span><span class="si">%d</span><span class="s1">-sorting limits&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">strategy</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="k">for</span> <span class="n">ci</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">actionsCategIntervals</span><span class="p">):</span>
            <span class="c1">#print(item[1])</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;categoryInterval&#39;</span><span class="p">]</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;categoryContent&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
<span class="c1">##                if strategy == &quot;average&quot;:</span>
                <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">catName0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]   : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catName0</span><span class="p">,</span><span class="n">content</span><span class="p">)</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">catName0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="n">catName1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">] : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catName1</span><span class="p">,</span>
                                                <span class="n">catName0</span><span class="p">,</span>
                                                <span class="n">content</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">catName1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]   : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catName1</span><span class="p">,</span>
                                               <span class="n">content</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">catName0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="n">catName1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">] : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catName0</span><span class="p">,</span>
                                                <span class="n">catName1</span><span class="p">,</span>
                                                <span class="n">content</span> <span class="p">)</span> <span class="p">)</span>                           
                            

            <span class="n">weakOrdering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">weakOrdering</span></div>


<div class="viewcode-block" id="SortingDigraph.showWeakOrder">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showWeakOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">showWeakOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; dummy for computeWeakOrder with Comments=True &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeWeakOrder</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

        

<div class="viewcode-block" id="SortingDigraph.computeSortingRelation">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.computeSortingRelation">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSortingRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">categoryContents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constructs a bipolar sorting relation using the category contents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">categoryContents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">categoryContents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
        <span class="n">categoryKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>

        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span><span class="p">]</span>
        <span class="n">currActions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="c1">#sortedActions = set()</span>
        <span class="n">sortingRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">srx</span> <span class="o">=</span> <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">srx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categoryContents&#39;</span><span class="p">,</span><span class="n">categoryContents</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">categoryKeys</span><span class="p">:</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">categoryContents</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ribch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">currActions</span><span class="p">)</span> <span class="o">-</span> <span class="n">ibch</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ibch,ribch&#39;</span><span class="p">,</span><span class="n">ibch</span><span class="p">,</span><span class="n">ribch</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ibch</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ibch</span><span class="p">:</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ribch</span><span class="p">:</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
            <span class="n">currActions</span> <span class="o">=</span> <span class="n">currActions</span> <span class="o">-</span> <span class="n">ibch</span>
        <span class="k">return</span> <span class="n">sortingRelation</span></div>



<div class="viewcode-block" id="SortingDigraph.showCriteriaCategoryLimits">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showCriteriaCategoryLimits">[docs]</a>
    <span class="k">def</span> <span class="nf">showCriteriaCategoryLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows category minimum and maximum limits for each criterion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> [</span><span class="si">%s</span><span class="s1">; </span><span class="si">%s</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> ]</span><span class="si">%s</span><span class="s1">; </span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">]))</span></div>


<div class="viewcode-block" id="SortingDigraph.getActionsKeys">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.getActionsKeys">[docs]</a>
    <span class="k">def</span> <span class="nf">getActionsKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">withoutProfiles</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extract normal actions keys()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">profiles_m</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">])</span>
        <span class="n">profiles_M</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsExt</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">withoutProfiles</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">actionsExt</span> <span class="o">-</span> <span class="n">profiles_m</span> <span class="o">-</span> <span class="n">profiles_M</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">actionsExt</span> <span class="o">|</span> <span class="n">profiles_m</span> <span class="o">|</span> <span class="n">profiles_M</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">action</span><span class="p">])</span>           </div>


<div class="viewcode-block" id="SortingDigraph.orderedCategoryKeys">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.orderedCategoryKeys">[docs]</a>
    <span class="k">def</span> <span class="nf">orderedCategoryKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the ordered list of category keys</span>
<span class="sd">        based on self.categories[&#39;order&#39;] numeric values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">orderedCategoryKeys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">Reverse</span><span class="p">:</span>
            <span class="n">orderedCategoryKeys</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">orderedCategoryKeys</span></div>


    <span class="k">def</span> <span class="nf">_computeWeakOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation for QuantilesSortingDigraphs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">cC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
            <span class="n">cCKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cCKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">cCKeys</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cC</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">setx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">sety</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">setx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
                <span class="n">setx</span> <span class="o">=</span> <span class="n">setx</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
                <span class="n">sety</span> <span class="o">=</span> <span class="n">sety</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">)),</span><span class="n">y</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">n2</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n2</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n2</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),[])</span> <span class="p">)</span> <span class="p">)</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
        
        <span class="n">orderingList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">orderingList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">orderingList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">orderingList</span>

<div class="viewcode-block" id="SortingDigraph.showOrderedRelationTable">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showOrderedRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showOrderedRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;decreasing&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Showing the relation table in decreasing (default) or increasing order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;decreasing&quot;</span><span class="p">:</span>
            <span class="n">Descending</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Descending</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeakOrder</span><span class="p">(</span><span class="n">Descending</span><span class="p">)</span>
        
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">weakOrdering</span><span class="p">:</span>
            <span class="c1">#print(eq)</span>
            <span class="n">eq</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eq</span><span class="p">:</span>
                <span class="n">actionsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !: missing action(s) </span><span class="si">%s</span><span class="s1"> in ordered table.&#39;</span><span class="p">)</span>
            
        <span class="n">Digraph</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                                <span class="n">relation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">,</span>
                                <span class="n">Sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="SortingDigraph.exportDigraphGraphViz">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.exportDigraphGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportDigraphGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bestChoice</span><span class="o">=</span><span class="nb">set</span><span class="p">(),</span><span class="n">worstChoice</span><span class="o">=</span><span class="nb">set</span><span class="p">(),</span>
                              <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                              <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for digraph drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Digraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                               <span class="n">bestChoice</span><span class="o">=</span><span class="n">bestChoice</span><span class="p">,</span>
                               <span class="n">worstChoice</span><span class="o">=</span><span class="n">worstChoice</span><span class="p">,</span>
                               <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                               <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                               <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                               <span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">)</span></div>



<div class="viewcode-block" id="SortingDigraph.exportGraphViz">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.exportGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;decreasing&#39;</span><span class="p">,</span>
                       <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                       <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                       <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                       <span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for weak order (Hasse diagram) drawing</span>
<span class="sd">        filtering from SortingDigraph instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

        <span class="k">def</span> <span class="nf">_safeName</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
                <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">t1</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">return</span> <span class="n">t1</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in nodeName: </span><span class="si">%s</span><span class="s1"> !!&#39;</span> <span class="o">%</span> <span class="n">t0</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">t0</span>
                
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;decreasing&#39;</span><span class="p">:</span>
            <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeakOrder</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeakOrder</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
                    
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>

        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="n">bgcolor</span><span class="p">)</span>            
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">Digraph3 (graphviz)</span><span class="se">\\</span><span class="s1">n R. Bisdorff, 2020&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;,fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fontSize</span><span class="p">)</span>
        <span class="c1"># nodes</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                   <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            
        <span class="c1"># same ranks for Hasses equivalence classes</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">sameRank</span> <span class="o">=</span> <span class="s1">&#39;{ rank = </span><span class="si">%d</span><span class="s1">; &#39;</span> <span class="o">%</span> <span class="n">i</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="n">sameRank</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;; &#39;</span>
            <span class="n">sameRank</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sameRank</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sameRank</span><span class="p">)</span>
            
        <span class="c1"># write out skeleton of sorting relation</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">InSite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Mwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="n">relx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                    <span class="n">jch</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">jch</span><span class="p">:</span>
                        <span class="n">relxy</span> <span class="o">=</span> <span class="n">relx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">relxy</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                            <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                            <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                   <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">relxy</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                            <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                            <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                                   <span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                                                  
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;dot -Grankdir=TB -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="c1">#commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SortingDigraph.computeSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.computeSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                        <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
            
        <span class="c1">#categories = list(self.orderedCategoryKeys())</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Threading</span><span class="p">:</span>
            <span class="c1">#from multiprocessing import Process, active_children</span>
            <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
            <span class="c1">#from os import cpu_count</span>
            <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
            <span class="k">if</span> <span class="n">startMethod</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">startMethod</span> <span class="o">=</span> <span class="s1">&#39;spawn&#39;</span>
            <span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>
            <span class="n">Process</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Process</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threaded computing of sorting characteristics ...&#39;</span><span class="p">)</span>        
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span><span class="p">,</span><span class="n">mkdtemp</span>
            <span class="n">tempDirName</span> <span class="o">=</span> <span class="n">mkdtemp</span><span class="p">()</span>
            <span class="n">td</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">selfFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpSelfRelation.py&#39;</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temDirName, selfFileName&#39;</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span><span class="n">selfFileName</span><span class="p">)</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">selfFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Relation dump: </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">td</span><span class="p">))</span>
           
            <span class="k">if</span> <span class="n">nbrOfCPUs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of actions&#39;</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
            
            <span class="n">nbrOfJobs</span> <span class="o">=</span> <span class="n">na</span><span class="o">//</span><span class="n">nbrOfCPUs</span>
            <span class="k">if</span> <span class="n">nbrOfJobs</span><span class="o">*</span><span class="n">nbrOfCPUs</span> <span class="o">&lt;</span> <span class="n">na</span><span class="p">:</span>
                <span class="n">nbrOfJobs</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of threads = &#39;</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of jobs/thread&#39;</span><span class="p">,</span><span class="n">nbrOfJobs</span><span class="p">)</span>
            <span class="n">nbrOfThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrOfCPUs</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thread = </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
                <span class="n">start</span><span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="n">nbrOfJobs</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nbrOfJobs</span> <span class="o">&lt;</span> <span class="n">na</span><span class="p">:</span>
                    <span class="n">stop</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nbrOfJobs</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stop</span> <span class="o">=</span> <span class="n">na</span>
                <span class="n">thActions</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">thActions</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">thActions</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">process</span> <span class="o">=</span> <span class="n">_mySDGThread</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">thActions</span><span class="p">,</span><span class="n">categories</span><span class="p">,</span><span class="n">LowerClosed</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                    <span class="n">process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                    <span class="n">nbrOfThreads</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="k">pass</span>
                <span class="c1">#sleep(1)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exit </span><span class="si">%d</span><span class="s1"> threads&#39;</span> <span class="o">%</span> <span class="n">nbrOfThreads</span><span class="p">)</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrOfThreads</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;job&#39;</span><span class="p">,</span><span class="n">th</span><span class="p">)</span>
                <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/sorting-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">sortingThread</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sortingThread&#39;</span><span class="p">,</span><span class="n">sortingThread</span><span class="p">)</span>
                <span class="n">sorting</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sortingThread</span><span class="p">)</span>
        <span class="c1"># end of Threading</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># with out Threading </span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">cMinKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                    <span class="n">cMaxKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMaxKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1">: low = </span><span class="si">%.2f</span><span class="s1">, high = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> \
                              <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

                    <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span>
        <span class="k">return</span> <span class="n">sorting</span></div>

    
<div class="viewcode-block" id="SortingDigraph.showSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">showSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            
        <span class="n">categoryKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">categoryKeys</span><span class="p">)):</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">cMinKey</span><span class="o">=</span> <span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="n">cMaxKey</span><span class="o">=</span> <span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMaxKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">categoryKeys</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in [</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">[</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in [</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">[</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                        
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in ]</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">]</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in ]</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">]</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                        
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>\
                                                  <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>\
                                                  <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">categoryKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span></div>


    <span class="k">def</span> <span class="nf">_computePessimisticSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary with category keys gathering the actions per ordered category on</span>
<span class="sd">        the basis of a bipolar valued outranking relation Stilde with low and high category limt profiles.</span>

<span class="sd">        An action x is added to cotegory c if (a Stilde c_min) &gt; Med and a Stilde C_Max &lt;= Med.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">()</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>

        <span class="n">sorts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="n">sorts</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">overMin</span><span class="o">=</span><span class="kc">True</span>
                <span class="n">overMax</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cMinKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="n">cMaxKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">: low = </span><span class="si">%.2f</span><span class="s1">, high = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMinKey</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">overMin</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">overMax</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="c1">#print &#39;\t %s: low = %.2f, high = %.2f&#39; % (c,self.relation[x][cMinKey],self.relation[x][cMaxKey])</span>
                    <span class="n">sorts</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">overMin</span> <span class="ow">and</span> <span class="n">overMax</span><span class="p">:</span>
                <span class="c1">#print &#39;\t %s: low = %.2f, high = %.2f&#39; % (c,self.relation[x][cMinKey],self.relation[x][cMaxKey])</span>
                <span class="n">sorts</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sorting results&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">sorts</span><span class="p">[</span><span class="n">c</span><span class="p">])))</span>
        <span class="k">return</span> <span class="n">sorts</span>

<div class="viewcode-block" id="SortingDigraph.computeCategoryContents">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.computeCategoryContents">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCategoryContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the sorting results per category.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">())</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>

        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">):</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span> <span class="o">=</span> <span class="n">categoryContent</span>
        <span class="k">return</span> <span class="n">categoryContent</span></div>

                                                     
<div class="viewcode-block" id="SortingDigraph.showSorting">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows sorting results in decreasing or increasing (Reverse=False)</span>
<span class="sd">        order of the categories. If isReturningHTML is True (default = False)</span>
<span class="sd">        the method returns a htlm table with the sorting result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#from string import replace</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">true</span>
        <span class="k">if</span> <span class="n">Reverse</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Quantiles Sorting results in descending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">prev_c</span> <span class="o">=</span> <span class="s1">&#39;&gt;&#39;</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">prev_c</span> <span class="o">=</span> <span class="s1">&#39;&amp;gt;&#39;</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in descending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Categories&lt;/th&gt;&lt;th&gt;Assorting&lt;/th&gt;&lt;/tr&gt;&#39;</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">):</span>
                <span class="n">cName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;]</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">]:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prev_c</span><span class="p">,</span><span class="n">cName</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;]</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">]&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prev_c</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
                        <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">[:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prev_c</span><span class="p">,</span><span class="n">cName</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;[</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">[&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prev_c</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
                        <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>
                <span class="n">prev_c</span> <span class="o">=</span> <span class="n">cName</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in ascending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in ascending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Categories&lt;/th&gt;&lt;th&gt;Assorting&lt;/th&gt;&lt;/tr&gt;&#39;</span>
            <span class="n">cat</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">)]</span>
            <span class="n">cat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span>
            <span class="n">catNames</span> <span class="o">=</span>  <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">)]</span>                              
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">catNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">catNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">[:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catNames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">catNames</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;]</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">]&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;]</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">]:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catNames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">catNames</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                    <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;[</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">[&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">cat</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span></div>


<div class="viewcode-block" id="SortingDigraph.showActionCategories">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showActionCategories">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        Returns a tuple : action, lowest category key, highest category key, membership credibility !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
                                                     <span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span>
                                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                                     <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                     <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">sorting</span><span class="p">)</span>
        <span class="c1">#keys = []</span>
        <span class="n">catKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>
        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># action is sorted by default in all categories </span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>  <span class="c1"># the highest lowLimit is remembered</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>  <span class="c1"># the highest notHighLimit (lowest HigLimit) is remembered</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">],</span><span class="n">keys</span><span class="p">)</span>
        <span class="n">credibility</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                 <span class="n">action</span><span class="p">,</span>
                                 <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>\
                <span class="n">credibility</span>            </div>


<div class="viewcode-block" id="SortingDigraph.showActionsSortingResult">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.showActionsSortingResult">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionsSortingResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the quantiles sorting result all (default) of a subset of the decision actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">actionSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">actionSubset</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantiles sorting result per decision action&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>


<div class="viewcode-block" id="SortingDigraph.saveProfilesXMCDA2">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.SortingDigraph.saveProfilesXMCDA2">[docs]</a>
    <span class="k">def</span> <span class="nf">saveProfilesXMCDA2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;XMCDA 2.0 format&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sortinDigraphs Module (RB)&#39;</span><span class="p">,</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;saved from Python session&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sorting categories in XMCDA-2.0 format.&#39;</span><span class="p">,</span><span class="n">variant</span><span class="o">=</span><span class="s1">&#39;Rubis&#39;</span><span class="p">,</span><span class="n">valuationType</span><span class="o">=</span><span class="s1">&#39;bipolar&#39;</span><span class="p">,</span><span class="n">isStringIO</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">stringNA</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by saveProfilesXMCDA2()&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save profiles object self in XMCDA 2.0 format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">codecs</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- saving sorting profiles in XMCDA 2.0 format  -------------*&#39;</span><span class="p">)</span>
        <span class="n">nameExt</span> <span class="o">=</span> <span class="n">fileName</span><span class="o">+</span><span class="s1">&#39;.xml&#39;</span>
        <span class="k">if</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;produced by stringIO()&#39;</span>
            <span class="kn">import</span> <span class="nn">io</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#nameExt = fileName+&#39;.xmcda2&#39;</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">nameExt</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;xmcda2Rubis.xsl&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;&lt;xmcda:XMCDA xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://www.decision-deck.org/2010/XMCDA-2.1.0-Rubis http://leopold-loewenheim.uni.lu/XMCDA2/XMCDA-2.1.0-Rubis.xsd&quot; xmlns:xmcda=&quot;http://www.decision-deck.org/2010/XMCDA-2.1.0-Rubis&quot; instanceID=&quot;void&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>

        <span class="c1"># write description</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;projectReference id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="n">nameExt</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;author&gt;</span><span class="si">%s</span><span class="s1">&lt;/author&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/projectReference&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>


        <span class="c1">#  save categories</span>
        <span class="n">categoriesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">]</span>
        <span class="n">categoriesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categoriesList</span><span class="p">)</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;categories mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Sorting categories.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">na</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">categoryName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">categoriesList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">categoryName</span> <span class="o">=</span> <span class="n">categoriesList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;category id=&quot;</span><span class="si">%s</span><span class="s1">&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categoriesList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">categoryName</span><span class="p">,</span><span class="s1">&#39;sortingCategory&#39;</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">categoriesList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;comment&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;type&gt;real&lt;/type&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;active&gt;true&lt;/active&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/category&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/categories&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># save criteriaCategoryLimits</span>
        <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">]</span>
        <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">categoriesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">]</span>
        <span class="n">categoriesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criteriaCategoryLimits mcdaConcept=&quot;categoryProfiles&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;subTitle&gt;Sorting profiles.&lt;/subTitle&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categoriesList</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">criterionName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">criterionName</span> <span class="o">=</span> <span class="n">g</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">categoryName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">category</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">categoryName</span> <span class="o">=</span> <span class="n">c</span>

                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionCategoryLimits id=&quot;lim_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&quot; mcdaConcept=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criterionName</span><span class="p">,</span><span class="n">categoryName</span><span class="p">,</span><span class="s1">&#39;criterionCategoryLimits&#39;</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;comment&gt;</span><span class="si">%s</span><span class="s1">&lt;/comment&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;No comment&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;version&gt;</span><span class="si">%s</span><span class="s1">&lt;/version&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Rubis k-sorting&#39;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/description&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;criterionID&gt;</span><span class="si">%s</span><span class="s1">&lt;/criterionID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">criterionName</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;categoryID&gt;</span><span class="si">%s</span><span class="s1">&lt;/categoryID&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categoryName</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;lowLimit&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/lowLimit&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;minimum&#39;</span><span class="p">])</span> <span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;highLimit&gt;&lt;real&gt;</span><span class="si">%.2f</span><span class="s1">&lt;/real&gt;&lt;/highLimit&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;maximum&#39;</span><span class="p">])</span> <span class="p">)</span>

                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criterionCategoryLimits&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/criteriaCategoryLimits&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#########################</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/xmcda:XMCDA&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isStringIO</span><span class="p">:</span>
            <span class="n">problemText</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span>
            <span class="k">return</span> <span class="n">problemText</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File: &#39;</span> <span class="o">+</span> <span class="n">nameExt</span> <span class="o">+</span> <span class="s1">&#39; saved !&#39;</span><span class="p">)</span></div>
</div>


<span class="c1">##    def recodeValuation(self,newMin=-1.0,newMax=1.0,Debug=False):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        Recodes the characteristic valuation domain according</span>
<span class="c1">##        to the parameters given.</span>
<span class="c1">##</span>
<span class="c1">##        .. note::</span>
<span class="c1">##</span>
<span class="c1">##            Default values gives a normalized valuation domain</span>
<span class="c1">##</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        from copy import copy, deepcopy</span>
<span class="c1">##        oldMax = self.valuationdomain[&#39;max&#39;]</span>
<span class="c1">##        oldMin = self.valuationdomain[&#39;min&#39;]</span>
<span class="c1">##        oldMed = self.valuationdomain[&#39;med&#39;]</span>
<span class="c1">##</span>
<span class="c1">##        oldAmplitude = oldMax - oldMin</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(oldMin, oldMed, oldMax, oldAmplitude)</span>
<span class="c1">##</span>
<span class="c1">##        newMin = Decimal(str(newMin))</span>
<span class="c1">##        newMax = Decimal(str(newMax))</span>
<span class="c1">##        newMed = Decimal(&#39;%.3f&#39; % ((newMax + newMin)/Decimal(&#39;2.0&#39;)))</span>
<span class="c1">##</span>
<span class="c1">##        newAmplitude = newMax - newMin</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(newMin, newMed, newMax, newAmplitude)</span>
<span class="c1">##</span>
<span class="c1">##        actions = self.getActionsKeys(withoutProfiles=False)</span>
<span class="c1">##        oldrelation = copy(self.relation)</span>
<span class="c1">##        newrelation = {}</span>
<span class="c1">##        for x in actions:</span>
<span class="c1">##            newrelation[x] = {}</span>
<span class="c1">##            for y in actions:</span>
<span class="c1">##                if oldrelation[x][y] == oldMax:</span>
<span class="c1">##                    newrelation[x][y] = newMax</span>
<span class="c1">##                elif oldrelation[x][y] == oldMin:</span>
<span class="c1">##                    newrelation[x][y] = newMin</span>
<span class="c1">##                elif oldrelation[x][y] == oldMed:</span>
<span class="c1">##                    newrelation[x][y] = newMed</span>
<span class="c1">##                else:</span>
<span class="c1">##                    newrelation[x][y] = newMin + ((self.relation[x][y] - oldMin)/oldAmplitude)*newAmplitude</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(x,y,self.relation[x][y],newrelation[x][y])</span>
<span class="c1">##        # install new values in self</span>
<span class="c1">##        self.valuationdomain[&#39;max&#39;] = newMax</span>
<span class="c1">##        self.valuationdomain[&#39;min&#39;] = newMin</span>
<span class="c1">##        self.valuationdomain[&#39;med&#39;] = newMed</span>
<span class="c1">##        self.valuationdomain[&#39;hasIntegerValuation&#39;] = False</span>
<span class="c1">##</span>
<span class="c1">##        self.relation = copy(newrelation)</span>

<span class="c1">#-------------</span>
<span class="c1"># multiprocessing thread for QuantilesSortingDigraph class</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">Pickler</span><span class="p">,</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
<span class="c1">#from multiprocessing import Process, Lock,\</span>
<span class="c1">#                            active_children, cpu_count</span>
<span class="k">class</span> <span class="nc">_myQSDGThread</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span>
                 <span class="n">InitialSplit</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span>
                 <span class="n">splitActions</span><span class="p">,</span>
                 <span class="n">hasNoVeto</span><span class="p">,</span> <span class="n">hasBipolarVeto</span><span class="p">,</span>
                 <span class="n">hasSymmetricThresholds</span><span class="p">,</span> <span class="n">Debug</span><span class="p">):</span>
        <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InitialSplit</span> <span class="o">=</span> <span class="n">InitialSplit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span> <span class="o">=</span> <span class="n">tempDirName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitActions</span> <span class="o">=</span> <span class="n">splitActions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasNoVeto</span> <span class="o">=</span> <span class="n">hasNoVeto</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasBipolarVeto</span> <span class="o">=</span> <span class="n">hasBipolarVeto</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasSymmetricThresholds</span> <span class="o">=</span> <span class="n">hasSymmetricThresholds</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
        <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">Pickler</span><span class="p">,</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
        <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
        <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="n">BipolarOutrankingDigraph</span>
        <span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">)</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(&quot;Starting working in %s on thread %s&quot; % (self.workingDirectory, str(self.threadId)))</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpSelf.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">splitActions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitActions</span>
        <span class="n">constructRelation</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="o">.</span><span class="n">_constructRelation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">InitialSplit</span><span class="p">:</span>
            <span class="n">initialIn</span> <span class="o">=</span> <span class="n">splitActions</span>
            <span class="n">terminalIn</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initialIn</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span>
            <span class="n">terminalIn</span> <span class="o">=</span> <span class="n">splitActions</span>
        <span class="n">StoreSorting</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">splitRelation</span> <span class="o">=</span> <span class="n">constructRelation</span><span class="p">(</span>
                                <span class="n">digraph</span><span class="p">,</span><span class="n">digraph</span><span class="o">.</span><span class="n">criteria</span><span class="p">,</span>
                                <span class="n">digraph</span><span class="o">.</span><span class="n">evaluation</span><span class="p">,</span>
                                <span class="n">initial</span><span class="o">=</span><span class="n">initialIn</span><span class="p">,</span>
                                <span class="n">terminal</span><span class="o">=</span><span class="n">terminalIn</span><span class="p">,</span>
                                <span class="n">hasNoVeto</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hasNoVeto</span><span class="p">,</span>
                                <span class="n">hasBipolarVeto</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hasBipolarVeto</span><span class="p">,</span>
                                <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="c1">#WithSortingRelation=True,</span>
                                <span class="c1">#StoreSorting=StoreSorting,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">hasSymmetricThresholds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hasSymmetricThresholds</span><span class="p">)</span>
        <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;splitRelation-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threadID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">splitRelation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># compute quantiles sorting result</span>
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">splitActions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">splitRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                        <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">splitRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">splitRelation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">splitRelation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

        <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
            <span class="c1">#self.sorting = sorting</span>
            <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;splitSorting-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threadID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">sorting</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># compute category contents</span>
        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">():</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">splitActions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1">#self.categoryContent = categoryContent</span>
        <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;splitCategoryContent-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threadID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
    <span class="c1"># .......</span>
<div class="viewcode-block" id="QuantilesSortingDigraph">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">QuantilesSortingDigraph</span><span class="p">(</span><span class="n">SortingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of the root :py:class:`sortingDigraphs.SortingDigraph` class</span>
<span class="sd">    for sorting of a large set of alternatives into</span>
<span class="sd">    quantiles delimited ordered classes.</span>
<span class="sd">      </span>
<span class="sd">    .. note::</span>

<span class="sd">        The constructor requires a valid PerformanceTableau instance.</span>
<span class="sd">        If no number of limiting quantiles is given, then a default profile with the limiting quartiles Q0,Q1,Q2, Q3 and Q4 is used on each criteria.</span>
<span class="sd">        By default upper closed limits of categories are supposed to be used in the sorting.</span>

<span class="sd">        Mind that setting *Threading* to *True when running from a python script file</span>
<span class="sd">        the main program entry must be started with a *__name__==&#39;__main__&#39;* test.</span>

<span class="sd">    Example Python3 session:</span>

<span class="sd">    &gt;&gt;&gt; from sortingDigraphs import QuantilesSortingDigraph</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomCBPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; t = RandomCBPerformanceTableau(numberOfActions=7,numberOfCriteria=5,</span>
<span class="sd">    ...                                weightDistribution=&#39;equiobjectives&#39;)</span>
<span class="sd">    &gt;&gt;&gt; qs = QuantilesSortingDigraph(t,limitingQuantiles=7)</span>
<span class="sd">    &gt;&gt;&gt; qs.showSorting()</span>
<span class="sd">    *--- Sorting results in descending order ---*</span>
<span class="sd">    ]0.86 - 1.00]: 	 []</span>
<span class="sd">    ]0.71 - 0.86]: 	 [&#39;a03&#39;]</span>
<span class="sd">    ]0.57 - 0.71]: 	 [&#39;a04&#39;]</span>
<span class="sd">    ]0.43 - 0.57]: 	 [&#39;a04&#39;, &#39;a05&#39;, &#39;a06&#39;]</span>
<span class="sd">    ]0.29 - 0.43]: 	 [&#39;a01&#39;, &#39;a02&#39;, &#39;a06&#39;, &#39;a07&#39;]</span>
<span class="sd">    ]0.14 - 0.29]: 	 []</span>
<span class="sd">    ]&lt; - 0.14]: 	 []</span>
<span class="sd">    &gt;&gt;&gt; qs.showQuantileOrdering()</span>
<span class="sd">    ]0.71-0.86] : [&#39;a03&#39;]</span>
<span class="sd">    ]0.43-0.71] : [&#39;a04&#39;]</span>
<span class="sd">    ]0.43-0.57] : [&#39;a05&#39;]</span>
<span class="sd">    ]0.29-0.57] : [&#39;a06&#39;]</span>
<span class="sd">    ]0.29-0.43] : [&#39;a07&#39;, &#39;a02&#39;, &#39;a01&#39;]</span>
<span class="sd">    &gt;&gt;&gt; qs.exportGraphViz(&#39;quantilesSorting&#39;)</span>
<span class="sd">    </span>
<span class="sd">    .. image:: quantilesSorting.png</span>
<span class="sd">       :alt: Example of quantiles sorting digraph</span>
<span class="sd">       :width: 400 px</span>
<span class="sd">       :align: center</span>

<span class="sd">    .. warning:: The multiprocessing :py:class:`~sortingDigraphs.QuantilesSortingDigraph` constructor uses</span>
<span class="sd">        the spwan start-mathod for threading. In a python script,</span>
<span class="sd">        the main entry code must hence be protected with the __name__==&#39;__main__&#39; test</span>
<span class="sd">        (see the documentation of the :py:mod:`multiprocessing` module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">limitingQuantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">PrefThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">outrankingType</span> <span class="o">=</span> <span class="s2">&quot;bipolar&quot;</span><span class="p">,</span>
                 <span class="n">WithSortingRelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">CompleteOutranking</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tempDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrCores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrOfProcesses</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for QuantilesSortingBigDigraph instances.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">deepcopy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">copy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

        <span class="c1"># import the performance tableau</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">argPerfTab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a valid performance tableau is required!&#39;</span><span class="p">)</span>
<span class="c1">##            perfTab = RandomPerformanceTableau(numberOfActions=10,</span>
<span class="c1">##                                               numberOfCriteria=13)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>
        <span class="c1"># normalize the actions as a dictionary construct</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

        <span class="c1"># keep a copy of the original actions set before adding the profiles</span>
        <span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">actionsOrig</span>

        <span class="c1">#  normalizing the performance tableau</span>
        <span class="n">normPerfTab</span> <span class="o">=</span> <span class="n">NormalizedPerformanceTableau</span><span class="p">(</span><span class="n">perfTab</span><span class="p">)</span>

        <span class="c1"># instantiating the performance tableau part</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertWeight2Decimal</span><span class="p">()</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convertEvaluation2Decimal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dataInput&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span><span class="p">}</span>

        <span class="c1">#  compute the limiting quantiles</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sorting_with_given_quantiles&#39;</span>
            <span class="n">newLimitingQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">limitingQuantiles</span><span class="p">:</span>
                <span class="n">newLimitingQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">newLimitingQuantiles</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;convert to decimal!&#39;</span><span class="p">,</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantiles</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">limitingQuantiles</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span>

        <span class="c1"># supposing all criteria scales between 0.0 and 100.0</span>
        <span class="c1"># with preference direction = max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="n">lowValue</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">highValue</span> <span class="o">=</span> <span class="mf">100.00</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">[&#39;</span>\
                                          <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]}</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - &lt;[&#39;</span>\
                                     <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span>
                                  <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                  <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;[&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span>                 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]&lt; - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                                     <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                  <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]&lt;&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>                                  
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                                           <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">categories</span><span class="p">)))</span>

        <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
            <span class="n">gQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeLimitingQuantiles</span><span class="p">(</span><span class="n">g</span><span class="p">,</span>\
                            <span class="n">PrefThresholds</span><span class="o">=</span><span class="n">PrefThresholds</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
<span class="c1">##            if Debug:</span>
<span class="c1">##                print(g,gQuantiles)</span>
            <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">gQuantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CriteriaCategoryLimits&#39;</span><span class="p">,</span><span class="n">criteriaCategoryLimits</span><span class="p">)</span>

        <span class="c1"># add the catogory limits to the actions set</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1">#profileLimits = set()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
            <span class="c1">#profileLimits.add(cKey)</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
        <span class="n">profileLimits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1">#profileLimits.sort()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span> <span class="o">=</span> <span class="n">profileLimits</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profiles&#39;</span><span class="p">,</span><span class="n">profiles</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profileLimits&#39;</span><span class="p">,</span><span class="n">profileLimits</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        
        <span class="c1"># construct outranking relation</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasNoVeto</span> <span class="o">=</span> <span class="n">hasNoVeto</span>
        <span class="n">minValuation</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="n">maxValuation</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">CompleteOutranking</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">normPerfTab</span><span class="p">,</span><span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span>
                <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span><span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">)</span>
            <span class="c1">#g.recodeValuation(minValuation,maxValuation)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relationOrig</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">relation</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">minValuation</span><span class="p">))</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">maxValuation</span><span class="p">))</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="p">(</span><span class="n">Max</span> <span class="o">+</span> <span class="n">Min</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Med</span> <span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span> <span class="p">}</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">initial</span><span class="o">=</span><span class="n">actionsOrig</span>
            <span class="n">terminal</span><span class="o">=</span><span class="n">profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial</span><span class="o">=</span><span class="n">profiles</span>
            <span class="n">terminal</span><span class="o">=</span><span class="n">actionsOrig</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructRelationWithThreading</span><span class="p">(</span><span class="n">criteria</span><span class="p">,</span>
                                                   <span class="n">evaluation</span><span class="p">,</span>
                                                   <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span>
                                                   <span class="n">terminal</span><span class="o">=</span><span class="n">terminal</span><span class="p">,</span>
                                                   <span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span>
                                                   <span class="n">hasBipolarVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                   <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                   <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>       
                                                   <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                                        <span class="n">startMethod</span><span class="o">=</span><span class="n">startMethod</span><span class="p">,</span>
                                                    <span class="n">tempDir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">,</span>
                                                    <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrCores</span><span class="p">,</span>
                                                    <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                                    <span class="n">WithSortingRelation</span><span class="o">=</span><span class="n">WithSortingRelation</span><span class="p">,</span>
                                                    <span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute weak ordering</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nbrOfProcesses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbrOfProcesses</span> <span class="o">=</span> <span class="n">nbrCores</span>
            <span class="n">sortingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingRelation</span><span class="p">(</span>
                            <span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">,</span>
                            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                            <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                            <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfProcesses</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                <span class="n">rx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="n">srx</span> <span class="o">=</span> <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                    <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">srx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                    
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;weakOrdering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="c1"># reset original action set</span>
        <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actionsOrig</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tt</span>

    <span class="k">def</span> <span class="nf">_constructRelationWithThreading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteria</span><span class="p">,</span>
                           <span class="n">evaluation</span><span class="p">,</span>
                           <span class="n">initial</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">terminal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">hasBipolarVeto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">hasSymmetricThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                        <span class="n">startMethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">tempDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">WithVetoCounts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">WithSortingRelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">nbrCores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialization of the corresponding BipolarOutrankingDigraph method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">cpu_count</span>
        
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>        

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Threading</span> <span class="ow">or</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># set parameters for non threading</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
            

            <span class="c1"># compute sorting relation</span>
            <span class="c1"># !! concordance relation and veto counts need a complex constructor</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">hasBipolarVeto</span><span class="p">)</span> <span class="ow">or</span> <span class="n">WithConcordanceRelation</span> <span class="ow">or</span> <span class="n">WithVetoCounts</span><span class="p">:</span>
                <span class="n">constructRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructRelation</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">constructRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructRelationSimple</span>

            <span class="n">relation</span> <span class="o">=</span> <span class="n">constructRelation</span><span class="p">(</span><span class="n">criteria</span><span class="p">,</span>
                            <span class="n">evaluation</span><span class="p">,</span>
                            <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span>
                            <span class="n">terminal</span><span class="o">=</span><span class="n">terminal</span><span class="p">,</span>
                            <span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span>
                            <span class="n">hasBipolarVeto</span><span class="o">=</span><span class="n">hasBipolarVeto</span><span class="p">,</span>
                            <span class="n">WithConcordanceRelation</span><span class="o">=</span><span class="n">WithConcordanceRelation</span><span class="p">,</span>
                            <span class="n">WithVetoCounts</span><span class="o">=</span><span class="n">WithVetoCounts</span><span class="p">,</span>
                            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span>
                            <span class="n">hasSymmetricThresholds</span><span class="o">=</span><span class="n">hasSymmetricThresholds</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>

            <span class="c1"># compute quantiles sorting result</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">actions</span> <span class="o">=</span> <span class="n">initial</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actions</span> <span class="o">=</span> <span class="n">terminal</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                            <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                            <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                            <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

            <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span>

            <span class="c1"># compute category contents</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">():</span>
                <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                        <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span> <span class="o">=</span> <span class="n">categoryContent</span>

            <span class="k">return</span> <span class="n">relation</span>
            
        <span class="c1">##</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># parallel computation</span>
            <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
            <span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
            <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">Pickler</span><span class="p">,</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
            <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
            <span class="k">if</span> <span class="n">startMethod</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">startMethod</span> <span class="o">=</span> <span class="s1">&#39;spawn&#39;</span>
            <span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">startMethod</span><span class="p">)</span>
            <span class="n">Process</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Process</span>
            <span class="n">active_children</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">active_children</span>
            <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">get_start_method</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threading ...&#39;</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
            <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="n">tempDir</span><span class="p">)</span> <span class="k">as</span> <span class="n">tempDirName</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

                <span class="c1">#selfDp = copy(self)</span>
                <span class="n">selfFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpSelf.py&#39;</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;temDirName, selfFileName&#39;</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span><span class="n">selfFileName</span><span class="p">)</span>
                <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">selfFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">nbrCores</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">nbrCores</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of cpus = &#39;</span><span class="p">,</span><span class="n">nbrCores</span><span class="p">)</span>
                <span class="c1"># set number of threads</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">nbrCores</span>

                <span class="n">ni</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>
                <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">terminal</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">ni</span>
                    <span class="n">actions2Split</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>
                    <span class="n">InitialSplit</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">nt</span>
                    <span class="n">actions2Split</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">terminal</span><span class="p">)</span>
                    <span class="n">InitialSplit</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(&#39;InitialSplit, actions2Split&#39;, InitialSplit, actions2Split)</span>
            
                <span class="n">nit</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="n">nbrCores</span>
                <span class="n">nbrOfJobs</span> <span class="o">=</span> <span class="n">nbrCores</span>
                <span class="k">if</span> <span class="n">nit</span><span class="o">*</span><span class="n">nbrCores</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">nit</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">nit</span><span class="o">*</span><span class="p">(</span><span class="n">nbrOfJobs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">nbrOfJobs</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbr of actions to split&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbr of jobs = &#39;</span><span class="p">,</span><span class="n">nbrOfJobs</span><span class="p">)</span>    
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nbr of splitActions = &#39;</span><span class="p">,</span><span class="n">nit</span><span class="p">)</span>

                <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">initial</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">terminal</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">actionsRemain</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actions2Split</span><span class="p">)</span>
                <span class="n">splitActionsList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrOfJobs</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thread = </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nbrOfJobs</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">splitActions</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nit</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">nbrOfJobs</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                            <span class="n">splitActions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actions2Split</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">splitActions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">actionsRemain</span><span class="p">)</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splitActions</span><span class="p">)),</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(splitActions)</span>
                    <span class="n">actionsRemain</span> <span class="o">=</span> <span class="n">actionsRemain</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">splitActions</span><span class="p">)</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(actionsRemain)</span>
                    <span class="n">splitActionsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">splitActions</span><span class="p">)</span>

                    <span class="n">splitThread</span> <span class="o">=</span> <span class="n">_myQSDGThread</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">InitialSplit</span><span class="p">,</span>
                                           <span class="n">tempDirName</span><span class="p">,</span><span class="n">splitActions</span><span class="p">,</span>
                                           <span class="n">hasNoVeto</span><span class="p">,</span><span class="n">hasBipolarVeto</span><span class="p">,</span>
                                           <span class="n">hasSymmetricThresholds</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                    <span class="n">splitThread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                    
                <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>    
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exiting computing threads&#39;</span><span class="p">)</span>
                <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">splitActionsList</span><span class="p">)):</span>
                    <span class="c1"># update category contents</span>
                    <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/splitCategoryContent-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                    <span class="n">splitCategoryContent</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="n">categoryContent</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">splitCategoryContent</span><span class="p">)</span>
                    <span class="c1"># update sorting result</span>
                    <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
                        <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/splitSorting-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                        <span class="n">splitSorting</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                        <span class="n">sorting</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">splitSorting</span><span class="p">)</span>
                    <span class="c1"># update complete sorting relation</span>
                    <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
                        <span class="n">splitActions</span> <span class="o">=</span> <span class="n">splitActionsList</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="c1">##                    if Debug:</span>
    <span class="c1">##                        print(&#39;splitActions&#39;,splitActions)</span>
                        <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/splitRelation-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                        <span class="n">splitRelation</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="c1">##                    if Debug:</span>
    <span class="c1">##                        print(&#39;splitRelation&#39;,splitRelation)</span>
                        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                        <span class="c1">#relation update with splitRelation)                    </span>
                        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                            <span class="c1">#for x,y in product(splitActions,terminal):</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">splitActions</span><span class="p">:</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                                <span class="k">except</span><span class="p">:</span>
                                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                                <span class="n">sprx</span> <span class="o">=</span> <span class="n">splitRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                                    <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">sprx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1">#for x,y in product(initial,splitActions):</span>
                            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                                <span class="n">sprx</span> <span class="o">=</span> <span class="n">splitRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">splitActions</span><span class="p">:</span>
                                    <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">sprx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span> <span class="o">=</span> <span class="n">categoryContent</span>
                <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span>
                <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">relation</span>
<div class="viewcode-block" id="QuantilesSortingDigraph.showCriteriaCategoryLimits">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showCriteriaCategoryLimits">[docs]</a>
    <span class="k">def</span> <span class="nf">showCriteriaCategoryLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ByCriterion</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for showCriteriaQuantileLimits()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCriteriaQuantileLimits</span><span class="p">(</span><span class="n">ByCriterion</span><span class="o">=</span><span class="n">ByCriterion</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="QuantilesSortingDigraph.showCriteriaQuantileLimits">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showCriteriaQuantileLimits">[docs]</a>
    <span class="k">def</span> <span class="nf">showCriteriaQuantileLimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ByCriterion</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows category minimum and maximum limits for each criterion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">catLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantile Class Limits (q = </span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Lower-closed classes&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Upper-closed classes&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">ByCriterion</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">catg</span> <span class="o">=</span> <span class="n">catLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                    <span class="n">nc</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>
                    <span class="c1">#print(nc,catg[nc])</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%.2f</span><span class="s1"> [</span><span class="si">%.2f</span><span class="s1">; </span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">],</span> <span class="n">catg</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">catg</span><span class="p">[</span><span class="n">nc</span><span class="p">])</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%.2f</span><span class="s1"> ]</span><span class="si">%.2f</span><span class="s1">; </span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">],</span> <span class="n">catg</span><span class="p">[</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">catg</span><span class="p">[</span><span class="n">nc</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;crit.&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;quantile&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*----------------------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
                <span class="n">catg</span> <span class="o">=</span> <span class="n">catLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catg</span><span class="p">[</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">catg</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">()</span></div>


                        
                    


<div class="viewcode-block" id="QuantilesSortingDigraph.showActionCategories">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showActionCategories">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        Returns a tuple : action, lowest category key, highest category key, membership credibility !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span>
                                                     <span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span>
                                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                                     <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                     <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
        <span class="n">catKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="c1">#keys.append(c)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">],</span> <span class="n">keys</span><span class="p">)</span>
        <span class="n">credibility</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                 <span class="n">action</span><span class="p">,</span>
                                 <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>\
                <span class="n">credibility</span>            </div>


<div class="viewcode-block" id="QuantilesSortingDigraph.showActionsSortingResult">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showActionsSortingResult">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionsSortingResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the quantiles sorting result all (default) of a subset of the decision actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">actionSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
            <span class="n">actions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">actionSubset</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantiles sorting result per decision action&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>

 

<div class="viewcode-block" id="QuantilesSortingDigraph.showWeakOrder">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showWeakOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">showWeakOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation for QuantilesSortingDigraphs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="n">TransitiveDigraph</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
            <span class="n">cCKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cCKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cC</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">setx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">sety</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">setx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
                <span class="n">setx</span> <span class="o">=</span> <span class="n">setx</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
                <span class="n">sety</span> <span class="o">=</span> <span class="n">sety</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">)),</span><span class="n">y</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">n2</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n2</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n2</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        
        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;result&#39;</span><span class="p">:</span><span class="n">ordering</span><span class="p">}</span>

        <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">showTransitiveDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">weakOrdering</span><span class="p">)</span></div>


<span class="c1">##        return orderingList</span>

    <span class="k">def</span> <span class="nf">_computeQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the </span>
<span class="sd">        *Parameters*:</span>
<span class="sd">            * Descending: listing in *decreasing* (default) or *increasing* quantile order.</span>
<span class="sd">            * strategy: ordering in an {&#39;optimistic&#39; | &#39;pessimistic&#39; | &#39;average&#39; (default)}</span>
<span class="sd">              in the uppest, the lowest or the average potential quantile.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sortingParameters</span><span class="p">[</span><span class="s1">&#39;strategy&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;average&#39;</span>
        <span class="n">actionsCategories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span> <span class="o">=</span>\
                     <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">ac</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">+</span><span class="n">hc</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># optimistic by default</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>      
                
        <span class="n">actionsCategIntervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">actionsCategories</span><span class="p">:</span>
            <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">interval</span><span class="p">,</span>
                                          <span class="n">actionsCategories</span><span class="p">[</span><span class="n">interval</span><span class="p">]])</span>
        <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">actionsCategIntervals</span>


<div class="viewcode-block" id="QuantilesSortingDigraph.computeQuantileOrdering">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.computeQuantileOrdering">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">HTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Quantiles Preordering&#39;</span><span class="p">,</span>
                                <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Parameters*:</span>
<span class="sd">            * Descending: listing in *decreasing* (default) or *increasing* quantile order.</span>
<span class="sd">            * strategy: ordering in an {&#39;optimistic&#39; | &#39;pessimistic&#39; | &#39;average&#39; (default)}</span>
<span class="sd">              in the uppest, the lowest or the average potential quantile.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;optimistic&#39;</span>
        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;</span><span class="si">%s</span><span class="s1">&lt;/h1&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">title</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;quantile limits&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1"> sorting&lt;/th&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">strategy</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">actionsCategories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span> <span class="o">=</span>\
                     <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="n">ilowCateg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
            <span class="n">ihighCateg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
            <span class="c1">#print(a,lowCateg,highCateg,credibility)</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ilowCateg</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">ac</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">+</span><span class="n">hc</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="n">ihighCateg</span><span class="p">,</span><span class="n">ilowCateg</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: </span><span class="si">%s</span><span class="s1"> not a valid ordering strategy !!!&#39;</span> <span class="o">%</span> <span class="n">strategy</span><span class="p">)</span>
                <span class="k">break</span>
                
        <span class="c1"># sorting the quantile equivalence classes</span>
        <span class="n">actionsCategoriesKeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">actionsCategories</span><span class="p">]</span>
        <span class="n">actionsCategoriesKeys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">actionsCategoriesKeys</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">actionsCategIntervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">actionsCategoriesKeys</span><span class="p">:</span>
            <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">interval</span><span class="p">,</span>\
                                          <span class="n">actionsCategories</span><span class="p">[</span><span class="n">interval</span><span class="p">]])</span>

        <span class="c1"># gathering the result with output when Comments=True</span>
        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">actionsCategIntervals</span><span class="p">:</span>
            <span class="c1">#print(item)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;tdbgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>                            
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>                   
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">weakOrdering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">weakOrdering</span></div>


<div class="viewcode-block" id="QuantilesSortingDigraph.showQuantileOrdering">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showQuantileOrdering">[docs]</a>
    <span class="k">def</span> <span class="nf">showQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy show method for the commenting computeQuantileOrdering() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;average&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileOrdering</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>



<div class="viewcode-block" id="QuantilesSortingDigraph.computeWeakOrder">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.computeWeakOrder">[docs]</a>
    <span class="k">def</span> <span class="nf">computeWeakOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation for QuantilesSortingDigraphs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">cC</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
            <span class="n">cCKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cCKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cCKeys&#39;</span><span class="p">,</span><span class="n">cCKeys</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cC</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n,n2&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n2</span><span class="p">)</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">setx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">sety</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">setx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
                <span class="n">setx</span> <span class="o">=</span> <span class="n">setx</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
                <span class="n">sety</span> <span class="o">=</span> <span class="n">sety</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i,x,y,setx,sety&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">setx</span><span class="p">,</span><span class="n">sety</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">)),</span><span class="n">y</span><span class="p">)</span> <span class="p">))</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">)),</span><span class="n">y</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">n2</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n2</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">cC</span><span class="p">[</span><span class="n">cCKeys</span><span class="p">[</span><span class="n">n2</span><span class="p">]])</span> <span class="o">-</span> <span class="p">(</span><span class="n">setx</span> <span class="o">|</span> <span class="n">sety</span><span class="p">))</span>
            <span class="n">ordering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),[])</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;median term&#39;</span><span class="p">,(</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">x</span><span class="p">),(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">)),[])</span> <span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
        
        <span class="n">orderingList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordering</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">orderingList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">ordering</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">orderingList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">orderingList</span></div>


<div class="viewcode-block" id="QuantilesSortingDigraph.showOrderedRelationTable">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showOrderedRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showOrderedRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;decreasing&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Showing the relation table in decreasing (default) or increasing order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;decreasing&quot;</span><span class="p">:</span>
            <span class="n">Descending</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Descending</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeWeakOrder</span><span class="p">(</span><span class="n">Descending</span><span class="p">)</span>
        
        <span class="n">actionsList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">eq</span> <span class="ow">in</span> <span class="n">weakOrdering</span><span class="p">:</span>
            <span class="c1">#print(eq)</span>
            <span class="n">eq</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eq</span><span class="p">:</span>
                <span class="n">actionsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !: missing action(s) </span><span class="si">%s</span><span class="s1"> in ordered table.&#39;</span><span class="p">)</span>
            
        <span class="n">Digraph</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>\
                                <span class="n">relation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">,</span>\
                                <span class="n">Sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                                <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

        

    <span class="k">def</span> <span class="nf">_computeQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        renders the limiting quantiles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;bitiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;tritiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;quartiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;quintiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;sextiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;septiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;octiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;deciles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;dodeciles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;centiles&#39;</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;automatic&#39;</span><span class="p">:</span>
            <span class="n">pth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> \
                           <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;ind&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">))</span>
                    <span class="n">pth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pref</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">amp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">pth</span><span class="p">))</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">amp</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Detected preference thresholds = &#39;</span><span class="p">,</span><span class="n">pth</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;amplitude, n&#39;</span><span class="p">,</span><span class="n">amp</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

        <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">limitingQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">/</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sorting_with_</span><span class="si">%d</span><span class="s1">-tile_limits&#39;</span> <span class="o">%</span> <span class="n">n</span>
        <span class="k">return</span> <span class="n">limitingQuantiles</span>
                                         
    <span class="k">def</span> <span class="nf">_computeLimitingQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">PrefThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the list of limiting quantiles on criteria g</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        <span class="n">actionsOrig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span>
        <span class="n">gValues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g,x,evaluation[g][x]&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">NA</span><span class="p">:</span>
                <span class="n">gValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
        <span class="n">gValues</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">PrefThresholds</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>            
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gValues</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g,n,gValues&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">gValues</span><span class="p">)</span>
<span class="c1">##        if n &gt; 0:</span>
<span class="c1">##        nf = Decimal(str(n+1))</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="n">limitingQuantiles</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">limitingQuantiles</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="c1"># computing the quantiles on criterion g</span>
        <span class="n">gQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="c1"># we ignore the 1.00 quantile and replace it with +infty</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r,rq&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rq</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]</span>\
                        <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rq</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">rq</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">PrefThresholds</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">+</span> <span class="n">quantile</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;200.0&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span><span class="n">quantile</span><span class="p">)</span>
                <span class="n">gQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantile</span><span class="p">)</span>               

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># upper closed categories</span>
            <span class="c1"># we ignore the quantile 0.0 and replace it with -\infty            </span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r,rq&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rq</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-200.0&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-100.0&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]</span>\
                        <span class="o">+</span> <span class="p">((</span><span class="n">r</span><span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rq</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">gValues</span><span class="p">[</span><span class="n">rq</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">PrefThresholds</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">-=</span> <span class="n">gPrefThrCst</span> <span class="o">-</span> <span class="n">quantile</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">quantile</span> <span class="o">=</span> <span class="n">gValues</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-200.0&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">quantile</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-100.0&#39;</span><span class="p">)</span>     
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;quantile&#39;</span><span class="p">,</span><span class="n">quantile</span><span class="p">)</span>
                <span class="n">gQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quantile</span><span class="p">)</span>
<span class="c1">##        else:</span>
<span class="c1">##            gQuantiles = []</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">LowerClosed</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">],</span><span class="n">gQuantiles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gQuantiles</span>

<div class="viewcode-block" id="QuantilesSortingDigraph.getActionsKeys">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.getActionsKeys">[docs]</a>
    <span class="k">def</span> <span class="nf">getActionsKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">withoutProfiles</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extract normal actions keys()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionsExt</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">withoutProfiles</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">actionsExt</span> <span class="o">-</span> <span class="n">profiles</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">actionsExt</span> <span class="o">|</span> <span class="n">profiles</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">action</span><span class="p">])</span>           </div>


<div class="viewcode-block" id="QuantilesSortingDigraph.computeCategoryContents">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.computeCategoryContents">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCategoryContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the sorting results per category.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">())</span>
        <span class="n">actions</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>\
                                                     <span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">,</span>\
                                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>\
                                                     <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>

        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">):</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">categoryContent</span></div>


<div class="viewcode-block" id="QuantilesSortingDigraph.computeSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.computeSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                        <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">storeSorting</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(actions)</span>
            
        <span class="c1">#categories = list(self.orderedCategoryKeys())</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">selfRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Threading</span> <span class="ow">and</span> <span class="n">action</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="c1">#from multiprocessing import Process, active_children</span>
            <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
            <span class="n">mpctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="s1">&#39;spawn&#39;</span><span class="p">)</span>
            <span class="n">Process</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">Process</span>
            <span class="n">active_children</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">active_children</span>
            <span class="n">cpu_count</span> <span class="o">=</span> <span class="n">mpctx</span><span class="o">.</span><span class="n">cpu_count</span>

            <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">load</span>
            <span class="c1">#from os import cpu_count</span>
            <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="c1">##            if Comments:</span>
<span class="c1">##                self.Debug = True</span>
            <span class="k">class</span> <span class="nc">_myThread</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threadID</span><span class="p">,</span> <span class="n">tempDirName</span><span class="p">,</span>
                             <span class="n">nq</span><span class="p">,</span> <span class="n">Min</span><span class="p">,</span> <span class="n">Max</span><span class="p">,</span> <span class="n">LowerClosed</span><span class="p">,</span> <span class="n">Debug</span><span class="p">):</span>
                    <span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span> <span class="o">=</span> <span class="n">threadID</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span> <span class="o">=</span> <span class="n">tempDirName</span>
                    <span class="c1">#self.actions = actions</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nq</span> <span class="o">=</span> <span class="n">nq</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Min</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Max</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">LowerClosed</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Debug</span> <span class="o">=</span> <span class="n">Debug</span>
                <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
                    <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span>
                    <span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workingDirectory</span><span class="p">)</span>
<span class="c1">##                    if self.Debug:</span>
<span class="c1">##                        print(&quot;Starting working in %s on %s&quot; % (self.workingDirectory, str(self.threadID)))</span>
<span class="c1">##                        print(&#39;actions,catKeys&#39;,self.actions,self.catKeys)</span>
                    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpSelfRelation.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                    <span class="c1">#context = loads(fi.read())</span>
                    <span class="n">relation</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpCategories.py&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                    <span class="c1">#context = loads(fi.read())</span>
                    <span class="n">catKeys</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dumpActions</span><span class="si">%d</span><span class="s1">.py&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">threadID</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                    <span class="c1">#context = loads(fi.read())</span>
                    <span class="n">actions</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                    <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">##                    Min = context.valuationdomain[&#39;min&#39;]</span>
<span class="c1">##                    Max = context.valuationdomain[&#39;max&#39;]</span>
                    <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Min</span>
                    <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Max</span>
                    <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
                    <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">nq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nq</span>
                    <span class="c1">#nq = len(context.limitingQuantiles) - 1</span>
                    <span class="c1">#actions = self.actions</span>
                    <span class="c1">#catKeys = self.catKeys</span>
                    <span class="c1">#relation = context.relation</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">sorx</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">catKeys</span><span class="p">:</span>
                            <span class="n">sorx</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                                <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                                <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                                    <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                                    <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                                <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1">: low = </span><span class="si">%.2f</span><span class="s1">, high = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> \
                                      <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                            <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                            <span class="n">sorx</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                            <span class="n">sorx</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                            <span class="n">sorx</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>
<span class="c1">##                            if self.Debug:</span>
<span class="c1">##                                print(&#39;\t %.2f \t %.2f \t %.2f\n&#39; % (sorting[x][c][&#39;lowLimit&#39;],\</span>
<span class="c1">##                                   sorting[x][c][&#39;notHighLimit&#39;], sorting[x][c][&#39;categoryMembership&#39;]))</span>
<span class="c1">##                        if self.Debug:</span>
<span class="c1">##                            print(sorting[x])</span>
                    <span class="n">foName</span> <span class="o">=</span> <span class="s1">&#39;sorting-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threadID</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">foName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">sorting</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Threaded computing of sorting characteristics ...&#39;</span><span class="p">)</span>        
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span><span class="p">,</span><span class="n">mkdtemp</span>
            <span class="n">tempDirName</span> <span class="o">=</span> <span class="n">mkdtemp</span><span class="p">()</span>
            <span class="n">td</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">selfFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpSelfRelation.py&#39;</span>
<span class="c1">##            if Debug:</span>
<span class="c1">##                print(&#39;temDirName, selfFileName&#39;, tempDirName,selfFileName)</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">selfFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">selfRelation</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">selfFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpCategories.py&#39;</span>
<span class="c1">##            if Debug:</span>
<span class="c1">##                print(&#39;temDirName, selfFileName&#39;, tempDirName,selfFileName)</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">selfFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>            
            <span class="k">if</span> <span class="n">nbrOfCPUs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dump relation: </span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">td</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of actions&#39;</span><span class="p">,</span><span class="n">na</span><span class="p">)</span>
                
            
            <span class="n">nbrOfJobs</span> <span class="o">=</span> <span class="n">na</span><span class="o">//</span><span class="n">nbrOfCPUs</span>
            <span class="k">if</span> <span class="n">nbrOfJobs</span><span class="o">*</span><span class="n">nbrOfCPUs</span> <span class="o">&lt;</span> <span class="n">na</span><span class="p">:</span>
                <span class="n">nbrOfJobs</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of threads = &#39;</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nbr of jobs/thread&#39;</span><span class="p">,</span><span class="n">nbrOfJobs</span><span class="p">)</span>
            <span class="n">nbrOfThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrOfCPUs</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;thread = </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
                <span class="n">start</span><span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="n">nbrOfJobs</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nbrOfJobs</span> <span class="o">&lt;</span> <span class="n">na</span><span class="p">:</span>
                    <span class="n">stop</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nbrOfJobs</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stop</span> <span class="o">=</span> <span class="n">na</span>
                <span class="n">thActions</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(thActions)</span>
                <span class="k">if</span> <span class="n">thActions</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">selfFileName</span> <span class="o">=</span> <span class="n">tempDirName</span> <span class="o">+</span><span class="s1">&#39;/dumpActions</span><span class="si">%d</span><span class="s1">.py&#39;</span> <span class="o">%</span> <span class="n">j</span>
                    <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">selfFileName</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                    <span class="n">pd</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">thActions</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>            
                    <span class="n">process</span> <span class="o">=</span> <span class="n">_myThread</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">tempDirName</span><span class="p">,</span><span class="n">nq</span><span class="p">,</span><span class="n">Min</span><span class="p">,</span><span class="n">Max</span><span class="p">,</span>
                                       <span class="n">LowerClosed</span><span class="p">,</span><span class="n">Debug</span><span class="p">)</span>
                    <span class="n">process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                    <span class="n">nbrOfThreads</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">active_children</span><span class="p">()</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="k">pass</span>
                <span class="c1">#sleep(1)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exit </span><span class="si">%d</span><span class="s1"> threads&#39;</span> <span class="o">%</span> <span class="n">nbrOfThreads</span><span class="p">)</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbrOfThreads</span><span class="p">):</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(&#39;job&#39;,th)</span>
                <span class="n">fiName</span> <span class="o">=</span> <span class="n">tempDirName</span><span class="o">+</span><span class="s1">&#39;/sorting-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
                <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fiName</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
                <span class="n">sortingThread</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(&#39;sortingThread&#39;,sortingThread)</span>
                <span class="n">sorting</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sortingThread</span><span class="p">)</span>
        <span class="c1"># end of Threading</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># with out Threading </span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                    <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                            <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                            <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">selfRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                            <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="n">selfRelation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">selfRelation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                    <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                    <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(&#39;\t %.2f \t %.2f \t %.2f&#39; % (sorting[x][c][&#39;lowLimit&#39;], sorting[x][c][&#39;notHighLimit&#39;], sorting[x][c][&#39;categoryMembership&#39;]))</span>
        <span class="k">if</span> <span class="n">StoreSorting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="n">sorting</span>
        <span class="k">return</span> <span class="n">sorting</span></div>


    <span class="k">def</span> <span class="nf">_computeSortingCharacteristicsOld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>

        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                        <span class="n">cMaxKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">cMinKey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="c1">#if Comments:</span>
                <span class="c1">#    print(&#39;%s in %s: low = %.2f, high = %.2f&#39; % \</span>
                <span class="c1">#          (x, c,lowLimit,notHighLimit), end=&#39; &#39;)</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="c1">#print(&#39;\t %.2f \t %.2f \t %.2f&#39; % (sorting[x][c][&#39;lowLimit&#39;], sorting[x][c][&#39;notHighLimit&#39;], sorting[x][c][&#39;categoryMembership&#39;]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">sorting</span>

<div class="viewcode-block" id="QuantilesSortingDigraph.showSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">showSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to category c in C&quot;,</span>
<span class="sd">        ie x outranks low category limit and does not outrank</span>
<span class="sd">        the high category limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span>\
                      <span class="p">(</span><span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                       <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>
                       <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">()</span></div>



<div class="viewcode-block" id="QuantilesSortingDigraph.showHTMLQuantileOrdering">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showHTMLQuantileOrdering">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Quantiles Preordering&#39;</span><span class="p">,</span>
                                 <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                 <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the html version of the quantile preordering in a browser window.</span>

<span class="sd">        The ordring strategy is either:</span>
<span class="sd">            * **average** (default), following the averag of the upper and lower quantile limits,</span>
<span class="sd">            * **optimistic**, following the upper quantile limits (default),</span>
<span class="sd">            * **pessimistic**, following the lower quantile limits.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileOrdering</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span>
                                              <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
                                              <span class="n">HTML</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                              <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                                              <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="QuantilesSortingDigraph.showHTMLSorting">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showHTMLSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        shows the html version of the sorting result in a browser window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showSorting</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">,</span><span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="QuantilesSortingDigraph.showSorting">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.showSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">isReturningHTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows sorting results in decreasing or increasing (Reverse=False)</span>
<span class="sd">        order of the categories. If isReturningHTML is True (default = False)</span>
<span class="sd">        the method returns a htlm table with the sorting result.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#from string import replace</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">categoryKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">LowerClosed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">Reverse</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in descending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in descending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Categories&lt;/th&gt;&lt;th&gt;Assorting&lt;/th&gt;&lt;/tr&gt;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">*--- Sorting results in ascending order ---*</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h2&gt;Sorting results in ascending order&lt;/h2&gt;&#39;</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;Categories&lt;/th&gt;&lt;th&gt;Assorting&lt;/th&gt;&lt;/tr&gt;&#39;</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categoryKeys</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
                <span class="c1">#html += &#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;[%s - %s[&lt;/td&gt;&#39; % (limprevc,limc)</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                <span class="n">catString</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="n">catString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&amp;apos;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isReturningHTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span></div>


<div class="viewcode-block" id="QuantilesSortingDigraph.computeSortingRelation">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.QuantilesSortingDigraph.computeSortingRelation">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSortingRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">categoryContents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">StoreSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        constructs a bipolar sorting relation using the category contents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">categoryContents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">categoryContents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">categoryContents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">(</span>
                <span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">,</span>
                <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="c1">#actions = [x for x in self.actionsOrig]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">()</span>
        <span class="n">currActions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">sortingRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categoryContents&#39;</span><span class="p">,</span><span class="n">categoryContents</span><span class="p">)</span>
        <span class="c1">#for i in categoryKeys:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ibch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">categoryContents</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
            <span class="n">ribch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">currActions</span><span class="p">)</span> <span class="o">-</span> <span class="n">ibch</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ibch,ribch&#39;</span><span class="p">,</span><span class="n">ibch</span><span class="p">,</span><span class="n">ribch</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ibch</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ibch</span><span class="p">:</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ribch</span><span class="p">:</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="n">sortingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
            <span class="n">currActions</span> <span class="o">=</span> <span class="n">currActions</span> <span class="o">-</span> <span class="n">ibch</span>
        <span class="k">return</span> <span class="n">sortingRelation</span></div>
</div>


<span class="c1">############################################################</span>
<div class="viewcode-block" id="ConfidentQuantilesSortingDigraph">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.ConfidentQuantilesSortingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">ConfidentQuantilesSortingDigraph</span><span class="p">(</span><span class="n">QuantilesSortingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of the root :py:class:`~sortingDigraphs.QuantilesSortingDigraph` class</span>
<span class="sd">    for sorting of a large set of alternatives into</span>
<span class="sd">    confident quantiles delimited ordered classes.</span>
<span class="sd">      </span>
<span class="sd">    .. note::</span>

<span class="sd">        The constructor requires a valid PerformanceTableau instance.</span>
<span class="sd">        If no number of limiting quantiles is given, then a default profile with the limiting quartiles Q0,Q1,Q2, Q3 and Q4 is used on each criteria.</span>
<span class="sd">        By default upper closed limits of categories are supposed to be used in the sorting.</span>

<span class="sd">    Example Python3 session:</span>

<span class="sd">    &gt;&gt;&gt; from sortingDigraphs import ConfidentQuantilesSortingDigraph</span>
<span class="sd">    &gt;&gt;&gt; from randomPerfTabs import RandomCBPerformanceTableau</span>
<span class="sd">    &gt;&gt;&gt; t = RandomCBPerformanceTableau(numberOfActions=7,numberOfCriteria=5,</span>
<span class="sd">    ...                                weightDistribution=&#39;equiobjectives&#39;)</span>
<span class="sd">    &gt;&gt;&gt; cqs = ConfidentQuantilesSortingDigraph(t,limitingQuantiles=7)</span>
<span class="sd">    &gt;&gt;&gt; cqs.showSorting()</span>
<span class="sd">    *--- Sorting results in descending order ---*</span>
<span class="sd">    ]0.86 - 1.00]: 	 []</span>
<span class="sd">    ]0.71 - 0.86]: 	 [&#39;a03&#39;]</span>
<span class="sd">    ]0.57 - 0.71]: 	 [&#39;a04&#39;]</span>
<span class="sd">    ]0.43 - 0.57]: 	 [&#39;a04&#39;, &#39;a05&#39;, &#39;a06&#39;]</span>
<span class="sd">    ]0.29 - 0.43]: 	 [&#39;a01&#39;, &#39;a02&#39;, &#39;a06&#39;, &#39;a07&#39;]</span>
<span class="sd">    ]0.14 - 0.29]: 	 []</span>
<span class="sd">    ]&lt; - 0.14]: 	 []</span>
<span class="sd">    &gt;&gt;&gt; cqs.showQuantileOrdering()</span>
<span class="sd">    ]0.71-0.86] : [&#39;a03&#39;]</span>
<span class="sd">    ]0.43-0.71] : [&#39;a04&#39;]</span>
<span class="sd">    ]0.43-0.57] : [&#39;a05&#39;]</span>
<span class="sd">    ]0.29-0.57] : [&#39;a06&#39;]</span>
<span class="sd">    ]0.29-0.43] : [&#39;a07&#39;, &#39;a02&#39;, &#39;a01&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfTab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">limitingQuantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">LowerClosed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">PrefThresholds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">outrankingType</span> <span class="o">=</span> <span class="s2">&quot;confident&quot;</span><span class="p">,</span>
                 <span class="n">distribution</span> <span class="o">=</span> <span class="s1">&#39;triangular&#39;</span><span class="p">,</span>
                 <span class="n">betaParameter</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="n">confidence</span> <span class="o">=</span> <span class="mf">90.0</span><span class="p">,</span>
                 <span class="n">WithSortingRelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="c1">#CompleteOutranking = False,</span>
                 <span class="n">StoreSorting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">CopyPerfTab</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="c1">#Threading=False,</span>
                 <span class="c1">#tempDir=None,</span>
                 <span class="c1">#nbrOfCPUs=None,</span>
                 <span class="c1">#nbrOfProcesses=None,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for QuantilesSortingBigDigraph instances.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
        <span class="k">if</span> <span class="n">CopyPerfTab</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">deepcopy</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">copy2self</span> <span class="o">=</span> <span class="n">copy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

        <span class="c1"># import the performance tableau</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">argPerfTab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a valid performance tableau is required!&#39;</span><span class="p">)</span>
<span class="c1">##            perfTab = RandomPerformanceTableau(numberOfActions=10,</span>
<span class="c1">##                                               numberOfCriteria=13)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">perfTab</span> <span class="o">=</span> <span class="n">argPerfTab</span>
        <span class="c1"># normalize the actions as a dictionary construct</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="c1">#self.actions = actions</span>

        <span class="c1"># keep a copy of the original actions set before adding the profiles</span>
        <span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsOrig</span> <span class="o">=</span> <span class="n">actionsOrig</span>

        <span class="c1">#  normalizing the performance tableau</span>
        <span class="n">normPerfTab</span> <span class="o">=</span> <span class="n">NormalizedPerformanceTableau</span><span class="p">(</span><span class="n">perfTab</span><span class="p">)</span>

        <span class="c1"># instantiating the performance tableau part</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">criteria</span>
        <span class="c1">#self.convertWeight2Decimal()</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="n">normPerfTab</span><span class="o">.</span><span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">copy2self</span><span class="p">(</span><span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="c1">#self.convertEvaluation2Decimal()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dataInput&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span><span class="p">}</span>

        <span class="c1">#  compute the limiting quantiles</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sorting_with_given_quantiles&#39;</span>
            <span class="n">newLimitingQuantiles</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">limitingQuantiles</span><span class="p">:</span>
                <span class="n">newLimitingQuantiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">newLimitingQuantiles</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;convert to decimal!&#39;</span><span class="p">,</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantiles</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">limitingQuantiles</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span>

        <span class="c1"># supposing all criteria scales between 0.0 and 100.0</span>
        <span class="c1"># with preference direction = max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="n">lowValue</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">highValue</span> <span class="o">=</span> <span class="mf">100.00</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]}</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - &lt;[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span>
                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;[&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span>                 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]&lt; - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]&lt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>                                  
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">categories</span><span class="p">)))</span>

        <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">gQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeLimitingQuantiles</span><span class="p">(</span><span class="n">g</span><span class="p">,</span>
                            <span class="n">PrefThresholds</span><span class="o">=</span><span class="n">PrefThresholds</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
<span class="c1">##            if Debug:</span>
<span class="c1">##                print(g,gQuantiles)</span>
            <span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">gQuantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="n">criteriaCategoryLimits</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CriteriaCategoryLimits&#39;</span><span class="p">,</span><span class="n">criteriaCategoryLimits</span><span class="p">)</span>

        <span class="c1"># add the catogory limits to the actions set</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1">#profileLimits = set()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-m&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="n">c</span><span class="o">+</span><span class="s1">&#39;-M&#39;</span>
            <span class="c1">#profileLimits.add(cKey)</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical low limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actions</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;categorical high limits&#39;</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">criteria</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">evaluation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
        <span class="n">profileLimits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1">#profileLimits.sort()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span> <span class="o">=</span> <span class="n">profileLimits</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.actions&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profiles&#39;</span><span class="p">,</span><span class="n">profiles</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profileLimits&#39;</span><span class="p">,</span><span class="n">profileLimits</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeProfiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        
        <span class="c1"># construct outranking relation</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasNoVeto</span> <span class="o">=</span> <span class="n">hasNoVeto</span>
        <span class="n">minValuation</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="n">maxValuation</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="p">(</span><span class="n">Max</span> <span class="o">+</span> <span class="n">Min</span><span class="p">)</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span><span class="n">Med</span> <span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span> <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actions</span>
<span class="c1">##        if CompleteOutranking:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">ConfidentBipolarOutrankingDigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span>
                 <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span><span class="p">,</span>
                 <span class="n">betaParameter</span> <span class="o">=</span> <span class="n">betaParameter</span><span class="p">,</span>
                 <span class="n">confidence</span> <span class="o">=</span> <span class="n">confidence</span><span class="p">,</span>
                <span class="c1">#Threading=Threading,nbrOfCPUs=nbrOfCPUs,</span>
                <span class="p">)</span>
        <span class="c1">#g.recodeValuation(minValuation,maxValuation)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">relation</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>
        <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rx</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                        <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                        <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute weak ordering</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
            <span class="c1">#if nbrOfProcesses is None:</span>
            <span class="c1">#    nbrOfProcesses = nbrOfCPUs</span>
            <span class="n">sortingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingRelation</span><span class="p">(</span>
                <span class="n">StoreSorting</span><span class="o">=</span><span class="n">StoreSorting</span><span class="p">,</span>
                <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                <span class="c1">#Threading=Threading,</span>
                <span class="c1">#nbrOfCPUs=nbrOfProcesses,</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                <span class="n">rx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="n">srx</span> <span class="o">=</span> <span class="n">sortingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actionsOrig</span><span class="p">:</span>
                    <span class="n">rx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">srx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                    
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;weakOrdering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        <span class="c1"># reset original action set</span>
        <span class="k">if</span> <span class="n">WithSortingRelation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">actionsOrig</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tt</span></div>

    
<span class="c1">##############################################################</span>

<span class="kn">from</span> <span class="nn">performanceQuantiles</span> <span class="kn">import</span> <span class="n">PerformanceQuantiles</span>  
<div class="viewcode-block" id="LearnedQuantilesRatingDigraph">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">LearnedQuantilesRatingDigraph</span><span class="p">(</span><span class="n">QuantilesSortingDigraph</span><span class="p">,</span><span class="n">PerformanceQuantiles</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialisation of the root :py:class:`sortingDigraphs.SortingDigraph` class</span>
<span class="sd">    for absolute rating of a new set of decision actions with</span>
<span class="sd">    normed performance quantiles gathered from historical data.</span>
<span class="sd">      </span>
<span class="sd">    .. note::</span>

<span class="sd">        The constructor requires a valid</span>
<span class="sd">        :py:class:`performanceQuantiles.PerformanceQuantiles` instance.</span>

<span class="sd">        Mind that setting *Threading* to *True when running from a python script file</span>
<span class="sd">        the main program entry must be started with a *__name__==&#39;__main__&#39;* test.</span>


<span class="sd">    Example Python session:</span>
<span class="sd">        &gt;&gt;&gt; from sortingDigraphs import *</span>
<span class="sd">        &gt;&gt;&gt; # historical data</span>
<span class="sd">        &gt;&gt;&gt; from randomPerfTabs import RandomCBPerformanceTableau</span>
<span class="sd">        &gt;&gt;&gt; nbrActions=1000</span>
<span class="sd">        &gt;&gt;&gt; nbrCrit = 13</span>
<span class="sd">        &gt;&gt;&gt; seed = 100</span>
<span class="sd">        &gt;&gt;&gt; tp = RandomCBPerformanceTableau(numberOfActions=nbrActions,numberOfCriteria=nbrCrit,seed=seed)</span>
<span class="sd">        &gt;&gt;&gt; pq = PerformanceQuantiles(tp,numberOfBins=&#39;deciles&#39;,LowerClosed=True,Debug=False)</span>
<span class="sd">        &gt;&gt;&gt; # new incoming decision actions of the same kind</span>
<span class="sd">        &gt;&gt;&gt; from randomPerfTabs import RandomPerformanceGenerator as PerfTabGenerator</span>
<span class="sd">        &gt;&gt;&gt; tpg = PerfTabGenerator(tp,instanceCounter=0,seed=seed)</span>
<span class="sd">        &gt;&gt;&gt; newActions = tpg.randomActions(10)</span>
<span class="sd">        &gt;&gt;&gt; # rating the new set of decision actions after</span>
<span class="sd">        &gt;&gt;&gt; # updating the historical performance quantiles</span>
<span class="sd">        &gt;&gt;&gt; pq.updateQuantiles(newActions,historySize=None)</span>
<span class="sd">        &gt;&gt;&gt; nqr = LearnedQuantilesRatingDigraph(pq,newActions)</span>
<span class="sd">        &gt;&gt;&gt; # inspecting the rating result</span>
<span class="sd">        &gt;&gt;&gt; nqr.showQuantilesRating()</span>
<span class="sd">        *-------- Learned quantiles rating result ---------</span>
<span class="sd">        [0.60 - 0.70[ [&#39;a01&#39;]</span>
<span class="sd">        [0.50 - 0.60[ [&#39;a07&#39;, &#39;a10&#39;, &#39;a02&#39;, &#39;a08&#39;, &#39;a09&#39;]</span>
<span class="sd">        [0.40 - 0.50[ [&#39;a03&#39;, &#39;a06&#39;, &#39;a05&#39;]</span>
<span class="sd">        [0.30 - 0.40[ [&#39;a04&#39;]</span>
<span class="sd">        &gt;&gt;&gt; nqr.showHTMLRatingHeatmap(pageTitle=&#39;Heatmap of Quantiles Rating&#39;)</span>

<span class="sd">    .. image:: heatMap3.png</span>
<span class="sd">        :alt: usage example of Learned Quantiles Rating Digraph</span>
<span class="sd">        :width: 500 px</span>
<span class="sd">        :align: center</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argPerfQuantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">newData</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">hasNoVeto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="c1">#PrefThresholds=False,</span>
                 <span class="n">valuationScale</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                 <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span>
                 <span class="n">WithSorting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">tempDir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="c1"># constructor for incremental rating agents</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span><span class="n">deepcopy</span>        
        <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

        <span class="c1"># set Debug status</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            self.Debug = Debug</span>
        <span class="c1"># import the performance quantiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">argPerfQuantiles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: valid performance quantiles are required!&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">perfQuantiles</span> <span class="o">=</span> <span class="n">argPerfQuantiles</span>

        <span class="c1"># instantiating the performance quantiles part</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">objectives</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span> <span class="o">=</span> <span class="n">perfQuantiles</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">historySizes</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">historySizes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">perfQuantiles</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;learnedRatingDigraph&#39;</span>
        <span class="c1"># import the actions to rate</span>
        <span class="k">if</span> <span class="n">newData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># randomActions format {&#39;actions&#39;: .., &#39;evaluation&#39;:..}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">newData</span><span class="p">[</span><span class="s1">&#39;evaluation&#39;</span><span class="p">]</span>
                <span class="c1">## need NA to found somewhere !!!</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>  <span class="c1">#  randomPerformanceTableau format</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">newData</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">newData</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !!!: valid new Actions or valid new PerformanceTableau required&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error !!!: newly observed decision actions with performance evaluations are required !!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tt</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;new actions&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;new evaluations&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;NA symbol&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantiles frequencies: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;limitingQuantiles&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>

        <span class="c1"># instantiate rating categories</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

        <span class="c1"># convertWeights to positive</span>
<span class="c1">##        from perfTabs import PerformanceTableau</span>
<span class="c1">##        PerformanceTableau.convertWeights2Positive(self)        </span>

        <span class="c1"># check if new quantile limits should be interpolated</span>
        <span class="k">if</span> <span class="n">quantiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">oldFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span>
            <span class="n">newFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeQuantilesFrequencies</span><span class="p">(</span><span class="n">quantiles</span><span class="p">)</span>
            <span class="n">newLimitingQuantiles</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                <span class="n">newLimitingQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">newFreq</span><span class="p">:</span>
                <span class="n">newQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileProfile</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">oldFreq</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
                    <span class="n">newLimitingQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="n">newLimitingQuantiles</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span> <span class="o">=</span> <span class="n">newFreq</span>
            
        <span class="n">quantFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span>
        <span class="n">limitingQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limitingQuantiles</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">limitingQuantiles</span><span class="p">)</span>
            
        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">[&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]}</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1"> - &lt;[&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">k</span><span class="p">,</span>
                                  <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;[</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                                  <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;[&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span>                 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]&lt; - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]&lt;&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>                                  
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
                <span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1">]&#39;</span>\
                <span class="o">%</span><span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;order&#39;</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s1">&#39;lowLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;]</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                        <span class="s1">&#39;highLimit&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="s1">&#39;quantile&#39;</span><span class="p">:</span> <span class="n">quantFreq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
<span class="c1">##</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="n">categories</span><span class="p">)))</span>

        <span class="c1"># instantiate criteria category limits</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LowerClosed</span>
        <span class="c1">#self.criteriaCategoryLimits = criteriaCategoryLimits</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">limitingQuantiles</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="n">gQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_computeLimitingQuantiles</span><span class="p">(</span><span class="n">g</span><span class="p">,</span>
                            <span class="c1">#PrefThresholds=PrefThresholds,</span>
                            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">gQuantiles</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;4.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CriteriaCategoryLimits&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">)</span>

        <span class="c1"># set the category limits type (LowerClosed = True is default)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="s1">&#39;LowerClosed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>
        <span class="n">criteriaCategoryLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span>

        <span class="c1"># add the profiles, ie catogory limits, to the actions set</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span><span class="o">+</span><span class="n">c</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cKey</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span><span class="o">+</span><span class="n">c</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; -&#39;</span><span class="p">,</span>\
                                  <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Inferior or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">profiles</span><span class="p">[</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;- &#39;</span> <span class="o">+</span> <span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                  <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Lower or equal limits for category membership assessment&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="n">profiles</span>
        <span class="n">profileLimits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span> <span class="o">=</span> <span class="n">profileLimits</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profiles&#39;</span><span class="p">,</span><span class="n">profiles</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;self.profileLimits&#39;</span><span class="p">,</span><span class="n">profileLimits</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;profiles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
        
        <span class="c1"># construct outranking relation</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Threading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="n">nbrOfCPUs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hasNoVeto</span> <span class="o">=</span> <span class="n">hasNoVeto</span>
        <span class="n">minValuation</span> <span class="o">=</span> <span class="n">valuationScale</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">maxValuation</span> <span class="o">=</span> <span class="n">valuationScale</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># construct the corresponding perfTab</span>
        <span class="n">perfTab</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">isEmpty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">)</span>
        <span class="n">perfTab</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span>
        <span class="n">perfTab</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">perfTab</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">)</span>
        <span class="n">perfTab</span><span class="o">.</span><span class="n">NA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span>
        
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;6.&#39;</span><span class="p">)</span>
            <span class="n">perfTab</span><span class="o">.</span><span class="n">showActions</span><span class="p">()</span>
            <span class="n">perfTab</span><span class="o">.</span><span class="n">showCriteria</span><span class="p">()</span>
            <span class="n">perfTab</span><span class="o">.</span><span class="n">showPerformanceTableau</span><span class="p">()</span>
        
        <span class="n">g</span> <span class="o">=</span> <span class="n">BipolarOutrankingDigraph</span><span class="p">(</span><span class="n">perfTab</span><span class="p">,</span><span class="n">hasNoVeto</span><span class="o">=</span><span class="n">hasNoVeto</span><span class="p">,</span><span class="n">Normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span><span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">recodeValuation</span><span class="p">(</span><span class="n">minValuation</span><span class="p">,</span><span class="n">maxValuation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">completeRelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">relation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">relation</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concordanceRelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">concordanceRelation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">largeDifferencesCount</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">largeDifferencesCount</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
<span class="c1">##        Min = g.valuationdomain[&#39;min&#39;]</span>
<span class="c1">##        Max = g.valuationdomain[&#39;max&#39;]</span>
<span class="c1">##        Med = g.valuationdomain[&#39;med&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">valuationdomain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeRelation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># compute rating categories</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span><span class="p">,</span><span class="n">CopelandOrder</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>           
            <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">corrnf</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="n">nf</span><span class="o">.</span><span class="n">netFlowsOrder</span><span class="p">)</span>
            <span class="c1">#print(&#39;nf:&#39;, corrnf)</span>
            <span class="n">corrcop</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="n">cop</span><span class="o">.</span><span class="n">copelandOrder</span><span class="p">)</span>
            <span class="c1">#print(&#39;cop&#39;, corrcop)</span>
            <span class="k">if</span> <span class="n">corrnf</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">corrcop</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;NetFlows&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">corrnf</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlows</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Copeland&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">corrcop</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">decCopelandScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">CopelandOrder</span>
            <span class="n">cop</span> <span class="o">=</span> <span class="n">CopelandOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">copelandRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Copeland&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">cop</span><span class="o">.</span><span class="n">decCopelandScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">NetFlowsOrder</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">NetFlowsOrder</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">netFlowsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;NetFlows&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">decnetFlowScores</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;RankedPairs&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">RankedPairsRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">RankedPairsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">rankedPairsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;RankedPairs&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedCopeland&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedCopelandRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">IteratedCopelandRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">iteratedCopelandRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;IteratedCopeland&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;IteratedNetFlows&#39;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">IteratedNetFlowsRanking</span>
            <span class="n">rp</span> <span class="o">=</span> <span class="n">IteratedNetFlowsRanking</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">iteratedNetFlowsRanking</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;IteratedNetFlows&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Kemeny&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: the digraph is to big for the Kemeny ranking rule üüü&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">linearOrders</span> <span class="kn">import</span> <span class="n">KemenyRanking</span>
                <span class="n">ke</span> <span class="o">=</span> <span class="n">KemenyRanking</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">orderLimit</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">ke</span><span class="o">.</span><span class="n">kemenyRanking</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span> <span class="o">=</span> <span class="s1">&#39;Kemeny&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Errr: The ranking rule </span><span class="si">%s</span><span class="s1"> is not availbale !!&#39;</span> <span class="o">%</span> <span class="n">rankingRule</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">!=</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">computeRankingCorrelation</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span> <span class="o">=</span> <span class="n">actionsList</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;6.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantilesRating</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking rule        :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actions ranking     :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ranking correlation :&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rating categories:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ranking&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
               
        <span class="c1"># compute quantiles sorting</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">WithSorting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCategoryContents</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;8.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showSorting</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showActionsSortingResult</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showQuantileOrdering</span><span class="p">()</span>
                <span class="c1">#self.showQuantilesRating()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

        <span class="c1"># end of the construction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tt</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default presentation method for BipolarOutrankingDigraph instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">String</span> <span class="o">=</span>  <span class="s1">&#39;*-----  Object instance description -----------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Instance class      : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Instance name       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Criteria            : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Quantiles           : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Lower-closed bins   : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;New actions         : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Size                : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSize</span><span class="p">()</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Determinateness (</span><span class="si">%%</span><span class="s1">) : </span><span class="si">%.1f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                  <span class="bp">self</span><span class="o">.</span><span class="n">computeDeterminateness</span><span class="p">(</span><span class="n">InPercents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Ranking rule        : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Ordinal correlation : </span><span class="si">%+.2f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>\
                  <span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Attributes: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;*------  Constructor run times (in sec.) ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Threads          : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Threads          : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbrThreads</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Start method         : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">startMethod</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
            
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Total time       : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;totalTime&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Data input       : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;dataInput&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Quantile classes : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute profiles : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;profiles&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute relation : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;computeRelation&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute ranking  : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;ranking&#39;</span><span class="p">]</span>
        <span class="n">String</span> <span class="o">+=</span> <span class="s1">&#39;Compute rating   : </span><span class="si">%.5f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">runTimes</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">String</span> 

<span class="c1"># ------------ private methods ------------------</span>

    <span class="k">def</span> <span class="nf">_computeLimitingQuantiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">_PrefThresholds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the list of limiting quantiles on criteria g</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_PrefThresholds</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;thresholds&#39;</span><span class="p">][</span><span class="s1">&#39;pref&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">gPrefThrCst</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
                <span class="n">gPrefThrSlope</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>            
        <span class="n">gQuantiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteriaCategoryLimits</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">gQuantiles</span><span class="p">)</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gQuantiles</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_PrefThresholds</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nq</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># quantile limits raised by the preference thershold</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">-</span> <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">+</span> <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
            <span class="c1"># we ignore the 1.00 quantile and replace it with +infty        </span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                <span class="n">gQuantiles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gQuantiles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>       

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># upper closed categories</span>
            <span class="c1"># we ignore the quantile 0.0 and replace it with -\infty            </span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                <span class="n">gQuantiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gQuantiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;scale&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">_PrefThresholds</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nq</span><span class="p">):</span> <span class="c1"># quantile limits raised by the preference thershold</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>
                        <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">-</span> <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gPrefThrCst</span> <span class="o">+</span> <span class="n">gQuantiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">gPrefThrSlope</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;preferenceDirection&#39;</span><span class="p">],</span><span class="n">gQuantiles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gQuantiles</span>

<span class="c1"># ------------ public methods ------------------</span>

<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.computeCategoryContents">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.computeCategoryContents">[docs]</a>
    <span class="k">def</span> <span class="nf">computeCategoryContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the quantiles sorting results per quantile category.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">Reverse</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span>
        <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">categoryContent</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="n">Reverse</span><span class="p">):</span>
            <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">categoryContent</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">categoryContent</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.computeQuantileOrdering">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.computeQuantileOrdering">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantileOrdering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">HTML</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Orders the quantiles sorting result of self.newActions.</span>

<span class="sd">        *Parameters*:</span>
<span class="sd">            * Descending: listing in *decreasing* (default) or *increasing* quantile order.</span>
<span class="sd">            * strategy: ordering in an {&#39;optimistic&#39; (default) | &#39;pessimistic&#39; | &#39;average&#39;}</span>
<span class="sd">              in the uppest, the lowest or the average potential quantile.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strategy</span> <span class="o">=</span> <span class="s1">&#39;average&#39;</span>
        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;h1&gt;Quantiles preordering&lt;/h1&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:White;&quot; border=&quot;1&quot;&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=&quot;#9acd32&quot;&gt;&lt;th&gt;quantile limits&lt;/th&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;Ordering by </span><span class="si">%s</span><span class="s1"> quantile class limits&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="n">strategy</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span>
        <span class="n">actionsCategories</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span><span class="n">lowCateg</span><span class="p">,</span><span class="n">highCateg</span><span class="p">,</span><span class="n">credibility</span> <span class="o">=</span>\
                     <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                <span class="n">lc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">)</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">highCateg</span><span class="p">)</span>
                <span class="n">ac</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">+</span><span class="n">hc</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="n">ac</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># optimistic by default</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">actionsCategories</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">highCateg</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">lowCateg</span><span class="p">))]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>      
                
        <span class="n">actionsCategIntervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">interval</span> <span class="ow">in</span> <span class="n">actionsCategories</span><span class="p">:</span>
            <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">interval</span><span class="p">,</span>
                                          <span class="n">actionsCategories</span><span class="p">[</span><span class="n">interval</span><span class="p">]])</span>
        <span class="n">actionsCategIntervals</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">weakOrdering</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">actionsCategIntervals</span><span class="p">:</span>
        <span class="c1">#print(item)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;optimistic&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;tdbgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>                            
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;pessimistic&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>                   
                <span class="k">elif</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>\
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;td bgcolor=&quot;#FFF79B&quot;&gt;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">])</span>
                            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&lt;/tr&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1"> : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                                <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">weakOrdering</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">HTML</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span>
            <span class="k">return</span> <span class="n">html</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">weakOrdering</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.computeQuantilesRating">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.computeQuantilesRating">[docs]</a>
    <span class="k">def</span> <span class="nf">computeQuantilesRating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          Renders an ordered dictionary of non empty quantiles in ascending order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span> <span class="c1"># lower closed quantiles</span>
            <span class="n">ranking</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;9.1&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
        <span class="n">ratingCategories</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">:</span>
            <span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ranking</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranking</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;swapping&#39;</span><span class="p">,</span><span class="n">ranking</span><span class="p">)</span>
        <span class="n">New</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">New</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">ratingCategories</span><span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">New</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                        <span class="n">ratingCategories</span><span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ratingCategories</span><span class="p">[</span><span class="n">ranking</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">New</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ratingCategories</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.computeRatingRelation">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.computeRatingRelation">[docs]</a>
    <span class="k">def</span> <span class="nf">computeRatingRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">StoreRating</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a bipolar rating relation using a pre-ranking (list of lists)</span>
<span class="sd">        of the self-actions (self.newActions + self.profiles).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantilesRating</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>

        <span class="c1"># pre-ranking self.actions</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span>
        <span class="n">preRanking</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span> <span class="c1">#  in ascending order</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="n">preRanking</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="n">c</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">preRanking</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># computing in descending order</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">profiles</span><span class="p">):</span>
                <span class="n">preRanking</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">preRanking</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;preRanking&#39;</span><span class="p">,</span><span class="n">preRanking</span><span class="p">)</span>

        
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">]</span>
        <span class="n">currentActions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">ratingRelation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># init the relation decitionaries</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">ratingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="n">ratingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="c1"># computing the relation in descending order</span>
        <span class="k">for</span> <span class="n">eqcl</span> <span class="ow">in</span> <span class="n">preRanking</span><span class="p">:</span>
            <span class="n">currRest</span> <span class="o">=</span> <span class="n">currentActions</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">eqcl</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;currentActions, eqcl, currRest&#39;</span><span class="p">,</span> <span class="n">currentActions</span><span class="p">,</span> <span class="n">eqcl</span><span class="p">,</span> <span class="n">currRest</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">currRest</span><span class="p">:</span>
                    <span class="n">ratingRelation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">ratingRelation</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
            <span class="n">currentActions</span> <span class="o">=</span> <span class="n">currentActions</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">eqcl</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">StoreRating</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ratingRelation</span> <span class="o">=</span> <span class="n">ratingRelation</span>
        <span class="k">return</span> <span class="n">ratingRelation</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.computeSortingCharacteristics">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.computeSortingCharacteristics">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSortingCharacteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a bipolar-valued bi-dictionary relation (newActions x profiles)</span>
<span class="sd">        representing the degree of credibility of the</span>
<span class="sd">        assertion that &quot;action x in A belongs to quantile category c profiles&quot;,</span>
<span class="sd">        If LowerClosed is True, x outranks the category low limit</span>
<span class="sd">        and x does not outrank the category high limit, or</span>
<span class="sd">        If LowerClosed is False, ie UPPERCLosed is True, the category</span>
<span class="sd">        low limit does not outrank x and the category high limit does outrank x. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>

        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span>
            
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>

        <span class="n">LowerClosed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span>

        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(x &gt;= m_k)</span><span class="se">\t</span><span class="s1"> r(x &lt; M_k)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x  in  K_k</span><span class="se">\t</span><span class="s1"> r(m_k &lt; x)</span><span class="se">\t</span><span class="s1"> r(M_k &gt;= x)</span><span class="se">\t</span><span class="s1"> r(x in K_k)&#39;</span><span class="p">)</span>

        <span class="n">sorting</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quantilesFrequencies</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
            <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="s1">&#39;m&#39;</span><span class="o">+</span><span class="n">c</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cKey</span><span class="o">=</span> <span class="s1">&#39;M&#39;</span><span class="o">+</span><span class="n">c</span>
                <span class="k">if</span> <span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cKey</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">nq</span><span class="p">:</span>
                        <span class="n">cMaxKey</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">cMaxKey</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">Max</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">cMinKey</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cMinKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">Min</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">cKey</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
                <span class="c1">#if Comments:</span>
                <span class="c1">#    print(&#39;%s in %s: low = %.2f, high = %.2f&#39; % \</span>
                <span class="c1">#          (x, c,lowLimit,notHighLimit), end=&#39; &#39;)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">categoryMembership</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lowLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">notHighLimit</span>
                <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">categoryMembership</span>

                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="c1">#print(&#39;\t %.2f \t %.2f \t %.2f&#39; % (sorting[x][c][&#39;lowLimit&#39;], sorting[x][c][&#39;notHighLimit&#39;], sorting[x][c][&#39;categoryMembership&#39;]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">],</span>
                        <span class="n">sorting</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">sorting</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.exportRatingGraphViz">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.exportRatingGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportRatingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                             <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy for self.exportRatingByRankingGraphViz()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportRatingByRankingGraphViz</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                                   <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                   <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                                   <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                                   <span class="n">fontSize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">,</span>
                                   <span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">)</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.exportRatingBySortingGraphViz">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.exportRatingBySortingGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportRatingBySortingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;12,12&#39;</span><span class="p">,</span>
                             <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graphviz drawing of the rating-by-sorting digraph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">selfActions</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getActionsKeys</span><span class="p">()</span>
        <span class="n">sortingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingRelation</span><span class="p">()</span>
        <span class="n">selfRelation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">sortingRelation</span>
        <span class="kn">from</span> <span class="nn">sortingDigraphs</span> <span class="kn">import</span> <span class="n">QuantilesSortingDigraph</span>
        <span class="n">QuantilesSortingDigraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                                   <span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                                   <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span>
                                   <span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                                   <span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">,</span>
                                   <span class="n">fontSize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">selfActions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">selfRelation</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.exportRatingByRankingGraphViz">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.exportRatingByRankingGraphViz">[docs]</a>
    <span class="k">def</span> <span class="nf">exportRatingByRankingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span>
                             <span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                             <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">,</span>
                             <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export GraphViz dot file for Hasse diagram drawing filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">deepcopy</span>
            
        <span class="k">def</span> <span class="nf">_safeName</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">t1</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">t1</span>
        
        <span class="c1"># working on a deepcopy of self</span>
        <span class="n">digraph</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">categoryContent</span><span class="p">)</span>

        <span class="c1"># constructing rankingByBestChoosing result</span>
        <span class="n">rankingByChoosing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">digraph</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),[</span><span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">categoryContent</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]))</span>
                <span class="n">rankingByChoosing</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),[</span><span class="bp">self</span><span class="o">.</span><span class="n">profileLimits</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>

            
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---- exporting a dot file for GraphViz tools ---------*&#39;</span><span class="p">)</span>

        <span class="c1"># install rating relation (weakly transitive)</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeRatingRelation</span><span class="p">()</span>
        <span class="c1">#    if Debug:</span>
        <span class="c1">#        actionKeys = digraph.computeCopelandRanking()</span>
        <span class="c1">#        digraph.showHTMLRelationTable(actionsList=actionKeys)</span>
        
        <span class="c1"># sorting actionsKeys</span>
        <span class="n">actionKeys</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionKeys</span><span class="p">)</span>
        
        <span class="n">Med</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">fileName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">fileName</span>
        <span class="n">dotName</span> <span class="o">=</span> <span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dot&#39;</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exporting to &#39;</span><span class="o">+</span><span class="n">dotName</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dotName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;digraph G {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;graph [ bgcolor = </span><span class="si">%s</span><span class="s1">, ordering = out, fontname = &quot;Helvetica-Oblique&quot;,</span><span class="se">\n</span><span class="s1"> fontsize = 12,</span><span class="se">\n</span><span class="s1"> label = &quot;&#39;</span> <span class="o">%</span> <span class="n">bgcolor</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nDigraph3 (graphviz)</span><span class="se">\\</span><span class="s1">n R. Bisdorff, 2020&quot;, size=&quot;&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">graphSize</span><span class="p">),</span><span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&quot;,fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fontSize</span><span class="p">)</span>
        <span class="c1"># nodes</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionKeys</span><span class="p">:</span>
            <span class="c1">#print(digraphClass)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
                <span class="n">cat</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; -&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="s1">&#39;- &#39;</span> <span class="o">+</span><span class="n">digraph</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;box&quot;, fillcolor=lightcoral, style=filled, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">nodeName</span><span class="p">,</span><span class="n">fontSize</span><span class="p">)</span>           
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="n">digraph</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">nodeName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">node</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> [shape = &quot;circle&quot;, label = &quot;</span><span class="si">%s</span><span class="s1">&quot;, fontsize=</span><span class="si">%d</span><span class="s1">];</span><span class="se">\n</span><span class="s1">&#39;</span>\
                       <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">nodeName</span><span class="p">),</span><span class="n">fontSize</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># same ranks for Hasses equivalence classes</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rankingByChoosing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">sameRank</span> <span class="o">=</span> <span class="s1">&#39;{ rank = </span><span class="si">%d</span><span class="s1">; &#39;</span> <span class="o">%</span> <span class="n">i</span>
            <span class="n">ich</span> <span class="o">=</span> <span class="n">rankingByChoosing</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ich</span><span class="p">:</span>
                <span class="n">sameRank</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;; &#39;</span>
            <span class="n">sameRank</span> <span class="o">+=</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sameRank</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sameRank</span><span class="p">)</span>

        <span class="c1"># keep only relation skeleton</span>
        <span class="n">digraph</span><span class="o">.</span><span class="n">closeTransitive</span><span class="p">(</span><span class="n">Reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">InSite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
        <span class="c1">#        actionKeys = digraph.computeCopelandRanking()</span>
            <span class="n">digraph</span><span class="o">.</span><span class="n">showHTMLRelationTable</span><span class="p">(</span><span class="n">actionsList</span><span class="o">=</span><span class="n">actionKeys</span><span class="p">)</span>

        <span class="c1"># write out relations between nodes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">actionKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">actionKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">digraph</span><span class="o">.</span><span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">digraph</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]:</span>
                    <span class="n">arcColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
                    <span class="n">edge</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&gt; </span><span class="si">%s</span><span class="s1"> [style=&quot;setlinewidth(</span><span class="si">%d</span><span class="s1">)&quot;,color=</span><span class="si">%s</span><span class="s1">] ;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">_safeName</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">_safeName</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">arcColor</span><span class="p">)</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
                

        
                                                  
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">commandString</span> <span class="o">=</span> <span class="s1">&#39;dot -Grankdir=TB -T&#39;</span><span class="o">+</span><span class="n">graphType</span><span class="o">+</span><span class="s1">&#39; &#39;</span> <span class="o">+</span><span class="n">dotName</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">graphType</span>
            <span class="c1">#commandString = &#39;dot -T&#39;+graphType+&#39; &#39; +dotName+&#39; -o &#39;+name+&#39;.&#39;+graphType</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">commandString</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;graphViz tools not avalaible! Please check installation.&#39;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_exportRatingGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">graphType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="s1">&#39;7,7&#39;</span><span class="p">,</span>
                             <span class="n">fontSize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The rating drawing is using the :py:func:`transitiveDigraphs.TransitiveDigraph.exportGraphViz` method for</span>
<span class="sd">        drawing oriented Hasse diagrams of weak orderings, ie the negation</span>
<span class="sd">        of the corresponding preorder relation.</span>

<span class="sd">        Continuing the previous Python session:</span>

<span class="sd">        &gt;&gt;&gt; nqr.showQuantilesRating()</span>
<span class="sd">        *-------- Quantile sorting result ---------</span>
<span class="sd">        [0.50 - 0.75[ [&#39;a01&#39;]</span>
<span class="sd">        [0.25 - 0.50[ [&#39;a07&#39;, &#39;a02&#39;, &#39;a10&#39;, &#39;a06&#39;, &#39;a03&#39;, &#39;a08&#39;, &#39;a09&#39;, &#39;a04&#39;]</span>
<span class="sd">        [0.00 - 0.25[ [&#39;a05&#39;]</span>
<span class="sd">        &gt;&gt;&gt; nqr.exportRatingGraphViz(&#39;quantilesRatingDigraph&#39;,Comments=False)</span>
<span class="sd">        *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">        Exporting to quantilesRatingDigraph.dot</span>
<span class="sd">        dot -Grankdir=TB -Tpng quantilesRatingDigraph.dot -o quantilesRatingDigraph.png</span>

<span class="sd">        .. image:: quantilesRatingDigraph.png</span>
<span class="sd">            :alt: usage example of Learned Quantiles Rating Digraph</span>
<span class="sd">            :width: 400 px</span>
<span class="sd">            :align: center</span>
<span class="sd">        </span>
<span class="sd">        .. warning::</span>

<span class="sd">             For graphviz, nodes&#39; or actions&#39; keys of the digraph must start with a letter</span>
<span class="sd">             and may not contain special characters like &#39;-&#39; or &#39;_&#39;.</span>
<span class="sd">             </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="n">TransitiveDigraph</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">ratingRelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRatingRelation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relationOrig</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="n">ratingRelation</span>
        <span class="n">TransitiveDigraph</span><span class="o">.</span><span class="n">exportGraphViz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span>
                             <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="n">Comments</span><span class="p">,</span>
                             <span class="n">graphType</span><span class="o">=</span><span class="n">graphType</span><span class="p">,</span><span class="n">graphSize</span><span class="o">=</span><span class="n">graphSize</span><span class="p">,</span>
                             <span class="n">digraphClass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span>
                             <span class="n">fontSize</span><span class="o">=</span><span class="n">fontSize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relationOrig</span>

    <span class="k">def</span> <span class="nf">_htmlRatingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argCriteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">argActionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">WithActionNames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="c1">#quantiles=None,</span>
                               <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">contentCentered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">colorLevels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">pageTitle</span><span class="o">=</span><span class="s1">&#39;Rating Heatmap&#39;</span><span class="p">,</span>
                               <span class="n">rankingRule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">Correlations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;       </span>
<span class="sd">        Renders the Brewer RdYlGn 5,7, or 9 levels colored heatmap of the performance table</span>
<span class="sd">        actions x criteria in html format.</span>

<span class="sd">        See the corresponding :py:meth:`perfTabs.showHTMLPerformanceHeatMap` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;see browser&#39;</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">brewerRdYlGn9Colors</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1111&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D53E4F&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2222&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#F46D43&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.3333&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4444&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5555&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6666&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.7777&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8888&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#65BD63&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.000&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#1A9850&quot;&#39;</span><span class="p">)]</span>
        <span class="n">brewerRdYlGn7Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.1429&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#F46D43&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2857&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4286&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.5714&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.7143&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8571&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0000&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#65BD63&quot;&#39;</span><span class="p">)</span>
                               <span class="p">]</span>
        <span class="n">brewerRdYlGn5Colors</span> <span class="o">=</span> <span class="p">[</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.2&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FDAE61&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.4&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FEE08B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.6&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#FFFFBF&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.8&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#D9EF8B&quot;&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">),</span><span class="s1">&#39;&quot;#A6D96A&quot;&#39;</span><span class="p">)</span>
                               <span class="p">]</span>
        <span class="k">if</span> <span class="n">colorLevels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colorLevels</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">if</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn7Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn9Colors</span>
        <span class="k">elif</span> <span class="n">colorLevels</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn5Colors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colorPalette</span> <span class="o">=</span> <span class="n">brewerRdYlGn7Colors</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorPalette</span><span class="p">)</span>
        <span class="n">backGroundColor</span>   <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">naColor</span>           <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">columnHeaderColor</span> <span class="o">=</span> <span class="s1">&#39;&quot;#CCFFFF&quot;&#39;</span>
        <span class="n">rowHeaderColor</span>    <span class="o">=</span> <span class="s1">&#39;&quot;#FFFFFF&quot;&#39;</span>
        <span class="n">actionRowHeaderColor</span> <span class="o">=</span> <span class="s1">&#39;#FFF79B&#39;</span>

        <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;title&gt;</span><span class="si">%s</span><span class="s1">&lt;/title&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;Digraph3 performance heat map&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;style type=&quot;text/css&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1">#html += &#39;table {border-collapse: collapse;}&#39;</span>
        <span class="k">if</span> <span class="n">contentCentered</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;td {text-align: center;}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;td.na {color: rgb(192,192,192);}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;tr.quantile {color: rgb(100,100,100);}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/style&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/head&gt;</span><span class="se">\n</span><span class="s1">&lt;body&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;h2&gt;</span><span class="si">%s</span><span class="s1">&lt;/h2&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pageTitle</span>
        
<span class="c1">##        from sparseOutrankingDigraphs import PreRankedOutrankingDigraph</span>
        <span class="k">if</span> <span class="n">argCriteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argCriteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="n">argCriteriaList</span>

        <span class="k">if</span> <span class="n">rankingRule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">argActionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span>
                <span class="n">rankingRule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">argActionsList</span>
                <span class="n">rankingRule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">argActionsList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;Copeland&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeCopelandRanking</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">rankingRule</span> <span class="o">==</span> <span class="s1">&#39;NetFlows&#39;</span><span class="p">:</span>
                    <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNetFlowsRanking</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rankingRule</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">actionsList</span> <span class="o">=</span> <span class="n">argActionsList</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span>
        <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
            <span class="n">rankCorrelation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeOrderCorrelation</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">actionsList</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="n">actionsList</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="n">rankCorrelation</span><span class="p">)</span>

        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="k">if</span> <span class="n">criteriaList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span>\
                                <span class="n">actionsList</span><span class="p">,</span><span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">criteriaList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">criteriaWeightsList</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">abs</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]),</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">]</span>
                <span class="n">criteriaWeightsList</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">criteriaList</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaWeightsList</span><span class="p">]</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteriaList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">Correlations</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">computeMarginalVersusGlobalRankingCorrelations</span><span class="p">(</span>\
                                <span class="n">actionsList</span><span class="p">,</span><span class="n">ValuedCorrelation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                <span class="n">nbrCores</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">criteriaCorrelation</span> <span class="o">=</span> <span class="kc">None</span>
            
        <span class="n">quantileColor</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="n">quantilexg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeActionCriterionQuantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">quantilexg</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">!=</span> <span class="s1">&#39;NA&#39;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        
                        <span class="k">if</span> <span class="n">quantilexg</span> <span class="o">&lt;=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">colorPalette</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">naColor</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">])</span>
        <span class="c1"># heatmap</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;Ranking rule&lt;/i&gt;: &lt;b&gt;</span><span class="si">%s</span><span class="s1">&lt;/b&gt;; &lt;i&gt;Ranking correlation&lt;/i&gt;: &lt;b&gt;</span><span class="si">%.3f</span><span class="s1">&lt;/b&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>\
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">rankingCorrelation</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">])</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;criteria&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">gName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;th&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gName</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;weights&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;tau&lt;sup&gt;(*)&lt;/sup&gt;&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cg</span> <span class="ow">in</span> <span class="n">criteriaCorrelation</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td align=&quot;center&quot;&gt;</span><span class="si">%+.2f</span><span class="s1">&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c1">##        if Debug:</span>
<span class="c1">##            print(html)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actionsList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="n">xcat</span> <span class="o">=</span> <span class="n">profiles</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">xcat</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; -&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="s1">&#39;- &#39;</span> <span class="o">+</span> <span class="n">categories</span><span class="p">[</span><span class="n">xcat</span><span class="p">][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">WithActionNames</span><span class="p">:</span>
                    <span class="n">xName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;shortName&#39;</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">xName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr class=&quot;quantile&quot;&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">rowHeaderColor</span><span class="p">,</span><span class="n">xName</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr&gt;&lt;th bgcolor=</span><span class="si">%s</span><span class="s1">&gt;</span><span class="si">%s</span><span class="s1">&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">actionRowHeaderColor</span><span class="p">,</span><span class="n">xName</span><span class="p">)</span>                
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">criteriaList</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NA</span><span class="p">:</span>
                    <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> align=&quot;right&quot;&gt;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">quantileColor</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">g</span><span class="p">],</span><span class="n">ndigits</span><span class="p">)</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1"> class=&quot;na&quot;&gt;NA&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="n">naColor</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(html)</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="c1"># table legend</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;b&gt;Color legend: &lt;/b&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;table style=&quot;background-color:</span><span class="si">%s</span><span class="s1">;&quot; border=&quot;1&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">backGroundColor</span><span class="p">)</span> 
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;tr bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&lt;th&gt;quantile&lt;/th&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">columnHeaderColor</span><span class="p">)</span>
        <span class="c1">#html += &#39;&lt;td bgcolor=%s&gt;&amp;nbsp;[%.2f - %.2f[&amp;nbsp;&lt;/td&gt;&#39; % (colorPalette[0][1],0.0,colorPalette[0][0])</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;td bgcolor=</span><span class="si">%s</span><span class="s1">&gt;&amp;nbsp;</span><span class="si">%.2f</span><span class="s1">&amp;#037;&lt;/td&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">colorPalette</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="c1">#colorPalette[col-1][0],</span>
                <span class="n">colorPalette</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;100.0&#39;</span><span class="p">))</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/tr&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/table&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">criteriaCorrelation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;(*) tau: Ordinal (Kendall) correlation between&lt;/i&gt;&lt;br/&gt;&#39;</span>
            <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;i&gt;marginal criterion and global ranking relation.&lt;/i&gt;&lt;br/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="c1">##        if rankCorrelation is not None:</span>
<span class="c1">##            html += &#39;&lt;i&gt;Ordinal (Kendall) correlation between global ranking and outranking relation: %.2f.&lt;/i&gt;&#39; % (rankCorrelation[&#39;correlation&#39;])</span>
        <span class="n">html</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/body&gt;&lt;/html&gt;&#39;</span>
        <span class="k">return</span> <span class="n">html</span>

<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showActionCategories">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showActionCategories">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionCategories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">action</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the union of categories in which the given action is sorted positively or null into.</span>
<span class="sd">        Returns a tuple : action, lowest category key, highest category key, membership credibility !</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">[</span><span class="s1">&#39;med&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorting</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sorting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeSortingCharacteristics</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="n">catKeys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">()</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">catKeys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedCategoryKeys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;categoryMembership&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">Med</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">lowLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="k">if</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">notHighLimit</span> <span class="o">=</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;notHighLimit&#39;</span><span class="p">]</span>
                    <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
                <span class="c1">#keys.append(c)</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">sorting</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">c</span><span class="p">],</span> <span class="n">keys</span><span class="p">)</span>
        <span class="n">credibility</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> with credibility: </span><span class="si">%.2f</span><span class="s1"> = min(</span><span class="si">%.2f</span><span class="s1">,</span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;lowLimit&#39;</span><span class="p">],</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;highLimit&#39;</span><span class="p">],</span>
                                 <span class="n">action</span><span class="p">,</span>
                                 <span class="n">credibility</span><span class="p">,</span><span class="n">lowLimit</span><span class="p">,</span><span class="n">notHighLimit</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">action</span><span class="p">,</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>\
                <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>\
                <span class="n">credibility</span>            </div>



<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showActionsSortingResult">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showActionsSortingResult">[docs]</a>
    <span class="k">def</span> <span class="nf">showActionsSortingResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the quantiles sorting result of all (default) or</span>
<span class="sd">        a subset of the decision actions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">actionsSubset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">newActions</span><span class="p">]</span>
            <span class="c1">#actions.sort()</span>
        <span class="c1">#else:</span>
        <span class="c1">#    actions = [x for x in flatten(actionSubset)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Quantiles sorting result per decision action&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showActionCategories</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>



<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showHTMLPerformanceHeatmap">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showHTMLPerformanceHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Please use the showHTMLRatingHeatmap() here !!&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showHTMLRatingHeatmap">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showHTMLRatingHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLRatingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">WithActionNames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">colorLevels</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                                   <span class="n">pageTitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">ndigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">rankingRule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Correlations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specialisation of html heatmap version showing the performance tableau in a browser window;</span>
<span class="sd">        see :py:meth:`perfTabs.showHTMLPerformanceHeatMap` method.</span>

<span class="sd">        **Parameters**:</span>

<span class="sd">              - *actionsList* and *criteriaList*, if provided,  give the possibility to show the decision alternatives, resp. criteria, in a given ordering.</span>
<span class="sd">              - *ndigits* = 0 may be used to show integer evaluation values.</span>
<span class="sd">              - If no *actionsList* is provided, the decision actions are ordered from the best to the worst following the ranking of the LearnedQuatilesRatingDigraph instance.              </span>
<span class="sd">              - It may interesting in some cases to use *RankingRule* = &#39;NetFlows&#39;.</span>
<span class="sd">              - With *Correlations* = *True* and *criteriaList* = *None*, the criteria will be presented from left to right in decreasing order of the correlations between the marginal criterion based ranking and the global ranking used for presenting the decision alternatives.</span>
<span class="sd">              - Computing the marginal correlations may be boosted with Threading = True, if multiple parallel computing cores are available.</span>

<span class="sd">        Suppose we observe the following rating result:</span>
<span class="sd">        </span>
<span class="sd">            &gt;&gt;&gt; nqr.showQuantilesRating()</span>
<span class="sd">            [0.50 - 0.75[ [&#39;a1005&#39;, &#39;a1010&#39;, &#39;a1008&#39;, &#39;a1002&#39;, &#39;a1006&#39;]</span>
<span class="sd">            [0.25 - 0.50[ [&#39;a1003&#39;, &#39;a1001&#39;, &#39;a1007&#39;, &#39;a1004&#39;, &#39;a1009&#39;]</span>
<span class="sd">            &gt;&gt;&gt; nqr.showHTMLRatingHeatmap(pageTitle=&#39;Heat map of the ratings&#39;,</span>
<span class="sd">            ...                           Correlations=True,</span>
<span class="sd">            ...                           colorLevels = 5)</span>

<span class="sd">        .. image:: heatMap1.png</span>
<span class="sd">            :alt: usage example of Learned Quantiles Rating Digraph</span>
<span class="sd">            :width: 550 px</span>
<span class="sd">            :align: center</span>

<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pageTitle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A ranking rule - Copeland (default) or NetFlows may be given with the LearnedQuantilesRatingDigraph constructor&#39;</span><span class="p">)</span>
            <span class="n">pageTitle</span> <span class="o">=</span> <span class="s1">&#39;Heatmap of Performance Tableau </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="c1">#quantiles = len(self.quantilesFrequencies)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_htmlRatingHeatmap</span><span class="p">(</span><span class="n">argCriteriaList</span><span class="o">=</span><span class="n">criteriaList</span><span class="p">,</span>
                                             <span class="n">argActionsList</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                                         <span class="n">WithActionNames</span><span class="o">=</span><span class="n">WithActionNames</span><span class="p">,</span>
                                             <span class="c1">#quantiles=quantiles,</span>
                                             <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span>
                                             <span class="n">colorLevels</span><span class="o">=</span><span class="n">colorLevels</span><span class="p">,</span>
                                             <span class="n">pageTitle</span><span class="o">=</span><span class="n">pageTitle</span><span class="p">,</span>
                                             <span class="n">rankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span>
                                             <span class="n">Correlations</span><span class="o">=</span><span class="n">Correlations</span><span class="p">,</span>
                                             <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span>
                                             <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                             <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showHTMLQuantilesSorting">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showHTMLQuantilesSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLQuantilesSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                 <span class="n">htmlFileName</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the html version of the quantile sorting result in a browser window.</span>

<span class="sd">        The ordring strategy is either:</span>
<span class="sd">            * **optimistic**, following the upper quantile limits (default),</span>
<span class="sd">            * **pessimistic**, following the lower quantile limits,</span>
<span class="sd">            * **average**, following the averag of the upper and lower quantile limits.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="k">if</span> <span class="n">htmlFileName</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span>
                                           <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">htmlFileName</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileOrdering</span><span class="p">(</span><span class="n">Descending</span><span class="o">=</span><span class="n">Descending</span><span class="p">,</span>
                                              <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
                                              <span class="n">HTML</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                              <span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span><span class="o">+</span><span class="n">fileName</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showOrderedRelationTable">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showOrderedRelationTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showOrderedRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">relation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;decreasing&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Showing the relation table in decreasing (default) or increasing order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionsRanking</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">actionsList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNetFlowsRanking</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">direction</span> <span class="o">!=</span> <span class="s2">&quot;decreasing&quot;</span><span class="p">:</span>
            <span class="n">actionsList</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">relation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span>

        <span class="n">Digraph</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">actionsSubset</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                                <span class="n">relation</span><span class="o">=</span><span class="n">relation</span><span class="p">,</span>
                                <span class="n">Sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">ReflexiveTerms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

        
    <span class="k">def</span> <span class="nf">showQuantilesRating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Descending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratingCategories</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">ratingCategories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantilesRating</span><span class="p">(</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Quantiles rating result ---------&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LowerClosed</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Descending</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">ratingCategories</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">ratingCategories</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">cat</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="n">ratingCategories</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>

<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showQuantilesSorting">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showQuantilesSorting">[docs]</a>
    <span class="k">def</span> <span class="nf">showQuantilesSorting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dummy show method for the commenting computeQuantileOrdering() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----- Quantiles sorting result ----&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">computeQuantileOrdering</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

            
<div class="viewcode-block" id="LearnedQuantilesRatingDigraph.showRankingScores">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.LearnedQuantilesRatingDigraph.showRankingScores">[docs]</a>
    <span class="k">def</span> <span class="nf">showRankingScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the ranking scores of the Copeland or the netflows ranking rule,</span>
<span class="sd">        the number of incoming arcs minus the number of outgoing arcs, resp.</span>
<span class="sd">        the sum of inflows minus the outflows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> Ranking Scores in </span><span class="si">%s</span><span class="s1"> Order&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rankingRule</span><span class="p">,</span><span class="n">direction</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;action </span><span class="se">\t</span><span class="s1"> score&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;descending&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rankingScores</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outFlows</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span></div>
</div>

                                         
<span class="c1">##    def getActionsKeys(self,action=None,WithoutProfiles=True):</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        extract normal actions keys()</span>
<span class="c1">##        &quot;&quot;&quot;</span>
<span class="c1">##        profiles = set([x for x in list(self.profiles.keys())])</span>
<span class="c1">##        if action is None:</span>
<span class="c1">##            actionsExt = set([x for x in list(self.newActions.keys())])</span>
<span class="c1">##            if WithoutProfiles:</span>
<span class="c1">##                return actionsExt - profiles</span>
<span class="c1">##            else:</span>
<span class="c1">##                return actionsExt | profiles</span>
<span class="c1">##        else:</span>
<span class="c1">##            return set([action])           </span>

<div class="viewcode-block" id="NormedQuantilesRatingDigraph">
<a class="viewcode-back" href="../techDoc.html#sortingDigraphs.NormedQuantilesRatingDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">NormedQuantilesRatingDigraph</span><span class="p">(</span><span class="n">LearnedQuantilesRatingDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obsolete name for backward compatibility</span>
<span class="sd">    &quot;&quot;&quot;</span></div>

<span class="c1">#</span>
<span class="c1">##########################################################3</span>
<span class="c1">#----------test SortingDigraph class ----------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
    <span class="kn">from</span> <span class="nn">perfTabs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">randomPerfTabs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">outrankingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">sortingDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">transitiveDigraphs</span> <span class="kn">import</span> <span class="o">*</span>
    <span class="kn">from</span> <span class="nn">performanceQuantiles</span> <span class="kn">import</span> <span class="o">*</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    * Digraph3 sortingDigraphs module                  *</span>
<span class="s2">    * depends on BipolarOutrankingDigraph and          *</span>
<span class="s2">    * $Revision$                                       *</span>
<span class="s2">    * Copyright (C) 2010-2025 Raymond Bisdorff         *</span>
<span class="s2">    * The module comes with ABSOLUTELY NO WARRANTY     *</span>
<span class="s2">    * to the extent permitted by the applicable law.   *</span>
<span class="s2">    * This is free software, and you are welcome to    *</span>
<span class="s2">    * redistribute it if it remains free software.     *</span>
<span class="s2">    ****************************************************</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Testing class and methods -------&#39;</span><span class="p">)</span>


    <span class="n">MP</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="mi">1001</span>
    <span class="n">nbrOfCPUs</span> <span class="o">=</span> <span class="mi">12</span>


    <span class="c1"># from randomPerfTabs import RandomPerformanceTableau</span>
    <span class="c1"># from randomPerfTabs import RandomPerformanceGenerator as PerfTabGenerator</span>
    <span class="n">nbrActions</span><span class="o">=</span><span class="mi">1000</span>
    <span class="n">nbrCrit</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">tp1</span> <span class="o">=</span> <span class="n">RandomCBPerformanceTableau</span><span class="p">(</span><span class="n">numberOfActions</span><span class="o">=</span><span class="n">nbrActions</span><span class="p">,</span>
                 <span class="n">numberOfCriteria</span><span class="o">=</span><span class="n">nbrCrit</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">NA</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">missingDataProbability</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">qs</span> <span class="o">=</span> <span class="n">QuantilesSortingDigraph</span><span class="p">(</span><span class="n">tp1</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">startMethod</span><span class="o">=</span><span class="s1">&#39;fork&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span>
    <span class="c1"># print(tp1.NA)</span>
    <span class="c1"># pq1 = PerformanceQuantiles(tp1,5,LowerClosed=False,Debug=False)</span>
    <span class="c1"># tpg1 = PerfTabGenerator(tp1,instanceCounter=0,seed=seed)</span>
    <span class="c1"># newActions = tpg1.randomActions(20)</span>
    <span class="c1"># pq1.updateQuantiles(newActions,historySize=None)</span>
    <span class="c1"># nqr = LearnedQuantilesRatingDigraph(pq1,newActions,</span>
    <span class="c1">#                             rankingRule=&#39;Copeland&#39;,</span>
    <span class="c1">#                                     WithSorting=True,Debug=False,Comments=True,</span>
    <span class="c1">#                             Threading=MP,nbrOfCPUs=nbrOfCPUs)</span>
    <span class="c1"># print(nqr)</span>
<span class="c1">##    qs = QuantilesSortingDigraph(tp1,5)</span>
<span class="c1">##    print(qs)</span>
<span class="c1">##    qs.showWeakOrder()</span>
<span class="c1">##    cqs = ConfidentQuantilesSortingDigraph(tp1,limitingQuantiles=5)</span>
<span class="c1">##    print(cqs)</span>
<span class="c1">##    cqs.showWeakOrder()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>

<span class="c1">#############################</span>
<span class="c1"># Log record for changes:</span>
<span class="c1"># $Log: sortingDigraphs.py,v $</span>
<span class="c1">#############################</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2025, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Aug 23, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>