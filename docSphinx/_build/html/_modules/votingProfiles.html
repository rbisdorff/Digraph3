

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>votingProfiles &mdash; Digraph3 3.14.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=e4f4b189"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=15d7cbb8"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Digraph3
              <img src="../_static/htmlLogo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">1. Digraph3 Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techDoc.html">2. Technical Reference of the Digraph3 modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pearls.html">3. Pearls of bipolar-valued epistemic logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adtLectures.html">4. Algorithmic Decision Theory Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compStatLectures.html">5. Computational Statistics Lectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph3Archives.html">6. Digraph3 Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../errataList.html">7. Digraph3 Book Errata List</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Digraph3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">votingProfiles</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for votingProfiles</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Python 3 implementation of voting digraphs</span>
<span class="sd">Refactored from revision 1.549 of the digraphs module</span>
<span class="sd">Copyright (C) 2011-2025 Raymond Bisdorff</span>

<span class="sd">    This program is free software; you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation; either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License along</span>
<span class="sd">    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="sd">    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#######################</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: Python 3.13.13&quot;</span>

<span class="kn">from</span> <span class="nn">digraphsTools</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">digraphs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#--------- Decimal precision --------------</span>
<span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

<span class="c1">#---------- voting profiles</span>

<div class="viewcode-block" id="VotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">VotingProfile</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A generic class for storing voting profiles.</span>

<span class="sd">    General structure::</span>

<span class="sd">	candidates = OrderedDict([(&#39;a&#39;, ...),(&#39;b&#39;, ...),(&#39;c&#39;, ...), ( ... ) ])</span>
<span class="sd">	voters = OrderedDict([</span>
<span class="sd">        (&#39;1&#39;, {&#39;weight&#39;:1.0}),</span>
<span class="sd">        (&#39;2&#39;, {&#39;weight&#39;:1.0}),</span>
<span class="sd">        ...,</span>
<span class="sd">        ])</span>
<span class="sd">    	ballot = {     # voters x candidates x candidates</span>
<span class="sd">            &#39;1&#39;: {     # bipolar characteristic {-1,0,1} of each voter&#39;s</span>
<span class="sd">                  &#39;a&#39;: { &#39;a&#39;:0,&#39;b&#39;:-1,&#39;c&#39;:0, ...},   # pairwise preferences</span>
<span class="sd">                  &#39;b&#39;: { &#39;a&#39;:1,&#39;b&#39;:0, &#39;c&#39;:1, ...},</span>
<span class="sd">    	          &#39;c&#39;: { &#39;a&#39;:0,&#39;b&#39;:-1,&#39;c&#39;:0, ...},</span>
<span class="sd">    	          ...,</span>
<span class="sd">    	    },</span>
<span class="sd">    	    &#39;2&#39;: { &#39;a&#39;: { &#39;a&#39;:0, &#39;b&#39;:0, &#39;c&#39;:1, ...},</span>
<span class="sd">                   &#39;b&#39;: { &#39;a&#39;:0, &#39;b&#39;:0, &#39;c&#39;:1, ...},</span>
<span class="sd">    	           &#39;c&#39;: { &#39;a&#39;:-1,&#39;b&#39;:-1,&#39;c&#39;:0, ...},</span>
<span class="sd">    	           ...,</span>
<span class="sd">            },</span>
<span class="sd">    	    ...,</span>
<span class="sd">    	}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default description for VotingProfile instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reprString</span> <span class="o">=</span> <span class="s1">&#39;*------- VotingProfile instance description ------*</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance class   : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Instance name    : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;# Candidates     : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;# Voters         : </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">)</span>
        <span class="n">reprString</span> <span class="o">+=</span> <span class="s1">&#39;Attributes       : </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
       
        <span class="k">return</span> <span class="n">reprString</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;ballot&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a stored voting profile is required!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
<div class="viewcode-block" id="VotingProfile.showAll">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.showAll">[docs]</a>
    <span class="k">def</span> <span class="nf">showAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">WithBallots</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show method for &lt;VotingProfile&gt; instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------ VotingProfile instance: </span><span class="si">%s</span><span class="s1"> ------*&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">]</span>
        <span class="n">voters</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Voters     : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">))</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">candidates</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Candidates : </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">WithBallots</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ballots&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;voting of voter </span><span class="si">%s</span><span class="s1"> (weight = </span><span class="si">%.1f</span><span class="s1">)&#39;</span> \
                      <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">showVoterBallot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="VotingProfile.showVoterBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.showVoterBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">showVoterBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">voter</span><span class="p">,</span> <span class="n">hasIntegerValuation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the actual voting of a voter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  &gt;  |&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39;, &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">-----|------------------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="s2">&quot;&#39; | &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hasIntegerValuation</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ballot</span><span class="p">[</span><span class="n">voter</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ballot</span><span class="p">[</span><span class="n">voter</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="VotingProfile.save">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempVotingProfile&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of an approval voting profile.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving voting profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ballot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:{&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="VotingProfile.computePrerankedBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.VotingProfile.computePrerankedBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">computePrerankedBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">preranking</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the bipolar-valued ballot obtained from</span>
<span class="sd">        given preorderings of the candidates per voter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
            
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">currentCandidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">prerankedBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>

        <span class="k">for</span> <span class="n">eqcl</span> <span class="ow">in</span> <span class="n">preranking</span><span class="p">:</span>
            <span class="n">currRest</span> <span class="o">=</span> <span class="n">currentCandidates</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">eqcl</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">currentCandidates</span><span class="p">,</span> <span class="n">eqcl</span><span class="p">,</span> <span class="n">currRest</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                        <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eqcl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">currRest</span><span class="p">:</span>
                    <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
            <span class="n">currentCandidates</span> <span class="o">=</span> <span class="n">currentCandidates</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">eqcl</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prerankedBallot</span></div>
</div>


<div class="viewcode-block" id="RandomVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">RandomVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A subclass for generating random voting profiles.</span>
<span class="sd">    </span>
<span class="sd">    When *IntraGroup* is set to *True*, the candidates are the voters themselves</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                 <span class="n">votersIdPrefix</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                 <span class="n">IntraGroup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">candidatesIdPrefix</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                 <span class="n">hasRandomWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">maxWeight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Random profile creation parameters:</span>

<span class="sd">            | numberOfVoters=9,</span>
<span class="sd">            | numberOfCandidates=5</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfVoters</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">voterID</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">votersIdPrefix</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hasRandomWeights</span><span class="p">:</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">maxWeight</span><span class="p">)}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">IntraGroup</span><span class="p">:</span>
            <span class="n">candidates</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfCandidates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="n">candidates</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfCandidates</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
                <span class="n">candidateID</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">candidatesIdPrefix</span><span class="p">,</span><span class="n">na</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="n">candidates</span><span class="p">[</span><span class="n">candidateID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">candidateID</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span> <span class="o">=</span> <span class="n">IntraGroup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;randonVotingProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomBallot</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showAll</span><span class="p">()</span>

<div class="viewcode-block" id="RandomVotingProfile.generateRandomBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomVotingProfile.generateRandomBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">generateRandomBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated approval ballot</span>
<span class="sd">        from a list of candidates for each voter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">]</span>
        <span class="c1">#candidatesList = [x for x in self.candidates]</span>
        <span class="c1">#nc = len(candidatesList)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span><span class="p">:</span>
                <span class="n">candidatesList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nc</span><span class="p">):</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">j</span><span class="p">]][</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ballot</span></div>
</div>



<span class="c1">#---------</span>

<div class="viewcode-block" id="PrerankedVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.PrerankedVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">PrerankedVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialised class for preranked voting profiles</span>

<span class="sd">    Structure::</span>

<span class="sd">        candidates = OrderedDict([(&#39;a&#39;, ...) ,(&#39;b&#39;, ...),(&#39;c&#39;, ...), ...])</span>
<span class="sd">        voters = OrderedDict([(&#39;1&#39;,{&#39;weight&#39;:1.0}), (&#39;2&#39;,{&#39;weight&#39;:1.0}), ...])</span>
<span class="sd">        ## each specifies a a ranked list of lists of candidates</span>
<span class="sd">        ## from the best to the worst</span>
<span class="sd">        preorderBallot = {</span>
<span class="sd">            &#39;1&#39; : [[&#39;b&#39;,&#39;c&#39;],[&#39;a&#39;], ...],</span>
<span class="sd">            &#39;2&#39; : [[&#39;a&#39;],[&#39;b&#39;,&#39;c&#39;], ...],</span>
<span class="sd">            ...</span>
<span class="sd">            }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span><span class="o">+</span><span class="s1">&#39;.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prerankedBallot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;prerankedBallot&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a stored preranked voting profile is required!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>


        
<div class="viewcode-block" id="PrerankedVotingProfile.save">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.PrerankedVotingProfile.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempPreRankedProfile&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of a  preranked voting profile.</span>

<span class="sd">        Parameter:</span>
<span class="sd">            name of file (without &lt;.py&gt; extension!).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving preorder profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">prerankedBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerankedBallot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved preranked voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;: {\&#39;name\&#39;: \&#39;&#39; + str(x)+ &#39;\&#39;},\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;prerankedBallot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">prerankedBallot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: [</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;],</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PrerankedVotingProfile.showPrerankedBallots">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.PrerankedVotingProfile.showPrerankedBallots">[docs]</a>
    <span class="k">def</span> <span class="nf">showPrerankedBallots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerWeights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show the preranked ballots</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">##        sumWeights = Decimal(&#39;0&#39;)</span>
        <span class="k">if</span> <span class="n">IntegerWeights</span><span class="p">:</span>
            <span class="n">formStr</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">(</span><span class="si">%.0f</span><span class="s1">):</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formStr</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">(%.f):</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; voters </span><span class="se">\t</span><span class="s1">      marginal     &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(weight)</span><span class="se">\t</span><span class="s1"> candidates rankings&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
<span class="c1">##            sumWeights += self.voters[v][&#39;weight&#39;]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">formStr</span> \
                  <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prerankedBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# voters: &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span><span class="p">))</span></div>


<div class="viewcode-block" id="PrerankedVotingProfile.computeBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.PrerankedVotingProfile.computeBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute ballots from the prerankeds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">preranked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerankedBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computePrerankedBallot</span><span class="p">(</span><span class="n">preranked</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">preranked</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ballot</span></div>
</div>


<span class="c1">#-----------</span>

<div class="viewcode-block" id="RandomPrerankedVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomPrerankedVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">RandomPrerankedVotingProfile</span><span class="p">(</span><span class="n">PrerankedVotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialized class for generating random preranked voting profiles.</span>

<span class="sd">    *Parameters*   </span>
<span class="sd">        * The *votersWeights* parameter may be a list of positive integers in order to</span>
<span class="sd">          deterministically attribute weights to the voters</span>
<span class="sd">          Is ignored when *RandomWeights* is True</span>
<span class="sd">        * When *voterWeights* are None and *RandomWeights* is False, each voter</span>
<span class="sd">          obtains a single vote (default setting)</span>
<span class="sd">        * the *lengthProbability* influences the expected cardinalities of the equivalence classes</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">votersIdPrefix</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                 <span class="n">candidatesIdPrefix</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                 <span class="n">votersWeights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">RandomWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">lengthProbability</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfVoters</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">voterID</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">votersIdPrefix</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">votersWeights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">votersWeights</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">RandomWeights</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">weight</span><span class="p">)}</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfCandidates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfCandidates</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">candidateID</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">candidatesIdPrefix</span><span class="p">,</span><span class="n">na</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">candidates</span><span class="p">[</span><span class="n">candidateID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Candidate &#39;</span><span class="o">+</span> <span class="n">candidateID</span><span class="p">}</span>
        <span class="c1"># store instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;randprerankedProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RandomWeights</span> <span class="o">=</span> <span class="n">RandomWeights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lengthProbability</span> <span class="o">=</span> <span class="n">lengthProbability</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prerankedBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomPrerankedBallot</span><span class="p">(</span>
                                                        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>


<div class="viewcode-block" id="RandomPrerankedVotingProfile.generateRandomPrerankedBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomPrerankedVotingProfile.generateRandomPrerankedBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">generateRandomPrerankedBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated preranked ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">prerankedBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">randomNumbers</span> <span class="kn">import</span>\
                     <span class="n">BinomialRandomVariable</span>
            <span class="n">currIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">prerankedBallotv</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">BinomialRandomVariable</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lengthProbability</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">currIndex</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">endIndex</span> <span class="o">=</span> <span class="n">currIndex</span> <span class="o">+</span> <span class="n">length</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">currIndex</span><span class="p">,</span><span class="n">endIndex</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">endIndex</span> <span class="o">&gt;</span> <span class="n">currIndex</span><span class="p">:</span>
                    <span class="k">if</span>  <span class="n">endIndex</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                        <span class="n">prerankedBallotv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">currIndex</span><span class="p">:</span><span class="n">endIndex</span><span class="p">])</span>
                        <span class="n">currIndex</span> <span class="o">=</span> <span class="n">endIndex</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prerankedBallotv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">[</span><span class="n">currIndex</span><span class="p">:</span><span class="n">n</span><span class="p">])</span>
                        <span class="n">currIndex</span> <span class="o">=</span> <span class="n">n</span>
                <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">prerankedBallotv</span><span class="p">)</span>
            <span class="n">prerankedBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">prerankedBallotv</span> 
        <span class="k">return</span> <span class="n">prerankedBallot</span></div>
</div>


<span class="c1">#-------------</span>
<div class="viewcode-block" id="LinearVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">LinearVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialised class for linear voting profiles</span>

<span class="sd">    Structure::</span>

<span class="sd">        candidates = OrderedDict([(&#39;a&#39;, ...) ,(&#39;b&#39;, ...),(&#39;c&#39;, ...), ...])</span>
<span class="sd">        voters = OrderedDict([(&#39;1&#39;,{&#39;weight&#39;:1.0}), (&#39;2&#39;,{&#39;weight&#39;:1.0}), ...])</span>
<span class="sd">        ## each specifies a a ranked list of candidates</span>
<span class="sd">        ## from the best to the worst</span>
<span class="sd">        linearBallot = {</span>
<span class="sd">            &#39;1&#39; : [&#39;b&#39;,&#39;c&#39;,&#39;a&#39;, ...],</span>
<span class="sd">            &#39;2&#39; : [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;, ...],</span>
<span class="sd">            ...</span>
<span class="sd">            }</span>

<span class="sd">    Sample Python3 session</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from votingProfiles import *</span>
<span class="sd">    &gt;&gt;&gt; v = RandomLinearVotingProfile(numberOfVoters=5,numberOfCandidates=3)</span>
<span class="sd">    &gt;&gt;&gt; v.showLinearBallots()</span>
<span class="sd">     voters 	      marginal     </span>
<span class="sd">    (weight)	 candidates rankings</span>
<span class="sd">     v1(1):	 [&#39;c1&#39;, &#39;c3&#39;, &#39;c2&#39;]</span>
<span class="sd">     v2(1):	 [&#39;c2&#39;, &#39;c1&#39;, &#39;c3&#39;]</span>
<span class="sd">     v3(1):	 [&#39;c1&#39;, &#39;c3&#39;, &#39;c2&#39;]</span>
<span class="sd">     v4(1):	 [&#39;c2&#39;, &#39;c1&#39;, &#39;c3&#39;]</span>
<span class="sd">     v5(1):	 [&#39;c3&#39;, &#39;c1&#39;, &#39;c2&#39;]</span>
<span class="sd">    # voters:  5</span>
<span class="sd">    &gt;&gt;&gt; v.computeRankAnalysis()</span>
<span class="sd">    {&#39;c1&#39;: [Decimal(&#39;2&#39;), Decimal(&#39;3&#39;), 0],</span>
<span class="sd">     &#39;c2&#39;: [Decimal(&#39;2&#39;), 0, Decimal(&#39;3&#39;)],</span>
<span class="sd">     &#39;c3&#39;: [Decimal(&#39;1&#39;), Decimal(&#39;2&#39;), Decimal(&#39;2&#39;)]}</span>
<span class="sd">    &gt;&gt;&gt; v.showRankAnalysisTable()</span>
<span class="sd">    *----  Borda rank analysis tableau -----*</span>
<span class="sd">     candi- | alternative-to-rank |      Borda</span>
<span class="sd">     dates  |  1    2    3        | score  average</span>
<span class="sd">     -------|-------------------------------------</span>
<span class="sd">       &#39;c1&#39; |  2    3    0        |  8     1.60</span>
<span class="sd">       &#39;c2&#39; |  2    0    3        |  11     2.20</span>
<span class="sd">       &#39;c3&#39; |  1    2    2        |  11     2.20</span>
<span class="sd">    &gt;&gt;&gt; v.computeUninominalVotes()</span>
<span class="sd">    {&#39;c1&#39;: Decimal(&#39;2&#39;), &#39;c2&#39;: Decimal(&#39;2&#39;), &#39;c3&#39;: Decimal(&#39;1&#39;)}</span>
<span class="sd">    &gt;&gt;&gt; v.computeSimpleMajorityWinner()</span>
<span class="sd">    [&#39;c1&#39;, &#39;c2&#39;]</span>
<span class="sd">    &gt;&gt;&gt; v.computeBordaScores()</span>
<span class="sd">    OrderedDict([</span>
<span class="sd">    (&#39;c1&#39;, {&#39;BordaScore&#39;: Decimal(&#39;8&#39;), &#39;averageBordaScore&#39;: Decimal(&#39;1.6&#39;)}),</span>
<span class="sd">    (&#39;c2&#39;, {&#39;BordaScore&#39;: Decimal(&#39;11&#39;), &#39;averageBordaScore&#39;: Decimal(&#39;2.2&#39;)}),</span>
<span class="sd">    (&#39;c3&#39;, {&#39;BordaScore&#39;: Decimal(&#39;11&#39;), &#39;averageBordaScore&#39;: Decimal(&#39;2.2&#39;)})])</span>
<span class="sd">    &gt;&gt;&gt; v.computeBordaWinners()</span>
<span class="sd">    [&#39;a1&#39;]</span>
<span class="sd">    &gt;&gt;&gt; v.computeInstantRunoffWinner()</span>
<span class="sd">    [&#39;c1&#39;]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
        <span class="c1">## else:</span>
        <span class="c1">##     fileName = &#39;testapprovalvotingprofile.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span><span class="n">argDict</span><span class="p">)</span>
            <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;seed&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">withPolls</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;WithPolls&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">WithPolls</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RandomWeights</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;RandomWeights&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;sumWeights&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;poll1&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;poll2&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;other&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">partyRepartition</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">(</span><span class="s1">&#39;partyRepartition&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;linearBallot&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Error: The name of a stored linear voting profile is required !!!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="LinearVotingProfile.computeBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a complete ballot from the linear Ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">linearBallot</span><span class="p">:</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span><span class="p">)</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-1.0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">ballot</span>
        <span class="k">return</span> <span class="n">ballot</span></div>


<div class="viewcode-block" id="LinearVotingProfile.save">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;templinearprofile&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of a linear voting profile.</span>

<span class="sd">        Parameter:</span>
<span class="sd">            name of file (without &lt;.py&gt; extension!).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving linear profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved linear voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;: {\&#39;name\&#39;: \&#39;&#39; + str(x)+ &#39;\&#39;},\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;linearBallot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">linearBallot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: [</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;],</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="LinearVotingProfile.showLinearBallots">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showLinearBallots">[docs]</a>
    <span class="k">def</span> <span class="nf">showLinearBallots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerWeights</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show the linear ballots</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="c1">##        sumWeights = Decimal(&#39;0&#39;)</span>
        <span class="k">if</span> <span class="n">IntegerWeights</span><span class="p">:</span>
            <span class="n">formStr</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">(</span><span class="si">%.0f</span><span class="s1">):</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formStr</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">(%.f):</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; voters </span><span class="se">\t</span><span class="s1">      marginal     &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(weight)</span><span class="se">\t</span><span class="s1"> candidates rankings&#39;</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
<span class="c1">##            sumWeights += self.voters[v][&#39;weight&#39;]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">formStr</span> \
                  <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">],</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# voters: &#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span><span class="p">))</span></div>


<div class="viewcode-block" id="LinearVotingProfile.computeRankAnalysis">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeRankAnalysis">[docs]</a>
    <span class="k">def</span> <span class="nf">computeRankAnalysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the number of ranks each candidate obtains</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">ranks</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="c1">#print(v,i)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="c1">#ranks[x][i] += 1</span>
                    <span class="n">ranks</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="c1">#print ranks</span>
        <span class="k">return</span> <span class="n">ranks</span></div>


<div class="viewcode-block" id="LinearVotingProfile.showRankAnalysisTable">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showRankAnalysisTable">[docs]</a>
    <span class="k">def</span> <span class="nf">showRankAnalysisTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print the rank analysis tableau.</span>
<span class="sd">        </span>
<span class="sd">        If Sorted (True by default), the candidates</span>
<span class="sd">        are ordered by increasing Borda Scores.</span>

<span class="sd">        In case of decimal voters weights, ndigits allows</span>
<span class="sd">        to format the decimal precision of the numerical output.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*----  Borda rank analysis tableau -----*&#39;</span><span class="p">)</span>
        <span class="n">bordaScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBordaScores</span><span class="p">()</span> 
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[(</span><span class="n">bordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Sorted</span><span class="p">:</span>
            <span class="n">candidatesList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">rankIndex</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">rankIndex</span><span class="p">)</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRankAnalysis</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">bordaScores</span><span class="p">)</span>
            
        <span class="c1">## print table</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; candi- | alternative-to-rank       |      Borda&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; dates  | &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rankIndex</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;| score  average&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------|-------------------------------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> |&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rankIndex</span><span class="p">:</span>
                <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f &#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">ranks</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]][(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
            <span class="n">formatString</span> <span class="o">=</span> <span class="s1">&#39; | </span><span class="si">%%</span><span class="s1"> .</span><span class="si">%d</span><span class="s1">f     </span><span class="si">%%</span><span class="s1">.2f&#39;</span> <span class="o">%</span> <span class="n">ndigits</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">formatString</span> <span class="o">%</span> <span class="p">(</span><span class="n">bordaScores</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">],</span>\
                                  <span class="n">bordaScores</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;averageBordaScore&#39;</span><span class="p">]))</span>      </div>



<div class="viewcode-block" id="LinearVotingProfile.computeBordaScores">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeBordaScores">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBordaScores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute Borda scores from the rank analysis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">ranks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeRankAnalysis</span><span class="p">()</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">BordaScore_x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">BordaScore_x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ranks</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">averageBordaScore_x</span> <span class="o">=</span> <span class="n">BordaScore_x</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">BordaScore_x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">averageBordaScore_x</span><span class="p">))</span>
        <span class="n">scores</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">BordaScores</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                            <span class="p">{</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                             <span class="s1">&#39;averageBordaScore&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]})</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">BordaScores</span></div>


<div class="viewcode-block" id="LinearVotingProfile.showBordaRanking">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showBordaRanking">[docs]</a>
    <span class="k">def</span> <span class="nf">showBordaRanking</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show Borda ranking in increasing order of the Borda score</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BordaScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBordaScores</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Borda ranking of the candidates&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">BordaScores</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;: &#39;</span><span class="p">,</span><span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">])</span></div>

                  
<div class="viewcode-block" id="LinearVotingProfile.computeBordaWinners">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeBordaWinners">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBordaWinners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the Borda winner from the Borda scores, ie the list of</span>
<span class="sd">        candidates with the minimal Borda score.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BordaScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBordaScores</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="n">BordaMinimum</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">BordaMinimum</span> <span class="o">&gt;</span> <span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">]:</span>
                <span class="n">BordaMinimum</span> <span class="o">=</span> <span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">]</span>
        <span class="n">winners</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">BordaScores</span> \
                   <span class="k">if</span> <span class="n">BordaScores</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;BordaScore&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">BordaMinimum</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">winners</span></div>


<div class="viewcode-block" id="LinearVotingProfile.computeInstantRunoffWinner">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeInstantRunoffWinner">[docs]</a>
    <span class="k">def</span> <span class="nf">computeInstantRunoffWinner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the instant runoff winner from a linear voting ballot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span><span class="p">,</span><span class="n">copy</span>
        <span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">]</span>
        <span class="n">totalWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">totalWeight</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="p">)</span>
        <span class="n">halfWeight</span> <span class="o">=</span> <span class="n">totalWeight</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;2.0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number of votes = &#39;</span><span class="p">,</span> <span class="n">totalWeight</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Half of the Votes = &#39;</span><span class="p">,</span> <span class="n">halfWeight</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">]</span>
        <span class="n">remainingCandidates</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">remainingLinearBallot</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">)</span>
        <span class="n">stage</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">remainingCandidates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">uninominalVotes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeUninominalVotes</span><span class="p">(</span>
                <span class="n">remainingCandidates</span><span class="p">,</span><span class="n">remainingLinearBallot</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ==&gt; stage = &#39;</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    remaining candidates&#39;</span><span class="p">,</span> <span class="n">remainingCandidates</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    uninominal votes&#39;</span><span class="p">,</span> <span class="n">uninominalVotes</span><span class="p">)</span>
            <span class="n">minVotes</span> <span class="o">=</span> <span class="n">totalWeight</span>
            <span class="n">maxVotes</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">uninominalVotes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">minVotes</span><span class="p">:</span>
                    <span class="n">minVotes</span> <span class="o">=</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxVotes</span><span class="p">:</span>
                    <span class="n">maxVotes</span> <span class="o">=</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    minimal number of votes = &#39;</span><span class="p">,</span> <span class="n">minVotes</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    maximal number of votes = &#39;</span><span class="p">,</span> <span class="n">maxVotes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">maxVotes</span> <span class="o">&lt;=</span> <span class="n">halfWeight</span><span class="p">:</span>
                <span class="n">currentCandidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">remainingCandidates</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">currentCandidates</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">minVotes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    candidate to remove = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                        <span class="n">remainingCandidates</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">remainingLinearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>
                <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    remaining candidates = &#39;</span><span class="p">,</span> <span class="n">remainingCandidates</span><span class="p">)</span>
                    <span class="c1">#print &#39;    remaining ballots    = &#39;, remainingLinearBallot</span>
                <span class="n">stage</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">remainingCandidates</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">maxVotes</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    candidate </span><span class="si">%s</span><span class="s1"> obtains an absolute majority&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
                        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">remainingCandidates</span></div>


<div class="viewcode-block" id="LinearVotingProfile.save2PerfTab">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.save2PerfTab">[docs]</a>
    <span class="k">def</span> <span class="nf">save2PerfTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;votingPerfTab&#39;</span><span class="p">,</span>
                     <span class="n">isDecimal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">NA</span><span class="o">=-</span><span class="mi">9999</span><span class="p">,</span>
                     <span class="n">valueDigits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NegativeWeights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of a linear voting profile in the format of a rank performance Tableau.</span>
<span class="sd">        For each voter *v*, the rank performance of candidate *x* corresponds to:</span>

<span class="sd">        number of candidates - linearProfile[v].index(x)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving as performance tableau in file: &lt;&#39;</span> \
                                       <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved performance Tableau: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># actions</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;actions = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
                         <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">it</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># writing objectives if WithPolls</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">WithPolls</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;objectives = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">n0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>          
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">party0</span><span class="se">\&#39;</span><span class="s1">,{</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">:</span><span class="se">\&#39;</span><span class="s1">other</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%.2f</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n0</span><span class="p">))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">criteria</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> }),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">p0</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">party1</span><span class="se">\&#39;</span><span class="s1">,{</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">:</span><span class="se">\&#39;</span><span class="s1">party 1</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%.2f</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n1</span><span class="p">))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">criteria</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> }),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">p1</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">party2</span><span class="se">\&#39;</span><span class="s1">,{</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">:</span><span class="se">\&#39;</span><span class="s1">party 2</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%.2f</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">criteria</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> }),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">p2</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;objectives = OrderedDict()</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  
        <span class="c1"># criteria</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">WithPolls</span><span class="p">:</span>
            <span class="n">NegativeWeights</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;criteria = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">it</span> <span class="o">==</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">NegativeWeights</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                 <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                 <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">scale</span><span class="se">\&#39;</span><span class="s2">:(Decimal(1),Decimal(</span><span class="si">%d</span><span class="s2">)),</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nc</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">preferenceDirection</span><span class="se">\&#39;</span><span class="s2">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s1">&#39;min&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># evaluation</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;evaluation = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Decimal</span><span class="p">:</span>
                    <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;:Decimal(&quot;&#39; + str(evaluation[g][x]) + &#39;&quot;),\n&#39;)</span>
                    <span class="n">evaluationString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%%</span><span class="s1">s</span><span class="se">\&#39;</span><span class="s1">:Decimal(&quot;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&quot;),</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                       <span class="o">%</span> <span class="p">(</span><span class="n">valueDigits</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">xval</span> <span class="o">=</span> <span class="n">NA</span>
                    <span class="k">if</span> <span class="n">NegativeWeights</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">xval</span><span class="p">))))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">:&#39;</span> \
                             <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">evaluation</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;NA = Decimal(&#39;</span><span class="si">%d</span><span class="s2">&#39;)</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">NA</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="LinearVotingProfile.showHTMLVotingHeatmap">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.showHTMLVotingHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLVotingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                              <span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Transposed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">SparseModel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">minimalComponentSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                              <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;Copeland&#39;</span><span class="p">,</span>
                              <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> 
                              <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">colorLevels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                              <span class="n">pageTitle</span><span class="o">=</span><span class="s1">&#39;Voting Heatmap&#39;</span><span class="p">,</span> 
                              <span class="n">Correlations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the linear voting profile as a rank performance heatmap.</span>
<span class="sd">        The linear voting profile is previously saved to a stored Performance Tableau.</span>
<span class="sd">        </span>
<span class="sd">        (see perfTabs.PerformanceTableau.showHTMLPerformanceHeatmap() )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">mkdtemp</span>
        <span class="n">tempDir</span> <span class="o">=</span> <span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">perfTabFileName</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/votingPerfTab&#39;</span> <span class="o">%</span> <span class="n">tempDir</span>
        <span class="k">if</span> <span class="n">SparseModel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save2PerfTab</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">,</span><span class="n">_NegativeWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save2PerfTab</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="n">criteriaList</span><span class="o">=</span><span class="n">criteriaList</span><span class="p">,</span>
                            <span class="n">actionsList</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                            <span class="n">fromIndex</span><span class="o">=</span><span class="n">fromIndex</span><span class="p">,</span><span class="n">toIndex</span><span class="o">=</span><span class="n">toIndex</span><span class="p">,</span>
                            <span class="n">Transposed</span><span class="o">=</span><span class="n">Transposed</span><span class="p">,</span>
                            <span class="n">SparseModel</span><span class="o">=</span><span class="n">SparseModel</span><span class="p">,</span>
                            <span class="n">minimalComponentSize</span><span class="o">=</span><span class="n">minimalComponentSize</span><span class="p">,</span>
                            <span class="n">rankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span>
                            <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span> 
                            <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span> <span class="n">colorLevels</span><span class="o">=</span><span class="n">colorLevels</span><span class="p">,</span>
                            <span class="n">pageTitle</span><span class="o">=</span><span class="n">pageTitle</span><span class="p">,</span> <span class="n">Correlations</span><span class="o">=</span><span class="n">Correlations</span><span class="p">,</span>
                            <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span> <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>


<div class="viewcode-block" id="LinearVotingProfile.computeUninominalVotes">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeUninominalVotes">[docs]</a>
    <span class="k">def</span> <span class="nf">computeUninominalVotes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">candidates</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">linearBallot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute uninominal votes for each candidate in candidates sublist</span>
<span class="sd">        and restricted linear ballots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">candidates</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="k">if</span> <span class="n">linearBallot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="n">uninominalVotes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
                    <span class="n">uninominalVotes</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">uninominalVotes</span></div>


<div class="viewcode-block" id="LinearVotingProfile.computeSimpleMajorityWinner">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.LinearVotingProfile.computeSimpleMajorityWinner">[docs]</a>
    <span class="k">def</span> <span class="nf">computeSimpleMajorityWinner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Comments</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        compute the winner in a uninominal Election from a linear ballot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeUninominalVotes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;uninominal votes &#39;</span><span class="p">,</span> <span class="n">uv</span><span class="p">)</span>
        <span class="n">maxVotes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uv</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxVotes</span><span class="p">:</span>
                <span class="n">maxVotes</span> <span class="o">=</span> <span class="n">uv</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;maxVotes &#39;</span><span class="p">,</span> <span class="n">maxVotes</span><span class="p">)</span>
        <span class="n">simpleMajorityWinner</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uv</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">maxVotes</span><span class="p">:</span>
                <span class="n">simpleMajorityWinner</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Comments</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;simple majority winner(s) &#39;</span><span class="p">,</span> <span class="n">simpleMajorityWinner</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">simpleMajorityWinner</span></div>
</div>


<div class="viewcode-block" id="RandomLinearVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">RandomLinearVotingProfile</span><span class="p">(</span><span class="n">LinearVotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialized class for generating random liwear voting profiles.</span>

<span class="sd">    *Parameters*   </span>
<span class="sd">        * When *WithPolls* is True, each party supporting voter&#39;s linear ballot is randomly oriented</span>
<span class="sd">          by one of two random exponential poll results. The corresponding polls are stored</span>
<span class="sd">          in self.poll1, respectively self.poll2.</span>
<span class="sd">        * The *partyRepartition* sets the theoretical distribution of the two polls over the</span>
<span class="sd">          set of voters. If set to 0.0 or 1.0, only self.poll2, resp. self.poll1, will orient</span>
<span class="sd">          the respective party supporters.</span>
<span class="sd">        * The *other* paraemter sets the theoretical proportion of non party supporters.</span>
<span class="sd">        * The *DivisivePolitics* flag provides, if True, two reversed polls for</span>
<span class="sd">          generating the random linear ballots. </span>
<span class="sd">        * The *votersWeights* parameter may be a list of positive integers in order to</span>
<span class="sd">          deterministically attribute weights to the voters.</span>
<span class="sd">          Is ignored when *RandomWeights* is True.</span>
<span class="sd">        * When *voterWeights* are None and *RandomWeights* is False, each voter</span>
<span class="sd">          obtains a single vote (default setting).</span>
<span class="sd">        * With *PartialLnearBallots* set to *True*, the linear voting ballots will be</span>
<span class="sd">          randomly shortened with the *lengthProbability* parameter.</span>
<span class="sd">          </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                 <span class="n">IntraGroup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">votersIdPrefix</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                 <span class="n">candidatesIdPrefix</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                 <span class="n">PartialLinearBallots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">lengthProbability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">WithPolls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">partyRepartition</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">other</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                 <span class="n">DivisivePolitics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">votersWeights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">RandomWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">votersList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfVoters</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">votersList</span><span class="p">:</span>
            <span class="n">voterID</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">votersIdPrefix</span><span class="p">,</span><span class="n">nd</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">votersWeights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">votersWeights</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">RandomWeights</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfVoters</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">voters</span><span class="p">[</span><span class="n">voterID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">weight</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">IntraGroup</span><span class="p">:</span>
            <span class="n">candidates</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">numberOfCandidates</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="n">candidates</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
            <span class="n">na</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">numberOfCandidates</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
                <span class="n">candidateID</span> <span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%%</span><span class="s1">0</span><span class="si">%d</span><span class="s1">d&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">candidatesIdPrefix</span><span class="p">,</span><span class="n">na</span><span class="p">))</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="n">candidates</span><span class="p">[</span><span class="n">candidateID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Candidate &#39;</span><span class="o">+</span> <span class="n">candidateID</span><span class="p">}</span>
        <span class="c1"># store instance attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;randLinearProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span> <span class="o">=</span> <span class="n">IntraGroup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">WithPolls</span> <span class="o">=</span> <span class="n">WithPolls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RandomWeights</span> <span class="o">=</span> <span class="n">RandomWeights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">WithPolls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> \
                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomLinearBallotWithPoll</span><span class="p">(</span>
                        <span class="n">partyRepartition</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">DivisivePolitics</span><span class="p">,</span>
                        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generateRandomLinearBallot</span><span class="p">(</span>
                        <span class="n">PartialLinearBallots</span><span class="o">=</span><span class="n">PartialLinearBallots</span><span class="p">,</span>
                        <span class="n">lengthProbability</span><span class="o">=</span><span class="n">lengthProbability</span><span class="p">,</span>
                        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>


<div class="viewcode-block" id="RandomLinearVotingProfile.generateRandomLinearBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile.generateRandomLinearBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">generateRandomLinearBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">PartialLinearBallots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">lengthProbability</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                   <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated linear ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">shuffle</span>
<span class="c1">##        random.seed(seed)</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span><span class="p">:</span>
                <span class="n">candidatesList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="n">shuffle</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">PartialLinearBallots</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">randomNumbers</span> <span class="kn">import</span>\
                     <span class="n">BinomialRandomVariable</span>
                <span class="n">length</span> <span class="o">=</span> <span class="n">BinomialRandomVariable</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">lengthProbability</span><span class="p">)</span>
                <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">candidatesList</span><span class="p">[:</span><span class="n">length</span><span class="o">.</span><span class="n">random</span><span class="p">()]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">candidatesList</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">linearBallot</span></div>


<div class="viewcode-block" id="RandomLinearVotingProfile.generateRandomLinearBallotWithPoll">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile.generateRandomLinearBallotWithPoll">[docs]</a>
    <span class="k">def</span> <span class="nf">generateRandomLinearBallotWithPoll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">partyRepartition</span><span class="p">,</span>
                                           <span class="n">other</span><span class="p">,</span><span class="n">DivisivePolitics</span><span class="p">,</span>
                                           <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a random linear ballot in accordance with the given polls:</span>
<span class="sd">        self.poll1 and self.poll2.</span>

<span class="sd">        Polls are distributed in the *bipartisan* proportion.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">randomNumbers</span> <span class="kn">import</span> <span class="n">DiscreteRandomVariable</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidatesList</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
          
        <span class="c1"># divisive or independent polls</span>
        <span class="n">poll1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sumPoll</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
            <span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">sumPoll</span> <span class="o">+=</span> <span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">poll1</span><span class="p">:</span>
            <span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sumPoll</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span> <span class="o">=</span> <span class="n">poll1</span>
        <span class="n">poll2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sumPoll</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">DivisivePolitics</span><span class="p">:</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">poll1</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">]</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span>
            <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">#for c in candidatesList:</span>
                <span class="c1">#c = candidatesList[i]</span>
                <span class="c1">#poll2[c] = random.expovariate(1)</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sumPoll</span> <span class="o">+=</span> <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidatesList</span><span class="p">:</span>
                <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sumPoll</span> <span class="o">+=</span> <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">poll2</span><span class="p">:</span>
            <span class="n">poll2</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="n">sumPoll</span>

        <span class="c1"># storing polls    </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span> <span class="o">=</span> <span class="n">poll1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span> <span class="o">=</span> <span class="n">poll2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="n">other</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partyRepartition</span> <span class="o">=</span> <span class="n">partyRepartition</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">poll1</span><span class="p">,</span><span class="n">poll2</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">partyRepartition</span><span class="p">)</span>

        <span class="c1"># generating random linear ballots</span>
        <span class="n">linearBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="c1"># each voter is attached to one of the polls</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">:</span> <span class="c1"># random voting</span>
                <span class="n">otherCandidatesList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">otherCandidatesList</span><span class="p">)</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">otherCandidatesList</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># poll driven random</span>
                
                <span class="k">if</span> <span class="n">partyRepartition</span> <span class="o">&lt;</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">():</span>
                    <span class="n">pollv</span> <span class="o">=</span> <span class="n">poll1</span>
                    <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pollv</span> <span class="o">=</span> <span class="n">poll2</span>
                    <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="c1"># generating a random linear ranking    </span>
                <span class="n">shuffledCandidatesList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">NotShuffled</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">currPoll</span> <span class="o">=</span> <span class="n">pollv</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">rdv</span> <span class="o">=</span> <span class="n">DiscreteRandomVariable</span><span class="p">(</span><span class="n">currPoll</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
                    <span class="k">while</span> <span class="n">NotShuffled</span><span class="p">:</span>
                        <span class="n">xc</span> <span class="o">=</span> <span class="n">rdv</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">xc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">shuffledCandidatesList</span><span class="p">:</span>
                            <span class="n">NotShuffled</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">shuffledCandidatesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
                    <span class="n">currPoll</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(i,shuffledCandidatesList)</span>
                            
                <span class="n">shc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">shuffledCandidatesList</span><span class="p">)</span>
                <span class="n">sc</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">candidatesList</span><span class="p">)</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="p">(</span><span class="n">sc</span><span class="o">-</span><span class="n">shc</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">shuffledCandidatesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
<span class="c1">##                if Debug:</span>
<span class="c1">##                    print(&#39;==&gt;&gt;&#39;, v,shuffledCandidatesList)           </span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">shuffledCandidatesList</span>
            
        <span class="k">return</span> <span class="n">linearBallot</span></div>


<div class="viewcode-block" id="RandomLinearVotingProfile.showRandomPolls">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomLinearVotingProfile.showRandomPolls">[docs]</a>
    <span class="k">def</span> <span class="nf">showRandomPolls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shows the random polls, the case given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">poll1</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">poll1</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">poll1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">poll1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
            <span class="n">nv</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voters</span><span class="p">)</span>
            <span class="n">supportersParty1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voters</span> <span class="k">if</span> <span class="n">voters</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">supportersParty2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voters</span> <span class="k">if</span> <span class="n">voters</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">otherSupporters</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">voters</span> <span class="k">if</span> <span class="n">voters</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">n0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">otherSupporters</span><span class="p">)</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">supportersParty1</span><span class="p">)</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">supportersParty2</span><span class="p">)</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">n0</span><span class="p">,</span><span class="n">p0</span><span class="p">)</span>
            <span class="n">poll1</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">poll2</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">poll2</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span><span class="p">]</span>
            <span class="n">poll2</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">poll</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span>\
                      <span class="n">p2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="n">poll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">poll</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="c1"># print polls</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Random repartition of voters&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Party-1 supporters : </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%05.2f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">p1</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Party-2 supporters : </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%05.2f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">p2</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Other voters       : </span><span class="si">%d</span><span class="s1"> (</span><span class="si">%05.2f%%</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n0</span><span class="p">,</span><span class="n">p0</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*---------------- random polls ---------------&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Party-1(</span><span class="si">%04.1f%%</span><span class="s1">) | Party-2(</span><span class="si">%04.1f%%</span><span class="s1">)|   expected  &#39;</span>\
                                             <span class="o">%</span> <span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">p2</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------------------------------&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%05.2f%%</span><span class="s2">  |  </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%05.2f%%</span><span class="s2">  |  </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%05.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span>\
                        <span class="p">(</span><span class="n">poll1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">poll1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">,</span>
                                      <span class="n">poll2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">poll2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">,</span>
                                               <span class="n">poll</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">poll</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No polls defined !&#39;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">BipolarApprovalVotingProfile</span><span class="p">(</span><span class="n">VotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialised class for approval-disapproval voting profiles.</span>

<span class="sd">    Structure::</span>

<span class="sd">        candidates = OrderedDict([(&#39;a&#39;, {&#39;name&#39;: ...}),</span>
<span class="sd">                                  (&#39;b&#39;, {&#39;name&#39;: ...}),</span>
<span class="sd">                                   ...,   ...          ])</span>
<span class="sd">        voters = OrderedDict([(&#39;v1&#39;,{&#39;weight&#39;:1.0}),(&#39;v2&#39;:{&#39;weight&#39;:1.0}), ...])</span>
<span class="sd">        ## each voter characterises the candidates </span>
<span class="sd">        ## he approves (+1), disapproves (-1) or ignores (0).</span>
<span class="sd">        approvalBallot = {</span>
<span class="sd">            &#39;v1&#39; : {&#39;a&#39;: Decima(&#39;1&#39;), &#39;b&#39;: Decimal(&#39;0&#39;), ...}, </span>
<span class="sd">            &#39;v2&#39; : {&#39;a&#39;: Decima(&#39;0&#39;), &#39;b&#39;: Decimal(&#39;-1&#39;), ...},</span>
<span class="sd">            ...</span>
<span class="sd">            }</span>
<span class="sd">        ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fileVotingProfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fileName</span> <span class="o">=</span> <span class="n">fileVotingProfile</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>
        <span class="c1">## else:</span>
        <span class="c1">##     fileName = &#39;testapprovalvotingprofile.py&#39;</span>
            <span class="n">argDict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="nb">compile</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">fileName</span><span class="p">,</span> <span class="s1">&#39;exec&#39;</span><span class="p">),</span> <span class="n">argDict</span><span class="p">)</span>
            <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileVotingProfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;candidates&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;voters&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;approvalBallot&#39;</span><span class="p">]</span>
            <span class="c1">#self.disapprovalBallot = argDict[&#39;disapprovalBallot&#39;]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">netApprovalScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNetApprovalScores</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span> <span class="o">=</span> <span class="n">argDict</span><span class="p">[</span><span class="s1">&#39;IntraGroup&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: a valid stored bipolar approval voting profile is required !&#39;</span><span class="p">)</span>
            <span class="k">return</span>
<div class="viewcode-block" id="BipolarApprovalVotingProfile.showBipolarApprovals">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.showBipolarApprovals">[docs]</a>
    <span class="k">def</span> <span class="nf">showBipolarApprovals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the approval and disapprovals per voter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bipolar approval ballots&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">app</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>\
                   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)]</span>
            <span class="n">disapp</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>\
                   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approvals   :&#39;</span><span class="p">,</span><span class="n">app</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Disapprovals:&#39;</span><span class="p">,</span><span class="n">disapp</span><span class="p">)</span></div>

            
        
<div class="viewcode-block" id="BipolarApprovalVotingProfile.showApprovalResults">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.showApprovalResults">[docs]</a>
    <span class="k">def</span> <span class="nf">showApprovalResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the number of approvals obtained by each candidate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approval results&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="c1">#candidates.sort()</span>
        <span class="n">votesPerCandidate</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">sumApp</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                    <span class="n">sumApp</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span><span class="n">c</span><span class="p">))</span>
        <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Candidate: </span><span class="si">%s</span><span class="s1"> obtains </span><span class="si">%d</span><span class="s1"> votes&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total approval votes: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sumApp</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">tot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">voters</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Approval proportion: </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1"> = </span><span class="si">%.2f</span><span class="s1">&#39;</span> \
              <span class="o">%</span> <span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">sumApp</span><span class="p">),</span><span class="n">tot</span><span class="p">,</span><span class="n">sumApp</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tot</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span></div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile.showDisapprovalResults">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.showDisapprovalResults">[docs]</a>
    <span class="k">def</span> <span class="nf">showDisapprovalResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the number of disapprovals obtained by each candidate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Disapproval results&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="c1">#candidates.sort()</span>
        <span class="n">votesPerCandidate</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">sumDisapp</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Med</span><span class="p">:</span>
                    <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
                    <span class="n">sumDisapp</span> <span class="o">+=</span> <span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span><span class="n">c</span><span class="p">))</span>
        <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Candidate: </span><span class="si">%s</span><span class="s1"> obtains </span><span class="si">%d</span><span class="s1"> votes&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total disapproval votes: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sumDisapp</span><span class="p">))</span> <span class="p">)</span>
        <span class="n">tot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">voters</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Disapproval proportion: </span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1"> = </span><span class="si">%.2f</span><span class="s1">&#39;</span> \
                  <span class="o">%</span> <span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">sumDisapp</span><span class="p">),</span><span class="n">tot</span><span class="p">,</span><span class="n">sumDisapp</span><span class="o">/</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tot</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span></div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile.showHTMLVotingHeatmap">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.showHTMLVotingHeatmap">[docs]</a>
    <span class="k">def</span> <span class="nf">showHTMLVotingHeatmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">criteriaList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                              <span class="n">actionsList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">fromIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">toIndex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Transposed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span>
                              <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> 
                              <span class="n">ndigits</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                              <span class="n">colorLevels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                              <span class="n">pageTitle</span><span class="o">=</span><span class="s1">&#39;Voting Heatmap&#39;</span><span class="p">,</span> 
                              <span class="n">Correlations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">Threading</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the linear voting profile as a rank performance heatmap.</span>
<span class="sd">        The linear voting profile is previously saved to a stored Performance Tableau.</span>
<span class="sd">        </span>
<span class="sd">        (see perfTabs.PerformanceTableau.showHTMLPerformanceHeatmap() )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">mkdtemp</span>
        <span class="n">tempDir</span> <span class="o">=</span> <span class="n">mkdtemp</span><span class="p">()</span>
        <span class="n">perfTabFileName</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/votingPerfTab&#39;</span> <span class="o">%</span> <span class="n">tempDir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save2PerfTab</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">PerformanceTableau</span><span class="p">(</span><span class="n">perfTabFileName</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">showHTMLPerformanceHeatmap</span><span class="p">(</span><span class="n">criteriaList</span><span class="o">=</span><span class="n">criteriaList</span><span class="p">,</span>
                            <span class="n">actionsList</span><span class="o">=</span><span class="n">actionsList</span><span class="p">,</span>
                            <span class="n">fromIndex</span><span class="o">=</span><span class="n">fromIndex</span><span class="p">,</span> <span class="n">toIndex</span><span class="o">=</span><span class="n">toIndex</span><span class="p">,</span>
                            <span class="n">Transposed</span><span class="o">=</span><span class="n">Transposed</span><span class="p">,</span>
                            <span class="n">rankingRule</span><span class="o">=</span><span class="n">rankingRule</span><span class="p">,</span>
                            <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
                            <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">,</span> <span class="n">colorLevels</span><span class="o">=</span><span class="n">colorLevels</span><span class="p">,</span>
                            <span class="n">pageTitle</span><span class="o">=</span><span class="n">pageTitle</span><span class="p">,</span> <span class="n">Correlations</span><span class="o">=</span><span class="n">Correlations</span><span class="p">,</span>
                            <span class="n">Threading</span><span class="o">=</span><span class="n">Threading</span><span class="p">,</span> <span class="n">nbrOfCPUs</span><span class="o">=</span><span class="n">nbrOfCPUs</span><span class="p">,</span>
                            <span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span></div>



<div class="viewcode-block" id="BipolarApprovalVotingProfile.computeNetApprovalScores">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.computeNetApprovalScores">[docs]</a>
    <span class="k">def</span> <span class="nf">computeNetApprovalScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the approvals - disapprovals score obtained by each candidate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="c1">#candidates.sort()</span>
        <span class="n">votesPerCandidate</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="n">approved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="c1">#disapproved = self.disapprovalBallot</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">approved</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="o">*</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">votesPerCandidate</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span><span class="n">c</span><span class="p">))</span>
        <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Net Approval Scores&#39;</span><span class="p">)</span>  
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;candidate: </span><span class="si">%s</span><span class="s1"> obtains </span><span class="si">%d</span><span class="s1"> net approvals&#39;</span> \
                                 <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">votesPerCandidate</span></div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile.showNetApprovalScores">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.showNetApprovalScores">[docs]</a>
    <span class="k">def</span> <span class="nf">showNetApprovalScores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the  approval - disapproval scores obtained by each candidate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">netApprovalScores</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span><span class="n">c</span><span class="p">))</span>
        <span class="n">results</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Net Approval Scores&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Candidate: </span><span class="si">%s</span><span class="s1"> obtains </span><span class="si">%d</span><span class="s1"> net approvals&#39;</span> \
                              <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span></div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile.computeBallot">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.computeBallot">[docs]</a>
    <span class="k">def</span> <span class="nf">computeBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a complete ballot from the approval Ballot.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="c1">#DAVBallot = self.disapprovalBallot</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">app</span><span class="p">:</span>
            <span class="n">av</span> <span class="o">=</span> <span class="n">app</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;0.0&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="c1">##                    if Debug:</span>
<span class="c1">##                        print(x,av[x],y,av[y])</span>
                    <span class="k">if</span> <span class="n">av</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">av</span><span class="p">[</span><span class="n">y</span><span class="p">]:</span>
                        <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                        <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                    <span class="k">elif</span> <span class="n">av</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">av</span><span class="p">[</span><span class="n">y</span><span class="p">]:</span>
                        <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span>
                        <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Max</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">ballot</span>
        <span class="k">return</span> <span class="n">ballot</span></div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile.save">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;tempAVprofile&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of a bipolar approval voting profile.</span>

<span class="sd">        Parameter:</span>
<span class="sd">            name of file (without &lt;.py&gt; extension!).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving AV profile in file: &lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">approvalBallot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="c1">#disapprovalBallot = self.disapprovalBallot</span>
        <span class="n">saveFileName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">saveFileName</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved approval voting profile: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;candidates = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">candidateName</span> <span class="o">=</span> <span class="n">x</span>
            <span class="c1">#fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;: {\&#39;name\&#39;: \&#39;&#39; + str(x)+ &#39;\&#39;},\n&#39;)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\&#39;</span><span class="s1">name</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">}),</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">candidateName</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;voters = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">weight</span><span class="se">\&#39;</span><span class="s1">:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;IntraGroup = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;IntraGroup = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;approvalProbability = </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                     <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalProbability</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;disapprovalProbability = </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                     <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">disapprovalProbability</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;approvalBallot = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">approvalBallot</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: Decimal(</span><span class="se">\&#39;</span><span class="s1">%.f</span><span class="se">\&#39;</span><span class="s1">),</span><span class="se">\n</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">x</span><span class="p">])</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">##        fo.write(&#39;disapprovalBallot = {\n&#39;)</span>
<span class="c1">##        for v in disapprovalBallot:</span>
<span class="c1">##            fo.write(&#39;\&#39;&#39; +str(v)+&#39;\&#39;: [\n&#39;)</span>
<span class="c1">##            for x in disapprovalBallot[v]:</span>
<span class="c1">##                fo.write(&#39;\&#39;&#39; + str(x) + &#39;\&#39;&#39; +&#39;,\n&#39;)</span>
<span class="c1">##            fo.write(&#39;],\n&#39;)</span>
<span class="c1">##        fo.write( &#39;}\n&#39;)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;netVotingScores = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: Decimal(</span><span class="se">\&#39;</span><span class="s1">%.f</span><span class="se">\&#39;</span><span class="s1">),</span><span class="se">\n</span><span class="s1">&#39;</span> \
                          <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">netApprovalScores</span><span class="p">[</span><span class="n">c</span><span class="p">]))</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="BipolarApprovalVotingProfile.save2PerfTab">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.BipolarApprovalVotingProfile.save2PerfTab">[docs]</a>
    <span class="k">def</span> <span class="nf">save2PerfTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;votingPerfTab&#39;</span><span class="p">,</span><span class="n">valueDigits</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Persistant storage of an approval voting profile in the format of a standard performance tableau.</span>
<span class="sd">        For each voter *v*, the performance of candidate *x* corresponds to:</span>

<span class="sd">              1, if approved;</span>
<span class="sd">              -1, if disapproved;</span>
<span class="sd">              NA, missing evaluation otherwise,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*--- Saving as performance tableau in file: &lt;&#39;</span> \
                                      <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.py&gt; ---*&#39;</span><span class="p">)</span>
        <span class="n">objectives</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fileNameExt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileNameExt</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# Saved performance Tableau: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from decimal import Decimal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from collections import OrderedDict</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># actions</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;actions = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> \
                         <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">it</span><span class="p">]))</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># no objectives</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;objectives = OrderedDict()</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>            
        <span class="c1"># criteria</span>
        <span class="n">minScale</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">maxScale</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">medScale</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">NA</span> <span class="o">=</span> <span class="mi">999</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;criteria = OrderedDict([</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;(</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">, {</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="n">it</span><span class="p">])))</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">scale</span><span class="se">\&#39;</span><span class="s2">:(Decimal(</span><span class="se">\&#39;</span><span class="si">%d</span><span class="se">\&#39;</span><span class="s2">),Decimal(</span><span class="se">\&#39;</span><span class="si">%d</span><span class="se">\&#39;</span><span class="s2">)),</span><span class="se">\n</span><span class="s2">&quot;</span> \
                         <span class="o">%</span> <span class="p">(</span><span class="n">minScale</span><span class="p">,</span><span class="n">maxScale</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}),</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># evaluation</span>
        <span class="n">AVballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span>
        <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="c1">#DAVBallot = self.disapprovalBallot</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;NA = Decimal(&quot;</span><span class="si">%d</span><span class="s1">&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">NA</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;evaluation = {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span><span class="p">:</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">: {</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">approved</span> <span class="o">=</span> <span class="n">AVballot</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span><span class="p">:</span>
                <span class="n">evaluationString</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%%</span><span class="s1">s</span><span class="se">\&#39;</span><span class="s1">:Decimal(&quot;</span><span class="si">%%</span><span class="s1">.</span><span class="si">%d</span><span class="s1">f&quot;),</span><span class="se">\n</span><span class="s1">&#39;</span> \
                                        <span class="o">%</span> <span class="p">(</span><span class="n">valueDigits</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">approved</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">Max</span><span class="p">:</span>
                    <span class="n">xval</span> <span class="o">=</span> <span class="n">maxScale</span>
                <span class="k">elif</span> <span class="n">approved</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">Min</span><span class="p">:</span>
                    <span class="n">xval</span> <span class="o">=</span> <span class="n">minScale</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># ignored</span>
                    <span class="n">xval</span> <span class="o">=</span> <span class="n">medScale</span>
                <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">evaluationString</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xval</span><span class="p">))))</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;},</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>


<span class="c1"># ------------------------</span>
<div class="viewcode-block" id="RandomBipolarApprovalVotingProfile">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.RandomBipolarApprovalVotingProfile">[docs]</a>
<span class="k">class</span> <span class="nc">RandomBipolarApprovalVotingProfile</span><span class="p">(</span><span class="n">BipolarApprovalVotingProfile</span><span class="p">,</span>
                                         <span class="n">RandomLinearVotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A specialized class for generating random approval-disapproval voting profiles</span>
<span class="sd">    with the help of random linear voting profiles.</span>

<span class="sd">    *approvalProbability* determines the number of first-ranked candidates approved</span>
<span class="sd">    *disapprovalProbability* determines the number of last-ranked candidates disapproved</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">votersIdPrefix</span><span class="o">=</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span>
                 <span class="n">IntraGroup</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                 <span class="n">candidatesIdPrefix</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                 <span class="n">approvalProbability</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                 <span class="n">disapprovalProbability</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                 <span class="n">WithPolls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">partyRepartition</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">other</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                 <span class="n">DivisivePolitics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">votersWeights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">RandomWeights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Random profile creation parameters:</span>
<span class="sd">            | numberOfVoters=9, numberOfCandidates=5,</span>
<span class="sd">            | minSizeOfBallot=1, maxSizeOfBallot=2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
        <span class="kn">from</span> <span class="nn">votingProfiles</span> <span class="kn">import</span> <span class="n">RandomLinearVotingProfile</span>
        <span class="n">rlv</span> <span class="o">=</span> <span class="n">RandomLinearVotingProfile</span><span class="p">(</span>
                 <span class="n">numberOfVoters</span><span class="o">=</span><span class="n">numberOfVoters</span><span class="p">,</span>
                 <span class="n">votersIdPrefix</span><span class="o">=</span><span class="n">votersIdPrefix</span><span class="p">,</span>
                 <span class="n">IntraGroup</span><span class="o">=</span><span class="n">IntraGroup</span><span class="p">,</span>
                 <span class="n">numberOfCandidates</span><span class="o">=</span><span class="n">numberOfCandidates</span><span class="p">,</span>
                 <span class="n">candidatesIdPrefix</span><span class="o">=</span><span class="n">candidatesIdPrefix</span><span class="p">,</span>
                 <span class="n">WithPolls</span><span class="o">=</span><span class="n">WithPolls</span><span class="p">,</span>
                 <span class="n">partyRepartition</span><span class="o">=</span><span class="n">partyRepartition</span><span class="p">,</span>
                 <span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">,</span>
                 <span class="n">DivisivePolitics</span><span class="o">=</span><span class="n">DivisivePolitics</span><span class="p">,</span>
                 <span class="n">votersWeights</span><span class="o">=</span><span class="n">votersWeights</span><span class="p">,</span>
                 <span class="n">RandomWeights</span><span class="o">=</span><span class="n">RandomWeights</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rlv</span><span class="p">)</span>
            <span class="n">rlv</span><span class="o">.</span><span class="n">showRandomPolls</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;bipolarApprovalProfile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IntraGroup</span><span class="o">=</span><span class="n">IntraGroup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">candidates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">voters</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sumWeights</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">sumWeights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">WithPolls</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">WithPolls</span>
        <span class="k">if</span> <span class="n">WithPolls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">poll1</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">poll1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">poll2</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">poll2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">other</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">partyRepartition</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">partyRepartition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linearBallot</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">linearBallot</span>
        <span class="k">if</span> <span class="n">approvalProbability</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">approvalProbability</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">approvalProbability</span> <span class="o">=</span> <span class="n">approvalProbability</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Invalid approval probability: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">approvalProbability</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">disapprovalProbability</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">disapprovalProbability</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disapprovalProbability</span> <span class="o">=</span> <span class="n">disapprovalProbability</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;!!! Invalid disapproval probability: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">disapprovalProbability</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">approvalBallot</span> <span class="o">=</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">_generateRandomApprovalBallot</span><span class="p">(</span><span class="n">rlv</span><span class="p">,</span>
                     <span class="n">approvalProbability</span><span class="o">=</span><span class="n">approvalProbability</span><span class="p">,</span>
                     <span class="n">disapprovalProbability</span><span class="o">=</span><span class="n">disapprovalProbability</span><span class="p">,</span>
                     <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">netApprovalScores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeNetApprovalScores</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeBallot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_generateRandomApprovalBallot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rlv</span><span class="p">,</span>
                                      <span class="n">approvalProbability</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                      <span class="n">disapprovalProbability</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span>
                                      <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders a randomly generated approval ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">randomNumbers</span> <span class="kn">import</span> <span class="n">BinomialRandomVariable</span>
        <span class="n">approvalBallot</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#disapprovalBallot = {}</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voters</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candidates</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
        <span class="n">approvalNbr</span> <span class="o">=</span> <span class="n">BinomialRandomVariable</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">approvalProbability</span><span class="p">)</span>
        <span class="n">disapprovalNbr</span> <span class="o">=</span> <span class="n">BinomialRandomVariable</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">disapprovalProbability</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">ac</span> <span class="o">=</span> <span class="n">approvalNbr</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="n">dc</span> <span class="o">=</span> <span class="n">disapprovalNbr</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="c1"># !!! -0 == 0 so that [-0:] does not select [] as expected</span>
            <span class="c1"># !!!  but instead [0:] i.e. the complete list of n elements</span>
            <span class="c1"># !!! just like [-n:] </span>
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">nc</span><span class="p">,</span><span class="n">ac</span><span class="p">,</span><span class="n">dc</span><span class="p">)</span>
            <span class="n">candidatesList</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">.</span><span class="n">linearBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="n">vApprovals</span> <span class="o">=</span> <span class="n">candidatesList</span><span class="p">[:</span><span class="n">ac</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">dc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vDisapprovals</span> <span class="o">=</span> <span class="n">candidatesList</span><span class="p">[</span><span class="o">-</span><span class="n">dc</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vDisapprovals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">vApprovals</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">vDisapprovals</span><span class="p">:</span>
                    <span class="n">vDisapprovals</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>                    
            <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">vApprovals</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">vDisapprovals</span><span class="p">)</span>
            <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">vApprovals</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vDisapprovals</span><span class="p">:</span> 
                    <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">vDisapprovals</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vApprovals</span><span class="p">:</span>
                    <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">approvalBallot</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">approvalBallot</span></div>


<span class="c1">#--------------------------------</span>
<div class="viewcode-block" id="MajorityMarginsDigraph">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.MajorityMarginsDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">MajorityMarginsDigraph</span><span class="p">(</span><span class="n">Digraph</span><span class="p">,</span><span class="n">VotingProfile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specialization of the general Digraph class for generating</span>
<span class="sd">    bipolar-valued marginal pairwise majority margins digraphs.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        | stored voting profile (fileName of valid py code) or voting profile object</span>
<span class="sd">        | optional, coalition (sublist of voters)</span>

<span class="sd">    Example Python3 session</span>

<span class="sd">    &gt;&gt;&gt; from votingProfiles import *</span>
<span class="sd">    &gt;&gt;&gt; v = RandomLinearVotingProfile(numberOfVoters=101,</span>
<span class="sd">    ...                               numberOfCandidates=5)</span>
<span class="sd">    &gt;&gt;&gt; v.showLinearBallots()</span>
<span class="sd">     voters 	      marginal     </span>
<span class="sd">    (weight)	 candidates rankings</span>
<span class="sd">     v001(1):	 [&#39;c5&#39;, &#39;c3&#39;, &#39;c1&#39;, &#39;c4&#39;, &#39;c2&#39;]</span>
<span class="sd">     v002(1):	 [&#39;c1&#39;, &#39;c3&#39;, &#39;c2&#39;, &#39;c5&#39;, &#39;c4&#39;]</span>
<span class="sd">     v003(1):	 [&#39;c5&#39;, &#39;c1&#39;, &#39;c2&#39;, &#39;c4&#39;, &#39;c3&#39;]</span>
<span class="sd">     v004(1):	 [&#39;c5&#39;, &#39;c1&#39;, &#39;c4&#39;, &#39;c2&#39;, &#39;c3&#39;]</span>
<span class="sd">     v005(1):	 [&#39;c4&#39;, &#39;c5&#39;, &#39;c3&#39;, &#39;c1&#39;, &#39;c2&#39;]</span>
<span class="sd">     v006(1):	 [&#39;c5&#39;, &#39;c1&#39;, &#39;c2&#39;, &#39;c4&#39;, &#39;c3&#39;]</span>
<span class="sd">    ...</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; g = MajorityMarginsDigraph(v,IntegerValuation=True)</span>
<span class="sd">    &gt;&gt;&gt; g.showRelationTable()</span>
<span class="sd">    * ---- Relation Table -----</span>
<span class="sd">      S   |  &#39;c1&#39;   &#39;c2&#39;  &#39;c3&#39;	&#39;c4&#39;   &#39;c5&#39;	  </span>
<span class="sd">    ------|--------------------------------</span>
<span class="sd">     &#39;c1&#39; |    0     -3	   -9	-11	 1	 </span>
<span class="sd">     &#39;c2&#39; |    3      0	   -7	  7	-3	 </span>
<span class="sd">     &#39;c3&#39; |    9      7	    0	 17	-9	 </span>
<span class="sd">     &#39;c4&#39; |   11     -7	  -17	  0	-1	 </span>
<span class="sd">     &#39;c5&#39; |   -1      3	    9	  1	 0	 </span>
<span class="sd">    Valuation domain: [-101;+101]</span>
<span class="sd">    &gt;&gt;&gt; g.computeCondorcetWinners()</span>
<span class="sd">    [&#39;]</span>
<span class="sd">    &gt;&gt;&gt; g.exportGraphViz()</span>
<span class="sd">    *---- exporting a dot file for GraphViz tools ---------*</span>
<span class="sd">    Exporting to rel_randLinearProfile.dot</span>
<span class="sd">    dot -Grankdir=BT -Tpng rel_randLinearProfile.dot -o rel_randLinearProfile.png</span>

<span class="sd">    .. image:: rel_randLinearProfile.png</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">argVotingProfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">coalition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">IntegerValuation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argVotingProfile</span><span class="p">,</span> <span class="p">(</span><span class="n">VotingProfile</span><span class="p">,</span>
                                         <span class="n">LinearVotingProfile</span><span class="p">,</span>
                                         <span class="n">BipolarApprovalVotingProfile</span><span class="p">)):</span>
            <span class="n">votingProfile</span> <span class="o">=</span> <span class="n">argVotingProfile</span>
        <span class="k">elif</span> <span class="n">argVotingProfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">votingProfile</span> <span class="o">=</span> <span class="n">VotingProfile</span><span class="p">(</span><span class="n">argVotingProfile</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: A valid voting profile has to be given!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rel_&#39;</span> <span class="o">+</span> <span class="n">votingProfile</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">candidates</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">coalition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">voters</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">voters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">voters</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">coalition</span><span class="p">:</span>
                <span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">votingProfile</span><span class="o">.</span><span class="n">voters</span><span class="p">[</span><span class="n">g</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="n">voters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">votingProfile</span><span class="o">.</span><span class="n">ballot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constructMajorityMarginsRelation</span><span class="p">(</span>
            <span class="n">IntegerValuation</span><span class="o">=</span><span class="n">IntegerValuation</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="n">Debug</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gammaSets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notGamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notGammaSets</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_constructMajorityMarginsRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">IntegerValuation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Renders the marginal majority between candidates</span>
<span class="sd">        on the basis of an approval ballot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>
        <span class="n">voters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
        <span class="n">sumWeight</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">sumWeight</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sumweight&#39;</span><span class="p">,</span><span class="n">sumWeight</span><span class="p">)</span>
        <span class="n">ballot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ballot</span>
        <span class="n">relation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Med</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">voters</span><span class="p">:</span>
            <span class="n">bv</span> <span class="o">=</span> <span class="n">ballot</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">bv</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]))</span>\
                                      <span class="o">*</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">voters</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">IntegerValuation</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="o">-</span><span class="n">sumWeight</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">sumWeight</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Min</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
            <span class="n">Max</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span>
            <span class="n">Med</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.0&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">Min</span><span class="p">,</span> <span class="s1">&#39;med&#39;</span><span class="p">:</span> <span class="n">Med</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="n">Max</span><span class="p">,</span>
                                <span class="s1">&#39;hasIntegerValuation&#39;</span><span class="p">:</span> <span class="n">IntegerValuation</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valuationdomain</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">IntegerValuation</span> <span class="ow">and</span> <span class="n">Max</span> <span class="o">!=</span> <span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">relation</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="o">/</span><span class="n">sumWeight</span>
        <span class="k">if</span> <span class="n">Debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">relation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">relation</span>

<div class="viewcode-block" id="MajorityMarginsDigraph.showMajorityMargins">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.MajorityMarginsDigraph.showMajorityMargins">[docs]</a>
    <span class="k">def</span> <span class="nf">showMajorityMargins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrapper for the</span>
<span class="sd">        Digraph.showRelationTable(Sorted=True, IntegerValues=False,</span>
<span class="sd">        actionsSubset=None, relation=None, ndigits=2,</span>
<span class="sd">        ReflexiveTerms=True, fromIndex=None, toIndex=None)</span>

<span class="sd">        See the :py:meth:`digraphs.Digraph.showRelationTable` description.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Digraph</span><span class="o">.</span><span class="n">showRelationTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">args</span><span class="p">)</span></div>
</div>

        
<div class="viewcode-block" id="CondorcetDigraph">
<a class="viewcode-back" href="../techDoc.html#votingProfiles.CondorcetDigraph">[docs]</a>
<span class="k">class</span> <span class="nc">CondorcetDigraph</span><span class="p">(</span><span class="n">MajorityMarginsDigraph</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dummy obsolete class name for MajorityMarginsDigraph class.</span>
<span class="sd">    &quot;&quot;&quot;</span>        </div>


<span class="c1">#----------test voting Digraph class ----------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1">#from transitiveDigraphs import *</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;****************************************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Python voting digraphs module                    *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* $Revision: Python3.13 $                          *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Copyright (C) 2006-2025 Raymond Bisdorff         *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* The module comes with ABSOLUTELY NO WARRANTY     *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* to the extent permitted by the applicable law.   *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* This is free software, and you are welcome to    *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* redistribute it if it remains free software.     *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;****************************************************&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-------- Testing classes and methods -------&#39;</span><span class="p">)</span>

    <span class="c1"># adA = RandomBipolarApprovalVotingProfile(numberOfVoters=4,</span>
    <span class="c1">#                                          votersIdPrefix=&#39;a&#39;,</span>
    <span class="c1">#                                          IntraGroup=True,</span>
    <span class="c1">#                                          numberOfCandidates=5,</span>
    <span class="c1">#                                          approvalProbability=0.3,</span>
    <span class="c1">#                                          disapprovalProbability=0.3,</span>
    <span class="c1">#                                          candidatesIdPrefix=&#39;b&#39;,</span>
    <span class="c1">#                                          seed=1,Debug=True)</span>
    <span class="c1"># adA.showBipolarApprovals()</span>
    <span class="c1"># for a in adA.voters:</span>
    <span class="c1">#     adA.showVoterBallot(a)</span>
<span class="c1">##    adB = RandomBipolarApprovalVotingProfile(numberOfVoters=5,</span>
<span class="c1">##                                             votersIdPrefix=&#39;b&#39;,</span>
<span class="c1">##                                             approvalProbability=0.5,</span>
<span class="c1">##                                             disapprovalProbability=0.5,</span>
<span class="c1">##                                             numberOfCandidates=5,</span>
<span class="c1">##                                             candidatesIdPrefix=&#39;a&#39;)</span>
<span class="c1">##    pv = RandomPrerankedVotingProfile(numberOfVoters=5,</span>
<span class="c1">##                                     numberOfCandidates=15,</span>
<span class="c1">##                                     votersIdPrefix=&#39;a&#39;,</span>
<span class="c1">##                                     candidatesIdPrefix=&#39;b&#39;,</span>
<span class="c1">##                                      lengthProbability=0.3,</span>
<span class="c1">##                                     votersWeights=[1,2,3,4,5],</span>
<span class="c1">##                                     seed=1)</span>
<span class="c1">##    pv.showPrerankedBallots()</span>
    
    <span class="c1"># k = 7</span>
    <span class="c1"># lvA = RandomLinearVotingProfile(numberOfVoters=k,numberOfCandidates=k,</span>
    <span class="c1">#                                   votersIdPrefix=&#39;a&#39;,</span>
    <span class="c1">#                                   candidatesIdPrefix=&#39;b&#39;,</span>
    <span class="c1">#                                 PartialLinearBallots=True,</span>
    <span class="c1">#                                 lengthProbability=0.5,</span>
    <span class="c1">#                                 seed=50)</span>
<span class="c1">##    lvB = RandomLinearVotingProfile(numberOfVoters=k,numberOfCandidates=k,</span>
<span class="c1">##                                      votersIdPrefix=&#39;b&#39;,</span>
<span class="c1">##                                    PartialLinearBallots=False,</span>
<span class="c1">##                                        candidatesIdPrefix=&#39;a&#39;,seed=114)</span>
<span class="c1">##</span>
<span class="c1">##    lvA.showLinearBallots()</span>
<span class="c1">##    lvB.showLinearBallots()</span>
<span class="c1">##    lvB.save(&#39;testpreorder&#39;)</span>
    
    <span class="n">v</span> <span class="o">=</span> <span class="n">RandomBipolarApprovalVotingProfile</span><span class="p">(</span><span class="n">numberOfVoters</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                           <span class="n">numberOfCandidates</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                           <span class="n">approvalProbability</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                           <span class="n">disapprovalProbability</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                           <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">DivisivePolitics</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                           <span class="n">WithPolls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="c1">##    v.showApprovalResults()</span>
<span class="c1">##    v.showDisapprovalResults()</span>
<span class="c1">##    v.showNetApprovalScores()</span>
<span class="c1">##    v.save(&#39;testAV&#39;)</span>
<span class="c1">##    v = BipolarApprovalVotingProfile(&#39;testAV&#39;)</span>
<span class="c1">##    print(v)</span>
<span class="c1">##    v.save2PerfTab(&#39;testODG&#39;)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">showHTMLVotingHeatmap</span><span class="p">(</span><span class="n">rankingRule</span><span class="o">=</span><span class="s1">&#39;NetFlows&#39;</span><span class="p">,</span><span class="n">Transposed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Threading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">##    from outrankingDigraphs import BipolarOutrankingDigraph</span>
<span class="c1">##    g = BipolarOutrankingDigraph(&#39;testODG&#39;)</span>
<span class="c1">##    g.showHTMLPerformanceTableau(Transposed=True)</span>
<span class="c1">##    print(g)</span>
<span class="c1">##    v3 =</span>
<span class="c1">##    RandomLinearVotingProfile(votersIdPrefix=&#39;m&#39;,candidatesIdPrefix=&#39;w&#39;)</span>
<span class="c1">##    v3.showLinearBallots() m = MajorityMarginsDigraph(v3,Debug=True)</span>
<span class="c1">##    print(m) m.showRelationTable() # m.showBestChoiceRecommendation()</span>
          
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*------------------*&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;If you see this line all tests were passed successfully :-)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enjoy !&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*************************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* R.B. September 2025               *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* $Revision: Python3.13 $           *&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*************************************&#39;</span><span class="p">)</span>

<span class="c1">#############################</span>
<span class="c1"># Log record for changes:</span>
<span class="c1"># $Log: votingDigraphs.py,v $#</span>
<span class="c1">#############################</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2025, Raymond Bisdorff.
      <span class="lastupdated">Last updated on Oct 25, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>